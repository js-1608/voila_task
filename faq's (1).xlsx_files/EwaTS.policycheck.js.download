'use strict';(globalThis.dullscriptWebpackJsonp=globalThis.dullscriptWebpackJsonp||[]).push([[46],{15486:function(fa,ka,a){a.r(ka);fa={};a.r(fa);a.d(fa,{gCl:function(){return H}});ka=a(68531);var J=a(59155),v=a(69405),na=a(31905),k=a(96785),A=a(21060),b=a(48392),c=a(21930),d=a(67150),l=a(90431),h=a(24072),f=a(6837),e=a(10121);class n{constructor(E,D,B,N,W,U){U=void 0===U?!0:U;this.Y0b="";this.f1b=this.zkg=this.pkg=null;this.wkg=!0;this.dbe=this.Uae=!1;this.qTc=Q=>{na.ULS.sendTraceTag(508048390,306,
50,"Early getPolicyLabels call succeeded");const M=this.B7(Q);k.AFrameworkApplication.W.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ImproveSensitivityCheck",!1)?(l.c()?appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!M)):(0,f.c)("Sensitivity",M),this.Uae&&(0,f.c)("OpenDocumentLabelPane",M),h.a.get_instance().lg(10,()=>this.a0g(M))):M&&h.a.get_instance().lg(10,this.a0g.bind(this))};this.a0g=Q=>{Q=void 0===Q?!0:Q;l.c()&&(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",
!Q)),k.AFrameworkApplication.W.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ImproveSensitivityCheck",!1)&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("OpenDocumentLabelPane",!Q||!this.Uae)),na.ULS.sendTraceTag(508048389,306,50,"Sensitivity visibility marked early"))};this.pTc=()=>{(0,b.f)(null,null);this.m1b.execute(Q=>{this.dbe?(0,b.g)()||k.AFrameworkApplication.W.Gp(()=>{const M=e.b.instance.supportsOfficeClientCoauthoring()?this.Y0b:k.AFrameworkApplication.W.appSettings.AppliedPolicyId;
Q.IIa(M,this.f1b)}):Q.IIa(this.Y0b,this.f1b)});na.ULS.sendTraceTag(508048388,306,10,"Early getPolicyLabels call failed")};if(!E)throw Error.argumentNull("appSettingsManager");if(!D)throw Error.argumentNull("clientRequestManager");this.DPj=new e.b(E);this.Akg=new e.a(E);this.pkg=E;this.zkg=D;this.BPj=B;this.APj=N;this.m1b=W;this.wkg=U;this.Uae=this.Akg.BZ();this.dbe=this.Akg.LKa()}CWi(E){var D=1;D=void 0===D?1:D;this.Y0b=E;this.f1b=D;na.ULS.sendTraceTag(508048392,306,50,"Early getPolicyLabels call");
const B=this.DPj.cVd(),N=(0,c.b)(D);(0,c.d)(this.pkg,this.zkg,this.qTc,this.pTc,(0,c.c)(this.BPj,B,this.APj,!1,"getpolicylabels",!1,D),E,N,D)}B7(E){try{let D;const B=null==E?void 0:null==(D=E.data)?void 0:D.responseData;let N;const W=null==E?void 0:null==(N=E.data)?void 0:N.wA,U=d.b(B);this.wkg&&(0,b.f)(U,W);return(0,c.a)(U)}catch(D){return na.ULS.sendTraceTag(508048391,306,10,"Error when deserializing DataLossPrevention response."),(0,b.f)(null,null),this.dbe?(0,b.g)()||k.AFrameworkApplication.W.Gp(()=>
{const B=e.b.instance.supportsOfficeClientCoauthoring()?this.Y0b:k.AFrameworkApplication.W.appSettings.AppliedPolicyId;this.m1b.execute(N=>{N.IIa(B,this.f1b)})}):this.m1b.execute(B=>{B.IIa(this.Y0b,this.f1b)}),!1}}}(0,J.a)(n,"SensitivityVisibilityInitializer",null,[]);var m=a(74295),t=(0,v.b)("Common.IAppliedPolicyLabelIdRequestor");const w=(0,v.c)(t);class u{constructor(){this.Bae=null;this.fbe=!0}get name(){return"Common.SensitivityStatusCheckPackage"}ji(){}init(){k.AFrameworkApplication.W.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EarlySensitivityVisibilityEnabled",
!1)&&(this.m1b=(0,v.d)(m.a),this.Bae=(0,v.a)(w),!k.AFrameworkApplication.W.AZ&&e.a.instance.LKa()?k.AFrameworkApplication.W.appSettings.WopiInfo?this.Dve(!0):h.a.get_instance().lg(23,()=>{this.Dve(!0)}):k.AFrameworkApplication.W.Gp(()=>{this.Dve(k.AFrameworkApplication.axa)}))}dispose(){}Dve(E){E=void 0===E?!1:E;!(0,f.b)("Sensitivity")||e.a.instance.BZ()&&e.a.instance.rxa()&&!(0,f.b)("OpenDocumentLabelPane")?e.a.instance.LKa()&&!k.AFrameworkApplication.W.AZ?this.B3f(E,!0):this.Bae.FZk()?this.B3f(E):
na.ULS.sendTraceTag(507827521,306,50,"Application indicates host does not support policies and GetPolicyLabel request will not be sent. "):na.ULS.sendTraceTag(507265989,306,50,"Control is already cached. Skipping GetPolicyLabel request.")}B3f(E,D){E=void 0===E?!1:E;try{const B=k.AFrameworkApplication.W.Na("AppliedPolicyId");""!==B||E?this.$fg(B,D):this.fbe=this.Bae.aRi(this.rSh.bind(this));this.fbe&&(0,b.d)(D)}catch(B){na.ULS.sendTraceTag(508048393,306,10,`Failed to create sensitivityVisibilityInitializer with exception ${B.message||
"Unknown"}`)}}$fg(E,D){try{D&&(0,b.d)(void 0);const B=e.b.instance.dVd();let N=k.AFrameworkApplication.Eh;e.a.instance.LKa()&&!N&&(N=decodeURIComponent(k.AFrameworkApplication.W.appSettings.WopiInfo));(new n(k.AFrameworkApplication.W,k.AFrameworkApplication.nc,B,N,this.m1b,null!=D?D:this.fbe)).CWi(E)}catch(B){na.ULS.sendTraceTag(507883677,306,10,`Failed to create sensitivityVisibilityInitializer with exception ${B.message||"Unknown"}`)}}rSh(E,D,B){D&&na.ULS.sendTraceTag(507883678,306,15,`Failed to create get the AppliedPolicyId with the following error ${D}`);
this.$fg(E,B)}static main(){A.a.instance.Ji(new u)}}(0,J.a)(u,"SensitivityStatusCheckPackage",null,[34,35]);var x=a(88620),z=a(81872),C=a(33585);class y{constructor(E){this.Wc=()=>{this.J.Z.pc&&(this.mBd(),this.J.Z.Gk(this.Wc))};this.Nd=(D,B)=>{B.wV||B.ng||(this.mBd(),this.J.hm(this.Nd))};this.J=E}mBd(){const E=this.J.ja.oa.Xb();(0,z.c)(this.J.ja.oa,this.J.pa.DocumentHostInfo.TenantId,D=>{this.yFg(D.Result,null)},()=>{this.yFg("","Unable to get policy label id from server")},null,null,E)}aRi(E){k.AFrameworkApplication.W.ha("SupportsOfficeClientCoauthoring")?
E("",null,!0):(this.yFg=E,this.J.Z.pc?this.mBd():C.EwaSettings.isChangeGateEnabled("OfficeVSO:9121209_EarlyPolicyAfterWorkbookOpened")?this.J.Al(this.Nd):this.J.Z.ek(this.Wc));return!0}FZk(){return k.AFrameworkApplication.W.ha("SupportsPolicies")}}(0,J.a)(y,"AppliedPolicyLabelIdRequestor",null,[424]);t=a(29004);a=a(42522);let H=class{constructor(E){this.J=E;this.init()}init(){x.a.instance.register(424,"Common.IAppliedPolicyLabelIdRequestor").Ac().Ic(()=>new y(this.J));u.main()}};H=(0,ka.__decorate)([(0,
a.d)(t.igc),(0,ka.__param)(0,(0,t.ra)())],H);(0,J.a)(H,"SensitivityCheck",null,[]);String(fa);window.___1721130813540_closurehack=fa},74295:function(fa,ka,a){a.d(ka,{a:function(){return J}});fa=a(69405);const J=(0,fa.b)("Common.App.Policy.Contracts.IPolicyManager")},10121:function(fa,ka,a){function J(c){if(c.startsWith("CLP."))return"Microsoft.Office.SharedOnline."+c;if(c.startsWith("Microsoft.Office.SharedOnline.")){const d=c.substring(30);return d.startsWith("CLP.")?c:"Microsoft.Office.SharedOnline.CLP."+
d}return"Microsoft.Office.SharedOnline.CLP."+c}function v(c){return c.startsWith("Microsoft.Office.SharedOnline.")?c:"Microsoft.Office.SharedOnline."+c}a.d(ka,{a:function(){return A},b:function(){return b}});fa=a(59155);var na=a(31905),k=a(96785);class A{static get instance(){if(A.Va)return A.Va;if(k.AFrameworkApplication.W){const c=new A(k.AFrameworkApplication.W);return A.Va=c}return new A(void 0)}constructor(c){this.W=c}TRd(c){let d;return!(null==(d=this.W)||!d.getBooleanFeatureGate(J(c),!1))}j6f(){const c=
J("BaseDocumentParameterizationChangeEnabled");let d;return!(null==(d=this.W)||!d.getBooleanFeatureGate(c,!1))}w7f(){const c=v("ClpDateTimeLabelToken");let d;return!(null==(d=this.W)||!d.getBooleanFeatureGate(c,!1))}q7f(){const c=J("DynamicWatermarkingInViewMode");let d;return!(null==(d=this.W)||!d.getBooleanFeatureGate(c,!1))}XXb(){const c=J("EnsureAppSettingsReadyInInit");let d;return!(null==(d=this.W)||!d.getBooleanFeatureGate(c,!1))}zL(){const c=J("FixBindingEnabled");let d;return!(null==(d=this.W)||
!d.getBooleanFeatureGate(c,!1))}BZ(){const c=v("ClpLouderLabelEnabled");let d;return!(null==(d=this.W)||!d.getBooleanFeatureGate(c,!1))}Wag(){const c=v("ClpQueryShortLabelEnabled");let d;return!(null==(d=this.W)||!d.getBooleanFeatureGate(c,!1))}LKa(){let c,d,l;return!(null==(c=this.W)||!c.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.RibbonSensitivityLabelPerfEnhancement",!1)||2!=(null==(d=k.AFrameworkApplication.qa)?void 0:null==(l=d.nb)?void 0:l.Dh))}WR(){const c=v("EnableSensitivityLabelingInOfficeJS");
let d;return!(null==(d=this.W)||!d.getBooleanFeatureGate(c,!1))}rxa(){const c=J("SeparateSensitivityBarRegistrationEnabled");let d;return!(null==(d=this.W)||!d.getBooleanFeatureGate(c,!1))}b3d(){const c=J("FixOfficeJSHasExtractForUserNull");let d;return!(null==(d=this.W)||!d.getBooleanFeatureGate(c,!1))}}(0,fa.a)(A,"ClpGates",null,[]);class b{static get instance(){if(b.Va)return b.Va;if(k.AFrameworkApplication.W){const c=new b(k.AFrameworkApplication.W);return b.Va=c}return new b(void 0)}constructor(c){this.W=
c}async fBf(){const c=this.W;if(!c)return 101;try{return await c.sTb(),0}catch(d){return na.ULS.sendTraceTag(506869249,306,10,"ClpSettings: Failed to get full app settings"),100}}AZ(){let c;return!(null==(c=this.W)||!c.AZ)}KNf(){let c;return(null==(c=this.W)?void 0:c.Ed("SetPolicyLabelAwaitFileExistsOnHostMaxRetries",6))||6}LNf(){let c;return(null==(c=this.W)?void 0:c.Ed("SetPolicyLabelAwaitFileExistsOnHostRetryDelayMs",5E3))||5E3}cVd(){let c;return(null==(c=this.W)?void 0:c.Na("PolicyHandlerEndpointName"))||
"PolicyHandler.ashx"}dVd(){let c;return(null==(c=this.W)?void 0:c.Na("PolicyHandlerWebServiceBase"))||k.AFrameworkApplication.qa.nb.OV}N1g(){let c;return!(null==(c=this.W)||!c.ha("ShouldInitCommonPolicyPackage"))}supportsOfficeClientCoauthoring(){let c;return!(null==(c=this.W)||!c.ha("SupportsOfficeClientCoauthoring"))}supportsPolicies(){let c;return!(null==(c=this.W)||!c.ha("SupportsPolicies"))}yw(){let c;return(null==(c=this.W)?void 0:c.Na("AppliedPolicyId"))||""}}(0,fa.a)(b,"ClpSettings",null,
[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.policycheck.js.map/682af9821a804c80a07b2a2b6e9a2b69/EwaTS.policycheck.js.map