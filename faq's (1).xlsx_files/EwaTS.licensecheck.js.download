'use strict';(globalThis.dullscriptWebpackJsonp=globalThis.dullscriptWebpackJsonp||[]).push([[37],{19601:function(fa,ka,a){a.r(ka);fa={};a.r(fa);a.d(fa,{kzl:function(){return n}});ka=a(68531);var J=a(59155),v=a(64797),na=a(31905),k=a(96785),A=a(21060),b=a(24072),c=a(90431),d=a(6837);class l{constructor(m){this.Rkg=m}get name(){return"EarlyLicenseFeatureCheck"}ji(){}init(){if(k.AFrameworkApplication.W.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",!1)){const m=async()=>{const t=
(0,v.a)(),w=Date.now(),u=[];for(const x of this.Rkg){const z=await t.isFeatureEnabled(x.feature,!1);u.push({yga:x.yga,isFeatureEnabled:z,A6d:x.A6d})}this.$7c(u,w)};k.AFrameworkApplication.W.Gp(()=>{this.CZk()?m().then(()=>{na.ULS.sendTraceTag(507388113,306,50,"EarlyFeatureChecks completed")}):na.ULS.sendTraceTag(507331904,306,50,"EarlyFeatureChecks not run since visibility is cached for all features")})}}$7c(m,t){c.c()?(this.vXg(m),na.ULS.sendTraceTag(507331604,306,50,`[EarlyLicenseFeatureCheck] ${m.map(w=>
w.yga).join(", ")} visibilities marked early while ribbon was displayed after: ${Date.now()-t}ms`)):((0,d.d)(m.map(w=>({controlId:w.yga,visible:w.isFeatureEnabled}))),b.a.get_instance().lg(10,()=>{this.vXg(m);na.ULS.sendTraceTag(507388114,306,50,`[EarlyLicenseFeatureCheck] ${m.map(w=>w.yga).join(", ")} visibilities marked early after waiting on ribbon to be displayed after: ${Date.now()-t}ms`)}))}vXg(m){const t=[];m.forEach(w=>{w.A6d?w.isFeatureEnabled?t.push(appChrome.actions.activateRibbonTab(w.yga)):
t.push(appChrome.actions.deactivateRibbonTab(w.yga)):t.push(appChrome.actions.updateControlHiddenState(w.yga,!w.isFeatureEnabled))});appChrome.api.dispatch(t)}CZk(){let m=!1;this.Rkg.forEach(t=>{(0,d.b)(t.yga)||(m=!0)});return m}dispose(){}}(0,J.a)(l,"EarlyLicenseFeatureCheck",null,[34,35]);var h=a(29004),f=a(42522),e=a(64169);let n=class{constructor(){this.init()}init(){A.a.instance.Ji(new l([{feature:"Copilot",yga:"Copilot"},{feature:"ExcelIdeas",yga:"AnalyzeData"},{feature:e.a.Zlb(),yga:"Automate",
A6d:!0}]))}};n=(0,ka.__decorate)([(0,f.d)(h.Nfc)],n);(0,J.a)(n,"LicenseBootCheck",null,[]);String(fa);window.___1721130813523_closurehack=fa},64169:function(fa,ka,a){a.d(ka,{a:function(){return b}});fa=a(59155);var J=a(96785),v=a(99906),na=a(33585),k=a(50455),A;(function(c){c.makerservicetest="makerservicetest";c.makerserviceprodnew="makerserviceprodnew";c.makerserviceint="makerserviceint";c.makerserviceprod="makerserviceprod";c.makerservicegcc="makerservicegcc"})(A||(A={}));(0,fa.b)("StorageModePreference",
A);class b{static vR(c){const d=na.EwaSettings.getBooleanFeatureGate(b.NKb,!1);let l=(0,v.a)(String,J.AFrameworkApplication.ic.AudienceGroup)||"";"TestHost"===c.pa.DocumentHostInfo.HostTier&&(l="BlueChicken");na.EwaSettings.isChangeGateEnabled("OfficeVSO:7833020_GCCModerateSupport")&&"USGov"===J.AFrameworkApplication.W.Na("SovereignEnvironmentName")&&(l="GCCModerate");return d?"Developer":l}static LZa(c){switch(b.vR(c)){case "Developer":return"DevCodeEditor.URL";case "Dogfood":case "Microsoft":case "BlueChicken":return"CodeEditor.URL";
case "GCCModerate":return"GCCMCodeEditor.URL";default:return"ProdCodeEditor.URL"}}static hGc(c){switch(b.vR(c)){case "Developer":return"DevScriptRecorder.URL";case "Dogfood":case "Microsoft":case "BlueChicken":return"ScriptRecorder.URL";case "GCCModerate":return"GCCMScriptRecorder.URL";default:return"ProdScriptRecorder.URL"}}static d_a(c){switch(b.vR(c)){case "Developer":return"DevRunFromButton.URL";case "Dogfood":case "Microsoft":case "BlueChicken":return"RunFromButton.URL";case "GCCModerate":return"GCCMRunFromButton.URL";
default:return"ProdRunFromButton.URL"}}static aGc(c){switch(b.vR(c)){case "Developer":return"DevPowerAutomate.URL";case "Dogfood":case "Microsoft":case "BlueChicken":return"PowerAutomate.URL";case "GCCModerate":return"GCCMPowerAutomate.URL";default:return"ProdPowerAutomate.URL"}}static $Za(){const c=(0,v.a)(String,J.AFrameworkApplication.ic.AudienceGroup)||"",d=na.EwaSettings.isChangeGateEnabled("OfficeVSO:7833020_GCCModerateSupport");return na.EwaSettings.getBooleanFeatureGate(b.JLa,!1)?"test":"Dogfood"===
c?"int":d&&"USGov"===J.AFrameworkApplication.W.Na("SovereignEnvironmentName")?"gcc":"prodNew"}static lmb(c){switch(c){case "test":return A.makerservicetest;case "prodNew":return A.makerserviceprodnew;case "int":return A.makerserviceint;case "gcc":return A.makerservicegcc;default:return A.makerserviceprod}}static CWd(){const c=b.$Za();switch(b.lmb(c)){case A.makerservicetest:return b.nbc;case A.makerserviceint:return b.mbc;default:return b.lbc}}static FRd(c){return`OfficeScriptingPermission-${c.pa.DocumentHostInfo.TenantId}`}static xTb(c){return c.isChromeRtl?
k.a.mMd:k.a.lMd}static wUb(){return k.a.NAc}static Zlb(){return na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptsConsumer",!1)&&J.AFrameworkApplication.W.ha("IsO365ConsumerHost")?b.M2b:na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptsOnlineOnly",!1)?b.L2b:b.Srb}}b.Srb="ExcelOfficeScripting";b.L2b="ExcelOfficeScriptingOnlineEnterprise";b.M2b="ExcelOfficeScriptingConsumer";b.NKb="Microsoft.Office.Excel.AutomateDevMode";b.JLa="Microsoft.Office.Excel.MakerTestService";
b.ska="Microsoft.Office.Excel.CopilotSaveAutomation";b.EFd="Microsoft.Office.Excel.CopilotPAIntegration";b.cnb="ExcelOnline";b.Fkb="Web";b.locale="en-Us";b.solutionId="FA000000043";b.b9b="1.0.0.0";b.iT=320;b.QMb="MakerCodeEditor";b.xue="MakerScriptRecorder";b.uue="ewaautomate_officescripts_20";b.tue="OfficeScripts_20";b.eSc=6;b.Bee=50;b.rle=6;b.vrc="AllMyScriptsButton";b.die="OnThisWorkbookSeeMore";b.gde="MyRecentScriptsSeeMore";b.Xte="SampleScriptsSeeMore";b.voe="Publish";b.soe="Delete";b.roe="Attach";
b.toe="Detach";b.uoe="Open";b.U7="clickId";b.$_c="RunFromButtonAction";b.Qte="shapeId";b.Pte="scriptLink";b.Ote="buttonText";b.uJe="ViewScriptAction";b.U_d="InitializeAction";b.lBe="ShowTaskpaneAction";b.dFd="ContactOwnerAction";b.RCe="StopRunAction";b.QCc="wacFlights";b.V4c="storageAuth";b.IJc="invocationContext";b.VCe="storageModePreference";b.XJd="documentHostInfo";b.Q5c="taskpaneWidth";b.Zsc="blockExternalCalls";b.yme="publishedScripts";b.qAb="workbookScripts_v3";b.dKe="workbookScripts";b.X9c=
"workbookId";b.G0c="scripts";b.pza="recentScripts";b.bIc="headerCssClass";b.s6c="titleCssClass";b.Q_c="ring";b.lbc="https://officescripting.microsoft.com";b.nbc="https://officescripting-test.microsoft.com";b.mbc="https://officescripting-int.microsoft.com";b.T5c="samples-11";b.U5c="samples-12";b.s0a="Scripts";b.t0a="OfficeScriptingCache";(0,fa.a)(b,"OfficeScriptsConstants",null,[])},42259:function(fa,ka,a){a.d(ka,{a:function(){return E}});fa=a(59155);var J=a(69405),v=a(68713),na=a(31905),k=a(84134),
A=a(70824),b=a(99906),c=a(86676),d=a(90166),l=a(38065),h=a(96785);class f{constructor(D,B,N){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=D;this.isEnabled=B;this.tierName=N}}(0,fa.a)(f,"FeatureStateChangeArgs",null,[]);var e=a(80268),n=a(74285),m=a(67150),t=a(93264),w=a(8004),u=a(59303),x=a(20584),z;(function(D){D[D.Enabled=0]="Enabled";D[D.Disabled=1]="Disabled"})(z||(z={}));(0,fa.b)("FeatureState",z);var C=a(39181),y=a(40562),H=a(20985);class E{constructor(D,B,N=null,
W=null,U=null){this.XN=this.Ara=this.PGb=this.nN=this.Nra=null;this.rje=Q=>{(Q=m.b(Q))?(na.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),na.ULS.sendTraceTag(50938594,3004,50,"{0}",Q)):na.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return Q.Features};this.UXd=()=>{na.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");
this.XN.then(Q=>{this.v6b(Q)}).catch(()=>{this.v6b({})})};this.Wle=Q=>{try{Q&&"Date"in Q&&(this.Ara=new Date(Q.Date),na.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.Ara.toString()))}catch(M){na.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",M)}};this.Mqa=new d.a(D,B);this.va=D;this.pmd=D.Ed("LicensingMaxRetryAttempts",0);this.Iba=D.ha("IsO365ConsumerHost");this.SSa=D.ha("IsO365CommercialHost");
this.RSa=D.ha("PremiumUpsellIsEnabled");this.N0=!1;this.aTa=0;this.qqa=N;this.cIb=W;this.eb=U;this.mN=D.ha("LicensingIsEnabled");this.OT=D.ha("OcpsIsEnabled")&&this.SSa;this.DUa=D.ha("ShowPrivacyDialog")&&!!W;this.Qqa=D.ha("IsAnonymousUser");this.IU=new Promise(Q=>{Q(!1)});this.fC=new Promise(Q=>{Q(!0)});this.WN=new k.a(A.a.Gf());this.Yra=!0;this.mFb=this.TTd();this.V1a()&&!this.Qqa?(void 0!==h.AFrameworkApplication.qa&&null!==h.AFrameworkApplication.qa&&(this.Nra=h.AFrameworkApplication.qa.pF,void 0!==
this.Nra&&null!==this.Nra&&(this.nN=this.Nra.Sg("WebServiceCall","ApplicationFeatureHelperService"))),this.XN=this.S9a()):this.XN=new Promise(Q=>{Q({})});this.XN.catch(Q=>{Q=(0,b.a)(l.a,Q);na.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",Q?Q.httpStatusCode.toString():"Unknown")});this.Yra&&this.isFeatureEnabled("FreemiumUpsell",!0).then(Q=>{this.N0=Q;return null})}TTd(){const D=this.va.gj("AllLicensedFeatures")?this.va.Rk("AllLicensedFeatures"):
[],B=new c.a;for(let N=0;N<D.length;N++)B.add(D[N]);return B}V1a(){return this.SSa||this.Iba}S9a(D=0,B=!1){na.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",B);const N=n.a.xp();N&&(N.set("retryAttempt",D.toString()),N.set("forceRefresh",B.toString()),N.set("isO365ConsumerHost",this.Iba.toString()),N.set("isO365CommercialHost",this.SSa.toString()),N.set("isFreemiumUpsellSettingEnabled",this.RSa.toString()),N.set("useOwlOrigin",this.va.ha("OwlOriginForAFHSIsEnabled").toString()));
e.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",N);e.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",y.b.SuccessBased,"waclicensing",N);void 0!==this.nN&&null!==this.nN&&this.nN.start();let W=null;B&&(W=new k.a(A.a.Gf()),W.$("x-LicensingForceRefresh","true"));this.PGb=new Date;B=this.va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.WACAADTokenForAFHSIsEnabled",!1);return(this.mN?this.Mqa.yka(this.hO("/afhs/ApplicationFeatureHelperHandler.ashx",
this.va.ha("OwlOriginForAFHSIsEnabled")),this.rje,0,W,this.Wle,["Date"],null,null,B):Promise.resolve({})).then(U=>{const Q={durationMs:this.kbc(),extendedProperties:N};Q.extendedProperties&&U&&(Q.extendedProperties.set("featureCount",u.a.count(U).toString()),Q.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in U).toString()),Q.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in U).toString()),"FreemiumUpsell"in U&&Q.extendedProperties.set("isFreemiumUpsellEnabled",
U.FreemiumUpsell.toString()),this.Ara&&Q.extendedProperties.set("fromCache",(this.Ara<this.PGb).toString()));e.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",Q);return U},U=>{const Q=Object.assign({},{durationMs:this.kbc()}),M=(0,b.a)(l.a,U);if(!M)return na.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),e.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",
!1,!0,Q),new Promise((aa,wa)=>{wa(U)});Q.extendedProperties=N;Q.extendedProperties&&Q.extendedProperties.set("status",M.httpStatusCode.toString());e.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,Q);return 408===M.httpStatusCode&&++D<=this.pmd?this.S9a(D):new Promise((aa,wa)=>{wa(M)})})}hO(D,B){D=String.format("{0}{1}",B?this.va.Na("OwlOrigin"):this.va.Na("WebServiceBase"),D);B&&(D+="?usid="+h.AFrameworkApplication.userSessionId);this.va.gj("ApplicationFeatureHelperHttpCachingEnabled")&&
this.va.ha("ApplicationFeatureHelperHttpCachingEnabled")&&(B=E.Bva(this.va))&&0<B.length&&(this.Yra&&(B+="ucbf"),D=new t.a(D),D.ej("afhskey",B),D=D.toString());return D}isFeatureEnabled(D,B){if(!this.OT&&!this.DUa&&!this.mN)return this.fC;na.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",D);if("ConnectedServices"===D){var N=this.OT?this.qqa.$z("ControllerConnectedServicesEnabled"):this.fC;const Q=this.DUa?this.cIb.getSettings().then(M=>
2!==M.$l,()=>B):this.fC;return N.then(M=>M?Q:this.IU)}if("FreemiumUpsell"===D&&(!this.RSa||!this.Iba||this.Qqa))return this.IU;if("sendcopilotfeedback"===D)return this.qqa.$z("sendcopilotfeedback",!1,!1).then(Q=>Q?this.fC:this.IU,()=>this.qqa.$z("Enabled",!1,!1).then(Q=>Q?this.fC:this.IU,Q=>"PolicyNotConfigured"===Q?this.fC:this.IU));N=null;N=this.OT?this.qqa.isFeatureEnabled(D):this.fC;let W=null;W=this.mN?this.Q2d(D,B):this.fC;let U=null;U=this.DUa?this.cIb.isFeatureEnabled(D):this.fC;return N.then(Q=>
Q?U.then(M=>M?W:this.IU):this.IU).then(Q=>{this.F0b(D,Q,!0);return Q},()=>{this.F0b(D,B,!1);return B})}F0b(D,B,N){na.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",D,B,N)}getFeatureTier(D,B){if(!this.mN)return new Promise(N=>{N(2)});na.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",D);return this.XN.then(N=>this.Sva(D,N,B),()=>B)}isFreemiumUpsellEnabled(){if(this.RSa&&this.Iba&&!this.Qqa){if(this.N0&&
2!==this.aTa||!this.N0&&1!==this.aTa)na.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.N0.toString()),this.aTa=this.N0?2:1;return this.N0}return!1}fdg(){return(0,H.g)()&&this.Iba&&this.Qqa}launchUpsellExperience(D,B=null){na.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",D));var N=n.a.xp();N&&(N.set("experienceId",D),
B&&N.set("campaignId",B));e.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",y.b.SuccessBased,"waclicensing",N);(N=(0,J.f)(v.a))?N.r9d(D,this.UXd,B):(na.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),e.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.eb.he(C.a.kSb,2,{["experience"]:D}))}l6a(D,B){if(!this.mN)return null;if(!D||!B)return na.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),
null;const N=x.a.create().toString();this.WN.qb(D)||this.WN.$(D,new k.a(A.a.Gf()));this.WN.ma(D).add(N,B);na.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",N,D));return N}RYc(D,B){this.mN&&(D&&this.WN.qb(D)?B&&x.a.isValid(B)?this.WN.ma(D).qb(B)?(na.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",
B,D)),this.WN.ma(D).remove(B)):na.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",B,D)):na.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",B,D)):na.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",
D)))}Sva(D,B,N){return this.Yra?D in B?B[D].LicenseTier:N:D in B?this.xje(B[D],N):N}xje(D,B){switch(D.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return B}}v6b(D){na.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const B=this.S9a(0,!0);B.then(N=>{this.XN=B;u.a.count(N)>u.a.count(D)?e.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):e.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess",
"FeatureCountNotIncreased",!1,!0,null);for(const W of this.WN.keys)if(W in N){const U=this.Sva(W,N,0);W in D?this.Sva(W,D,0)!==U&&this.h4a(W,!0,U):this.h4a(W,!0,U)}else W in D&&this.h4a(W,!1,this.Sva(W,D,0))}).catch(N=>{e.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);na.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(N))})}h4a(D,B,N){na.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",
D,B,N);B=new f(D,B,N);N=this.WN.ma(D);for(const W of N)try{W.value(B)}catch(U){na.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",D,W.key,U.message))}}Wd(D,B){if(this.mN){const N=this.mFb.contains(D);let W=!0,U="",Q=!1;return this.XN.then(M=>{D in M?(M=M[D],U=z[M.FeatureState],W=1!==M.FeatureState):W=!N;this.H0b(D,N,U,Q,B,W);return W},()=>{Q=!0;N&&(W=B);this.H0b(D,
N,U,Q,B,W);return W})}return this.fC}H0b(D,B,N,W,U,Q){na.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",D,B,W,N,U,Q)}Q2d(D,B){if(this.Yra)return this.Wd(D,B);if(this.mN){if(this.mFb.contains(D))return this.XN.then(N=>D in N,()=>B);na.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",
D)}return this.fC}kbc(){if(void 0!==this.nN&&null!==this.nN){const D=this.nN.zc;this.nN.stop();return D}return null}static Bva(D){try{if(w.a.t8g){const B=D.Na("UserDataSignature").split(".");if(1<B.length){const N=window.self.atob(B[1]),W=JSON.parse(N).LocalStorageKey;if(void 0!==W&&null!==W&&0<W.length)return W}}}catch(B){na.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",B.toString())}return null}}(0,fa.a)(E,"ApplicationFeatureHelper",null,[209])},64797:function(fa,ka,
a){a.d(ka,{a:function(){return b}});var J=a(96785),v=a(42259),na=a(88149),k=a(77759);let A;const b=()=>{A||(A=new v.a(J.AFrameworkApplication.W,J.AFrameworkApplication.nc,(0,na.a)(),(0,k.a)(),J.AFrameworkApplication.Ab));return A}},99112:function(fa,ka,a){a.d(ka,{a:function(){return z}});fa=a(59155);var J=a(69405),v=a(14566),na=a(31905),k=a(86676),A=a(99906),b=a(28482),c=a(42259);class d{constructor(C,y){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=C.PolicySettings;C=new Date;
C.setMinutes(C.getMinutes()+y);this.ExpirationTime=C.getTime()}}(0,fa.a)(d,"CloudPolicySettingsCacheData",null,[]);var l=a(90166),h=a(38065),f=a(80268),e=a(74285),n=a(67150),m=a(20481),t=a(14794);class w{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}(0,fa.a)(w,"CloudPolicySettingsData",null,[]);var u=a(40562),x=a(96785);class z{constructor(C,y){this.IRa=0;this.Dta=null;this.sje=H=>{let E=null;({ut:E}=n.d(H));H=!!E;na.ULS.sendTraceTag(50622687,3004,H?50:10,"ParseCloudPolicySettingsResponse: Success={0}",
H);return E};this.Xle=H=>{try{if(void 0!==H&&null!==H&&"CheckIn-Interval"in H){const E=parseInt(H["CheckIn-Interval"]);void 0!==E&&null!==E&&0<E&&(this.IRa=E)}}catch(E){na.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",E)}};this.Mqa=new l.a(C,y);this.va=C;y=C.Na("HostAuthType");this.OT=C.ha("OcpsIsEnabled")&&C.ha("IsO365CommercialHost")&&!(void 0===y||null===y)&&"aad"===y.toLowerCase();this.XFb=n.b(C.Na("OcpsDefaultSettings")||"{}");this.Kba=this.Bva();
y=this.va.gj("ServicesControlsMicrosoftControllerServicesList")?this.va.Rk("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.VRa=new k.a;for(let H=0;H<y.length;H++)this.VRa.add(y[H]);this.OT&&!C.ha("IsAnonymousUser")&&C.ha("SideCarIsEnabled")?this.Dta=this.pGe():this.Dta=this.zha(this.OT,this.sje);this.Dta.then(()=>null).catch(H=>{H=(0,A.a)(h.a,H);na.ULS.sendTraceTag(50622685,3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",H?H.httpStatusCode.toString():"Unknown")})}$z(C,
y=!0,H=!0){if(!this.OT){const B=this;return new Promise(N=>{N(B.nea(C))})}const E=this,D=this;return this.Dta.then(B=>{try{let N=null;B.PolicySettings&&"unknown"in B.PolicySettings&&(N=B.PolicySettings.unknown);if(N){if(C in N&&void 0!==N[C]&&null!==N[C])return new Promise(U=>{U("0"!==N[C])});const W=C.toLowerCase();if(W in N&&void 0!==N[W]&&null!==N[W])return new Promise(U=>{U("0"!==N[W])});if(H)return na.ULS.sendTraceTag(51512667,3004,50,"Policy"+C+" not found, using default"),new Promise(U=>{U(E.nea(C))});
na.ULS.sendTraceTag(508395746,3004,50,"Policy"+C+" not found, returning PolicyNotConfigured error");return new Promise((U,Q)=>{Q("PolicyNotConfigured")})}return new Promise(W=>{W(E.nea(C))})}catch(N){return na.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+C+" policy value. Error Message: {0}",N.message),E.handleError(N.toString(),y,E.nea(C))}},B=>D.handleError(B,y,D.nea(C))).then(B=>{na.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",
C,B);return B})}isFeatureEnabled(C,y=!0){return this.R2d(C,y)}R2d(C,y=!0){let H=new Promise(D=>{D(!0)}),E="";"mso_sendASmile"===C?E="Enabled":"Survey"===C||"FloodgateSurvey"===C?E="SurveyEnabled":this.VRa.contains(C)&&(E="ControllerConnectedServicesEnabled");""!==E&&(H=this.$z(E,y));return H.then(D=>{na.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",C,D,E);return D})}handleError(C,y,H){return y?new Promise(E=>{E(H)}):
new Promise((E,D)=>{D(C)})}zha(C,y){if(!C)return Promise.resolve(new w);let H=!1,E=null;(C=e.a.xp())&&C.set("useOwlOrigin",this.va.ha("OwlOriginForAFHSIsEnabled").toString());f.Health.instance.recordKpiUsage("GetCloudPolicySettings",u.b.SuccessBased,"jpittsdirects",C);const D=this.va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.WACAADTokenInOCPSIsEnabled",!1);let B=this.LNb("GetCloudPolicySettings");return(new Promise((N,W)=>{if(void 0!==this.Kba&&null!==this.Kba&&0<this.Kba.length){const U=
this.fGe();if(void 0!==U&&null!==U){H=!0;N(U);return}}this.Mqa.yka(this.hO("/afhs/CloudPolicySettings.ashx",this.va.ha("OwlOriginForAFHSIsEnabled")),y,1,null,this.Xle,["CheckIn-Interval"],this.va.Ed("CloudPolicySettingsRequestQueueTimeout",15E3),this.va.Ed("CloudPolicySettingsRequestSentTimeout",3E4),D).then(U=>{na.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.yGe(U);N(U);return U},U=>{W(U);return null})})).then(N=>{({stopwatch:B,returnValue:E}=this.iyb(B));
var W=e.a.xp();W&&(W.set("FromCache",H.toString()),W.set("useOwlOrigin",this.va.ha("OwlOriginForAFHSIsEnabled").toString()));W=Object.assign({},{durationMs:E,extendedProperties:W});f.Health.instance.recordKpiSuccess("GetCloudPolicySettings",W);return N})}pGe(){return t.a.S3c().then(()=>{na.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}hO(C,y){C=String.format("{0}{1}",
y?this.va.Na("OwlOrigin"):this.va.Na("WebServiceBase"),C);y&&(C+="?usid="+x.AFrameworkApplication.userSessionId);return C}nea(C){return C in this.XFb?"0"!==this.XFb[C]:!0}fGe(){try{const C=m.a.instance.getItem(this.Kba);if(void 0===C||null===C)return na.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;na.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",C);const y=JSON.parse(C);
if(void 0===y||null===y)return na.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===y.ExpirationTime||null===y.ExpirationTime)return na.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(y.ExpirationTime)).getTime()<Date.now())return na.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),
null;const H=new w;H.PolicySettings=y.PolicySettings;H.ControllerConnectedServicesFeatureNames=new b.a;this.va.gj("ServicesControlsMicrosoftControllerServicesList")&&this.va.Rk("ServicesControlsMicrosoftControllerServicesList");for(const E of this.VRa)H.ControllerConnectedServicesFeatureNames.add(E);na.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return H}catch(C){return na.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",
C.toString()),null}}yGe(C){try{if(void 0===C||null===C||void 0===C.PolicySettings||null===C.PolicySettings)na.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.IRa)na.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const y=new d(C,this.IRa),H=JSON.stringify(y);na.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",H);m.a.instance.setItem(this.Kba,
H);na.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(y){na.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",y.toString())}}Bva(){const C=c.a.Bva(this.va);return C&&0<C.length?"OCPS"+C:null}LNb(C){const y=(0,J.f)(v.a);return void 0!==y&&null!==y?y.Gc("WebServiceCall",C):null}iyb(C){if(void 0!==C&&null!==C){const y=C.zc;C.stop();return{returnValue:y,stopwatch:null}}return{returnValue:null,stopwatch:C}}}(0,
fa.a)(z,"CloudPolicySettingsHelper",null,[208])},88149:function(fa,ka,a){a.d(ka,{a:function(){return k}});var J=a(99112),v=a(96785);let na;const k=()=>{na||(na=new J.a(v.AFrameworkApplication.W,v.AFrameworkApplication.nc));return na}},90166:function(fa,ka,a){a.d(ka,{a:function(){return h}});fa=a(59155);var J=a(31905),v;(function(f){f[f.pSh=0]="applicationFeatureHelperHandler";f[f.M7h=1]="cloudPolicySettings";f[f.kRh=2]="alternateAuthToken"})(v||(v={}));(0,fa.b)("ApplicationFeatureHelperRequestType",
v);var na=a(38065),k=a(80268),A=a(61146),b=a(9433),c=a(22078),d=a(40562),l=a(74285);class h{constructor(f,e){this.va=f;this.lf=e}yka(f,e,n,m=null,t=null,w=null,u=null,x=null,z=!1){return z?this.yGd(f,e,n,m,t,w,u,x):this.SNb(f,e,n,m,t,w,u,x)}yGd(f,e,n,m=null,t=null,w=null,u=null,x=null){return new Promise((z,C)=>{this.lf.yz(f).then(()=>{this.SNb(f,e,n,m,t,w,u,x).then(y=>{z(y)},y=>{C(y)})})})}SNb(f,e,n,m=null,t=null,w=null,u=null,x=null){const z=v[n],C=z+"RequestFailure";k.Health.instance.recordKpiUsage(C,
d.b.FailureBased,"jpittsdirects",null);return new Promise((y,H)=>{J.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",z);const E=null!=u?u:this.va.Ed("ApplicationFeatureHelperRequestQueueTimeout",15E3),D=null!=x?x:this.va.Ed("ApplicationFeatureHelperRequestSentTimeout",3E4);this.lf.l1(f,1,null,this.TZa(n,m),w,!1,1,B=>{J.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",
z);try{if(void 0===B||null===B||void 0===B.data||null===B.data||void 0===B.data.responseData||null===B.data.responseData){k.Health.instance.recordKpiFailure(C,"Invalid RequestSucceededEventArgs",!1,!0,null);const W=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",z);H(this.eA(W,B))}else if(B.data.httpStatus!==b.a.jC){k.Health.instance.recordKpiFailure(C,"HttpStatusCode_"+B.data.httpStatus.toString(),
!1,!0,null);const W=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",B.data.httpStatus,z);H(this.eA(W,B))}else{void 0!==t&&null!==t&&void 0!==B.data.responseHeaders&&null!==B.data.responseHeaders&&t(B.data.responseHeaders);var N=e(B.data.responseData);if(N)J.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",
z),y(N);else{k.Health.instance.recordKpiFailure(C,"Parse Failure",!1,!0,null);const W=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",z);H(this.eA(W,B))}}}catch(W){k.Health.instance.recordKpiFailure(C,"Unexpected Failure",!1,!0,null),N=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",W,z),H(this.eA(N,B))}},B=>{var N;if(B.data){if(N=l.a.xp())try{N.set("useOwlOrigin",f.toLowerCase().includes("owl").toString())}catch(W){J.ULS.sendTraceTag(507876040,
3004,50,"Failed to set useOwlOrigin")}k.Health.instance.recordKpiFailure(C,"HttpStatusCode_"+B.data.httpStatus.toString(),!1,!0,{extendedProperties:N});N=c.a.Kva(B.data.responseData||"No Data");N=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",B.data.httpStatus,N,z)}else k.Health.instance.recordKpiFailure(C,"Invalid RequestFailedEventArgs",!1,!0,null),N=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
z);H(this.eA(N,B))},null,void 0,void 0,E,D)})}eA(f,e){const n=new na.a;n.message=f;n.httpStatusCode=e&&e.data?e.data.httpStatus:-1;return n}TZa(f,e){const n={};n["x-UserDataSignature"]=this.va.Na("UserDataSignature");n["x-LicensingIsEnabled"]=this.va.ha("LicensingIsEnabled").toString();n["x-CacheIsEnabled"]=this.va.ha("LicensingRedisIsEnabled").toString();n["x-OcpsIsEnabled"]=this.va.ha("OcpsIsEnabled").toString();n["x-LicensingAADIdIsEnabled"]=this.va.ha("LicensingAadIdIsEnabled").toString();0===
f&&(n["x-LicenseCheckOnTenantEnabled"]="true",n["x-SupportUserConsentDependentFeatures"]="true",n["x-AFHUserConsentGroupValue"]="0",n["x-UseShellServiceForUserConsentGroup"]="true",n["x-SMBUserLicensingEnabled"]="true",n["x-AFHPIPLComplianceEnabled"]=A.a.ys(window.location.href,"wd_afhpipl")||"false",n["x-ConsumerLicensingSNICertIsEnabled"]=this.va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ConsumerLicensingSNICertIsEnabled",!1).toString(),n["x-MSGraphInLicensingIsEnabled"]=this.va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MSGraphInLicensingIsEnabled",
!1).toString(),n["x-MSGraphResultInLicensingIsEnabled"]=this.va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MSGraphResultInLicensingIsEnabled",!1).toString());if(e)for(const m of e.keys)n[m]=e.ma(m);return n}}(0,fa.a)(h,"HttpRequestToPromiseUtility",null,[])},38065:function(fa,ka,a){a.d(ka,{a:function(){return J}});fa=a(59155);class J{constructor(){this.message=null;this.httpStatusCode=0}}(0,fa.a)(J,"HttpRequstToPromiseRejectData",null,[])},17241:function(fa,ka,a){a.d(ka,{a:function(){return l}});
fa=a(59155);var J=a(31905),v=a(28482),na=a(86676),k=a(96785);class A{constructor(){this.JPb=this.Mdc=this.$l=0;this.KPb=this.Ndc=this.e8="";this.hUa=this.QP=2}clone(){const h=new A;h.$l=this.$l;h.Mdc=this.Mdc;h.JPb=this.JPb;h.e8=this.e8;h.Ndc=this.Ndc;h.KPb=this.KPb;h.QP=this.QP;h.hUa=this.src;return h}get src(){return this.hUa}serialize(h=null){const f={};if(!h||h.contains(A.UV))f[A.UV]=this.$l;if(!h||h.contains(A.Cfa))f[A.Cfa]=this.e8;if(!h||h.contains(A.Dfa))f[A.Dfa]=this.QP;return JSON.stringify(f)}static create(h,
f=null){const e=new A;e.hUa=h;void 0!==f&&null!==f&&(A.UV in f&&(e.$l=f[A.UV]),A.Cfa in f&&(e.e8=f[A.Cfa]),A.Dfa in f&&(e.QP=f[A.Dfa]));return e}static deserialize(h,f){try{const e=JSON.parse(h);if(void 0!==e&&null!==e)return A.create(f,e);J.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",h);throw Error.argument("settingsData");}catch(e){throw J.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",e.toString()),e;}}}A.UV=
"CCS";A.Cfa="CCSTime";A.Dfa="OfficePrivacyRoamedNoticeShown";(0,fa.a)(A,"UserPrivacySettings",null,[]);var b=a(87682),c=a(9433),d=a(57470);class l{constructor(h,f){this.URa=null;if(void 0===h||null===h||void 0===f||null===f)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.va=h;this.lf=f;this.cUa=this.Pd=null;this.LEb=this.va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OptimizedPrivacySettingsLookup",!1)}get qFd(){this.URa||(this.URa=this.ZSb());return this.URa}hO(h){var f=
String.format("{0}RoamingServiceHandler.ashx?action=",this.va.appSettings.RoamingServiceHandlerWebServiceBase||"");f=new Sys.StringBuilder(f);f.append(h);f.append("&");f.append(k.AFrameworkApplication.Eh);return f.toString()}executeRequest(h,f,e,n=null){if(k.AFrameworkApplication.W.getBooleanFeatureGate("Microsoft.Office.SharedOnline.WatcUserPrivacySettingsHelper",!1)){const m=new d.a;this.lf.yz(h).then(()=>{this.lf.t7(h,f,n,null,e,"33",!1,null,6E4).continueWith(t=>{m.setResult(t.result)})});return m.task}return this.lf.t7(h,
f,n,null,e,"33",!1,null,6E4)}saveSettings(h){return new Promise((f,e)=>{try{if(void 0===this.Pd||null===this.Pd||void 0===h||null===h)J.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),e("Can't determine setting changes to save");else{var n=this.Pd.$l!==h.$l;if(2===this.Pd.src&&n)this.iue(h),f(!0);else{var m=this.Rve(h);if(void 0===m||null===m||!m.length)J.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),
e("No changes to save");else if(1===this.Pd.src)f(this.Occ(m));else if(0===this.Pd.src){J.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",m);const t=this.executeRequest(this.hO("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",m);t.continueWith(()=>{if(t.$h||t.Kg)J.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),f(!1);else{var w=t.result;void 0!==w.Kf&&null!==w.Kf&&void 0!==w.Kf.data&&null!==w.Kf.data&&
w.Kf.data.httpStatus===c.a.jC?(J.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),f(!0)):(J.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),f(!1))}})}}}}catch(t){J.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",t.toString()),f(!1)}})}Rve(h){if(void 0===this.Pd||null===this.Pd||void 0===h||null===h)throw Error.invalidOperation("User Privacy settings have not been initialized");const f=new v.a;
0===h.src?(this.Pd.$l!==h.$l&&(f.add(A.UV),f.add(A.Cfa)),this.Pd.QP!==h.QP&&f.add(A.Dfa)):1===h.src&&this.Pd.$l!==h.$l&&f.add(A.UV);return f.count?h.serialize(f):(J.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.cUa){const h=this;this.cUa=new Promise(f=>{try{h.Pd?f(h.Pd.clone()):h.mGe().then(e=>{h.Pd=e;f(h.Pd.clone());return null},()=>{h.kGe().then(e=>{h.Pd=e;f(h.Pd.clone());return null},()=>{h.lGe().then(e=>{h.Pd=e;f(h.Pd.clone());
return null},()=>{J.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");h.Pd=new A;f(h.Pd.clone());return null});return null});return null})}catch(e){J.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",e.toString()),h.Pd=new A,f(h.Pd.clone())}})}return this.cUa}mGe(){return new Promise((h,f)=>{try{const n=-1!==window.location.href.indexOf("&wd_pn=2");if(this.va.ha("PrivacyDialogShouldCheckRoaming")||n){var e=
this.executeRequest(this.hO("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");e.continueWith(()=>{try{if(e.$h||e.Kg)J.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const m=e.result;if(m&&m.Kf&&m.Kf.data)if(m.Kf.data.httpStatus!==c.a.jC)J.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",m.Kf.data.httpStatus);else{if(m.Kf.data.responseData){h(l.parse(m.Kf.data.responseData,
0));J.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",m.Kf.data.responseData);return}J.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else J.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");f("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(m){J.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",
m.toString()),f("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else J.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),f("Roaming should not be used")}catch(n){J.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",n.toString()),f("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}kGe(){return new Promise((h,f)=>{try{const e=b.a.get("WacUPToggleState");let n=null;void 0!==e&&null!==
e&&0<e.length&&(n=decodeURIComponent(e));if(void 0!==n&&null!==n&&0<n.length){const m=l.parse(n,1);J.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",m.toString());h(m)}else{const m=A.create(1),t=new v.a;t.add(A.UV);const w=m.serialize(t);this.Occ(w)?(J.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",w),h(m)):(J.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",
w),f("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(e){J.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",e.toString()),f("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}lGe(){return new Promise(h=>{try{var f=-1!==window.location.href.indexOf("&wdccsoff=1");const e=A.create(2);f?(e.$l=2,k.AFrameworkApplication.Uyc(),J.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",
e.toString())):(e.$l=1,J.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",e.toString()));h(e)}catch(e){J.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",e.toString()),f=A.create(2),f.$l=1,h(f)}})}iue(h){J.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===h.$l?k.AFrameworkApplication.Uyc():k.AFrameworkApplication.eAf();J.ULS.sendTraceTag(51258454,
3004,50,"SaveSettingsToQueryParam saved settings = {0}",h)}Occ(h){try{J.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",h);const f=this.va.Na("PrivacyCookieDomain")||"";if(!f||!f.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");J.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",h);return b.a.w2c("WacUPToggleState",h,b.a.m4,"/",f)}catch(f){return J.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",
f.toString()),!1}}isFeatureEnabled(h){return this.LEb&&!this.EXb(h)?Promise.resolve(!0):this.getSettings().then(f=>this.EXb(h)?2!==f.$l:!0,()=>{J.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",h);return!0})}EXb(h){if(!this.LEb){const f=this.ZSb(),e=new na.a;for(let n=0;n<f.length;n++)e.add(f[n]);return e.contains(h)}return this.qFd.includes(h)}ZSb(){return this.va.gj("ServicesControlsMicrosoftControllerServicesList")?this.va.Rk("ServicesControlsMicrosoftControllerServicesList"):
[]}static parse(h,f){try{return J.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",h,f),A.deserialize(h,f)}catch(e){throw J.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",e.toString()),e;}}}(0,fa.a)(l,"UserPrivacySettingsHelper",null,[210])},77759:function(fa,ka,a){a.d(ka,{a:function(){return k}});var J=a(17241),v=a(96785);let na;const k=()=>{na||(na=new J.a(v.AFrameworkApplication.W,v.AFrameworkApplication.nc));return na}},68713:function(fa,
ka,a){a.d(ka,{a:function(){return J}});fa=a(69405);const J=(0,fa.b)("Common.IInProductMessagingUIManager")},14794:function(fa,ka,a){a.d(ka,{a:function(){return k}});fa=a(59155);var J=a(96785),v=a(68968),na=a(68666);class k{static S3c(){return J.AFrameworkApplication.W.ha("SideCarIsEnabled")?k.Yza&&k.hob?new Promise(A=>{A(!0)}):new Promise((A,b)=>{k.Yza=na.a.create(J.AFrameworkApplication.W.Na("SideCarUrl"));v.a.xua(k.Yza);k.Yza.wja((c,d)=>{(k.hob=d.succeeded)?A(d.succeeded):b(d.succeeded)})}):new Promise(A=>
{A(!1)})}}k.hob=!1;k.Yza=null;(0,fa.a)(k,"SideCarLoader",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.licensecheck.js.map/45bfa50db4b47ef9d0873e180a002cae/EwaTS.licensecheck.js.map