function _define_property(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _object_spread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){_define_property(e,t,n[t])}))}return e}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _object_spread_props(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(window,(function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=253)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.duplicateStyle=t.getRenderingRegionKey=t.updateCellMergeInformation=t.isPLTRegressionInMFPFixEnabled=t.isGridRenderPerfFixEnabled=t.isOffscreenCanvasSupported=t.isFontRefactorFGEnabled=t.isModernFontRenderingEnabled=t.isSubPixelRenderingEnabled=t.getDynamicImageInformationFromCell=t.getDynamicImages=t.extendHighContrastScheme=t.extendRenderingContext=t.getPreviewCellsRange=t.areTwoRectsEqual=t.isPointInRect=t.doRangesIntersect=t.intersects1D=t.rgbToColorHex=t.getModelColumnIndex=t.getModelRowIndex=t.isDefined=t.prepareTextRunRanges=t.removeHardBreaks=t.shouldRenderFormulaOnCell=t.updateCellText=t.getDisplayText=t.getFormattedTextForMetadata=t.getFormattedText=t.isHighContrastMode=t.hasWorkbookBackgroundColor=t.getWorkbookBackgroundColor=t.setCellCachedDisplayText=t.getTextRunText=t.getCellPositionInArray=t.getCellFont=t.getColumnWidth=t.setCellAndSpannedOverCellsDirty=t.initializeCellCachedObjects=t.isCellAdjacentToMergedCell=t.getLinePixelTranslation=t.throwError=t.shouldApplyBorderAtPosition=t.isSerializedBorderPresent=t.isActualBorderPresent=t.verifyCellStyleAndFont=t.binarySearch=t.numbersComparer=t.assertArgumentNotNull=t.NumberOfUniqueStyleIDs=void 0,t.isFontRefactorFGV2Enabled=t.afterBorderStyleEdit=t.setBordersNew=t.prepareBorderStyleForEdit=t.removeRowHeightOverrides=t.updateModelWithRowHeightOverrides=t.isFixedRows=t.getBreakOpForThaiText=t.doesTextContainThaiCharacter=t.getLastNonUniqueStyleID=t.getChangedCellsFromModel=t.updateReferenceUpdate=t.isCellPreviewTextDefined=t.isSafari=t.isMac=t.getLastBorderStyleID=t.removeBorderFromCell=t.addBorderToCellIfNotPresent=t.addLeftBorderToAdjacentCell=t.attachCellToModel=t.setBordersToBorderStyle=t.removeBordersWithinSpillCellRange=t.removeBordersWithinASpillCell=t.duplicateTextRun=t.updateGlobalFontIdsOfTextRuns=t.duplicateTextRuns=t.getCellStyleHashesFromModel=t.removeValueFromArray=t.addNewValueToArray=t.registerCanvasHitRegionsFromCache=t.renderingRegionContainsDirtyCells=t.isLargeBlock=t.validateRenderingRegion=t.getDrawingOffsetXForRenderingRegion=t.incrementNumericVal=t.duplicateFont=t.duplicateBorderStyle=t.duplicateOnlyStyleWithoutFont=void 0;const o=n(1),r=n(3),i=n(6),l=n(109),a=n(14),s=n(31),d=n(4),c=n(11);let u,g,h,C,f,m;function p(e,t){return e-t}function y(e,t,n,o,r){let i=t,l=t+n-1;for(;i<=l;){const t=i+(l-i>>1),n=r(e instanceof Array?e[t]:e.item(t),o);if(0===n)return t;n<0?i=t+1:l=t-1}return~i}function S(e,t){return((e.BitwiseBorderPosition||0)&1<<t)==1<<t}function R(e,t){const n=e.CachedBorderStyle;if(!n||!n.Borders)return!1;for(const e of n.Borders)if(e.BorderPosition===t)return!0;return!1}function F(e,t){if((0,d.verifyArgumentNotNull)(e,"cell","getCellFont"),(0,d.verifyArgumentNotNull)(t.Styles,"Styles","getCellFont"),(0,d.verifyArgumentNotNull)(t.Fonts,"Fonts","getCellFont"),!e.CachedFont){const n=(0,o.getCellStyle)(t,e);e.CachedFont=(0,o.getFontByID)(n,t,(null==e?void 0:e.StyleID)||0)}return e.CachedFont}function T(e,t){let n=y(t,0,t.length,e,o.cellsPositionComparer);return n<0&&(n=~n),n}function w(e){return!(0,i.isNullOrUndefined)(e)}function I(e,t,n){var o;if(t.TextRuns&&n.Fonts)return{Text:e,TextRuns:null!==(o=t.CachedDisplayTextRuns)&&void 0!==o?o:t.TextRuns,Fonts:n.Fonts}}function b(e,t){if(K(e.PreviewText))return e.PreviewText;if(e.DisplayFormula)return e.FormulaInfo.Formula;if((0,a.shouldRenderVerticalText)(e)&&e.Text&&e.OriginalText&&(n=e.Text,/^(#)+$/.test(n)))return e.OriginalText;var n;if(!M(e))return e.Text;if((0,i.isNullOrUndefined)(e.CachedDisplayText))if(!(0,i.isNullOrUndefined)(e.Text)&&(0,i.isNullOrUndefined)(e.WrapText)&&e.Text.indexOf(r.HardBreak)>=0){const n=I(e.Text,e,t);!(0,i.isNullOrUndefined)(n)&&n.Text.indexOf(r.HardBreak)>=0&&(e.CachedDisplayTextRuns=function(e){const t=e.TextRuns,n=[],o=e.Text;x(t,o);let i=0;for(let l=0;l<t.length;l++){const a=t[l];(0,d.verifyArgumentNotNull)(a.EndIndex,"EndIndex","getAdjustedTextRuns"),(0,d.verifyArgumentNotNull)(a.StartIndex,"StartIndex ","getAdjustedTextRuns");let s=a.StartIndex,c=a.EndIndex;i!==s&&(c+=i-s,s=i);for(let t=a.StartIndex;t<a.EndIndex;t++)o.charAt(t)!==r.HardBreak||e.WrapText||c--;n.push({StartIndex:s,EndIndex:c,FontID:a.FontID,GlobalFontID:a.GlobalFontID,CachedFont:a.CachedFont}),i=c}return n}(e)),e.CachedDisplayText=v(e.Text)}else e.CachedDisplayText=e.Text;return e.CachedDisplayText}function v(e){return-1!==e.indexOf(r.HardBreakCRLF)||-1!==e.indexOf(r.HardBreak)?e.replace(/\r\n|\n/g,""):e}function x(e,t){var n;if(void 0===(null===(n=e[0])||void 0===n?void 0:n.EndIndex))for(let n=0;n<e.length;n++){const o=e[n],r=n<e.length-1?e[n+1].StartIndex:t.length;o.EndIndex=r}}function D(e){let t=Number(e).toString(16);for(;t.length<6;)t="0"+t;return"#"+t}function A(e,t,n,o){return!(t<n||o<e)}function P(e){return!(0,i.isNullOrUndefined)(e.Text)&&(0,i.isNullOrUndefined)(e.WrapText)&&e.Text.indexOf(r.HardBreak)>=0&&e.Text!==e.CachedDisplayText}function M(e){var t;const n=e.ValueType===o.CellValueType.Number,r=(0,o.shouldOverrideText)(e),i=P(e),l=(null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment)===o.HorizontalAlignment.Fill;return n||i||l||r}function B(){return void 0!==u?u:(u=(0,o.isChangeGateEnabled)(o.ChangeGate.ModernFontRendering)?(0,c.getBooleanFeatureGate)("Microsoft.Office.Excel.ModernFontRendering"):(0,c.getBooleanFeatureGate)("Microsoft.Office.Excel.ModernFontPicker"),!!u)}function H(e,t,n,r){const i=O(t,n,r);if(e.Fonts){const n=(0,o.getFontByID)(t,e,void 0);n.RefCount=L(n.RefCount||0)}return i}function O(e,t,n){return{BackgroundColor:e.BackgroundColor,HorizontalAlignment:e.HorizontalAlignment||o.HorizontalAlignment.Automatic,ID:t||0,NamedStyleId:e.NamedStyleId||0,RefCount:n||0,VerticalAlignment:e.VerticalAlignment,Indentation:e.Indentation||0,IsUnlocked:e.IsUnlocked,IsHidden:e.IsHidden,ReadingOrder:e.ReadingOrder||o.ReadingOrderType.Context,FontID:e.FontID||0,GlobalFontID:e.GlobalFontID,ShrinkToFit:e.ShrinkToFit,Gradient:e.Gradient,Orientation:e.Orientation||0,VerticalText:e.VerticalText||!1,PatternStyle:e.PatternStyle||0,PatternColor:e.PatternColor}}function k(e,t,n){const o=[];for(let t=0;t<e.Borders.length;t++){const n=e.Borders[t],r={BorderLineStyle:n.BorderLineStyle,BorderPosition:n.BorderPosition,Weight:n.Weight,Color:{Red:n.Color.Red,Blue:n.Color.Blue,Green:n.Color.Green}};o.push(r)}return{Borders:o,ID:t||0,RefCount:n||0}}function L(e){return(0,i.isNullOrUndefined)(e)?1:e+1}function N(e,t){return{FontID:null!=t?t:e.FontID||0,GlobalFontID:e.GlobalFontID,StartIndex:e.StartIndex,CachedFont:e.CachedFont}}function E(e,t,n,r){const i=1===n?r+1:r;for(let r=1===n?1:0;r<i;r++){const i=(0,o.getCell)(t.Row,t.Col+n*r,e);if(i){const t=(0,o.getCellBorderStyle)(e,i);t&&t.Borders&&t.Borders.length>0&&_(i,t,e)}}}function z(e,t,n){if((0,o.isRenderFlagEnabled)(o.RenderFlagsArray.MoveSpillCellBeforeRendering,t))j(e,n,t);else{(0,d.verifyArgumentNotNull)(e,"cell","setBorders"),(0,d.verifyArgumentNotNull)(n,"BorderStyle","setBorders");const r=(0,o.getCellBorderStyle)(t,e),i=V(t)+1;n.ID=i,r.RefCount=Math.max(0,(r.RefCount||0)-1),t.BorderStyles.splice(i,0,n),e.BorderStyleID=i,e.CachedBorderStyle=n}}function W(e,t){if((0,d.verifyArgumentNotNull)(e,"cell","attachCellToModel"),(0,d.verifyArgumentNotNull)(t.Cells,"this.model.Cells","attachCellToModel"),(0,o.getCell)(e.Row,e.Col,t))return;const n=(0,o.getModelClientCache)(t),r=T(e,t.Cells);t.Cells.splice(r,0,e),n.CellLookup[(0,o.getCellLookupKey)(e.Row,e.Col)]=e;const i=(0,o.getCellStyle)(t,e);(0,d.verifyArgumentNotNull)(i,"style","attachCellToModel"),i.RefCount=L(i.RefCount||0);const l=(0,o.getCellBorderStyle)(t,e);(0,d.verifyArgumentNotNull)(l,"borderStyle","attachCellToModel"),l.RefCount=L(l.RefCount||0),e.CachedBorderStyle=l}function G(e,t,n,r){const i=(0,o.getCellBorderStyle)(t,e);if(!i)return;let l=!1;for(let e=0;e<i.Borders.length;e++)if(i.Borders[e].BorderPosition===r){l=!0;break}l||(ne(e,t),(0,o.getCellBorderStyle)(t,e).Borders.push(n),re(e,t))}function V(e){return e.BorderStyles.length-1}function j(e,t,n){(0,d.verifyArgumentNotNull)(e,"cell","setBorders"),(0,d.verifyArgumentNotNull)(t,"BorderStyle","setBorders");const r=(0,o.getCellBorderStyle)(n,e),i=V(n)+1;t.ID=i,r.RefCount=Math.max(0,(r.RefCount||0)-1),n.BorderStyles.splice(i,0,t),e.BorderStyleID=i,e.CachedBorderStyle=t}function _(e,t,n){const r=k(t,t.ID||0,1);if(r&&r.Borders){const t=r.Borders.length;for(let i=0;i<t;i++){const t=r.Borders[i];t&&t.BorderPosition===o.BorderPositionType.Left&&(r.Borders.splice(i),(0,o.isGlobalBorderStylesEnabled)(n)?ie(e,n,r,!0):j(e,r,n))}}}function U(e,t){const n=(0,o.getReferencedObjectById)(t.FontID||0,e.Fonts);return $(t.IsUnlocked)+"|"+$(t.IsHidden)+"|"+$(t.VerticalText)+"|"+$(t.IsPattern)+"|"+$(t.ShrinkToFit)+"|"+Y(t.HorizontalAlignment)+"|"+Y(t.VerticalAlignment)+"|"+Y(t.ReadingOrder)+"|"+Y(t.NamedStyleId||0)+"|"+Y(t.Orientation||0)+"|"+Y(t.Indentation||0)+"|"+Y(t.BackgroundColor)+"|"+function(e){if(!e)return"0";let t="";for(let o=0;o<(null===(n=e.Stops)||void 0===n?void 0:n.length);o++){var n;const r=e.Stops[o];r&&(t+=q(r)+"|")}return Y(e.ShadingStyle)+"|"+t}(t.Gradient)+"|"+function(e){return $(e.Bold)+"|"+$(e.Italic)+"|"+$(e.StrikeThrough)+"|"+Y(e.FontName)+"|"+Y(e.Size)+"|"+Y(e.Color)+"|"+Y(e.Underline)+"|"+Y(e.VerticalAlign)+"|"+Y(e.FontScheme)}(n)+"|"}function q(e){return Y(e.Color)+"|"+Y(e.Position)}function $(e){return e?1:0}function Y(e){return e||0}function X(){var e;return(null===(e=window)||void 0===e||null===(e=e.navigator)||void 0===e?void 0:e.userAgent.indexOf("Macintosh"))>=0}function K(e){return null!=e}function J(e){return e.Styles.length-t.NumberOfUniqueStyleIDs-1}function Z(e,t){const n=J(e)+1,r=H(e,(0,o.getCellStyleByID)(t,e),n,1);return r.HorizontalAlignment=o.HorizontalAlignment.Center,r.VerticalAlignment=o.VerticalAlignment.Center,e.Styles.splice(n,0,r),{refErrorStyle:r,refErrorGlobalId:(0,o.getGlobalCellStylesMap)().getOrCreateID(r)}}function Q(e,t,n){e.HorizontalAlignmentSet=!1,e.CachedStyle=t,e.GlobalCellStyleID=n,e.StyleID=t.ID}function ee(e,t,n){let o=!1;if(e.Merge){const r=e.Row+e.Merge.Rows,i=t.RowNumbers[r],l=e.Col+e.Merge.Columns;o=n(i,t.ColumnNumbers[l])}return o}function te(e){let t=0;for(let n=0;n<e.RowHeights.length;n++)e.RowOffsets[n]=t,t+=e.RowHeights[n];e.BlockHeight=t}function ne(e,t){const n=(0,o.getCellBorderStyle)(t,e);if((0,o.isGlobalBorderStylesEnabled)(t))oe(e,t,k(n,0,1),!1);else{if((n.ID||0)!==o.UniqueStyleID.DefaultBorder&&(n.RefCount||0)<=1)return;z(e,t,k(n,0,1))}}function oe(e,t,n,r){if((0,o.isRenderFlagEnabled)(o.RenderFlagsArray.MoveSpillCellBeforeRendering,t))ie(e,t,n,r);else{(0,d.verifyArgumentNotNull)(e,"cell","setBordersNew"),(0,d.verifyArgumentNotNull)(n,"BorderStyle","setBordersNew");const i=(0,o.getCellBorderStyle)(t,e),l=V(t)+1;n.ID=l,i.RefCount=Math.max(0,(i.RefCount||0)-1),t.BorderStyles.splice(l,0,n),e.BorderStyleID=l,r?(e.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID(n),e.CachedBorderStyle=(0,o.getBorderStyleByID)(e,t)):e.CachedBorderStyle=n}}function re(e,t){const n=(0,o.getCellBorderStyle)(t,e);e.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID(n),e.CachedBorderStyle=(0,o.getBorderStyleByID)(e,t)}function ie(e,t,n,r){(0,d.verifyArgumentNotNull)(e,"cell","setBorders"),(0,d.verifyArgumentNotNull)(n,"BorderStyle","setBorders");const i=(0,o.getCellBorderStyle)(t,e),l=V(t)+1;n.ID=l,i.RefCount=Math.max(0,(i.RefCount||0)-1),t.BorderStyles.splice(l,0,n),e.BorderStyleID=l,r?(e.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID(n),e.CachedBorderStyle=(0,o.getBorderStyleByID)(e,t)):e.CachedBorderStyle=n}t.NumberOfUniqueStyleIDs=2,t.assertArgumentNotNull=function(e,t,n){if(null==e)throw Error(`${n}.assertArgumentNotNull: ${t} cannot be null or undefined`)},t.numbersComparer=p,t.binarySearch=y,t.verifyCellStyleAndFont=function(e,t,n){(0,d.verifyArgumentNotNull)(t,"cell",n),t.CachedStyle||(0,o.getCellStyle)(e,t),t.CachedFont||F(t,e),null!=t&&t.TextRuns&&t.TextRuns.forEach(t=>{t.CachedFont||(t.CachedFont=(0,o.getFontByID)(t,e,void 0))})},t.isActualBorderPresent=S,t.isSerializedBorderPresent=R,t.shouldApplyBorderAtPosition=function(e,t,n){if(t===o.BorderPositionType.Top||t===o.BorderPositionType.Left)return S(e,t)&&R(e,t);const r=t===o.BorderPositionType.Right?(0,o.getCell)(e.Row,e.Col+1,n):(0,o.getCell)(e.Row+1,e.Col,n),l=t===o.BorderPositionType.Right?o.BorderPositionType.Left:o.BorderPositionType.Top;return(0,i.isNullOrUndefined)(r)?S(e,t):!!(t===o.BorderPositionType.Right&&function(e,t){return S(e,o.BorderPositionType.Right)&&S(t,o.BorderPositionType.Left)}(e,r)||t===o.BorderPositionType.Bottom&&function(e,t){return S(e,o.BorderPositionType.Bottom)&&S(t,o.BorderPositionType.Top)}(e,r))||R(r,l)&&!S(r,l)},t.throwError=function(e,t){throw Error(`${t}: ${e}`)},t.getLinePixelTranslation=function(e){return e/2},t.isCellAdjacentToMergedCell=function(e,t,n){(0,d.verifyArgumentNotNull)(n,"model","isCellAdjacentToMergedCell");const r=function(e,t,n){return[(0,o.getCell)(e-1,t,n),(0,o.getCell)(e+1,t,n),(0,o.getCell)(e,t-1,n),(0,o.getCell)(e,t+1,n)]}(e,t,n);for(let e=0;e<r.length;e++)if(r[e]&&r[e].Merge)return!0;return!1},t.initializeCellCachedObjects=function(e,t,n){if((0,d.verifyArgumentNotNull)(e.Styles,"styles","helpers.initCellCachedObjects"),(0,d.verifyArgumentNotNull)(e.Fonts,"fonts","helpers.initCellCachedObjects"),t.CachedStyle=(0,o.getCellStyleByID)(t,e),(0,i.isNullOrUndefined)(e.BorderStyles)||(t.CachedBorderStyle=(0,o.getBorderStyleByID)(t,e)),t.CachedFont=(0,o.getFontByID)(t.CachedStyle,e,t.StyleID||0),t.CachedDrawingLayout={UnderlineRuns:[],StrikethroughRuns:[],CellTextLayout:{}},t.CachedIndent=t.CachedStyle.Indentation,!(0,i.isNullOrUndefined)(t.TextRuns))for(let n=0;n<t.TextRuns.length;n++){const r=t.TextRuns[n];r.CachedFont=(0,o.getFontByID)(r,e,void 0)}t.CachedDisplayText=void 0,t.CachedDisplayTextRuns=void 0,n&&t.Text&&(t.CachedDisplayText=b(t,e))},t.setCellAndSpannedOverCellsDirty=function(e,t){const n=(0,o.getModelClientCache)(e);n.DirtyCellsKeys||(n.DirtyCellsKeys=[]),n.DirtyCellsKeys.push((0,o.getCellLookupKey)(t.Row,t.Col));const r=T(t,e.Cells),i=(0,o.getAllSpanningCellsKeys)(e.Cells,t,r);n.DirtyCellsKeys=n.DirtyCellsKeys.concat(i)},t.getColumnWidth=function(e,t){if((0,d.verifyArgumentNotNull)(t,"model","getColumnWidth"),(0,d.verifyArgumentNotNull)(t.ColumnWidths,"ColumnWidths","getColumnWidth"),e>t.ColumnWidths.length-1||e<0)throw Error(`getColumnWidth: column width requested for a cell which is not in range of the model. colIndex: ${e}, columnWidths.length: ${t.ColumnWidths.length}`);return t.ColumnWidths[e]},t.getCellFont=F,t.getCellPositionInArray=T,t.getTextRunText=function(e,t,n){const o=t[e].StartIndex;let r=n.length;return e<t.length-1&&(r=t[e+1].StartIndex),n.substring(o,r)},t.setCellCachedDisplayText=function(e,t){e.CachedDisplayText=t,e.CachedDrawingLayout.CellTextLayout.Width=void 0},t.getWorkbookBackgroundColor=function(e,t){return(0,i.isNullOrUndefined)(e)?w(t)?t:r.DefaultBackgroundColor:D(e.BackgroundColor)},t.hasWorkbookBackgroundColor=w,t.isHighContrastMode=function(e){return!(0,i.isNullOrUndefined)(e.highContrastScheme)},t.getFormattedText=I,t.getFormattedTextForMetadata=function(e,t,n){if(t.TextRuns&&n.Fonts)return{Text:e,TextRuns:t.TextRuns,Fonts:n.Fonts}},t.getDisplayText=b,t.updateCellText=function(e,t,n){t.Text=n,M(t)&&(P(t)&&(t.CachedDisplayText=void 0),t.CachedDisplayText=b(t,e)),(0,o.isAccAndCustomNumFmtApplicable)(t)?(0,l.updateNumFmtFromCell)(t):t.NumFmt=void 0},t.shouldRenderFormulaOnCell=function(e,t){var n;return!(!t||null===(n=e.FormulaInfo)||void 0===n||!n.Formula)&&(e.FormulaInfo.FormulaType===o.CellFormulaType.Formula||e.FormulaInfo.FormulaType===o.CellFormulaType.ArrayFormula&&e.FormulaInfo.IsArrayRoot)},t.removeHardBreaks=v,t.prepareTextRunRanges=x,t.isDefined=function(e){return void 0!==e},t.getModelRowIndex=function(e,t){return(0,d.verifyArgumentNotNull)(e,"model","getModelRowIndex"),(0,d.verifyArgumentNotNull)(e.RowNumbers,"RowNumbers","getModelRowIndex"),y(e.RowNumbers,0,e.RowNumbers.length,t,p)},t.getModelColumnIndex=function(e,t){return(0,d.verifyArgumentNotNull)(e,"model","getModelColumnIndex"),(0,d.verifyArgumentNotNull)(e.ColumnNumbers,"ColumnNumbers","getModelColumnIndex"),y(e.ColumnNumbers,0,e.ColumnNumbers.length,t,p)},t.rgbToColorHex=D,t.intersects1D=A,t.doRangesIntersect=function(e,t){const n=A(e.FirstColumn,e.LastColumn,t.FirstColumn,t.LastColumn),o=A(e.FirstRow,e.LastRow,t.FirstRow,t.LastRow);return n&&o},t.isPointInRect=function(e,t){return A(t.x,t.x,e.x,e.x+e.width)&&A(t.y,t.y,e.y,e.y+e.height)},t.areTwoRectsEqual=function(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height==e.height},t.getPreviewCellsRange=function(e){var t,n,o;return null!==(t=null===(n=e.ClientOnlyCache)||void 0===n||null===(n=n.PreviewCellsSettings)||void 0===n?void 0:n.PreviewCellsRange)&&void 0!==t?t:null===(o=e.ClientOnlyCache)||void 0===o?void 0:o.PreviewCellsRange},t.extendRenderingContext=function(e){(0,d.verifyArgumentNotNull)(e.zoom,"context.zoom","extendRenderingContext");const t=e;return t.scaleFactor=e.devicePixelRatio*e.zoom,t},t.extendHighContrastScheme=function(e,t){const n=t;n.HeaderPartialSelectionFontColor=o.PartialRowColSelectionHCFontColor,e.highContrastScheme=n},t.getDynamicImages=function(e,t){switch(t){case s.ImageType.Sparkline:return e.Sparklines;case s.ImageType.InCellImage:return e.InCellImages;default:throw Error("getDynamicImages: unsupported image type = "+t)}},t.getDynamicImageInformationFromCell=function(e,t){switch(t){case s.ImageType.Sparkline:return e.Sparkline;case s.ImageType.InCellImage:return e.InCellImage;default:throw Error("getDynamicImageInformationFromCell: unsupported image type = "+t)}},t.isSubPixelRenderingEnabled=function(){return!((0,o.isChangeGateEnabled)(o.ChangeGate.FixBoldFontsOnMac)&&X()||(!window||!window.navigator||navigator.userAgent.indexOf("Edge/")>=0||!(navigator.userAgent.indexOf("Chrome/")>=0))&&(!window||!window.navigator||!(navigator.userAgent.indexOf(" Firefox/")>=0)))},t.isModernFontRenderingEnabled=B,t.isFontRefactorFGEnabled=function(){return void 0!==g||(g=B()&&(0,c.getBooleanFeatureGate)("Microsoft.Office.Excel.FontLoadRefactorV1",!1)),!!g},t.isOffscreenCanvasSupported=function(){return"undefined"!=typeof OffscreenCanvas},t.isGridRenderPerfFixEnabled=function(){return void 0!==C||(C=(0,o.isChangeGateEnabled)(o.ChangeGate.GridRenderPerfFix)),C},t.isPLTRegressionInMFPFixEnabled=function(){return void 0===f&&(f=(0,o.isChangeGateEnabled)(o.ChangeGate.PLTRegressionInMFPFix)&&B()),f},t.updateCellMergeInformation=function(e,t,n){const o=t.Merge;if(o.SpansBlocks){o.HeightAdjustedForDrawing=Math.round(o.Height*n),o.WidthAdjustedForDrawing=Math.round(o.Width*n),o.OriginDeltaXAdjustedForDrawing=Math.round(o.OriginDeltaX*n),o.OriginDeltaYAdjustedForDrawing=Math.round(o.OriginDeltaY*n);const r=e.RowOffsets[t.Row]-o.OriginDeltaY;o.SpansNextBlockVertically=r+o.Height>e.BlockHeight;const i=e.ColumnOffsets[t.Col]-o.OriginDeltaX;o.SpansNextBlockHorizontally=i+o.Width>e.BlockWidth}},t.getRenderingRegionKey=function(e){const{startOffsetX:t,startOffsetY:n}=e;return(t<<10)+n},t.duplicateStyle=H,t.duplicateOnlyStyleWithoutFont=O,t.duplicateBorderStyle=k,t.duplicateFont=function(e,t,n){return{Bold:e.Bold,Color:e.Color,FontName:e.FontName,FontScheme:e.FontScheme,ID:t||0,Italic:e.Italic,RefCount:n||0,Size:e.Size,StrikeThrough:e.StrikeThrough,Underline:e.Underline,VerticalAlign:e.VerticalAlign,GlobalId:e.GlobalId}},t.incrementNumericVal=L,t.getDrawingOffsetXForRenderingRegion=function(e,t){return e.IsRtl?t.endOffsetX-e.BlockWidth:-1*t.startOffsetX},t.validateRenderingRegion=function(e,t,n){(0,d.verifyArgumentNotNull)(e,"renderingRegion","validateRenderingRegion");const o=t.RowOffsets[e.startRow],r=t.RowOffsets[e.endRow]+t.RowHeights[e.endRow],i=t.ColumnOffsets[e.startColumn],l=t.ColumnOffsets[e.endColumn]+t.ColumnWidths[e.endColumn];if(o>e.startOffsetY||r<e.endOffsetY)throw Error(`validateRenderingRegion: Invalid renderingRegion. startOffsetY= ${e.startOffsetY}, endOffsetY = ${e.endOffsetY}, firstRowStartOffset= ${o}, lastRowEndOffset= ${r}, modelHeight= ${t.BlockHeight}, rowHeights= ${t.RowHeights}, rowOffsets= ${t.RowOffsets}, startRow = ${e.startRow}, endRow = ${e.endRow}, isRTL = ${t.IsRtl}, DPR: ${n.devicePixelRatio}, zoom: ${n.zoom}`);if(i>e.startOffsetX||l<e.endOffsetX)throw Error(`validateRenderingRegion: Invalid renderingRegion. startOffsetX= ${e.startOffsetX}, endOffsetX = ${e.endOffsetX}, firstColumnStartOffset= ${i}, lastColumnEndOffset= ${l}, modelWidth= ${t.BlockWidth}, colWidths= ${t.ColumnWidths}, colOffsets= ${t.ColumnOffsets}, startColumn = ${e.startColumn}, endColumn = ${e.endColumn}, isRTL = ${t.IsRtl}, DPR: ${n.devicePixelRatio}, zoom: ${n.zoom}`)},t.isLargeBlock=function(e,t){return t.startOffsetX>0||t.startOffsetY>0||!(e.BlockWidth===t.endOffsetX&&e.BlockHeight===t.endOffsetY)},t.renderingRegionContainsDirtyCells=function(e,t){if(0===e.startOffsetX&&0===e.startOffsetY&&e.endOffsetX===t.BlockWidth&&e.endOffsetY===t.BlockHeight)return!0;const n=t.ClientOnlyCache.DirtyCellsKeys;for(let t=0;t<n.length;t++){const r=n[t],{row:i,column:l}=(0,o.getRowColFromCellKey)(r),a=A(l,l,e.startColumn,e.endColumn),s=A(i,i,e.startRow,e.endRow);if(a&&s)return!0}return!1},t.registerCanvasHitRegionsFromCache=function(e,t){if(e)for(const n in e){const o=e[n];for(let e=0;e<o.length;e++)t(o[e])}},t.addNewValueToArray=function(e,t,n){if(!(t>=0&&t<=e.length))throw Error(`addNewValueToArray: Index ${t} is out of range`);e.splice(t,0,n)},t.removeValueFromArray=function(e,t){if(!(t>=0&&t<e.length))throw Error(`addNewValueToArray: Index ${t} is out of range`);e.splice(t,1)},t.getCellStyleHashesFromModel=function(e){const t=new Set,n=e.Styles||[];for(let r=0;r<n.length;r++){const i=n[r];if(i)if((0,o.isRenderFlagEnabled)(o.RenderFlagsArray.GlobalStylesSlice1,e)){const l=(0,o.getReferencedObjectById)(i.FontID||0,e.Fonts);t.add((0,o.generateKeyFromModelStyles)(o.StyleType.CellStyle,n[r])+(0,o.generateKeyFromModelStyles)(o.StyleType.Font,l))}else t.add(U(e,n[r]))}return t},t.duplicateTextRuns=function(e,t){const n=[];for(let o=0;o<e.length;o++){const r=e[o];n[o]=N(r,t[r.FontID||0])}return n},t.updateGlobalFontIdsOfTextRuns=function(e,t){for(let n=0;n<e.length;n++)e[n].GlobalFontID=(0,o.getGlobalStyleId)(e[n].FontID,t)},t.duplicateTextRun=N,t.removeBordersWithinASpillCell=function(e,t){E(e,t,1,t.Spill.SpanToEnd),E(e,t,-1,t.Spill.SpanToStart)},t.removeBordersWithinSpillCellRange=E,t.setBordersToBorderStyle=z,t.attachCellToModel=W,t.addLeftBorderToAdjacentCell=function(e,t){if((0,d.verifyArgumentNotNull)(e,"cell","addLeftBorderToAdjacentCell"),e.Col===t.ColumnNumbers.length-1)return;const n=(0,o.getOrCreateCell)(t,e.Row,e.Col+1);W(n,t);const r=(0,o.getCellBorderStyle)(t,e);if(!r||0===r.Borders.length)return;let i=void 0;for(let e=0;e<r.Borders.length;e++){const t=r.Borders[e];if(t.BorderPosition===o.BorderPositionType.Left){i={BorderLineStyle:t.BorderLineStyle,BorderPosition:o.BorderPositionType.Left,Color:t.Color,Weight:t.Weight};break}}i&&G(n,t,i,o.BorderPositionType.Left)},t.addBorderToCellIfNotPresent=G,t.removeBorderFromCell=function(e,t,n){(0,d.verifyArgumentNotNull)(e,"cell","removeBorderFromCell");const r=(0,o.getCellBorderStyle)(t,e);if(!r||!r.Borders||0===r.Borders.length)return;let i=!1;for(let e=0;e<r.Borders.length;e++){const t=r.Borders[e];t&&t.BorderPosition===n&&(i=!0)}if(!i)return;ne(e,t);const l=(0,o.getCellBorderStyle)(t,e);for(let e=0;e<l.Borders.length;e++){const t=l.Borders[e];if(t&&t.BorderPosition===n){l.Borders.splice(e,1);break}}re(e,t)},t.getLastBorderStyleID=V,t.isMac=X,t.isSafari=function(){if(window&&window.navigator){const e=window.navigator.userAgent.toLowerCase();return e.indexOf("safari")>=0&&e.indexOf("chrome")<0&&e.indexOf("edge")<0}return!1},t.isCellPreviewTextDefined=K,t.updateReferenceUpdate=function(e,t,n,r){const i=[];if(!e)return i;if(e.Cells&&0===e.Cells.length)return i;let l=void 0,a=void 0;for(let s=0;s<e.Cells.length;s++){const d=e.Cells[s];if(!d)continue;let c=void 0;const u=e.RowNumbers[d.Row],g=e.ColumnNumbers[d.Col];if(d.FormulaInfo&&d.FormulaInfo.FormulaType!==o.CellFormulaType.Value){const n=r(d.FormulaInfo.Formula);if(n&&n.newFormula){if(d.FormulaInfo.Formula=n.newFormula,c=n.newFormula,d.CachedDisplayText=void 0,d.CachedDisplayTextRuns=void 0,n.isRefError){if(d.Text=t,d.HasIgnorableError=!0,d.ValueType=o.CellValueType.Error,d.Value="4",c=t,!l){const{refErrorStyle:t,refErrorGlobalId:n}=Z(e,d);l=t,a=n}Q(d,l,a)}i.push({rowNum:u,colNum:g,cellText:c||d.Text||""});continue}}(d.Text||d.Value)&&(n(u,g)||ee(d,e,n))&&i.push({rowNum:u,colNum:g,cellText:d.Text||""})}return i},t.getChangedCellsFromModel=function(e,t){const n=[];if(!e)return n;if(e.Cells&&0===e.Cells.length)return n;for(let o=0;o<e.Cells.length;o++){const r=e.Cells[o];if(!r)continue;const i=e.RowNumbers[r.Row],l=e.ColumnNumbers[r.Col];(r.Text||r.Value)&&(t(i,l)||ee(r,e,t))&&n.push({rowNum:i,colNum:l,cellText:""})}return n},t.getLastNonUniqueStyleID=J,t.doesTextContainThaiCharacter=function(e){for(let t=0;t<e.length;t++){const n=e.charCodeAt(t);if(n>=r.MinUnicodeThaiRange&&n<=r.MaxUnicodeThaiRange)return!0}return!1},t.getBreakOpForThaiText=function(e){if(!Intl.Segmenter)return;h||(h=new Intl.Segmenter("th",{granularity:"word"}));const t=h.segment(e)[Symbol.iterator](),n=[];for(let t=0;t<e.length;t++)n.push("2");let o=t.next();for(;!1===o.done;){const e=o.value;e.isWordLike&&e.index>0&&(n[e.index]="1"),o=t.next()}return n.join("")},t.isFixedRows=function(e,t){return t>28||0!=(e&1<<t)},t.updateModelWithRowHeightOverrides=function(e,t){if(t){for(let n=0;n<e.RowHeights.length;n++){const o=e.RowNumbers[n],r=t.get(o);!r||void 0!==r.serverHeight&&r.serverHeight!==e.RowHeights[n]||(r.serverHeight=e.RowHeights[n],e.RowHeights[n]=r.clientHeight)}te(e)}},t.removeRowHeightOverrides=function(e,t){if(t){for(let n=0;n<e.RowHeights.length;n++){const o=e.RowNumbers[n],r=t.get(o);r&&r.serverHeight&&r.clientHeight===e.RowHeights[n]&&(e.RowHeights[n]=r.serverHeight)}te(e)}},t.prepareBorderStyleForEdit=ne,t.setBordersNew=oe,t.afterBorderStyleEdit=re,t.isFontRefactorFGV2Enabled=function(){return void 0!==m||(m=(0,c.getBooleanFeatureGate)("Microsoft.Office.Excel.FontLoadRefactorV2",!1)&&(0,c.getBooleanFeatureGate)("Microsoft.Office.Excel.ModernFontRendering",!1)&&(0,c.getBooleanFeatureGate)("Microsoft.Office.Excel.ModernFontPicker",!1)),!!m}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OldHeadersNSVFonts=t.PartialSelectionFontColor=t.PartialRowColSelectionAndHoverBackgroundColor=t.PartialRowColSelectionBackgroundColor=t.PartialRowColSelectionHCFontColor=t.DefaultHiddenRowColInnerGapPx=t.MinimalCellExtent=t.DefaultHeaderBackgroundColor=t.DefaultRowHeaderWidth=t.DefaultColHeaderHeight=t.RowHeaderWidthWithDragSquaresArea=t.ColHeaderHeightWithDragSquaresArea=t.getRowHeaderStylesArray=t.createHeaderCell=t.calculateRowHeaderWidth=t.columnNumberToTitle=t.createHeaderBlockModel=t.CalcBlockModel=t.verifyArgumentNotNull=t.overrideRenderFlagForMismatch=t.isRenderFlagEnabled=t.isRenderResizePillAcrossBlockEnabled=t.isFontRefactorFGV3Enabled=t.preprocessStyles=t.isHeaderInsertEnabled=t.isIncreasedHeaderSizeEnabled=t.processGlobalStyles=t.getCellBorderStyle=t.initCellLookup=t.validateCellShouldExistInModelUnsafe=t.getRenderingRegionHitTestCache=t.getOrCreateCell=t.cellsPositionComparer=t.getCellStyle=t.getCell=t.isDifferentialRenderingSupported=t.cleanHitTestCache=t.initModelClientCache=t.getModelClientCache=t.getAdjacentCellsKeysOld=t.getAdjacentCellsKeys=t.getSpilledOverCount=t.getRowColFromCellKey=t.uniqueValuesFilter=t.getAllSpanningCellsKeys=t.getDefaultCell=t.isAccAndCustomNumFmtApplicable=t.shouldOverrideText=t.getReferencedObjectToCache=t.getCellLookupKey=void 0,t.isGlobalBorderStylesEnabledNew=t.disableGlobalBorderStyles=t.isGlobalBorderStylesEnabled=t.getGlobalBorderStyleMap=t.getGlobalStyleId=t.getGlobalStylesTelemetry=t.preprocessModelStyles=t.StyleType=t.generateKeyFromModelStyles=t.isPassRibbonCommandsToCanvasRendererEnabled=t.isChangeGateEnabled=t.ChangeGate=t.MaxBitsPerRenderFlag=t.MaxAllowedRowColCount=t.isModelCellContainedInRange=t.getCellLog=t.getRangeLog=t.isCellContainedInRange=t.getRangeTopLeftCell=t.getReferencedObjectById=t.compareHeaderBlockModels=t.areMergeInformationEqual=t.areNumberFormatInformationEqual=t.areInCellControlOptionsEqual=t.areGridArraysEqual=t.areGridCellsEqual=t.comparePartialGridBlockModels=t.compareGridBlockModels=t.areFormattedTextsEqual=t.annonymize=t.serializeCell=t.HoverFontColor=t.WholeRowColSelectionBackgroundColor=t.HoverHeadersStylesSet=t.WholeSelectionHeadersStylesSet=t.PartiallySelectionHeadersStylesSet=t.NSVGridinesColor=t.NSVOutlinesColor=t.OutlinesColor=t.SelectedCellsGridlinesColor=t.NSVHeaderBackgroundColor=t.ColumnHeadersStylesArray=t.RowHeadersStylesArrayBeforeHeaderDragImprovements=t.RowHeadersStylesArray=t.HeadersFonts=t.OldHeadersFonts=t.ColumnHeadersNSVStylesArray=t.RowHeadersNSVStylesArrayBeforeHeaderDragImprovements=t.RowHeadersNSVStylesArray=t.HeadersNSVFonts=void 0,t.isGetStyleFixChangeGateEnabled=t.getCellStyleByID=t.getFontByID=t.getBorderStyleByID=t.isGlobalFontsAndCellStylesEnabled=t.isGlobalFontsAndCellStylesFlightEnabled=t.disableGlobalFonts=t.disableGlobalCellStyles=t.GlobalCellStyles=t.getGlobalCellStylesMap=t.updateGlobalFontIDInCell=t.GlobalFonts=t.getGlobalFontsMap=t.GlobalBorderStyles=void 0;const o=n(61);o.__exportStar(n(24),t);var r=n(42);Object.defineProperty(t,"getCellLookupKey",{enumerable:!0,get:function(){return r.getCellLookupKey}}),Object.defineProperty(t,"getReferencedObjectToCache",{enumerable:!0,get:function(){return r.getReferencedObjectToCache}}),Object.defineProperty(t,"shouldOverrideText",{enumerable:!0,get:function(){return r.shouldOverrideText}}),Object.defineProperty(t,"isAccAndCustomNumFmtApplicable",{enumerable:!0,get:function(){return r.isAccAndCustomNumFmtApplicable}}),Object.defineProperty(t,"getDefaultCell",{enumerable:!0,get:function(){return r.getDefaultCell}}),Object.defineProperty(t,"getAllSpanningCellsKeys",{enumerable:!0,get:function(){return r.getAllSpanningCellsKeys}}),Object.defineProperty(t,"uniqueValuesFilter",{enumerable:!0,get:function(){return r.uniqueValuesFilter}}),Object.defineProperty(t,"getRowColFromCellKey",{enumerable:!0,get:function(){return r.getRowColFromCellKey}}),Object.defineProperty(t,"getSpilledOverCount",{enumerable:!0,get:function(){return r.getSpilledOverCount}}),Object.defineProperty(t,"getAdjacentCellsKeys",{enumerable:!0,get:function(){return r.getAdjacentCellsKeys}}),Object.defineProperty(t,"getAdjacentCellsKeysOld",{enumerable:!0,get:function(){return r.getAdjacentCellsKeysOld}}),Object.defineProperty(t,"getModelClientCache",{enumerable:!0,get:function(){return r.getModelClientCache}}),Object.defineProperty(t,"initModelClientCache",{enumerable:!0,get:function(){return r.initModelClientCache}}),Object.defineProperty(t,"cleanHitTestCache",{enumerable:!0,get:function(){return r.cleanHitTestCache}}),Object.defineProperty(t,"isDifferentialRenderingSupported",{enumerable:!0,get:function(){return r.isDifferentialRenderingSupported}}),Object.defineProperty(t,"getCell",{enumerable:!0,get:function(){return r.getCell}}),Object.defineProperty(t,"getCellStyle",{enumerable:!0,get:function(){return r.getCellStyle}}),Object.defineProperty(t,"cellsPositionComparer",{enumerable:!0,get:function(){return r.cellsPositionComparer}}),Object.defineProperty(t,"getOrCreateCell",{enumerable:!0,get:function(){return r.getOrCreateCell}}),Object.defineProperty(t,"getRenderingRegionHitTestCache",{enumerable:!0,get:function(){return r.getRenderingRegionHitTestCache}}),Object.defineProperty(t,"validateCellShouldExistInModelUnsafe",{enumerable:!0,get:function(){return r.validateCellShouldExistInModelUnsafe}}),Object.defineProperty(t,"initCellLookup",{enumerable:!0,get:function(){return r.initCellLookup}}),Object.defineProperty(t,"getCellBorderStyle",{enumerable:!0,get:function(){return r.getCellBorderStyle}}),Object.defineProperty(t,"processGlobalStyles",{enumerable:!0,get:function(){return r.processGlobalStyles}}),Object.defineProperty(t,"isIncreasedHeaderSizeEnabled",{enumerable:!0,get:function(){return r.isIncreasedHeaderSizeEnabled}}),Object.defineProperty(t,"isHeaderInsertEnabled",{enumerable:!0,get:function(){return r.isHeaderInsertEnabled}}),Object.defineProperty(t,"preprocessStyles",{enumerable:!0,get:function(){return r.preprocessStyles}}),Object.defineProperty(t,"isFontRefactorFGV3Enabled",{enumerable:!0,get:function(){return r.isFontRefactorFGV3Enabled}}),Object.defineProperty(t,"isRenderResizePillAcrossBlockEnabled",{enumerable:!0,get:function(){return r.isRenderResizePillAcrossBlockEnabled}});var i=n(26);Object.defineProperty(t,"isRenderFlagEnabled",{enumerable:!0,get:function(){return i.isRenderFlagEnabled}}),Object.defineProperty(t,"overrideRenderFlagForMismatch",{enumerable:!0,get:function(){return i.overrideRenderFlagForMismatch}}),Object.defineProperty(t,"verifyArgumentNotNull",{enumerable:!0,get:function(){return i.verifyArgumentNotNull}});var l=n(154);Object.defineProperty(t,"CalcBlockModel",{enumerable:!0,get:function(){return l.CalcBlockModel}});var a=n(155);Object.defineProperty(t,"createHeaderBlockModel",{enumerable:!0,get:function(){return a.createHeaderBlockModel}}),Object.defineProperty(t,"columnNumberToTitle",{enumerable:!0,get:function(){return a.columnNumberToTitle}}),Object.defineProperty(t,"calculateRowHeaderWidth",{enumerable:!0,get:function(){return a.calculateRowHeaderWidth}}),Object.defineProperty(t,"createHeaderCell",{enumerable:!0,get:function(){return a.createHeaderCell}}),Object.defineProperty(t,"getRowHeaderStylesArray",{enumerable:!0,get:function(){return a.getRowHeaderStylesArray}});var s=n(106);Object.defineProperty(t,"ColHeaderHeightWithDragSquaresArea",{enumerable:!0,get:function(){return s.ColHeaderHeightWithDragSquaresArea}}),Object.defineProperty(t,"RowHeaderWidthWithDragSquaresArea",{enumerable:!0,get:function(){return s.RowHeaderWidthWithDragSquaresArea}}),Object.defineProperty(t,"DefaultColHeaderHeight",{enumerable:!0,get:function(){return s.DefaultColHeaderHeight}}),Object.defineProperty(t,"DefaultRowHeaderWidth",{enumerable:!0,get:function(){return s.DefaultRowHeaderWidth}}),Object.defineProperty(t,"DefaultHeaderBackgroundColor",{enumerable:!0,get:function(){return s.DefaultHeaderBackgroundColor}}),Object.defineProperty(t,"MinimalCellExtent",{enumerable:!0,get:function(){return s.MinimalCellExtent}}),Object.defineProperty(t,"DefaultHiddenRowColInnerGapPx",{enumerable:!0,get:function(){return s.DefaultHiddenRowColInnerGapPx}}),Object.defineProperty(t,"PartialRowColSelectionHCFontColor",{enumerable:!0,get:function(){return s.PartialRowColSelectionHCFontColor}}),Object.defineProperty(t,"PartialRowColSelectionBackgroundColor",{enumerable:!0,get:function(){return s.PartialRowColSelectionBackgroundColor}}),Object.defineProperty(t,"PartialRowColSelectionAndHoverBackgroundColor",{enumerable:!0,get:function(){return s.PartialRowColSelectionAndHoverBackgroundColor}}),Object.defineProperty(t,"PartialSelectionFontColor",{enumerable:!0,get:function(){return s.PartialSelectionFontColor}}),Object.defineProperty(t,"OldHeadersNSVFonts",{enumerable:!0,get:function(){return s.OldHeadersNSVFonts}}),Object.defineProperty(t,"HeadersNSVFonts",{enumerable:!0,get:function(){return s.HeadersNSVFonts}}),Object.defineProperty(t,"RowHeadersNSVStylesArray",{enumerable:!0,get:function(){return s.RowHeadersNSVStylesArray}}),Object.defineProperty(t,"RowHeadersNSVStylesArrayBeforeHeaderDragImprovements",{enumerable:!0,get:function(){return s.RowHeadersNSVStylesArrayBeforeHeaderDragImprovements}}),Object.defineProperty(t,"ColumnHeadersNSVStylesArray",{enumerable:!0,get:function(){return s.ColumnHeadersNSVStylesArray}}),Object.defineProperty(t,"OldHeadersFonts",{enumerable:!0,get:function(){return s.OldHeadersFonts}}),Object.defineProperty(t,"HeadersFonts",{enumerable:!0,get:function(){return s.HeadersFonts}}),Object.defineProperty(t,"RowHeadersStylesArray",{enumerable:!0,get:function(){return s.RowHeadersStylesArray}}),Object.defineProperty(t,"RowHeadersStylesArrayBeforeHeaderDragImprovements",{enumerable:!0,get:function(){return s.RowHeadersStylesArrayBeforeHeaderDragImprovements}}),Object.defineProperty(t,"ColumnHeadersStylesArray",{enumerable:!0,get:function(){return s.ColumnHeadersStylesArray}}),Object.defineProperty(t,"NSVHeaderBackgroundColor",{enumerable:!0,get:function(){return s.NSVHeaderBackgroundColor}}),Object.defineProperty(t,"SelectedCellsGridlinesColor",{enumerable:!0,get:function(){return s.SelectedCellsGridlinesColor}}),Object.defineProperty(t,"OutlinesColor",{enumerable:!0,get:function(){return s.OutlinesColor}}),Object.defineProperty(t,"NSVOutlinesColor",{enumerable:!0,get:function(){return s.NSVOutlinesColor}}),Object.defineProperty(t,"NSVGridinesColor",{enumerable:!0,get:function(){return s.NSVGridinesColor}}),Object.defineProperty(t,"PartiallySelectionHeadersStylesSet",{enumerable:!0,get:function(){return s.PartiallySelectionHeadersStylesSet}}),Object.defineProperty(t,"WholeSelectionHeadersStylesSet",{enumerable:!0,get:function(){return s.WholeSelectionHeadersStylesSet}}),Object.defineProperty(t,"HoverHeadersStylesSet",{enumerable:!0,get:function(){return s.HoverHeadersStylesSet}}),Object.defineProperty(t,"WholeRowColSelectionBackgroundColor",{enumerable:!0,get:function(){return s.WholeRowColSelectionBackgroundColor}}),Object.defineProperty(t,"HoverFontColor",{enumerable:!0,get:function(){return s.HoverFontColor}});var d=n(156);Object.defineProperty(t,"serializeCell",{enumerable:!0,get:function(){return d.serializeCell}}),Object.defineProperty(t,"annonymize",{enumerable:!0,get:function(){return d.annonymize}});var c=n(158);Object.defineProperty(t,"areFormattedTextsEqual",{enumerable:!0,get:function(){return c.areFormattedTextsEqual}}),Object.defineProperty(t,"compareGridBlockModels",{enumerable:!0,get:function(){return c.compareGridBlockModels}}),Object.defineProperty(t,"comparePartialGridBlockModels",{enumerable:!0,get:function(){return c.comparePartialGridBlockModels}}),Object.defineProperty(t,"areGridCellsEqual",{enumerable:!0,get:function(){return c.areGridCellsEqual}}),Object.defineProperty(t,"areGridArraysEqual",{enumerable:!0,get:function(){return c.areGridArraysEqual}}),Object.defineProperty(t,"areInCellControlOptionsEqual",{enumerable:!0,get:function(){return c.areInCellControlOptionsEqual}}),Object.defineProperty(t,"areNumberFormatInformationEqual",{enumerable:!0,get:function(){return c.areNumberFormatInformationEqual}}),Object.defineProperty(t,"areMergeInformationEqual",{enumerable:!0,get:function(){return c.areMergeInformationEqual}});var u=n(159);Object.defineProperty(t,"compareHeaderBlockModels",{enumerable:!0,get:function(){return u.compareHeaderBlockModels}});var g=n(62);Object.defineProperty(t,"getReferencedObjectById",{enumerable:!0,get:function(){return g.getReferencedObjectById}});var h=n(160);Object.defineProperty(t,"getRangeTopLeftCell",{enumerable:!0,get:function(){return h.getRangeTopLeftCell}}),Object.defineProperty(t,"isCellContainedInRange",{enumerable:!0,get:function(){return h.isCellContainedInRange}}),Object.defineProperty(t,"getRangeLog",{enumerable:!0,get:function(){return h.getRangeLog}}),Object.defineProperty(t,"getCellLog",{enumerable:!0,get:function(){return h.getCellLog}}),Object.defineProperty(t,"isModelCellContainedInRange",{enumerable:!0,get:function(){return h.isModelCellContainedInRange}});var C=n(81);Object.defineProperty(t,"MaxAllowedRowColCount",{enumerable:!0,get:function(){return C.MaxAllowedRowColCount}}),Object.defineProperty(t,"MaxBitsPerRenderFlag",{enumerable:!0,get:function(){return C.MaxBitsPerRenderFlag}});var f=n(34);Object.defineProperty(t,"ChangeGate",{enumerable:!0,get:function(){return f.ChangeGate}}),Object.defineProperty(t,"isChangeGateEnabled",{enumerable:!0,get:function(){return f.isChangeGateEnabled}}),Object.defineProperty(t,"isPassRibbonCommandsToCanvasRendererEnabled",{enumerable:!0,get:function(){return f.isPassRibbonCommandsToCanvasRendererEnabled}});var m=n(63);Object.defineProperty(t,"generateKeyFromModelStyles",{enumerable:!0,get:function(){return m.generateKeyFromModelStyles}});var p=n(53);Object.defineProperty(t,"StyleType",{enumerable:!0,get:function(){return p.StyleType}});var y=n(105);Object.defineProperty(t,"preprocessModelStyles",{enumerable:!0,get:function(){return y.preprocessModelStyles}}),Object.defineProperty(t,"getGlobalStylesTelemetry",{enumerable:!0,get:function(){return y.getGlobalStylesTelemetry}}),Object.defineProperty(t,"getGlobalStyleId",{enumerable:!0,get:function(){return y.getGlobalStyleId}});var S=n(52);Object.defineProperty(t,"getGlobalBorderStyleMap",{enumerable:!0,get:function(){return S.getGlobalBorderStyleMap}}),Object.defineProperty(t,"isGlobalBorderStylesEnabled",{enumerable:!0,get:function(){return S.isGlobalBorderStylesEnabled}}),Object.defineProperty(t,"disableGlobalBorderStyles",{enumerable:!0,get:function(){return S.disableGlobalBorderStyles}}),Object.defineProperty(t,"isGlobalBorderStylesEnabledNew",{enumerable:!0,get:function(){return S.isGlobalBorderStylesEnabledNew}}),Object.defineProperty(t,"GlobalBorderStyles",{enumerable:!0,get:function(){return S.GlobalBorderStyles}});var R=n(43);Object.defineProperty(t,"getGlobalFontsMap",{enumerable:!0,get:function(){return R.getGlobalFontsMap}}),Object.defineProperty(t,"GlobalFonts",{enumerable:!0,get:function(){return R.GlobalFonts}}),Object.defineProperty(t,"updateGlobalFontIDInCell",{enumerable:!0,get:function(){return R.updateGlobalFontIDInCell}});var F=n(44);Object.defineProperty(t,"getGlobalCellStylesMap",{enumerable:!0,get:function(){return F.getGlobalCellStylesMap}}),Object.defineProperty(t,"GlobalCellStyles",{enumerable:!0,get:function(){return F.GlobalCellStyles}}),Object.defineProperty(t,"disableGlobalCellStyles",{enumerable:!0,get:function(){return F.disableGlobalCellStyles}});var T=n(54);Object.defineProperty(t,"disableGlobalFonts",{enumerable:!0,get:function(){return T.disableGlobalFonts}}),Object.defineProperty(t,"isGlobalFontsAndCellStylesFlightEnabled",{enumerable:!0,get:function(){return T.isGlobalFontsAndCellStylesFlightEnabled}}),Object.defineProperty(t,"isGlobalFontsAndCellStylesEnabled",{enumerable:!0,get:function(){return T.isGlobalFontsAndCellStylesEnabled}});var w=n(104);Object.defineProperty(t,"getBorderStyleByID",{enumerable:!0,get:function(){return w.getBorderStyleByID}}),Object.defineProperty(t,"getFontByID",{enumerable:!0,get:function(){return w.getFontByID}}),Object.defineProperty(t,"getCellStyleByID",{enumerable:!0,get:function(){return w.getCellStyleByID}}),Object.defineProperty(t,"isGetStyleFixChangeGateEnabled",{enumerable:!0,get:function(){return w.isGetStyleFixChangeGateEnabled}}),o.__exportStar(n(24),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isArrayFormulaChildInFormulaView=t.clipForOutlinesIfNecessary=t.doesHeaderModelContainOutlines=t.drawVerticalLine=t.drawHorizontalLine=t.isAdjustedForDrawingOffsetsInitialized=t.initializeOffsetsForDrawing=t.getClipMaskWidth=t.getReOrderDiv=t.isCellShrunk=t.getHighContrastTextColor=t.isRtlChar=t.getColOffsetAdjustedForDrawing=t.shouldRenderGridLines=t.cellIntersectsRenderingRegion=t.hexToRgb=t.drawLine=t.restoreClipping=t.applyClipping=t.drawClipRect=t.getContainerClipMaskWidth=t.getTextDrawingMaxHeight=t.getTextDrawingMaxWidth=t.getBlockDimensionsAdjustedForDrawing=t.getRowHeightFromOffsets=t.getColWidthFromOffsets=t.getDefaultBorderLineWidth=void 0;const o=n(1),r=n(3),i=n(6),l=n(37),a=n(0),s={},d={},c={};function u(e,t){return Math.round(e*t)}function g(e){return e-r.GridLineWidthPx}function h(e,t,n,o,r){e.beginPath(),e.rect(t,n,o,r),e.stroke(),e.clip()}function C(e,t){t&&(e.save(),e.strokeStyle="transparent",h(e,t.x,t.y,t.width,t.height))}function f(e,t){return t?2===e.ColumnOffsets.length:2===e.RowOffsets.length}t.getDefaultBorderLineWidth=function(e){return(0,i.isNullOrUndefined)(s[e])?(s[e]=Math.max(Math.round(e),1),s[e]):s[e]},t.getColWidthFromOffsets=function(e,t){if(e<0||e>t.length-1)throw"getColWidthFromOffsets:: invalid colIndex "+e;return t[e+1]-t[e]},t.getRowHeightFromOffsets=function(e,t){if(e<0||e>t.length-1)throw"getRowHeightFromOffsets:: invalid colIndex "+e;return t[e+1]-t[e]},t.getBlockDimensionsAdjustedForDrawing=u,t.getTextDrawingMaxWidth=function(e,t,n,o,i){let a=0;n&&(a=n+l.IconTextMinimalPadding);const s=t+a+o+i;return Math.max(0,e-r.GridLineWidthPx-s)},t.getTextDrawingMaxHeight=function(e,t){return Math.max(0,e-r.GridLineWidthPx-t)},t.getContainerClipMaskWidth=g,t.drawClipRect=h,t.applyClipping=C,t.restoreClipping=function(e,t){t&&e.restore()},t.drawLine=function(e,t,n,o,r){e.moveTo(t,n),e.lineTo(o,r)},t.hexToRgb=function(e){if(""===e)return{Red:0,Green:0,Blue:0};const t="#"===e[0]?e.substr(1):e,n=parseInt(t,16);return{Red:n>>16&255,Green:n>>8&255,Blue:255&n}},t.cellIntersectsRenderingRegion=function(e,t){let n=e.Row,o=e.Row,r=e.Col,i=e.Col;e.Merge?(o+=e.Merge.Rows,i+=e.Merge.Columns,e.Merge.SpansBlocks&&(e.Merge.OriginDeltaX&&(r=0),e.Merge.OriginDeltaY&&(n=0))):e.Spill&&(r-=e.Spill.SpanToStart,i+=e.Spill.SpanToEnd);const l=(0,a.intersects1D)(r,i,t.startColumn,t.endColumn),s=(0,a.intersects1D)(n,o,t.startRow,t.endRow);return l&&s},t.shouldRenderGridLines=function(e,t){return e||!t},t.getColOffsetAdjustedForDrawing=function(e,t){const n=t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,o=n[n.length-1];return t.IsRtl?o-n[e+1]:n[e]},t.isRtlChar=function(e){const t=e.charCodeAt(0);return t>=1424&&t<=1535||t>=1536&&t<=1791||t>=1872&&t<=1919||t>=64336&&t<=65023||t>=65136&&t<=65279||t>=1984&&t<=1792||t>=1792&&t<=1871||t>=1920&&t<=1983||t>=11568&&t<=11647},t.getHighContrastTextColor=function(e,t){const n=e.CachedStyle.BackgroundColor;return(0,i.isNullOrUndefined)(t.HeaderPartialSelectionFontColor)||n!==o.PartialRowColSelectionBackgroundColor&&n!==o.PartialRowColSelectionAndHoverBackgroundColor?(0,i.isNullOrUndefined)(e.Hyperlink)?(l=t.TextColor,c[l]||(c[l]=(0,a.rgbToColorHex)(l)),c[l]):(r=t.LinkColor,d[r]||(d[r]=(0,a.rgbToColorHex)(r)),d[r]):t.HeaderPartialSelectionFontColor;var r,l},t.isCellShrunk=function(e){return!(!e.ShrunkSize||!e.CachedFont)&&e.ShrunkSize<e.CachedFont.Size},t.getReOrderDiv=function(e,t){const n=document.createElement("div");return n.style.visibility="hidden",n.style.direction=e.BaseDir,n.style.position="absolute",n.style.width=Math.max(2e3,1.1*t)+"px",n},t.getClipMaskWidth=function(e,t,n){const o=g(e)-t-n;return Math.max(0,o)},t.initializeOffsetsForDrawing=function(e,t){const n=e.RowHeights,r=e.ColumnWidths,i=e.RowOffsets,l=e.ColumnOffsets;(0,o.verifyArgumentNotNull)(n,"rowHeights","initializeOffsetsForDrawing"),(0,o.verifyArgumentNotNull)(r,"colWidths","initializeOffsetsForDrawing"),(0,o.verifyArgumentNotNull)(i,"rowOffsets","initializeOffsetsForDrawing"),(0,o.verifyArgumentNotNull)(l,"colOffsets","initializeOffsetsForDrawing");const a=(0,o.getModelClientCache)(e);a.RowOffsetsAdjustedForDrawing=[];for(let e=0;e<i.length;e++){const n=i[e];a.RowOffsetsAdjustedForDrawing.push(Math.round(n*t))}a.ColOffsetsAdjustedForDrawing=[];for(let e=0;e<l.length;e++){const n=l[e];a.ColOffsetsAdjustedForDrawing.push(Math.round(n*t))}a.RowOffsetsAdjustedForDrawing.push(u(e.BlockHeight,t)),a.ColOffsetsAdjustedForDrawing.push(u(e.BlockWidth,t))},t.isAdjustedForDrawingOffsetsInitialized=function(e){return!!e.ClientOnlyCache&&!!e.ClientOnlyCache.RowOffsetsAdjustedForDrawing&&!!e.ClientOnlyCache.ColOffsetsAdjustedForDrawing},t.drawHorizontalLine=function(e,t,n,o){e.moveTo(t,o),e.lineTo(n,o)},t.drawVerticalLine=function(e,t,n,o){e.moveTo(o,t),e.lineTo(o,n)},t.doesHeaderModelContainOutlines=f,t.clipForOutlinesIfNecessary=function(e,t,n){let o=void 0;const r=!!t.IsRow;if(!f(t,r))return o;const i=n.scaleFactor,l=t.IsRtl;return o=r?{x:l?0:Math.ceil(t.ColumnOffsets[1]*i),y:0,width:l?Math.floor(t.ColumnWidths[1]*i):Math.ceil(t.ColumnWidths[1]*i),height:Math.ceil(t.BlockHeight*i)}:{x:0,y:Math.ceil(t.RowOffsets[1]*i),width:Math.ceil(t.BlockWidth*i),height:Math.ceil(t.RowHeights[1]*i)},C(e,o),o},t.isArrayFormulaChildInFormulaView=function(e,t){var n;return t.isFormulaView&&(null===(n=e.FormulaInfo)||void 0===n?void 0:n.FormulaType)===o.CellFormulaType.ArrayFormula&&!e.FormulaInfo.IsArrayRoot}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SkeletonColor=t.UnderlineMarginFromTextBaseline=t.UnderlineLineWidth=t.MediumDotDashedLineDash=t.MediumDashedLineDash=t.DashedDotDotLineDash=t.DashedDotLineDash=t.DashedLineDash=t.DottedLineDash=t.ColoredGridLineDash=t.DefaultDash=t.ThickBorderWeight=t.MediumBorderWeight=t.ThinBorderWeight=t.HardBreakCRLF=t.HardBreakCR=t.HardBreak=t.FullWidthSpace=t.Whitespace=t.EmptyString=t.RightHorizontalAlignmentItalicExtraPadding=t.EmptyLineTextToken=t.EmptyFormattedText=t.EmptyLine=t.DefaultPreviewSuggestionContentFontColor=t.DefaultCellFontColor=t.DefaultBackgroundColor=t.HighContrastPageLayoutWidthPx=t.SelectionBorderWidth=t.GridLineWidthPx=t.TextLineHeightPx=t.InCellVerticalPaddingPx=t.InCellIndentPaddingPx=t.InCellBottomAndCenterVerticalPaddingPx=t.InCellEndOfTextHorizontalPaddingPx=t.InCellHorizontalPaddingPx=t.MinimalScaleFactorForGridlinesRendering=t.PageLayoutLineColor=t.NSVHiddenRowColumnIndicatorWithSelectionLineColor=t.NSVHiddenRowColumnIndicatorLineColor=t.WholeRowColSelectionHiddenRowColumnIndicatorLineColor=t.PartialRowColSelectionHiddenRowColumnIndicatorLineColor=t.HiddenRowColumnIndicatorGapColor=t.HiddenRowColumnIndicatorLineColor=t.NSVDefaultBorderGridLineColor=t.DefaultBorderGridLineColor=t.NSVSelectedCellsGridLineColor=t.NSVDefaultGridLineColor=t.SelectedCellsGridLineColor=t.DefaultGridLineColor=void 0,t.MaxRowHeaderTextWidth=t.MaxColumnHeaderTextWidth=t.HeaderTextLineHeight=t.HeaderCornerRadius=t.RowHeaderCellHorizontalPaddingPx=t.ColumnHeaderGutterSize=t.CellIconBottomSizeRatioPadding=t.CellFontUnicodeFontFamily=t.PatternTileSize=t.pixelTranslation=t.ColumnCountInBlock=t.RowCountInBlock=t.BlockColumnEndIndex=t.BlockColumnStartIndex=t.BlockRowEndIndex=t.BlockRowStartIndex=t.GapBetweenRotatedDoubleUnderline=t.GapBetweenDoubleUnderline=t.NinetyDegreeInRadians=t.RightTextAlign=t.LeftTextAlign=t.RotatedTextPaddingMultiplier=t.MaxOrientationRange=t.MinOrientationRange=t.MaxUnicodeThaiRange=t.MinUnicodeThaiRange=t.FormulaErrorBorderStyle=t.FormulaErrorFontColor=t.FormulaErrorBackgroundColor=t.FontHeightToBaselineGapRatio=t.SkeletonCellsColor=void 0;const o=n(1);t.DefaultGridLineColor="#E0E0E0",t.SelectedCellsGridLineColor="#A0D8B9",t.NSVDefaultGridLineColor="#525252",t.NSVSelectedCellsGridLineColor="#BDBDBD",t.DefaultBorderGridLineColor="#BDBDBD",t.NSVDefaultBorderGridLineColor="#BDBDBD",t.HiddenRowColumnIndicatorLineColor="#969696",t.HiddenRowColumnIndicatorGapColor="#FFFFFF",t.PartialRowColSelectionHiddenRowColumnIndicatorLineColor="#666666",t.WholeRowColSelectionHiddenRowColumnIndicatorLineColor="#FFFFFF",t.NSVHiddenRowColumnIndicatorLineColor="#B3B3B3",t.NSVHiddenRowColumnIndicatorWithSelectionLineColor="#FFFFFF",t.PageLayoutLineColor="#9e9e9e",t.MinimalScaleFactorForGridlinesRendering=.4,t.InCellHorizontalPaddingPx=2,t.InCellEndOfTextHorizontalPaddingPx=2,t.InCellBottomAndCenterVerticalPaddingPx=1,t.InCellIndentPaddingPx=9,t.InCellVerticalPaddingPx=-1,t.TextLineHeightPx=20,t.GridLineWidthPx=1,t.SelectionBorderWidth=2,t.HighContrastPageLayoutWidthPx=2,t.DefaultBackgroundColor="#ffffff",t.DefaultCellFontColor="#000000",t.DefaultPreviewSuggestionContentFontColor="#66706F",t.EmptyLine={text:"",width:0,underlineWidth:0},t.EmptyFormattedText={Text:"",Fonts:[],TextRuns:[]},t.EmptyLineTextToken={tokens:[{text:"",width:0,start:0,containsThaiCharacters:!1}],containsThaiCharacters:!1},t.RightHorizontalAlignmentItalicExtraPadding=3,t.EmptyString="",t.Whitespace=" ",t.FullWidthSpace="",t.HardBreak="\n",t.HardBreakCR="\r",t.HardBreakCRLF="\r\n",t.ThinBorderWeight=1,t.MediumBorderWeight=2,t.ThickBorderWeight=3,t.DefaultDash=[],t.ColoredGridLineDash=[1,1],t.DottedLineDash=[2,2],t.DashedLineDash=[6,2],t.DashedDotLineDash=[9,3,3,3],t.DashedDotDotLineDash=[9,3,3,3,3,3],t.MediumDashedLineDash=[9,3],t.MediumDotDashedLineDash=[9,3,3,3],t.UnderlineLineWidth=1,t.UnderlineMarginFromTextBaseline=1,t.SkeletonColor="#E4E4E4",t.SkeletonCellsColor="#aaaaaa",t.FontHeightToBaselineGapRatio=.22;const r={Red:255,Green:0,Blue:0};t.FormulaErrorBackgroundColor="#FFFFFF",t.FormulaErrorFontColor="#000000",t.FormulaErrorBorderStyle={Borders:[{BorderLineStyle:o.BorderLineType.Dashed,BorderPosition:o.BorderPositionType.Top,Color:r,Weight:2},{BorderLineStyle:o.BorderLineType.Dashed,BorderPosition:o.BorderPositionType.Bottom,Color:r,Weight:2},{BorderLineStyle:o.BorderLineType.Dashed,BorderPosition:o.BorderPositionType.Left,Color:r,Weight:2},{BorderLineStyle:o.BorderLineType.Dashed,BorderPosition:o.BorderPositionType.Right,Color:r,Weight:2}],ID:o.UniqueStyleID.FormulaError,RefCount:0},t.MinUnicodeThaiRange=3584,t.MaxUnicodeThaiRange=3711,t.MinOrientationRange=-90,t.MaxOrientationRange=90,t.RotatedTextPaddingMultiplier=4,t.LeftTextAlign="left",t.RightTextAlign="right",t.NinetyDegreeInRadians=Math.PI/2,t.GapBetweenDoubleUnderline=2,t.GapBetweenRotatedDoubleUnderline=3.14,t.BlockRowStartIndex=0,t.BlockRowEndIndex=27,t.BlockColumnStartIndex=0,t.BlockColumnEndIndex=29,t.RowCountInBlock=28,t.ColumnCountInBlock=30,t.pixelTranslation=.5,t.PatternTileSize=8,t.CellFontUnicodeFontFamily="XLYellow",t.CellIconBottomSizeRatioPadding=.1,t.ColumnHeaderGutterSize=11,t.RowHeaderCellHorizontalPaddingPx=2,t.HeaderCornerRadius=2,t.HeaderTextLineHeight=20,t.MaxColumnHeaderTextWidth=40,t.MaxRowHeaderTextWidth=53},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.verifyArgumentNotNull=void 0,t.verifyArgumentNotNull=function(e,t,n){if(null==e)throw Error(`${n}.verifyArgumentNotNull: ${t} cannot be null or undefined`)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSpillCellStartCol=t.getSpillCellEndCol=t.isIconAlignedToTheLeft=t.getAdjustedCellArea=t.getCellDimensionsAdjustedForDrawing=t.getSpillCellStartOffset=t.getOffsetLeftSpill=t.getSpillCellWidthAdjustedForDrawing=t.getSpillCellWidth=t.isCellSpansMultipleRowsOrBlocks=t.getCellTopAdjustedForDrawing=t.getCellCenterXAdjustedForDrawing=t.getCellCenterYAdjustedForDrawing=t.getCellBottomAdjustedForDrawing=t.getSpillCellRightAdjustedForDrawing=t.getCellRightAdjustedForDrawing=t.getSpillCellLeftAdjustedForDrawing=t.getCellLeftAdjustedForDrawing=t.getCellHeightAdjustedForDrawing=t.getCellWidthAdjustedForDrawing=t.getCellTop=t.getCellBottom=t.getCellRight=t.getCellLeft=t.getCellHeight=t.getCellWidth=void 0;const o=n(0),r=n(4),i=n(2),l=n(3),a=n(6),s=n(45);function d(e,t,n){return(0,r.verifyArgumentNotNull)(t,"cell","getCellWidth"),(0,r.verifyArgumentNotNull)(e,"model","getCellWidth"),(0,r.verifyArgumentNotNull)(e.ColumnWidths,"model.ColumnWidths","getCellWidth"),t.Merge&&(0,r.verifyArgumentNotNull)(e.ColumnOffsets,"model.ColumnOffsets","getCellWidth"),I(e,t,n,!1)}function c(e,t,n){return(0,r.verifyArgumentNotNull)(t,"cell","getCellHeight"),(0,r.verifyArgumentNotNull)(e,"model","getCellHeight"),(0,r.verifyArgumentNotNull)(e.RowHeights,"model.RowHeights","getCellHeight"),t.Merge&&(0,r.verifyArgumentNotNull)(e.RowOffsets,"model.RowOffsets","getCellHeight"),w(e,t,n,!1)}function u(e,t){return T(e,t,!1,!1)}function g(e,t){return(0,r.verifyArgumentNotNull)(e,"model","getCellWidthAdjustedForDrawing"),(0,r.verifyArgumentNotNull)(e.ClientOnlyCache,"ClientOnlyCache","getCellHeightAdjustedForDrawing"),(0,r.verifyArgumentNotNull)(e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","getCellWidthAdjustedForDrawing"),(0,r.verifyArgumentNotNull)(t,"cell","getCellWidthAdjustedForDrawing"),I(e,t,!1,!0)}function h(e,t){return(0,r.verifyArgumentNotNull)(e,"model","getCellHeightAdjustedForDrawing"),(0,r.verifyArgumentNotNull)(e.ClientOnlyCache,"ClientOnlyCache","getCellHeightAdjustedForDrawing"),(0,r.verifyArgumentNotNull)(e.ClientOnlyCache.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","getCellHeightAdjustedForDrawing"),(0,r.verifyArgumentNotNull)(t,"cell","getCellHeightAdjustedForDrawing"),w(e,t,!1,!0)}function C(e,t,n,o){return(0,r.verifyArgumentNotNull)(e,"model","getCellWidthAdjustedForDrawing"),(0,r.verifyArgumentNotNull)(e.ClientOnlyCache,"ClientOnlyCache","getCellWidthAdjustedForDrawing"),(0,r.verifyArgumentNotNull)(e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","getCellWidthAdjustedForDrawing"),(0,r.verifyArgumentNotNull)(t,"cell","getCellWidthAdjustedForDrawing"),b(e,t,void 0,n,!0,o)}function f(e,t){return!e.IsRtl||t.RichValueIcon?C(e,t,!1,!1):m(e,t,!1)-y(t,e)+l.GridLineWidthPx}function m(e,t,n){const o=e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,r=o.length-1,i=t.Col;if(!e.IsRtl||n)return C(e,t,n,!1)+g(e,t)-l.GridLineWidthPx;const a=t.Merge&&t.Merge.SpansBlocks?t.Merge.OriginDeltaXAdjustedForDrawing:0;return o[r]+a-o[i]}function p(e,t,n){return T(e,t,!0,n)}function y(e,t){const n=x(t,F(e),!0),o=R(e,t),r=x(t,o,!0);return(0,i.getColWidthFromOffsets)(o,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing)+Math.abs(r-n)}function S(e,t){var n;return!!(0,s.isCFIconAlignedToTheLeft)(e,t)||!!t.RichValueIcon||!(0,a.isNullOrUndefined)(null===(n=t.LinkedEntity)||void 0===n?void 0:n.IconWidth)&&!e.IsRtl}function R(e,t){return(0,r.verifyArgumentNotNull)(t.ColumnNumbers,"model.ColumnNumbers","spillCell.getSpillCellEndCol"),Math.min(t.ColumnNumbers.length-1,e.Col+e.Spill.SpanToEnd)}function F(e){return Math.max(0,e.Col-e.Spill.SpanToStart)}function T(e,t,n,o){let r=v(e,t.Row,n);return t.Merge&&t.Merge.SpansBlocks&&!o&&(r-=function(e,t){return t?e.Merge.OriginDeltaYAdjustedForDrawing:e.Merge.OriginDeltaY}(t,n)),r}function w(e,t,n,o){if(t.Merge){if(t.Merge.SpansBlocks&&!n)return function(e,t){return t?e.Merge.HeightAdjustedForDrawing:e.Merge.Height}(t,o);const r=v(e,t.Row,o);return function(e,t,n){const o=t.Row+t.Merge.Rows;return n?e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[o+1]:e.RowOffsets[o]+e.RowHeights[o]}(e,t,o)-r}return function(e,t,n){return n?(0,i.getRowHeightFromOffsets)(t.Row,e.ClientOnlyCache.RowOffsetsAdjustedForDrawing):e.RowHeights[t.Row]}(e,t,o)}function I(e,t,n,r){if(t.Merge){if(t.Merge.SpansBlocks&&!n)return function(e,t){return t?e.Merge.WidthAdjustedForDrawing:e.Merge.Width}(t,r);const o=x(e,t.Col,r);return function(e,t,n){const o=t.Col+t.Merge.Columns;return n?e.ClientOnlyCache.ColOffsetsAdjustedForDrawing[o+1]:e.ColumnOffsets[o]+e.ColumnWidths[o]}(e,t,r)-o}return function(e,t,n){return n?(0,i.getColWidthFromOffsets)(t.Col,e.ClientOnlyCache.ColOffsetsAdjustedForDrawing):(0,o.getColumnWidth)(t.Col,e)}(e,t,r)}function b(e,t,n,o,r,i){let a=x(e,t.Col,r);return t.Merge&&t.Merge.SpansBlocks&&!i&&(a-=function(e,t){return t?e.Merge.OriginDeltaXAdjustedForDrawing:e.Merge.OriginDeltaX}(t,r)),!e.IsRtl||o?a:(r?m(e,t,o):n-a)-I(e,t,!1,r)+l.GridLineWidthPx}function v(e,t,n){return n?e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[t]:e.RowOffsets[t]}function x(e,t,n){return n?e.ClientOnlyCache.ColOffsetsAdjustedForDrawing[t]:e.ColumnOffsets[t]}t.getCellWidth=d,t.getCellHeight=c,t.getCellLeft=function(e,t,n){return(0,r.verifyArgumentNotNull)(t,"cell","getCellWidth"),(0,r.verifyArgumentNotNull)(e,"model","getCellWidth"),(0,r.verifyArgumentNotNull)(e.ColumnWidths,"model.ColumnWidths","getCellWidth"),t.Merge&&(0,r.verifyArgumentNotNull)(e.ColumnOffsets,"model.ColumnOffsets","getCellWidth"),b(e,t,n,!1,!1,!1)},t.getCellRight=function(e,t,n){let o=e.ColumnOffsets[t.Col];return t.Merge&&t.Merge.SpansBlocks&&(o-=t.Merge.OriginDeltaX),e.IsRtl?n-o:o+d(e,t,!1)-l.GridLineWidthPx},t.getCellBottom=function(e,t){return u(e,t)+c(e,t,!1)},t.getCellTop=u,t.getCellWidthAdjustedForDrawing=g,t.getCellHeightAdjustedForDrawing=h,t.getCellLeftAdjustedForDrawing=C,t.getSpillCellLeftAdjustedForDrawing=f,t.getCellRightAdjustedForDrawing=m,t.getSpillCellRightAdjustedForDrawing=function(e,t){return!t.Spill&&e.IsRtl?m(e,t,!1):C(e,t,!1,!1)+y(t,e)-l.GridLineWidthPx},t.getCellBottomAdjustedForDrawing=function(e,t){return p(e,t,!1)+h(e,t)},t.getCellCenterYAdjustedForDrawing=function(e,t){return p(e,t,!1)+h(e,t)/2},t.getCellCenterXAdjustedForDrawing=function(e,t,n){return(m(e,t,n)+C(e,t,n,!1))/2},t.getCellTopAdjustedForDrawing=p,t.isCellSpansMultipleRowsOrBlocks=function(e){return!(0,a.isNullOrUndefined)(e.Merge)&&(e.Merge.Rows>0||!0===e.Merge.SpansBlocks)},t.getSpillCellWidth=function(e,t){const n=t.ColumnOffsets[F(e)],o=R(e,t),r=t.ColumnOffsets[o];return t.ColumnWidths[o]+Math.abs(r-n)},t.getSpillCellWidthAdjustedForDrawing=y,t.getOffsetLeftSpill=function(e,t){const n=x(t,e.Col,!1),o=x(t,t.IsRtl?Math.max(F(e),R(e,t)):Math.min(F(e),R(e,t)),!1);return Math.abs(o-n)},t.getSpillCellStartOffset=function(e,t,n,o){const r=function(e,t,n,o){return(S(e,t)?n:0)+(e.IsRtl?0:o)}(t,e,n,o),i=t.ColumnOffsets[F(e)]+r;if(t.IsRtl){const n=R(e,t),o=t.ColumnOffsets[n],i=t.ColumnWidths[n];return t.BlockWidth-o-i+r+l.GridLineWidthPx}return i},t.getCellDimensionsAdjustedForDrawing=function(e,t,n){return{x:C(e,t,n,!1)-l.GridLineWidthPx,y:p(e,t,!1)-l.GridLineWidthPx,width:g(e,t)+l.GridLineWidthPx,height:h(e,t)+l.GridLineWidthPx}},t.getAdjustedCellArea=function(e,t,n){const o=t.Spill&&n;let r=o?f(e,t):C(e,t,!1,!1);return r=e.IsRtl?r-l.GridLineWidthPx:r,{x:r,y:p(e,t,!1),width:o?y(t,e):g(e,t),height:h(e,t)}},t.isIconAlignedToTheLeft=S,t.getSpillCellEndCol=R,t.getSpillCellStartCol=F},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringFormat=t.isNullOrUndefined=void 0,t.isNullOrUndefined=function(e){return null==e},t.stringFormat=function(e,...t){return e.replace(/{(\d+)}/g,(function(e,n){return void 0!==t[n]?t[n]:e}))}},function(e,t,n){"use strict";n.r(t),n.d(t,"UlsLoggerWrapper",(function(){return r.b})),n.d(t,"ULS",(function(){return r.a})),n.d(t,"initializeLogger",(function(){return r.c})),n.d(t,"RemoteUlsLogger",(function(){return d})),n.d(t,"getUlsLogger",(function(){return c})),n.d(t,"getUlsLoggerDeprecated",(function(){return u})),n.d(t,"formatForUpload",(function(){return l})),n.d(t,"uploadLogs",(function(){return i})),n.d(t,"LogCategory",(function(){return h.a})),n.d(t,"LogType",(function(){return o})),n.d(t,"TraceLevel",(function(){return a.a})),n.d(t,"UnitTestLogger",(function(){return f})),n.d(t,"ConsoleLogger",(function(){return m.a})),n.d(t,"CategoryLogger",(function(){return p})),n.d(t,"NoopLogger",(function(){return C.a}));var o,r=n(51);function i(e,t,n){if(!t)return;const o=window.navigator;if(o&&o.sendBeacon)try{return void o.sendBeacon(t,e)}catch(e){}!function(e,t,n){const o=new XMLHttpRequest;o.readyState!==XMLHttpRequest.UNSENT&&o.readyState!==XMLHttpRequest.DONE||(o.open("POST",t,n),o.send(e))}(e,t,n)}function l(e,t,n,o){const r=[],i=e.map(e=>function(e,t,n){const o={};if(o.G=e.tag,o.T=e.timestamp-t,o.M=e.message,o.C=e.category,e.correlationId){let t=n.findIndex(t=>t===e.correlationId);t<0&&(t=n.push(e.correlationId)-1),o.I=t}const r=1e3*e.type+e.level;return o.D=r,o}(e,o,r)),l=function(e,t,n,o,r){const i={};return i.T=e,i.L=t,i.S=n,i.I=o,r&&r.length>0&&(i.W=r),i.V=1,i}(o,i,t,n,r);return JSON.stringify(l)}!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(o||(o={}));var a=n(16);class s{handleTrace(e){e.message.length>s.messageMaxChars&&(e.message=e.message.substr(0,s.messageMaxChars-s.trimmedMessage.length)+s.trimmedMessage),this.logCache.push(e),(this.logCache.length>s.uploadTriggerSize||e.level===a.a.Error)&&this.triggerUploadAsync()}constructor(e,t,n){this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=()=>{this.triggerUpload(!1,!1)},this.flush=()=>{this.triggerUploadAsync()},this.triggerUploadAsync=()=>{window.setTimeout(()=>this.triggerUpload(!0,!0),0)},this.triggerUpload=(e,t)=>{window.clearTimeout(this.timeoutId),this.logCache.length>0&&(this.uploadId+=1,i(l(this.logCache,this.userSessionId,this.uploadId,this.timestampBase),this.remoteUrlEndpoint,t),this.logCache=[],this.timestampBase=Date.now()),e&&(this.timeoutId=window.setTimeout(this.triggerUploadAsync,s.uploadCadenceInMsSec))},this.userSessionId=e;let o=t+"?usid="+e;void 0!==n&&n.forEach((e,t)=>{o+="&"+t+"="+e}),this.remoteUrlEndpoint=o,window.setTimeout(()=>this.triggerUpload(!0,!0),0)}}s.messageMaxChars=3072,s.uploadCadenceInMsSec=3e4,s.uploadTriggerSize=30,s.trimmedMessage="... [Trimmed]";class d{setCorrelationId(e){this.correlationId=e}sendTraceTag(e,t,n,o){g(this.cache,e,t,n,o,this.correlationId)}debugAssertTag(e,t,n,o){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")}shipAssertTag(e,t,n,o){n&&g(this.cache,e,t,a.a.Error,o,this.correlationId)}flush(){this.cache.flush()}flushOnClose(){this.cache.flushOnClose}constructor(e,t,n){this.correlationId="",this.cache=new s(e,t,n)}}function c(e,t){return new d(e,t)}function u(e,t){const n=new s(e,t);return{sendTraceTag:(e,t,o,r)=>g(n,e,t,o,r,""),shipAssertTag:(e,t,o,r)=>{o&&g(n,e,t,a.a.Error,r,"")},debugAssertTag:()=>{throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:n.flush,flushOnClose:n.flushOnClose,setCorrelationId:()=>{}}}function g(e,t,n,r,i,l){if(r>a.a.Info)return;const s={timestamp:Date.now(),category:n,tag:t,level:r,type:o.Trace,message:i,correlationId:l};e.handleTrace(s)}var h=n(80),C=n(50);class f extends C.a{}var m=n(84);class p{info(e,t,...n){r.a.sendTraceTag(e,this.category,a.a.Info,this.messageToLog(t,n))}warn(e,t,...n){r.a.sendTraceTag(e,this.category,a.a.Warning,this.messageToLog(t,n))}error(e,t,...n){r.a.sendTraceTag(e,this.category,a.a.Error,this.messageToLog(t,n))}messageToLog(e,...t){return t.length?`${e}: ${t.map(e=>JSON.stringify(e)).join(", ")}`:e}constructor(e){this.category=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getActualFontSizeFromFont=t.getActualFontSize=t.cellHasShrinkToFit=t.getShrunkFontSize=t.getFontLookupKey=t.getCellFontWeightStyle=t.getFontNameFromCssString=t.getFontCssString=t.isFontContainsVerticalAlignment=t.getFontCssStringFromFont=t.getFontCssStringFromCell=t.getRenderedFontsCount=t.incrementFontCount=t.isFontSupportedNew=t.isKnownFont=t.sanitizeFontName=t.getFontNameForLogging=void 0;const o=n(39),r=n(10),i=n(1),l=n(0),a=n(13),s=n(6),d=n(162),c=n(37),u=n(163),g=n(56),h=n(7),C={},f={totalCount:0,unknown:0,static:0,flat:0,hierarchical:0},m=new Set;let p,y=!1,S=!1;function R(e){let t="Custom Font";return T(e)&&(t=F(e)),t}function F(e){return"Sanitized_"+e}function T(e){const t=e.replace(/\s/g,"").toLowerCase();return void 0===p&&(p=(0,i.isChangeGateEnabled)(i.ChangeGate.UseSetForKnownFonts)),p?o.KnownFontNamesLowerCaseSet.has(t):(0,o.getKnownFontNamesLowerCase)().indexOf(t)>-1}function w(e,t){if(!m.has(e))switch(m.add(e),f.totalCount+=1,t){case 0:f.unknown+=1;break;case 1:f.static+=1;break;case 2:f.flat+=1;break;case 3:f.hierarchical+=1}}function I(e,t,n){var r;const i=!!e.Bold,l=x(i,!!e.Italic);let a=null!==(r=null!=t?t:e.Size)&&void 0!==r?r:o.DefaultFontSizePt;return b(e)&&(a=(0,d.getVerticalAlignmentFontSizeAdjusted)(a)),v(n,l,a,e.FontName,i)}function b(e){return!(0,s.isNullOrUndefined)(e.VerticalAlign)&&e.VerticalAlign!==i.FontVerticalAlignment.None}function v(e,t,n,r,l=!1){let a=(0,g.canonizeFontName)(r),s=r;var d;e.ClientOnlyCache&&e.ClientOnlyCache.FallbackFonts&&e.ClientOnlyCache.FallbackFonts[D(a,n)]&&(a=c.DefaultFallbackFontName),function(e){return(0,i.isFontRefactorFGV3Enabled)()&&!y&&e===o.CannonizedAptosNarrow}(a)&&(null!==(d=e.ClientOnlyCache)&&void 0!==d&&d.renderWithOldDefaultFont?(a=c.DefaultFallbackFontName,s=c.DefaultFallbackFontName):!y&&(0,g.documentFontsCheck)(`${n}pt "${a}"`,a)?(y=!0,S&&setTimeout(()=>{h.ULS.sendTraceTag(507053218,h.LogCategory.msoulscat_ES_EWAJSGrid,h.TraceLevel.Info,"getFontCssString: Was using fallback for Aptos Narrow, but now it is loaded.")},200)):(a=c.DefaultFallbackFontName,s=c.DefaultFallbackFontName,e.ClientOnlyCache.renderWithOldDefaultFont=!0,S=!0));const f=`${t} ${n}pt "${a}"`,m=(0,u.cssFontToCanvasFont)(f,l);return C[m]=s,m}function x(e,t){let n="";return n=e&&t?"bold italic":e?"bold":t?"italic":"normal",n}function D(e,t){return`${t}pt ${(0,g.canonizeFontName)(e)}`}function A(e){if(P(e))return e.ShrunkSize}function P(e){return!((0,l.isCellPreviewTextDefined)(e.PreviewText)||e.DisplayFormula||!e.CachedStyle.ShrinkToFit||e.WrapText)}function M(e,t,n){const o=P(e);let r=o?e.ShrunkSize:t.Size;var i,l;return(!n&&b(t)||b(t)&&!n)&&(r=(0,d.getVerticalAlignmentFontSizeAdjusted)(r)),r<0&&(0,a.setRenderingResultInfo)(`\n      actual font size < 0.\n      doesCellHaveShrinkToFit: ${o},\n      cell.ShrunkSize: ${e.ShrunkSize},\n      Font:\n        size: ${t.Size};\n        fontName: ${R(t.FontName)};\n        refCount: ${t.RefCount||0};\n      cell.CachedStyle:\n        isHidden: ${!(null===(i=e.CachedStyle)||void 0===i||!i.IsHidden)};\n        shrinkToFit: ${!(null===(l=e.CachedStyle)||void 0===l||!l.ShrinkToFit)};\n      cell.Ifmt: ${e.Ifmt||0};\n      cell.WrapText: ${e.WrapText};\n    `),r}t.getFontNameForLogging=R,t.sanitizeFontName=F,t.isKnownFont=T,t.isFontSupportedNew=function(e){if((0,l.isModernFontRenderingEnabled)()){const t=(0,r.getFontFamilyEndPoint)(e);return w(e,t),0!==t}return T(e)},t.incrementFontCount=w,t.getRenderedFontsCount=function(){return f.documentFontsCheckCount=(0,g.getDocumentFontsCheckCount)(),f},t.getFontCssStringFromCell=function(e,t){return I(e.CachedFont,A(e),t)},t.getFontCssStringFromFont=I,t.isFontContainsVerticalAlignment=b,t.getFontCssString=v,t.getFontNameFromCssString=function(e){return C[e]},t.getCellFontWeightStyle=x,t.getFontLookupKey=D,t.getShrunkFontSize=A,t.cellHasShrinkToFit=P,t.getActualFontSize=function(e){return M(e,e.CachedFont,!0)},t.getActualFontSizeFromFont=M},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCellHorizontalIndentationPaddingPx=t.doesExpandCollapseButtonShiftText=t.getDistanceFromCellStartToIconEnd=t.getOverhangHashWidth=t.getNumFmtHashWidth=t.getNumFmtSeparatorWidth=t.getFormattedTextLineFontMetrics=t.getFormattedTextLineHeight=t.getLargestFont=t.getTextLineHeight=t.getBidiContext=t.measureTextHeightForVerticalText=t.measureTextRunsHeightForVerticalText=t.measureTextRunsWidth=t.cacheLegacyTextWidthOnCell=t.getTextWidthNoCaching=t.getTextWidth=t.getTextHorizontalPosition=t.getTextDecorationLineWidth=t.getYPositionForFontVerticalAlignmentRtf=t.getMiddleBaseline=t.getTextOffsetYAlphabeticBaseline=t.isCellBottomPaddingRequired=t.getTextVerticalPosition=t.getFontLineHeight=t.getCellAdornmentPadding=t.getHorizontalPadding=t.getWrapTextAdditionalPadding=t.getCellTextClipMask=t.getCellTextHorizontalPaddingWithoutVisualElements=t.getCellTextHorizontalPadding=t.getIndentationPaddingPx=t.getCellTextCenterX=t.calculateSubSuperOffsetY=t.calculateVerticalAlignment=t.measureTextWidth=void 0;const o=n(1),r=n(3),i=n(7),l=n(39),a=n(6),s=n(0),d=n(8),c=n(4),u=n(66),g=n(85),h=n(86),C=n(67),f=n(12),m=n(15),p=n(5),y=n(114),S=n(2),R=n(14),F=n(70),T=n(45),w=n(13),I=n(17),b=n(87),v=n(10),x=n(22),D=n(49),A=n(46);let P=!0;const M={},B={},H={};let O={},k=0,L=0,N=0;function E(e,t,n,o){if(!t)return 0;if(o){L++;const o=e.font,r=(0,d.getFontNameFromCssString)(o),l=!!r&&(0,A.getFontLoadStatus)(r)!==A.FontLoadStatus.Pending;let a=O[o];if(a){const e=a[t];if(e)return N++,e}else a={};const s=_(e,t,n);return l&&(a[t]=s,O[o]=a,k++),k===(0,v.getServiceSetting)(12,200)&&(i.ULS.sendTraceTag(544310413,i.LogCategory.msoulscat_ES_EWAJSGrid,i.TraceLevel.Info,`measureTextWidth: Cache Reset, {"cacheHits"=${N}, "totalCalls"=${L}}`),k=0,O={},N=0,L=0),s}return _(e,t,n)}function z(e,t,n,o){const i=ie(e,t,n,o),l=(0,p.isIconAlignedToTheLeft)(e,t)?i:0,a=(0,f.getExpandCollapseButtonPadding)(t),s=(0,f.shouldExpandCollapseButtonShiftText)(e,t)?a:0,d=e.IsRtl?r.GridLineWidthPx:0,c=(0,p.getCellLeft)(e,t,e.BlockWidth)+l+s;let u=(0,p.getCellWidth)(e,t,!1)-i-a;return u=Math.max(0,u),c+u/2-d}function W(e){return e*r.InCellIndentPaddingPx}function G(e,t,n,o){return ae(t,e,j(t,e,n,o))}function V(e,t,n,r,i,l,a,s=0){const d=le(t,i),c=(0,m.getEffectiveHorizontalAlignment)(e,t);let u=h.CalibriRegularPadding;switch(c){case o.HorizontalAlignment.Automatic:case o.HorizontalAlignment.Left:return d+(0,g.approximateValue)(n,u)+a+((0,o.isIncreasedHeaderSizeEnabled)(e)?s:0);case o.HorizontalAlignment.Right:return r&&(u=h.CalibriItalicPadding),d+(0,g.approximateValue)(n,u)+a+((0,o.isIncreasedHeaderSizeEnabled)(e)?s:0);case o.HorizontalAlignment.Center:case o.HorizontalAlignment.CenterAcrossSelection:return l?(0,g.approximateValue)(n,u):0;default:throw Error("getTextHorizontalPosition: unsupported horizontalAlignment: "+c)}}function j(e,t,n,r){let i=function(e,t,n,r){return function(e,t){var n;const r=(0,T.isCFIconAlignedToTheLeft)(e,t),i=!(null===(n=t.LinkedEntity)||void 0===n||!n.IconWidth)||!!t.RichValueIcon;if((r||i)&&!(0,x.shouldDrawRotatedText)(e,t.CachedStyle,t.CachedFont)){const n=(0,p.isIconAlignedToTheLeft)(e,t),r=(0,m.getEffectiveHorizontalAlignment)(e,t);switch(r){case o.HorizontalAlignment.Right:return!n;case o.HorizontalAlignment.Automatic:case o.HorizontalAlignment.Left:return n;case o.HorizontalAlignment.Center:case o.HorizontalAlignment.CenterAcrossSelection:return!0;default:throw Error("unexpected context alignment "+r)}}return!1}(e,t)?ie(e,t,n,r):0}(e,t,n,r);return(0,f.shouldExpandCollapseButtonShiftText)(e,t)&&(i+=(0,f.getExpandCollapseButtonPadding)(t)),i+=(0,I.shouldAddAutoFilterPadding)(e,t)?(0,I.getAutoFilterButtonPadding)(e,t,n,r):0,i}function _(e,t,n){if(!t)return 0;if(n&&P){try{const n=t.replace(/^\s+|\s+$/g,""),o=e.measureText(n);if(!(0,a.isNullOrUndefined)(o.actualBoundingBoxLeft)&&!(0,a.isNullOrUndefined)(o.actualBoundingBoxRight)){const r=Math.abs(o.actualBoundingBoxRight)+Math.abs(o.actualBoundingBoxLeft),i=t.length-n.length;let l=0;return i>0&&(l=i*e.measureText(" ").width),r+l}}catch(e){}P=!1}return se(e,t)}function U(e,t,n){const o=function(e,t,n){return(0,u.getCachedFontMetrics)(n,t,e).height}(e,t,n);return Math.ceil(o*l.LineHeightUsingDivFontFactor)}function q(e,t){return(0,y.cellHasBottomDoubleBorder)(t,e)||(0,S.isCellShrunk)(t)}function $(e,t,n,r){switch(e){case o.FontVerticalAlignment.Subscript:const i=Y(r);return n+t.baseline/2-i;case o.FontVerticalAlignment.Superscript:return n-2*(t.middle-t.baseline);default:throw Error(`getYPositionForFontVerticalAlignmentRtf: Font vertical alignment ${e} is unexpected here`)}}function Y(e){return e?l.SubscriptVerticalPaddingForUnderlinePx:0}function X(e,t,n,o){return J(e-(t+r.GridLineWidthPx-n)/2,o)}function K(e,t,n){return J(e+t,n)}function J(e,t){return e-l.LineHeightBottomConstantPx-t}function Z(e,t,n){n.CachedDrawingLayout||(n.CachedDrawingLayout={CellTextLayout:{}}),n.CachedDisplayText||(0,s.updateCellText)(t,n,n.Text);const r=!n.DisplayFormula&&n.TextRuns;if(n.CachedDrawingLayout.CellTextLayout.Width){if(r&&!n.CachedDrawingLayout.TextRunDrawingInformation)throw"getTextWidthInternal: TextRunsDrawingData is supposed to be defined";return{width:n.CachedDrawingLayout.CellTextLayout.Width,textRunsDrawingInformation:n.CachedDrawingLayout.TextRunDrawingInformation}}const i=!(0,b.isTestRun)(),l=(0,s.getDisplayText)(n,t);if(r){const o=ne(n),r=Q(e,n.TextRuns,n.Text,t,o);return{width:r.totalSize,textRunsDrawingInformation:r.textRunsDrawingInformation}}return{width:E(e,l,i,(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.TextWidthClientPhase1,t))}}function Q(e,t,n,o,r){const i=e.textAlign;e.textAlign="left";const l=ee(e,o,n,!1,r,t);return e.textAlign=i,l}function ee(e,t,n,r,i,l){const a=[],c=function(e,t,n){return void 0!==e&&e.HasBidi?(0,C.prepareTextRunsForBidiLayout)(t,n):t}(i,l,n);let u=0;const g=(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.TextWidthClientPhase1,t);for(let o=0;o<c.length;o++){const i=c[o],l={FontID:i.FontID||0,GlobalFontID:i.GlobalFontID,StartIndex:i.StartIndex},h=(0,s.getTextRunText)(o,c,n),C=i.CachedFont,f=(0,d.getFontCssStringFromFont)(C,void 0,t);if(r){const e=U(t,C.Size,C.FontName),n=te(e,h);l.HeightPx=n,l.WidthPx=e,u+=n}else{e.font=f;const t=E(e,h,o===c.length-1,g);l.Underline=C.Underline,l.WidthPx=t,u+=t}l.Strikethrough=C.StrikeThrough,l.Text=h,l.FontCss=f,a[o]=_object_spread({},l,i)}return{textRunsDrawingInformation:a,totalSize:u}}function te(e,t){return e*(0,F.breakToGraphemes)(t).length}function ne(e){(0,c.verifyArgumentNotNull)(e.CachedDrawingLayout,"CachedDrawingLayout","getBidiContext");const t=e.CachedDrawingLayout.BidiContext;if(t)return t;const n=(0,C.analyzeBidiText)(e.Text,e.CachedStyle.ReadingOrder||o.ReadingOrderType.Context);return e.CachedDrawingLayout.BidiContext=n,n}function oe(e,t){(0,c.verifyArgumentNotNull)(e.CachedDrawingLayout,"CachedDrawingLayout","getTextLineHeight"),(0,c.verifyArgumentNotNull)(e.CachedDrawingLayout.CellTextLayout,"CellTextLayout","getTextLineHeight"),(0,c.verifyArgumentNotNull)(e.CachedFont,"CachedFont","getTextLineHeight");const n=!!e.TextRuns;if(void 0!==e.CachedDrawingLayout.CellTextLayout.LineHeight)return e.CachedDrawingLayout.CellTextLayout.LineHeight;let o;n&&(o=re(t,e.TextRuns));const r=n?o.Size:(0,d.getActualFontSizeFromFont)(e,e.CachedFont,!0),i=n?o.FontName:e.CachedFont.FontName;(0,a.isNullOrUndefined)(i)&&(0,w.setRenderingResultInfo)(`\n    isRichText: ${n},\n    fontSize: ${r}\n    `);const l=U(t,r,i);return e.CachedDrawingLayout.CellTextLayout.LineHeight=l,l}function re(e,t){let n;for(let r=0;r<t.length;r++){const i=t[r],l=i.CachedFont&&(0,o.isGetStyleFixChangeGateEnabled)()&&i.CachedFont.GlobalId===i.GlobalFontID?i.CachedFont:(0,o.getFontByID)(i,e,void 0);(!n||n.Size<l.Size)&&(n=l)}if(!n)throw"getLargestFont: Largest fonts is supposed to be defined";return n}function ie(e,t,n,o){var r;if((0,s.isCellPreviewTextDefined)(t.PreviewText))return 0;if((null!==(r=t.LinkedEntity)&&void 0!==r&&r.IconWidth||t.RichValueIcon)&&t.DisplayFormula)return 0;const i=(0,d.getActualFontSize)(t);return(0,f.getIconSizeAndPadding)(e,t,i,n,o)}function le(e,t){return(0,R.shouldRenderVerticalText)(e)?0:W(t)}function ae(e,t,n){const o=t.CachedIndent||0,i=(0,d.getActualFontSize)(t),l=!(0,a.isNullOrUndefined)(t.WrapText)||(0,d.cellHasShrinkToFit)(t),s=(0,R.shouldRenderVerticalText)(t)?oe(t,e)/2:0,c=function(e){return e.IsRow?r.RowHeaderCellHorizontalPaddingPx:0}(e);return V(e,t,i,t.CachedFont.Italic,o,l,n,c)+s}function se(e,t){return e.measureText(t).width}function de(e,t,n,r){let i=B[r];if(i||(B[r]=se(e,"#"),i=B[r]),n.CachedFont.Italic&&!H[r]){const n=E(e,"#",!0,(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.TextWidthClientPhase1,t));H[r]=n-i}}t.measureTextWidth=E,t.calculateVerticalAlignment=function(e,t,n,r,i){if(i)return o.VerticalAlignment.Bottom;const l=t.CachedStyle,a=l.VerticalAlignment;return t.WrapText||t.Merge||l.VerticalText||!(n>r)||(0,x.shouldDrawRotatedText)(e,l,t.CachedFont)||(0,D.isVerticalAlignmentJustifyOrDistributed)(a)?a:o.VerticalAlignment.Center},t.calculateSubSuperOffsetY=function(e,t,n,o,r,i){return i?$(t,r,o,(0,f.isBottomPaddingNeededForSubscriptUnderline)(n,e.CachedStyle.VerticalAlignment)):0},t.getCellTextCenterX=z,t.getIndentationPaddingPx=W,t.getCellTextHorizontalPadding=G,t.getCellTextHorizontalPaddingWithoutVisualElements=function(e,t){return ae(e,t,0)},t.getCellTextClipMask=function(e,t,n,o,r,i,l){return{x:t+(e.IsRtl&&!l?0:i),y:n,width:(0,S.getContainerClipMaskWidth)(o)-i,height:r}},t.getWrapTextAdditionalPadding=function(e,t,n){const o=(0,d.getActualFontSize)(t),r=!(0,a.isNullOrUndefined)(t.WrapText)||(0,d.cellHasShrinkToFit)(t),i=(0,I.shouldAddAutoFilterPadding)(e,t)?(0,I.getAutoFilterButtonPadding)(e,t,n.zoom,n.devicePixelRatio):0;return V(e,t,o,t.CachedFont.Italic,0,r,i)},t.getHorizontalPadding=V,t.getCellAdornmentPadding=j,t.getFontLineHeight=U,t.getTextVerticalPosition=function(e,t,n,i,l,a){const s=e.TextRuns,c=s?re(t,e.TextRuns):e.CachedFont,g=s?c.Size:(0,d.getActualFontSize)(e),h=(0,p.getCellTop)(t,e),C=(0,p.getCellBottom)(t,e),m=q(t,e)?r.InCellVerticalPaddingPx:0;let y,S;if((0,d.isFontContainsVerticalAlignment)(c))if(a)y=a;else{const e=(0,u.getCachedFontMetrics)(c.FontName,g,t),n=(0,f.isBottomPaddingNeededForSubscriptUnderline)(c,l);y=function(e,t,n){switch(t){case o.FontVerticalAlignment.Subscript:return e.baseline/2+Y(n);case o.FontVerticalAlignment.Superscript:return e.middle+(e.middle-e.baseline);default:return e.baseline}}(e,s?o.FontVerticalAlignment.None:c.VerticalAlign||0,n)}else y=a||(0,u.getCachedFontMetrics)(c.FontName,g,t).baseline;switch(l){case o.VerticalAlignment.Bottom:case o.VerticalAlignment.Justify:case o.VerticalAlignment.Distributed:S=m+J(C,y);break;case o.VerticalAlignment.Top:S=K(h,n,y);break;case o.VerticalAlignment.Center:S=X(C,i,n,y);break;default:throw Error("getTextVerticalPosition: unsupported verticalAlignment: "+l)}return{absoluteY:S,lastTextLineAlphabeticBaselineOffset:y}},t.isCellBottomPaddingRequired=q,t.getTextOffsetYAlphabeticBaseline=function(e,t,n,r,i,l){const a=U(e,r,i),s=(0,u.getCachedFontMetrics)(i,r,e).baseline;switch(l){case o.VerticalAlignment.Center:case o.VerticalAlignment.Justify:case o.VerticalAlignment.Distributed:return X(t,n,a,s);case o.VerticalAlignment.Bottom:return J(t,s);case o.VerticalAlignment.Top:return K(t-n,a,s)}},t.getMiddleBaseline=function(e,t,n,o){const r=(0,u.getCachedFontMetrics)(n.FontName,o,e);return t-(r.middle-r.baseline)},t.getYPositionForFontVerticalAlignmentRtf=$,t.getTextDecorationLineWidth=function(e){return(0,g.approximateValue)(e,h.CalibriTextDecorationLineWidth)},t.getTextHorizontalPosition=function(e,t,n){const i=(0,m.getEffectiveHorizontalAlignment)(e,t),l=G(t,e,n.zoom,n.devicePixelRatio);switch(i){case o.HorizontalAlignment.Right:return(0,p.getCellRight)(e,t,e.BlockWidth)-l;case o.HorizontalAlignment.Center:return z(e,t,n.zoom,n.devicePixelRatio);case o.HorizontalAlignment.Automatic:case o.HorizontalAlignment.Left:return(0,p.getCellLeft)(e,t,e.BlockWidth)+l;case o.HorizontalAlignment.CenterAcrossSelection:return function(e,t,n,o){if(t.Spill){const i=ie(e,t,n,o),l=(0,f.getExpandCollapseButtonPadding)(t),a=e.IsRtl?r.GridLineWidthPx:0,s=(0,p.getSpillCellWidth)(t,e)-i-l;return(0,p.getSpillCellStartOffset)(t,e,i,l)+s/2-a}return z(e,t,n,o)}(e,t,n.zoom,n.devicePixelRatio);default:throw Error("getTextHorizontalPosition: unsupported horizontalAlignment: "+i)}},t.getTextWidth=function(e,t,n){const{width:o,textRunsDrawingInformation:r}=Z(e,t,n);return n.CachedDrawingLayout.CellTextLayout.Width=o,n.CachedDrawingLayout.TextRunDrawingInformation=r,o},t.getTextWidthNoCaching=function(e,t,n){return Z(e,t,n).width},t.cacheLegacyTextWidthOnCell=function(e,t,n){const r=E(e,n.CachedDisplayText,!1,(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.TextWidthClientPhase1,t));n.CachedDrawingLayout.CellTextLayout.Width=r},t.measureTextRunsWidth=Q,t.measureTextRunsHeightForVerticalText=function(e,t,n,o,r,i,l){return r?{textRunsDrawingInformation:[],totalSize:i*n.length}:ee(e,o,n,!0,l,t)},t.measureTextHeightForVerticalText=te,t.getBidiContext=ne,t.getTextLineHeight=oe,t.getLargestFont=re,t.getFormattedTextLineHeight=function(e,t){const n=re(e,t.TextRuns);return U(e,n.Size,n.FontName)},t.getFormattedTextLineFontMetrics=function(e,t){const n=re(e,t.TextRuns);return(0,u.getCachedFontMetrics)(n.FontName,n.Size,e)},t.getNumFmtSeparatorWidth=function(e,t,n,o){(0,c.verifyArgumentNotNull)(o,"numFmt","getNumFmtSeparatorWidth"),(0,c.verifyArgumentNotNull)(o.Separator,"separator","getNumFmtSeparatorWidth");const r=o.Separator,i=(0,d.getFontCssStringFromCell)(n,t)+r,l=M[i];if((0,a.isNullOrUndefined)(l)||0===l){const t=se(e,r);return M[i]=t,t}return M[i]},t.getNumFmtHashWidth=function(e,t,n){(0,c.verifyArgumentNotNull)(n,"cell","getNumFmtSeparatorWidth");const o=(0,d.getFontCssStringFromCell)(n,t);return de(e,t,n,o),B[o]},t.getOverhangHashWidth=function(e,t,n){(0,c.verifyArgumentNotNull)(n,"cell","getOverhangHashWidth");const o=(0,d.getFontCssStringFromCell)(n,t);return de(e,t,n,o),H[o]},t.getDistanceFromCellStartToIconEnd=ie,t.doesExpandCollapseButtonShiftText=function(e,t){const n=(0,m.getEffectiveHorizontalAlignment)(e,t);switch(n){case o.HorizontalAlignment.Left:case o.HorizontalAlignment.CenterAcrossSelection:case o.HorizontalAlignment.Center:return!e.IsRtl;case o.HorizontalAlignment.Right:return e.IsRtl;case o.HorizontalAlignment.Automatic:default:throw Error("doesExpandCollapseButtonShiftText: unsupported horizontalAlignment: "+n)}},t.getCellHorizontalIndentationPaddingPx=le},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAppVisuallyReady=t.isHoverTelemetryEnabled=t.trackGridRendererEventResponseTime=t.getRibbonCommandsMapping=t.isStandardZoomCssSupportedByBrowser=t.onAutoFilterMouseEnter=t.isexternalCallbacksRegistered=t.getTooltipTitle=t.isEditingOrInComponentRangePicker=t.isEditing=t.getTopBorderForBottomCell=t.getLeftBorderForNextCell=t.inRangePicker=t.isFontSourceAddedToCss=t.getFontFamilyEndPoint=t.isFontSupported=t.headerInsertButtonInvokedCallback=t.headerInsertHitAreaHoveredCallback=t.isHeaderInsertAllowed=t.isHeaderDragAllowed=t.isResizeAllowed=t.getBlockStatisticLog=t.blockCacheSizeCallback=t.getTablesRangeContainingRange=t.showOrHideHyperlinkFloatie=t.showCtrlClickHyperlinkCallout=t.invalidHyperlinkCallback=t.shouldHitTestHandleEvent=t.getDevicePixelRatio=t.getAppZoom=t.getServiceSetting=t.expandCollapseOutlines=t.onHeaderDragStartCallback=t.onHeaderUnhideRowColCallback=t.onHeaderResizeStartCallback=t.setOrRemoveResizeZoneHoveredCallback=t.setOrRemoveHoveredCellCallback=t.tableSelectorsCallback=t.setLastInputMethod=t.togglePivotDrill=t.togglePivotDrillFromChildElement=t.handleGoTo=t.followHyperlink=t.invokeRibbonCommandWithCellReference=t.showOrCloseFloatingCommentCallback=t.pivotFilterClickHandler=t.handleRibbonCommand=t.registerExternalCallbacks=void 0;const o=n(6),r=n(4),i=n(11);let l,a=void 0;t.registerExternalCallbacks=function(e){l=e},t.handleRibbonCommand=function(e,t,n,o,i,a){(0,r.verifyArgumentNotNull)(l,"externalCallbacks","handleRibbonCommand"),l.handleRibbonCommandCallback(e,t,n,o,i,a)},t.pivotFilterClickHandler=function(e,t,n,o,i){(0,r.verifyArgumentNotNull)(l,"externalCallbacks","showPivotFilterMenu"),l.pivotFilterClickHandlerCallback(e,t,n,o,i)},t.showOrCloseFloatingCommentCallback=function(e,t,n){(0,r.verifyArgumentNotNull)(l,"externalCallbacks","showFloatingCommentCallback"),l.showOrCloseFloatingCommentCallback(e,t,n)},t.invokeRibbonCommandWithCellReference=function(e,t,n,o){(0,r.verifyArgumentNotNull)(l,"externalCallbacks","invokeRibbonCommandWithCellReference"),l.invokeRibbonCommandWithCellReferenceCallback(e,t,n,o)},t.followHyperlink=function(e,t){(0,r.verifyArgumentNotNull)(l,"externalCallbacks","followHyperlink"),l.followHyperlinkCallback(e,t)},t.handleGoTo=function(e,t,n,o,i,a,s){(0,r.verifyArgumentNotNull)(l,"externalCallbacks","handleGoTo"),l.handleGoToCallback(e,t,n,o,i,a,s)},t.togglePivotDrillFromChildElement=function(e){(0,r.verifyArgumentNotNull)(l,"externalCallbacks","togglePivotDrillFromChildElement"),l.togglePivotDrillFromChildElementCallback(e)},t.togglePivotDrill=function(e,t,n,o,i){(0,r.verifyArgumentNotNull)(l,"externalCallbacks","togglePivotDrill"),l.togglePivotDrillCallback(e,t,n,o,i)},t.setLastInputMethod=function(e){(0,r.verifyArgumentNotNull)(l,"externalCallbacks","setLastInputMethod"),l.setLastInputMethod(e)},t.tableSelectorsCallback=function(e,t,n,o){(0,r.verifyArgumentNotNull)(l,"externalCallbacks","tableSelectorsCallback"),l.tableSelectorsCallback(e,t,n,o)},t.setOrRemoveHoveredCellCallback=function(e,t,n,o){(0,r.verifyArgumentNotNull)(l,"externalCallbacks","setOrRemoveHoveredCellCallback"),l.setOrRemoveHoveredCellCallback(e,t,n,o)},t.setOrRemoveResizeZoneHoveredCallback=function(e,t,n,o){(0,r.verifyArgumentNotNull)(l,"externalCallbacks","setOrRemoveResizeZoneHoveredCallback"),l.setOrRemoveResizeZoneHoveredCallback(e,t,n,o)},t.onHeaderResizeStartCallback=function(e,t,n,o,i,a,s){(0,r.verifyArgumentNotNull)(l,"externalCallbacks","onHeaderResizeStartCallback"),l.onHeaderResizeStartCallback(e,t,n,o,i,a,s)},t.onHeaderUnhideRowColCallback=function(e,t,n,o,i){(0,r.verifyArgumentNotNull)(l,"externalCallbacks","onHeaderUnhideRowColCallback"),l.onHeaderUnhideRowColCallback(e,t,n,o,i)},t.onHeaderDragStartCallback=function(e,t,n){(0,r.verifyArgumentNotNull)(l,"externalCallbacks","onHeaderDragStartCallback"),l.onHeaderDragStartCallback(e,t,n)},t.expandCollapseOutlines=function(e,t,n,o){(0,r.verifyArgumentNotNull)(l,"externalCallbacks","setOutlineLevelCanvas"),l.expandCollapseOutlines(e,t,n,o)};const s={};function d(){return void 0===a&&(a=(0,i.getBooleanFeatureGate)("Microsoft.Office.Excel.HoverTelemetry",!1)),a||!1}t.getServiceSetting=function(e,t){if(!l)return t;if(!(0,o.isNullOrUndefined)(s[e]))return s[e];const n=l.getServiceSetting(e);return s[e]=n,(0,o.isNullOrUndefined)(n)?t:n},t.getAppZoom=function(){return l.getAppZoom()},t.getDevicePixelRatio=function(){return l.getDevicePixelRatio()},t.shouldHitTestHandleEvent=function(){return l.shouldHitTestHandleEvent()},t.invalidHyperlinkCallback=function(){return l.invalidHyperlinkCallback()},t.showCtrlClickHyperlinkCallout=function(e,t){return(0,r.verifyArgumentNotNull)(l,"externalCallbacks","showCtrlClickHyperlinkCallout"),l.showCtrlClickHyperlinkCallout&&l.showCtrlClickHyperlinkCallout(e,t)},t.showOrHideHyperlinkFloatie=function(e,t,n,o){return(0,r.verifyArgumentNotNull)(l,"externalCallbacks","showOrHideHyperlinkFloatie"),l.showOrHideHyperlinkFloatie(e,t,n,o)},t.getTablesRangeContainingRange=function(e,t){return(0,r.verifyArgumentNotNull)(l,"externalCallbacks","getTablesRangeContainingRangeCallback"),l.getTablesRangeContainingRange(e,t)},t.blockCacheSizeCallback=function(){return l.blockCacheSizeCallback()},t.getBlockStatisticLog=function(){return l.getBlockStatisticLog()},t.isResizeAllowed=function(e){return(0,r.verifyArgumentNotNull)(l,"externalCallbacks","isResizeAllowed"),l.isResizeAllowed(e)},t.isHeaderDragAllowed=function(){return(0,r.verifyArgumentNotNull)(l,"externalCallbacks","isHeaderDragAllowed"),l.isHeaderDragAllowed()},t.isHeaderInsertAllowed=function(e,t,n){return(0,r.verifyArgumentNotNull)(l,"externalCallbacks","isHeaderInsertAllowed"),l.isHeaderInsertAllowed(e,t,n)},t.headerInsertHitAreaHoveredCallback=function(e,t,n,o){return(0,r.verifyArgumentNotNull)(l,"externalCallbacks","onHeaderInsertAreaHovered"),l.headerInsertHitAreaHoveredCallback(e,t,n,o)},t.headerInsertButtonInvokedCallback=function(e,t,n,o){return(0,r.verifyArgumentNotNull)(l,"externalCallbacks","onHeaderInsertButtonClick"),l.headerInsertButtonInvokedCallback(e,t,n,o)},t.isFontSupported=function(e){return l.isFontSupported(e)},t.getFontFamilyEndPoint=function(e){return"function"==typeof l.getFontFamilyEndPoint?l.getFontFamilyEndPoint(e):0},t.isFontSourceAddedToCss=function(e){return"function"==typeof l.isFontSourceAddedToCss&&l.isFontSourceAddedToCss(e)},t.inRangePicker=function(){return(0,r.verifyArgumentNotNull)(l,"externalCallbacks","inRangePicker"),l.inRangePicker()},t.getLeftBorderForNextCell=function(e,t){return l.getLeftBorderForNextCell(e,t)},t.getTopBorderForBottomCell=function(e,t){return l.getTopBorderForBottomCell(e,t)},t.isEditing=function(){return l.isEditing()},t.isEditingOrInComponentRangePicker=function(){return l.isEditingOrInComponentRangePicker()},t.getTooltipTitle=function(e){return l.getTooltipTitle(e)},t.isexternalCallbacksRegistered=function(){return!(0,o.isNullOrUndefined)(l)},t.onAutoFilterMouseEnter=function(){l.onAutoFilterMouseEnter&&l.onAutoFilterMouseEnter()},t.isStandardZoomCssSupportedByBrowser=function(){return l.isStandardZoomCssSupportedByBrowser()},t.getRibbonCommandsMapping=function(){return l.getRibbonCommandsMapping()},t.trackGridRendererEventResponseTime=function(e,t,n){if(d())return l.trackGridRendererEventResponseTime(e,t,n)},t.isHoverTelemetryEnabled=d,t.isAppVisuallyReady=function(){return"function"==typeof l.isAppVisuallyReady&&l.isAppVisuallyReady()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(61);o.__exportStar(n(82),t),o.__exportStar(n(148),t),o.__exportStar(n(83),t),o.__exportStar(n(149),t),o.__exportStar(n(150),t),o.__exportStar(n(151),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pointsToPixels=t.cellTextReplacedWithHashes=t.getCellRightVisualElementsPadding=t.shouldExpandCollapseButtonShiftText=t.getExpandCollapseButtonWidth=t.getExpandCollapseButtonPadding=t.getIconSizeAndPadding=t.adjustNumberToRange=t.isBottomPaddingNeededForSubscriptUnderline=t.getIconHorizontalPadding=t.getIconSize=void 0;const o=n(85),r=n(86),i=n(1),l=n(57),a=n(3),s=n(15),d=n(68),c=n(164),u=n(17),g=n(37);function h(e,t){return Math.floor((0,o.approximateValue)(e,r.FontSizeToIconSize)*t)}function C(e,t){return Math.floor((0,o.approximateValue)(e,r.IconHorizontalPadding)*t)}function f(e){var t;return null!==(t=e.PivotTable)&&void 0!==t&&t.HasExpandCollapseIndicator?l.ExpandCollapseButtonSizePx+l.PaddingBetweenExpandCollapseButtonAndTextPx:0}t.getIconSize=h,t.getIconHorizontalPadding=C,t.isBottomPaddingNeededForSubscriptUnderline=function(e,t){return t===i.VerticalAlignment.Bottom&&(e.Underline===i.FontUnderline.Single||e.Underline===i.FontUnderline.Double)},t.adjustNumberToRange=function(e,t,n){return e<t?t:e>n?n:e},t.getIconSizeAndPadding=function(e,t,n,o,r){var i;if(null!==(i=t.CondFormat)&&void 0!==i&&i.Icon)return h(n,1)+C(n,1)+a.GridLineWidthPx;if(t.RichValueIcon){const n=(0,c.shouldAddRichValueIconPadding)(e,t)?(0,u.getAutoFilterButtonPadding)(e,t,o,r):0;return t.RichValueIcon.Width+d.RichValueIconRightHorizontalPadding+n}return 0},t.getExpandCollapseButtonPadding=f,t.getExpandCollapseButtonWidth=function(e){return e?l.ExpandCollapseButtonSizePx+l.PaddingBetweenExpandCollapseButtonAndTextPx:0},t.shouldExpandCollapseButtonShiftText=function(e,t){const n=(0,s.getEffectiveHorizontalAlignment)(e,t);switch(n){case i.HorizontalAlignment.Left:case i.HorizontalAlignment.CenterAcrossSelection:case i.HorizontalAlignment.Center:return!e.IsRtl;case i.HorizontalAlignment.Right:return e.IsRtl;case i.HorizontalAlignment.Automatic:default:throw Error("shouldExpandCollapseButtonShiftText: unsupported horizontalAlignment: "+n)}},t.getCellRightVisualElementsPadding=function(e,t){var n;return e.IsRtl&&null!==(n=t.PivotTable)&&void 0!==n&&n.HasExpandCollapseIndicator?f(t):0},t.cellTextReplacedWithHashes=function(e){if(!e.Text)return!1;const t=e.Text.split("#").length-1;return e.CachedIsTextWidthExceedsCellWidth||t===e.Text.length&&e.ValueType===i.CellValueType.Number},t.pointsToPixels=function(e,t=1){return Math.round(e*t*g.pixelsPerPoint)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setRenderingResultInfo=t.setRenderingResultMonitorable=t.getRenderingMessage=t.RenderPerformanceMetric=t.trackDuration=t.clearPerformanceMetrics=t.createRenderResult=t.verifyPerformanceNowSupported=t.perf=void 0;let o="",r=[],i=void 0,l=[];function a(){if(i)return i;i=!1,window.performance&&"function"==typeof window.performance.now&&(i=!0);try{window.performance.now()}catch(e){i=!1}return i}var s;function d(e,t){var n;e&&""!==e&&(o=(o+"; "+e).substring(0,2500),(n=t)>u()&&(c=n))}let c;function u(){return void 0===c?0:c}t.perf=a()?window.performance:void 0,t.verifyPerformanceNowSupported=a,t.createRenderResult=function(e,t){return{succeeded:e,message:t,performance:r,counters:l,messageLevel:u()}},t.clearPerformanceMetrics=function(){r=[],l=[]},t.trackDuration=function(e,n,o,i){const a=t.perf?t.perf.now():-1;if(n(),t.perf){const n=t.perf.now()-a;o&&r[e]?(r[e]+=n,i&&l[e]++):(r[e]=n,i&&(l[e]=1))}},function(e){e[e.DrawGridlinesDurationMs=0]="DrawGridlinesDurationMs",e[e.DrawTextDurationMs=1]="DrawTextDurationMs",e[e.ClearDurationMs=2]="ClearDurationMs",e[e.RenderInternalDurationMs=3]="RenderInternalDurationMs",e[e.ModelPreparationsMs=4]="ModelPreparationsMs",e[e.ClearRectDurationMs=5]="ClearRectDurationMs",e[e.FillRectDurationMs=6]="FillRectDurationMs",e[e.GetContextDurationMs=7]="GetContextDurationMs",e[e.DrawSpillCellsDurationMs=8]="DrawSpillCellsDurationMs",e[e.DrawBackgroundFillMs=9]="DrawBackgroundFillMs",e[e.ClearGridlinesMs=10]="ClearGridlinesMs",e[e.ClearGridlinesForBorderMs=11]="ClearGridlinesForBorderMs",e[e.ClearGridLinesForSpannedCellsMs=12]="ClearGridLinesForSpannedCellsMs",e[e.DrawBordersMs=13]="DrawBordersMs",e[e.DrawTextDecoration=14]="DrawTextDecoration",e[e.GetFontMetrics=15]="GetFontMetrics",e[e.DrawCFIconsMs=16]="DrawCFIconsMs",e[e.ReorderBidiTextRuns=17]="ReorderBidiTextRuns",e[e.DrawPageBreaksDurationMs=18]="DrawPageBreaksDurationMs",e[e.DrawSkeletonMs=19]="DrawSkeletonMs",e[e.DrawPrintAreasDurationMs=20]="DrawPrintAreasDurationMs",e[e.ClearGridLinesForPivotTable=21]="ClearGridLinesForPivotTable",e[e.DrawEmptyPivotTableTitleContainers=22]="DrawEmptyPivotTableTitleContainers",e[e.DrawEmptyPivotTableImages=23]="DrawEmptyPivotTableImages",e[e.DrawEmptyPivotTableTitleText=24]="DrawEmptyPivotTableTitleText",e[e.DrawDataBarsMs=25]="DrawDataBarsMs",e[e.DrawSparklines=26]="DrawSparklines",e[e.DrawExpandCollapseButtonsMs=27]="DrawExpandCollapseButtonsMs",e[e.DrawAutoFiltersMs=28]="DrawAutoFiltersMs",e[e.RegisterHitRegionsMs=29]="RegisterHitRegionsMs",e[e.DrawInCellImagesMs=30]="DrawInCellImagesMs",e[e.DrawRichErrorMs=31]="DrawRichErrorMs",e[e.DrawCommentsMs=32]="DrawCommentsMs",e[e.DrawRichValueIcons=33]="DrawRichValueIcons",e[e.DrawPhoneticTextDurationMs=34]="DrawPhoneticTextDurationMs",e[e.HyperlinkEventRegistrationMs=35]="HyperlinkEventRegistrationMs",e[e.CellTooltipRegistrationMs=36]="CellTooltipRegistrationMs",e[e.RegisterTableSelectorsMs=37]="RegisterTableSelectorsMs",e[e.DrawPreviewCellsModeOverlayMs=38]="DrawPreviewCellsModeOverlayMs",e[e.DrawSkeletonCellsMs=39]="DrawSkeletonCellsMs",e[e.RegisterHeaderHitRegionsToModelMs=40]="RegisterHeaderHitRegionsToModelMs",e[e.DrawTableBordersMs=41]="DrawTableBordersMs",e[e.DrawHiddenRowColDurationMs=42]="DrawHiddenRowColDurationMs",e[e.DrawOutlines=43]="DrawOutlines",e[e.DrawPatternMs=44]="DrawPatternMs",e[e.DrawAutoFiltersForHeaderSnappingMs=45]="DrawAutoFiltersForHeaderSnappingMs",e[e.DrawInCellControls=46]="DrawInCellControls",e[e.DrawRowColDragAndDropSixSquaresDurationMs=47]="DrawRowColDragAndDropSixSquaresDurationMs",e[e.DrawResizePillDurationMs=48]="DrawResizePillDurationMs",e[e.ClearColumnHeaderGutterAreaDurationMs=49]="ClearColumnHeaderGutterAreaDurationMs",e[e.DrawHeaderCellTextDurationMs=50]="DrawHeaderCellTextDurationMs",e[e.DrawSingleCellTextDurationMs=51]="DrawSingleCellTextDurationMs",e[e.DrawInsertDotAndInsertButton=52]="DrawInsertDotAndInsertButton",e[e.DrawTextTextLineHeight=53]="DrawTextTextLineHeight",e[e.DrawTextTextMaxWidth=54]="DrawTextTextMaxWidth",e[e.DrawTextUpdateCellContext=55]="DrawTextUpdateCellContext",e[e.DrawDataCleansingHeaderIcon=56]="DrawDataCleansingHeaderIcon"}(s||(t.RenderPerformanceMetric=s={})),t.getRenderingMessage=function(){const e=o;o="";const t=u();return c=void 0,{message:e,level:t}},t.setRenderingResultMonitorable=function(e){d(e,1)},t.setRenderingResultInfo=function(e){d(e,0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isHorizontalAlignmentJustifiedOrDistributedForVerticalText=t.isVerticalAlignmentJustifiedOrDistributedForVerticalText=t.shouldRenderVerticalText=void 0;const o=n(1);function r(e){var t;return!0===(null===(t=e.CachedStyle)||void 0===t?void 0:t.VerticalText)&&!e.DisplayFormula&&!e.PreviewText}t.shouldRenderVerticalText=r,t.isVerticalAlignmentJustifiedOrDistributedForVerticalText=function(e){if(r(e))switch(e.CachedStyle.VerticalAlignment){case o.VerticalAlignment.Justify:case o.VerticalAlignment.Distributed:return!0}return!1},t.isHorizontalAlignmentJustifiedOrDistributedForVerticalText=function(e){var t;if(r(e))switch(null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment){case o.HorizontalAlignment.Justify:case o.HorizontalAlignment.JustifyDistributed:case o.HorizontalAlignment.Distributed:return!0}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustXForHorizontalAlignment=t.getEffectiveHorizontalAlignment=t.getTextAlignment=t.isHorizontalAlignmentAdvance=t.isHorizontalAlignmentJustifiedAndDistributed=t.isHorizontalAlignmentCenteredAcrossSelection=void 0;const o=n(1),r=n(6),i=n(2),l=n(22),a=n(14),s=n(0);function d(e,t){var n,d,c;if(t.DisplayFormula)return o.HorizontalAlignment.Left;if((0,s.isCellPreviewTextDefined)(t.PreviewText)&&null!==(c=t.PreviewCellStyle)&&void 0!==c&&c.HorizontalAlignment)return t.PreviewCellStyle.HorizontalAlignment;const u=(null===(n=t.CachedStyle)||void 0===n?void 0:n.HorizontalAlignment)||o.HorizontalAlignment.Automatic;if(null!==(d=t.PivotTable)&&void 0!==d&&d.HasExpandCollapseIndicator&&!(0,r.isNullOrUndefined)(t.Spill)&&u!==o.HorizontalAlignment.CenterAcrossSelection)return e.IsRtl?o.HorizontalAlignment.Right:o.HorizontalAlignment.Left;var g;if((0,l.shouldDrawRotatedText)(e,t.CachedStyle,t.CachedFont))return(0,l.getOrientationInCanvas)(e.IsRtl,null===(g=t.CachedStyle)||void 0===g?void 0:g.Orientation)<0?o.HorizontalAlignment.Left:o.HorizontalAlignment.Right;switch(u){case o.HorizontalAlignment.Fill:return e.IsRtl?o.HorizontalAlignment.Right:o.HorizontalAlignment.Left;case o.HorizontalAlignment.JustifyDistributed:case o.HorizontalAlignment.Justify:case o.HorizontalAlignment.Distributed:case o.HorizontalAlignment.Automatic:return(0,a.shouldRenderVerticalText)(t)?o.HorizontalAlignment.Left:function(e,t){var n,l,a;const s=(null===(n=t.CachedStyle)||void 0===n?void 0:n.HorizontalAlignment)||o.HorizontalAlignment.Automatic;if(null!==(l=t.PivotTable)&&void 0!==l&&l.HasExpandCollapseIndicator&&(s===o.HorizontalAlignment.Distributed||s===o.HorizontalAlignment.Fill))return e.IsRtl?o.HorizontalAlignment.Right:o.HorizontalAlignment.Left;switch((null===(a=t.CachedStyle)||void 0===a?void 0:a.ReadingOrder)||o.ReadingOrderType.Context){case o.ReadingOrderType.LeftToRight:return o.HorizontalAlignment.Left;case o.ReadingOrderType.RightToLeft:return o.HorizontalAlignment.Right;case o.ReadingOrderType.Context:const e=t.Text;if(!(0,r.isNullOrUndefined)(e)&&""!==e)return(0,i.isRtlChar)(e[0])?o.HorizontalAlignment.Right:o.HorizontalAlignment.Left}return o.HorizontalAlignment.Left}(e,t)}return u}t.isHorizontalAlignmentCenteredAcrossSelection=function(e){var t;return(null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment)===o.HorizontalAlignment.CenterAcrossSelection},t.isHorizontalAlignmentJustifiedAndDistributed=function(e){var t;switch(null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment){case o.HorizontalAlignment.Justify:case o.HorizontalAlignment.JustifyDistributed:case o.HorizontalAlignment.Distributed:return!0}return!1},t.isHorizontalAlignmentAdvance=function(e){return e>o.HorizontalAlignment.Right},t.getTextAlignment=function(e,t){if((0,a.shouldRenderVerticalText)(t))return"center";const n=d(e,t);switch(n){case o.HorizontalAlignment.Right:return"right";case o.HorizontalAlignment.CenterAcrossSelection:case o.HorizontalAlignment.Center:return"center";case o.HorizontalAlignment.Left:return"left";default:throw Error("getTextAlignment: unsupported horizontalAlignment: "+n)}},t.getEffectiveHorizontalAlignment=d,t.adjustXForHorizontalAlignment=function(e,t,n,r){let i=0;const l=d(e,t);switch(l){case o.HorizontalAlignment.Left:i=n;break;case o.HorizontalAlignment.Right:i=n-r;break;case o.HorizontalAlignment.Center:case o.HorizontalAlignment.CenterAcrossSelection:i=n-r/2;break;default:throw Error("unexpected context alignment "+l)}return i}},function(e,t,n){"use strict";var o;n.d(t,"a",(function(){return o})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(o||(o={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFilterLeftAdjustedForDrawing=t.getFilterBottomAdjustedForDrawing=t.isTextAlignedOnButton=t.shouldAddAutoFilterPaddingForMetadata=t.shouldAddAutoFilterPadding=t.getAutoFilterPaddingForAdvancedHorizontalAlignment=t.getAutoFilterButtonPaddingForShrinkToFit=t.getAutoFilterButtonPadding=t.getFilterSizeAdjustedForDrawing=void 0;const o=n(1),r=n(5),i=n(2),l=n(21),a=n(48),s=n(68);function d(e,t,n,o){return(0,l.getInteractiveIconMaxSizeAdjustedForDrawing)(a.AutoFilterIconRectPx,e,t,n,o,!1,!0)}function c(e,t,n,r){const i=d(e,t,1,n);if((0,o.isChangeGateEnabled)(o.ChangeGate.RichIconFilterScale)&&t.RichValueIcon&&!t.PivotTable){const e=(a.AutoFilterTextHorizontalPaddingPx+s.RichValueIconLeftHorizontalPadding)/r;return Math.round(i/n+e)}return Math.round(t.PivotTable&&t.RichValueIcon?(i/n+a.AutoFilterTextHorizontalPaddingPx)*r:i/n+a.AutoFilterTextHorizontalPaddingPx*r)}function u(e,t){return(null==t?void 0:t.HorizontalAlignment)===o.HorizontalAlignment.Right&&!e.IsRtl||(null==t?void 0:t.HorizontalAlignment)===o.HorizontalAlignment.Left&&e.IsRtl}t.getFilterSizeAdjustedForDrawing=d,t.getAutoFilterButtonPadding=c,t.getAutoFilterButtonPaddingForShrinkToFit=function(e,t,n,r){return function(e,t){var n,r;if(null===(n=t.CachedStyle)||void 0===n||!n.ShrinkToFit)return!1;const i=(null===(r=t.CachedStyle)||void 0===r?void 0:r.HorizontalAlignment)||o.HorizontalAlignment.Automatic,l=e.IsRtl?i===o.HorizontalAlignment.Right:i===o.HorizontalAlignment.Left;return t.AutoFilter&&l}(e,t)?c(e,t,n,r):0},t.getAutoFilterPaddingForAdvancedHorizontalAlignment=function(e,t,n,r){return function(e){var t;const n=((null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment)||o.HorizontalAlignment.Automatic)>3;return e.AutoFilter&&n}(t)?c(e,t,n,r):0},t.shouldAddAutoFilterPadding=function(e,t){var n;return(t.AutoFilter||(null===(n=t.PivotFilter)||void 0===n?void 0:n.DisplayFilter)&&t.RichValueIcon)&&u(e,t.CachedStyle)},t.shouldAddAutoFilterPaddingForMetadata=function(e,t){return t.Autofilter&&u(e,t.CachedStyle)},t.isTextAlignedOnButton=u,t.getFilterBottomAdjustedForDrawing=function(e,t,n,l,s){var d;const c=(0,i.getDefaultBorderLineWidth)(s*l),u=(0,r.getCellHeightAdjustedForDrawing)(e,t)-2*c>n?Math.round(a.AutoFilterPaddingBottomPx*l):0;switch(null===(d=t.CachedStyle)||void 0===d?void 0:d.VerticalAlignment){case o.VerticalAlignment.Top:return(0,r.getCellTopAdjustedForDrawing)(e,t,!1)+u+c+n;case o.VerticalAlignment.Center:return(0,r.getCellBottomAdjustedForDrawing)(e,t)-Math.round((0,r.getCellHeightAdjustedForDrawing)(e,t)/2)+Math.round(n/2);case o.VerticalAlignment.Bottom:default:return(0,r.getCellBottomAdjustedForDrawing)(e,t)-u-c}},t.getFilterLeftAdjustedForDrawing=function(e,t,n,o,l){const s=(0,i.getDefaultBorderLineWidth)(l*o),d=(0,r.getCellWidthAdjustedForDrawing)(e,t)-2*s>n?Math.round(a.AutoFilterHorizontalPaddingPx*o):0;return e.IsRtl?(0,r.getCellLeftAdjustedForDrawing)(e,t,!1,!1)+s:(0,r.getCellRightAdjustedForDrawing)(e,t,!1)-n-s-d}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeLinesAdjustment=t.ShapeOutlineWidthPx=void 0;const o=n(0);t.ShapeOutlineWidthPx=1,t.ShapeLinesAdjustment=(0,o.getLinePixelTranslation)(t.ShapeOutlineWidthPx)},function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.CircledExclamationMarkWidthRectSizeRatio=t.ExclamationMarkMinSpaceBetweenRectangels=t.ExclamationMarkTopRectHeightSizeRatio=t.ExclamationMarkSpaceBetweenRectanglesRatio=t.ExclamationMarkLeftRectanglePaddingRatio=t.ExclamationMarkWidthRectSizeRatio=t.ExclamationMarkBottomRectHeightSizeRatio=t.CrossMarkInnerSmallPaddingRatio=t.CrossMarkInnerBigPaddingRatio=t.CrossMarkInnerCenterRatio=t.CrossMarkOuterSmallPaddingRatio=t.CrossMarkOuterBigPaddingRatio=t.CircledCheckMarkTopMiddleXRatio=t.CircledCheckMarkTopMiddleYRatio=t.CircledCheckMarkTopLeftXRatio=t.CircledCheckMarkTopLeftYRatio=t.CircledCheckMarkMiddleRightXRatio=t.CircledCheckMarkMiddleRightYRatio=t.CircledCheckMarkTopRightXRatio=t.CircledCheckMarkTopRightYRatio=t.CircledCheckMarkBottomYRatio=t.CircledCheckMarkMiddleYRatio=t.CircledCheckMarkMiddleXRatio=t.CheckMarkTopMiddleXRatio=t.CheckMarkTopMiddleYRatio=t.CheckMarkTopLeftXRatio=t.CheckMarkTopLeftYRatio=t.CheckMarkMiddleRightYRatio=t.CheckMarkTopRightXRatio=t.CheckMarkTopRightYRatio=t.CheckMarkBottomYRatio=t.CheckMarkMiddleYRatio=t.CheckMarkMiddleXRatio=t.UnusedColor=t.Circle360Deg=t.Circle180Deg=t.Circle90Deg=t.Circle0Deg=t.Circle270Deg=t.StarInset=t.StarRotation2Cos=t.StarRotationCos=t.StarRotation2Sin=t.StarRotationSin=t.MinimalIconSize=t.MinimalIconPadding=t.FlagPoleWidth=t.CirclePaddingFromBoundariesPx=t.IconImageLookup=t.CFIconImage=void 0,t.StripedCircleLowerLineAngle=t.StripedCircleMiddleLineAngle=t.StripedCircleUpperLineAngle=t.CircleHighContrastLargeRadiusPortion=t.CircleHighContrastMediumRadiusPortion=t.CircleHighContrastSmallRadiusPortion=t.QuarterPiTan=t.CircledCrossMarkPaddingFromCircleRatio=t.CircledCrossMarkInnerBigPaddingRatio=t.CircledCrossMarkInnerSmallPaddingRatio=t.CircledCrossMarkInnerCenterRatio=t.CircledCrossMarkOuterBigPaddingRatio=t.CircledCrossMarkOuterSmallPaddingRatio=t.ArrowAngle=t.ArrowUpRightTipYRatio=t.ArrowUpRightTipXRatio=t.ArrowDownRightTipYRatio=t.ArrowDownRightTipXRatio=t.ArrowHeightRatio=t.ArrowWidthRatio=t.CircledExclamationMarkPaddingFromCircle=t.CircledExclamationMarkTopRectHeightSizeRatio=t.CircledExclamationMarkLeftCircleSizeRatio=void 0,function(e){e[e.ColoredArrowUp=0]="ColoredArrowUp",e[e.ColoredArrowUpRight=1]="ColoredArrowUpRight",e[e.ColoredArrowRight=2]="ColoredArrowRight",e[e.ColoredArrowDownRight=3]="ColoredArrowDownRight",e[e.ColoredArrowDown=4]="ColoredArrowDown",e[e.TriangleHigh=5]="TriangleHigh",e[e.TriangleMedium=6]="TriangleMedium",e[e.TriangleLow=7]="TriangleLow",e[e.GrayArrowUp=8]="GrayArrowUp",e[e.GrayArrowUpRight=9]="GrayArrowUpRight",e[e.GrayArrowRight=10]="GrayArrowRight",e[e.GrayArrowDownRight=11]="GrayArrowDownRight",e[e.GrayArrowDown=12]="GrayArrowDown",e[e.CircleHigh=13]="CircleHigh",e[e.CircleMedium=14]="CircleMedium",e[e.CircleLow=15]="CircleLow",e[e.SignMedium=16]="SignMedium",e[e.SignLow=17]="SignLow",e[e.FourCircleHigh=18]="FourCircleHigh",e[e.FourCircleMedium1=19]="FourCircleMedium1",e[e.FourCircleMedium2=20]="FourCircleMedium2",e[e.FourCircleLow=21]="FourCircleLow",e[e.TrafficHigh=22]="TrafficHigh",e[e.TrafficMedium=23]="TrafficMedium",e[e.TrafficLow=24]="TrafficLow",e[e.CircleSymbolHigh=25]="CircleSymbolHigh",e[e.CircleSymbolMedium=26]="CircleSymbolMedium",e[e.CircleSymbolLow=27]="CircleSymbolLow",e[e.FlagHigh=28]="FlagHigh",e[e.FlagMedium=29]="FlagMedium",e[e.FlagLow=30]="FlagLow",e[e.SymbolHigh=31]="SymbolHigh",e[e.SymbolMedium=32]="SymbolMedium",e[e.SymbolLow=33]="SymbolLow",e[e.StarHigh=34]="StarHigh",e[e.StarMedium=35]="StarMedium",e[e.StarLow=36]="StarLow",e[e.CircleFilled=37]="CircleFilled",e[e.Circle75=38]="Circle75",e[e.CircleHalf=39]="CircleHalf",e[e.Circle25=40]="Circle25",e[e.CircleEmpty=41]="CircleEmpty",e[e.QuadrantFull=42]="QuadrantFull",e[e.Quadrant75=43]="Quadrant75",e[e.QuadrantHalf=44]="QuadrantHalf",e[e.Quadrant25=45]="Quadrant25",e[e.QuadrantEmpty=46]="QuadrantEmpty",e[e.SignalBarEmpty=47]="SignalBarEmpty",e[e.SignalBarLow=48]="SignalBarLow",e[e.SignalBarMedium1=49]="SignalBarMedium1",e[e.SignalBarMedium2=50]="SignalBarMedium2",e[e.SignalBarHigh=51]="SignalBarHigh"}(o||(t.CFIconImage=o={})),t.IconImageLookup=[[o.ColoredArrowDown,o.ColoredArrowRight,o.ColoredArrowUp],[o.GrayArrowDown,o.GrayArrowRight,o.GrayArrowUp],[o.FlagLow,o.FlagMedium,o.FlagHigh],[o.CircleLow,o.CircleMedium,o.CircleHigh],[o.TrafficLow,o.TrafficMedium,o.TrafficHigh],[o.SignLow,o.SignMedium,o.CircleHigh],[o.CircleSymbolLow,o.CircleSymbolMedium,o.CircleSymbolHigh],[o.SymbolLow,o.SymbolMedium,o.SymbolHigh],[o.ColoredArrowDown,o.ColoredArrowDownRight,o.ColoredArrowUpRight,o.ColoredArrowUp],[o.GrayArrowDown,o.GrayArrowDownRight,o.GrayArrowUpRight,o.GrayArrowUp],[o.FourCircleLow,o.FourCircleMedium1,o.FourCircleMedium2,o.FourCircleHigh],[o.SignalBarLow,o.SignalBarMedium1,o.SignalBarMedium2,o.SignalBarHigh],[o.FourCircleLow,o.CircleLow,o.CircleMedium,o.CircleHigh],[o.ColoredArrowDown,o.ColoredArrowDownRight,o.ColoredArrowRight,o.ColoredArrowUpRight,o.ColoredArrowUp],[o.GrayArrowDown,o.GrayArrowDownRight,o.GrayArrowRight,o.GrayArrowUpRight,o.GrayArrowUp],[o.SignalBarEmpty,o.SignalBarLow,o.SignalBarMedium1,o.SignalBarMedium2,o.SignalBarHigh],[o.CircleEmpty,o.Circle25,o.CircleHalf,o.Circle75,o.CircleFilled],[o.StarLow,o.StarMedium,o.StarHigh],[o.TriangleLow,o.TriangleMedium,o.TriangleHigh],[o.QuadrantEmpty,o.Quadrant25,o.QuadrantHalf,o.Quadrant75,o.QuadrantFull]],t.CirclePaddingFromBoundariesPx=2,t.FlagPoleWidth=1,t.MinimalIconPadding=3,t.MinimalIconSize=4;const r=Math.PI/5;t.StarRotationSin=Math.sin(r),t.StarRotation2Sin=Math.sin(2*r),t.StarRotationCos=Math.cos(r),t.StarRotation2Cos=Math.cos(2*r),t.StarInset=.4,t.Circle270Deg=1.5*Math.PI,t.Circle0Deg=0,t.Circle90Deg=.5*Math.PI,t.Circle180Deg=Math.PI,t.Circle360Deg=2*Math.PI,t.UnusedColor="unused",t.CheckMarkMiddleXRatio=.375,t.CheckMarkMiddleYRatio=.5625,t.CheckMarkBottomYRatio=.9375,t.CheckMarkTopRightYRatio=.125,t.CheckMarkTopRightXRatio=.8125,t.CheckMarkMiddleRightYRatio=.3125,t.CheckMarkTopLeftYRatio=.34375,t.CheckMarkTopLeftXRatio=.1875,t.CheckMarkTopMiddleYRatio=.53125,t.CheckMarkTopMiddleXRatio=0,t.CircledCheckMarkMiddleXRatio=.4,t.CircledCheckMarkMiddleYRatio=.575,t.CircledCheckMarkBottomYRatio=.87,t.CircledCheckMarkTopRightYRatio=.22,t.CircledCheckMarkTopRightXRatio=.775,t.CircledCheckMarkMiddleRightYRatio=.37,t.CircledCheckMarkMiddleRightXRatio=.91,t.CircledCheckMarkTopLeftYRatio=.4,t.CircledCheckMarkTopLeftXRatio=.24,t.CircledCheckMarkTopMiddleYRatio=.55,t.CircledCheckMarkTopMiddleXRatio=.09,t.CrossMarkOuterBigPaddingRatio=.8125,t.CrossMarkOuterSmallPaddingRatio=.1875,t.CrossMarkInnerCenterRatio=.5,t.CrossMarkInnerBigPaddingRatio=.6875,t.CrossMarkInnerSmallPaddingRatio=.3125,t.ExclamationMarkBottomRectHeightSizeRatio=.25,t.ExclamationMarkWidthRectSizeRatio=.25,t.ExclamationMarkLeftRectanglePaddingRatio=.375,t.ExclamationMarkSpaceBetweenRectanglesRatio=.125,t.ExclamationMarkTopRectHeightSizeRatio=.6,t.ExclamationMarkMinSpaceBetweenRectangels=2,t.CircledExclamationMarkWidthRectSizeRatio=.4,t.CircledExclamationMarkLeftCircleSizeRatio=.325,t.CircledExclamationMarkTopRectHeightSizeRatio=.625,t.CircledExclamationMarkPaddingFromCircle=2,t.ArrowWidthRatio=.18,t.ArrowHeightRatio=.62,t.ArrowDownRightTipXRatio=.875,t.ArrowDownRightTipYRatio=.875,t.ArrowUpRightTipXRatio=.875,t.ArrowUpRightTipYRatio=.13,t.ArrowAngle=Math.PI/4,t.CircledCrossMarkOuterSmallPaddingRatio=.305,t.CircledCrossMarkOuterBigPaddingRatio=1-t.CircledCrossMarkOuterSmallPaddingRatio,t.CircledCrossMarkInnerCenterRatio=.5,t.CircledCrossMarkInnerSmallPaddingRatio=.325,t.CircledCrossMarkInnerBigPaddingRatio=1-t.CircledCrossMarkInnerSmallPaddingRatio,t.CircledCrossMarkPaddingFromCircleRatio=.125,t.QuarterPiTan=Math.tan(Math.PI/4),t.CircleHighContrastSmallRadiusPortion=.4,t.CircleHighContrastMediumRadiusPortion=.55,t.CircleHighContrastLargeRadiusPortion=.7,t.StripedCircleUpperLineAngle=.05*Math.PI,t.StripedCircleMiddleLineAngle=.25*Math.PI,t.StripedCircleLowerLineAngle=.45*Math.PI},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerHitRegionInternal=t.registerMouseLeaveHitRegion=t.registerMouseEnterHitRegion=t.registerTooltipHitRegion=t.registerLongPressHitRegion=t.registerCursorHitRegion=t.registerHitRegion=void 0;const o=n(1);function r(e,t,n){(function(e,t){const n=(0,o.getCellLookupKey)(t.Row,t.Col);let r=e[n];return r||(e[n]=[],r=e[n]),r})(t,e).push(n)}function i(e){const t=e.scaleFactor,n=e.rect,o=n.x/t,r=n.y/t,i=n.width/t,l=n.height/t,a=e.renderingRegion,s=o-(e.isRtl?e.blockWidth-a.endOffsetX:a.startOffsetX),d=r-a.startOffsetY;return{x:e.isMirrored?a.endOffsetX-o-i:s,y:d,width:i,height:l}}t.registerHitRegion=function(e,t,n,o,l,a){const s={eventType:a,callback:l,zIndex:o,region:i(n)};r(e,t.CellHitRegions,s)},t.registerCursorHitRegion=function(e,t,n,o,l,a=(()=>!0)){const s={cursorType:o,zIndex:l,region:i(n),shouldChangeCursor:a};r(e,t.CellCursorHitRegions,s)},t.registerLongPressHitRegion=function(e,t,n,o,l,a){const s={zIndex:o,region:i(n),onStart:l,onEnd:a};r(e,t.CellLongPressHitRegions,s)},t.registerTooltipHitRegion=function(e,t,n,o,l){const a={tooltipText:o,zIndex:l,region:i(n)};r(e,t.CellTooltipHitRegions,a)},t.registerMouseEnterHitRegion=function(e,t,n,o,l){const a={zIndex:o,eventType:"mouseenter",callback:l,region:i(n)};r(e,t.CellHitRegions,a)},t.registerMouseLeaveHitRegion=function(e,t,n,o,l){const a={zIndex:o,eventType:"mouseleave",callback:l,region:i(n)};r(e,t.CellHitRegions,a)},t.registerHitRegionInternal=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDynamicImageCallback=t.createRichErrorCallback=t.createCommentsCallback=t.getUnadjustedHitRegionFromRect=t.getInteractiveIconMaxSizeAdjustedForDrawing=void 0;const o=n(1),r=n(5),i=n(2),l=n(10),a=n(0),s=n(6),d=n(31),c=n(47);function u(e,t,n,r){const{commentRow:i,commentColumn:a}=function(e,t){var n,o;let r=e.RowNumbers[t.Row]-1,i=e.ColumnNumbers[t.Col]-1;const l=(null===(n=t.Merge)||void 0===n?void 0:n.OriginRow)||0,a=(null===(o=t.Merge)||void 0===o?void 0:o.OriginColumn)||0;return l&&a&&(r=l,i=a),{commentRow:r,commentColumn:i}}(e,t);return n?s=>{if(t.HasIgnorableError){const n=(0,o.isPassRibbonCommandsToCanvasRendererEnabled)()?(0,c.getRibbonCommandsInstance)().CardViewHideTemporaryCard:e.RibbonCommands.CardViewHideTemporaryCard;g(e,t,n,!0)(s)}return h(e,t,!1,!0)(s),(0,l.showOrCloseFloatingCommentCallback)(i,a,n),r}:o=>(h(e,t,!0,!0)(o),(0,l.showOrCloseFloatingCommentCallback)(i,a,n),r)}function g(e,t,n,r){const i=e.RowNumbers[t.Row],a=e.ColumnNumbers[t.Col];return s=>{const d=(0,o.isPassRibbonCommandsToCanvasRendererEnabled)()?(0,c.getRibbonCommandsInstance)().CardViewShowTemporaryErrorCard:e.RibbonCommands.CardViewShowTemporaryErrorCard,g=n===d;return t.Comment&&g&&u(e,t,!1,!1)(s),(0,l.invokeRibbonCommandWithCellReference)(s,n,i,a),r}}function h(e,t,n,r){const i=e.RowNumbers[t.Row],u=e.ColumnNumbers[t.Col];return g=>{const h=(0,a.getDynamicImageInformationFromCell)(t,d.ImageType.InCellImage);if(!(0,s.isNullOrUndefined)(h)){let t;if((0,o.isPassRibbonCommandsToCanvasRendererEnabled)()){const e=(0,c.getRibbonCommandsInstance)();t=n?e.CardViewShowTemporaryDataCard:e.CardViewHideTemporaryCard}else t=n?e.RibbonCommands.CardViewShowTemporaryDataCard:e.RibbonCommands.CardViewHideTemporaryCard;(0,l.invokeRibbonCommandWithCellReference)(g,t,i,u)}return r}}t.getInteractiveIconMaxSizeAdjustedForDrawing=function(e,t,n,o,l,a,s){const d=(0,i.getDefaultBorderLineWidth)(l*o),c=(0,r.getCellWidthAdjustedForDrawing)(t,n)-d,u=(0,r.getCellHeightAdjustedForDrawing)(t,n)-d;let g=e;return s&&(g*=o),a&&(g*=l),Math.ceil(Math.max(Math.min(g,c,u),0))},t.getUnadjustedHitRegionFromRect=function(e,t,n,o){return{isMirrored:o,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:{x:n.x,y:n.y,width:n.width,height:n.height},isRtl:e.IsRtl,blockWidth:e.BlockWidth}},t.createCommentsCallback=u,t.createRichErrorCallback=g,t.createDynamicImageCallback=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUnderlinePadding=t.degreeToRadians=t.getRotatedTextVerticalPadding=t.getRotatedTextVerticalPosition=t.getRotatedTextHorizontalPosition=t.getEffectiveHorizontalAlignmentForRotatedText=t.getIndexOfMaxLineWidth=t.getRotatedWrapTextWidth=t.getRotatedTextBoxHeight=t.getRotatedTextBoxWidth=t.applyRotation=t.getOrientationInCanvas=t.isRotatedTextSlice2Enabled=t.isRotatedTextSlice1Enabled=t.shouldDrawRotateTextSlice1=t.shouldDrawRotatedText=void 0;const o=n(1),r=n(0),i=n(8),l=n(85),a=n(86),s=n(3);function d(e,t){return c(e)&&!(null==(r=t)||!r.Orientation)&&!((n=null==t?void 0:t.HorizontalAlignment)===o.HorizontalAlignment.Fill||n===o.HorizontalAlignment.CenterAcrossSelection);var n,r}function c(e){return(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.TextOrientationSlice1,e)}function u(e){return(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.TextOrientationSlice2,e)}function g(e,t,n){return e*Math.abs(Math.cos(n))+t}t.shouldDrawRotatedText=function(e,t,n){var o;return(o=n)&&(o.StrikeThrough||o.Underline||o.VerticalAlign)?u(e)&&d(e,t):d(e,t)},t.shouldDrawRotateTextSlice1=d,t.isRotatedTextSlice1Enabled=c,t.isRotatedTextSlice2Enabled=u,t.getOrientationInCanvas=function(e,t){(t>s.MaxOrientationRange||t<s.MinOrientationRange)&&(0,r.throwError)("Orientation is not in the defined range","getOrientationInCanvas");const n=-1*t;return e?-1*n:n},t.applyRotation=function(e,t,n,o){e.save(),e.textAlign=o<0?s.LeftTextAlign:s.RightTextAlign,e.translate(t,n),e.rotate(o)},t.getRotatedTextBoxWidth=g,t.getRotatedTextBoxHeight=function(e,t,n){return e*Math.abs(Math.sin(n))+t*Math.abs(Math.cos(n))},t.getRotatedWrapTextWidth=function(e,t,n){const o=e.length;if(1===o)return g(e[0].width,t[0],n);if(o>1){const o=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n));let i=e[0].width*o,l=0;for(let n=1;n<e.length;n++)l+=t[n]/r,i=Math.max(i,l+e[n].width*o);return i+t[0]}return 0},t.getIndexOfMaxLineWidth=function(e){let t=0,n=0;for(let o=0;o<e.length;o++)e[o].width>n&&(n=e[o].width,t=o);return t},t.getEffectiveHorizontalAlignmentForRotatedText=function(e,t){switch(e){case o.HorizontalAlignment.Distributed:case o.HorizontalAlignment.Justify:case o.HorizontalAlignment.Automatic:case o.HorizontalAlignment.JustifyDistributed:return t?o.HorizontalAlignment.Right:o.HorizontalAlignment.Left;case o.HorizontalAlignment.Left:case o.HorizontalAlignment.Right:case o.HorizontalAlignment.Center:return e;case o.HorizontalAlignment.CenterAcrossSelection:case o.HorizontalAlignment.Fill:default:throw Error("getEffectiveHorizontalAlignmentForRotatedText: Unsupported horizontal alignment "+e)}},t.getRotatedTextHorizontalPosition=function(e,t,n,r,i,l,a,s,d){const c=s<0;switch(e){case o.HorizontalAlignment.Left:return c?t+r*Math.abs(Math.sin(s))+i:t+a-r+i+l;case o.HorizontalAlignment.Right:return c?n-a-i-l+r:n-r*Math.abs(Math.sin(s))-i;case o.HorizontalAlignment.Center:return c?t+(d-a)/2+r:n-(d-a)/2-r;default:throw Error("getRotatedTextHorizontalPosition: unsupported horizontalAlignment: "+e)}},t.getRotatedTextVerticalPosition=function(e,t,n,r,i,l,a){switch(e){case o.VerticalAlignment.Top:return l+r+t;case o.VerticalAlignment.Center:return a-(i-r)/2;case o.VerticalAlignment.Bottom:case o.VerticalAlignment.Justify:case o.VerticalAlignment.Distributed:default:return a-(t-(n?s.InCellVerticalPaddingPx:0))}},t.getRotatedTextVerticalPadding=function(e,t){const n=!!e.WrapText||(0,i.cellHasShrinkToFit)(e);let r=a.CalibriRegularPadding;switch(e.CachedStyle.VerticalAlignment){case o.VerticalAlignment.Center:return n?(0,l.approximateValue)(t,r):0;case o.VerticalAlignment.Top:return e.CachedFont.Italic&&(r=a.CalibriItalicPadding),(0,l.approximateValue)(t,r);case o.VerticalAlignment.Justify:case o.VerticalAlignment.Distributed:case o.VerticalAlignment.Bottom:default:return(0,l.approximateValue)(t,r)}},t.degreeToRadians=function(e){return e*Math.PI/180},t.getUnderlinePadding=function(e,t){return e.Underline?function(e){return Math.abs(e)===s.NinetyDegreeInRadians}(t)?2*s.GridLineWidthPx:s.GridLineWidthPx:0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyTrueCallback=t.EmptyFalseCallback=t.TouchCallback=t.MinLongPressDurationMs=t.DoubleClickEventType=t.ClickEventType=t.DefaultTooltip=t.GrabCursorType=t.ColResizeModernizeCursorType=t.ColResizeCursorType=t.RowResizeModerinzeCursorType=t.RowResizeCursorType=t.DefaultCursorType=t.PointerCursorType=t.UnsetCursorType=t.OutsideCanvasPoint=t.PointerUpEvent=t.PointerDownEvent=t.PointerLeaveEvent=t.PointerMoveEvent=t.LongPressEventType=t.TooltipEventType=t.CursorEventType=t.HitMapKeyXShift=t.MaxHitMapOffsetCount=t.DefaultHitMapSectionsCount=void 0;const o=n(10);t.DefaultHitMapSectionsCount=30,t.MaxHitMapOffsetCount=32,t.HitMapKeyXShift=5,t.CursorEventType="cursor",t.TooltipEventType="tooltip",t.LongPressEventType="longpress",t.PointerMoveEvent="pointermove",t.PointerLeaveEvent="pointerleave",t.PointerDownEvent="pointerdown",t.PointerUpEvent="pointerup",t.OutsideCanvasPoint={x:-1,y:-1},t.UnsetCursorType="unset",t.PointerCursorType="pointer",t.DefaultCursorType="default",t.RowResizeCursorType="row-resize",t.RowResizeModerinzeCursorType="ns-resize",t.ColResizeCursorType="col-resize",t.ColResizeModernizeCursorType="ew-resize",t.GrabCursorType="grab",t.DefaultTooltip="",t.ClickEventType="click",t.DoubleClickEventType="dblclick",t.MinLongPressDurationMs=800,t.TouchCallback=e=>((0,o.setLastInputMethod)(e),!1),t.EmptyFalseCallback=()=>!1,t.EmptyTrueCallback=()=>!0},function(e,t,n){"use strict";var o,r,i,l,a,s,d,c,u,g,h,C,f,m,p,y,S,R,F,T,w,I,b,v,x,D,A,P,M,B,H,O,k,L,N,E,z,W,G,V,j,_;n.r(t),n.d(t,"InsertButtonType",(function(){return o})),n.d(t,"LocationInCell",(function(){return r})),n.d(t,"MenuDisplayType",(function(){return i})),n.d(t,"InCellControlType",(function(){return l})),n.d(t,"PivotTableDataFieldAggregationType",(function(){return a})),n.d(t,"PivotTableDataFieldFormatType",(function(){return s})),n.d(t,"PivotFilterType",(function(){return d})),n.d(t,"PivotSortInfo",(function(){return c})),n.d(t,"PivotMeasureType",(function(){return u})),n.d(t,"RangeType",(function(){return g})),n.d(t,"ViewMode",(function(){return h})),n.d(t,"GradientShadingStyle",(function(){return C})),n.d(t,"BackgroundFillType",(function(){return f})),n.d(t,"ReadingOrderType",(function(){return m})),n.d(t,"HorizontalAlignment",(function(){return p})),n.d(t,"VerticalAlignment",(function(){return y})),n.d(t,"UniqueStyleID",(function(){return S})),n.d(t,"CellValueType",(function(){return R})),n.d(t,"CellFormulaType",(function(){return F})),n.d(t,"AutoFilterType",(function(){return T})),n.d(t,"CellsEncoding",(function(){return w})),n.d(t,"RenderFlagsArray",(function(){return I})),n.d(t,"MenuItemType",(function(){return b})),n.d(t,"BorderLineType",(function(){return v})),n.d(t,"BorderPositionType",(function(){return x})),n.d(t,"FontUnderline",(function(){return D})),n.d(t,"FontVerticalAlignment",(function(){return A})),n.d(t,"FontSchemeOption",(function(){return P})),n.d(t,"OutlineState",(function(){return M})),n.d(t,"MenuEntryIdentifier",(function(){return B})),n.d(t,"RichValueCellType",(function(){return H})),n.d(t,"RichValueIconType",(function(){return O})),n.d(t,"CFIconSet",(function(){return k})),n.d(t,"SparklineType",(function(){return L})),n.d(t,"DirtyType",(function(){return N})),n.d(t,"TolType",(function(){return E})),n.d(t,"UniqueHeadersStyleID",(function(){return z})),n.d(t,"UniqueHeadersFontID",(function(){return W})),n.d(t,"PatternStyleType",(function(){return G})),n.d(t,"ModelType",(function(){return V})),n.d(t,"DelayRenderToNextAnimationFrameState",(function(){return j})),n.d(t,"SpillDirection",(function(){return _})),n.d(t,"HitTestEvents",(function(){return U})),n.d(t,"RenderFeaturesZIndex",(function(){return q})),function(e){e[e.InsertDot=0]="InsertDot",e[e.InsertButton=1]="InsertButton"}(o||(o={})),function(e){e[e.CellStart=0]="CellStart",e[e.CellEnd=1]="CellEnd"}(r||(r={})),function(e){e[e.Gallery=0]="Gallery",e[e.List=1]="List"}(i||(i={})),function(e){e[e.None=0]="None",e[e.Checkbox=1]="Checkbox",e[e.Dropdown=2]="Dropdown"}(l||(l={})),function(e){e[e.None=-1]="None",e[e.Sum=0]="Sum",e[e.Count=1]="Count",e[e.Average=2]="Average",e[e.Max=3]="Max",e[e.Min=4]="Min",e[e.Product=5]="Product",e[e.CountNumbers=6]="CountNumbers",e[e.StdDeviation=7]="StdDeviation",e[e.StdDeviationPercent=8]="StdDeviationPercent",e[e.Variant=9]="Variant",e[e.VariantPercent=10]="VariantPercent",e[e.DistinctCountPPM=11]="DistinctCountPPM",e[e.Median=12]="Median",e[e.AggregationTypeMax=12]="AggregationTypeMax"}(a||(a={})),function(e){e[e.None=-1]="None",e[e.NoCalculation=0]="NoCalculation",e[e.DifferenceFrom=1]="DifferenceFrom",e[e.PercentOf=2]="PercentOf",e[e.PercentDifferenceFrom=3]="PercentDifferenceFrom",e[e.RunningTotalIn=4]="RunningTotalIn",e[e.PercentOfRowTotal=5]="PercentOfRowTotal",e[e.PercentOfColumnTotal=6]="PercentOfColumnTotal",e[e.PercentOfGrandTotal=7]="PercentOfGrandTotal",e[e.Index=8]="Index",e[e.PercentOfParentRowTotal=9]="PercentOfParentRowTotal",e[e.PercentOfParentColumnTotal=10]="PercentOfParentColumnTotal",e[e.PercentOfParentTotal=11]="PercentOfParentTotal",e[e.PercentRunningTotalIn=12]="PercentRunningTotalIn",e[e.RankSmallestToLargest=13]="RankSmallestToLargest",e[e.RankLargestToSmallest=14]="RankLargestToSmallest",e[e.DataFormatMax=14]="DataFormatMax"}(s||(s={})),function(e){e[e.Invalid=0]="Invalid",e[e.FirstTop10=1]="FirstTop10",e[e.Count=1]="Count",e[e.Percent=2]="Percent",e[e.Sum=3]="Sum",e[e.LastTop10=3]="LastTop10",e[e.CaptionFirst=4]="CaptionFirst",e[e.CaptionEquals=4]="CaptionEquals",e[e.CaptionDoesNotEqual=5]="CaptionDoesNotEqual",e[e.CaptionBeginsWith=6]="CaptionBeginsWith",e[e.CaptionDoesNotBeginWith=7]="CaptionDoesNotBeginWith",e[e.CaptionEndsWith=8]="CaptionEndsWith",e[e.CaptionDoesNotEndWith=9]="CaptionDoesNotEndWith",e[e.CaptionContains=10]="CaptionContains",e[e.CaptionDoesNotContain=11]="CaptionDoesNotContain",e[e.CaptionIsGreaterThan=12]="CaptionIsGreaterThan",e[e.CaptionIsGreaterThanOrEqualTo=13]="CaptionIsGreaterThanOrEqualTo",e[e.CaptionIsLessThan=14]="CaptionIsLessThan",e[e.CaptionIsLessThanOrEqualTo=15]="CaptionIsLessThanOrEqualTo",e[e.CaptionIsBetween=16]="CaptionIsBetween",e[e.CaptionIsNotBetween=17]="CaptionIsNotBetween",e[e.ValueFirst=18]="ValueFirst",e[e.ValueEqual=18]="ValueEqual",e[e.ValueNotEqual=19]="ValueNotEqual",e[e.ValueGreaterThan=20]="ValueGreaterThan",e[e.ValueGreaterThanOrEqual=21]="ValueGreaterThanOrEqual",e[e.ValueLessThan=22]="ValueLessThan",e[e.ValueLessThanOrEqual=23]="ValueLessThanOrEqual",e[e.ValueBetween=24]="ValueBetween",e[e.ValueNotBetween=25]="ValueNotBetween",e[e.DateFirst=26]="DateFirst",e[e.DateEquals=26]="DateEquals",e[e.DateOlderThan=27]="DateOlderThan",e[e.DateNewerThan=28]="DateNewerThan",e[e.DateBetween=29]="DateBetween",e[e.DateTomorrow=30]="DateTomorrow",e[e.DateToday=31]="DateToday",e[e.DateYesterday=32]="DateYesterday",e[e.DateNextWeek=33]="DateNextWeek",e[e.DateThisWeek=34]="DateThisWeek",e[e.DateLastWeek=35]="DateLastWeek",e[e.DateNextMonth=36]="DateNextMonth",e[e.DateThisMonth=37]="DateThisMonth",e[e.DateLastMonth=38]="DateLastMonth",e[e.DateNextQuarter=39]="DateNextQuarter",e[e.DateThisQuarter=40]="DateThisQuarter",e[e.DateLastQuarter=41]="DateLastQuarter",e[e.DateNextYear=42]="DateNextYear",e[e.DateThisYear=43]="DateThisYear",e[e.DateLastYear=44]="DateLastYear",e[e.DateYearToDate=45]="DateYearToDate",e[e.DateAllDatesInPeriodQuarter1=46]="DateAllDatesInPeriodQuarter1",e[e.DateAllDatesInPeriodQuarter2=47]="DateAllDatesInPeriodQuarter2",e[e.DateAllDatesInPeriodQuarter3=48]="DateAllDatesInPeriodQuarter3",e[e.DateAllDatesInPeriodQuarter4=49]="DateAllDatesInPeriodQuarter4",e[e.DateAllDatesInPeriodJanuary=50]="DateAllDatesInPeriodJanuary",e[e.DateAllDatesInPeriodFebruary=51]="DateAllDatesInPeriodFebruary",e[e.DateAllDatesInPeriodMarch=52]="DateAllDatesInPeriodMarch",e[e.DateAllDatesInPeriodApril=53]="DateAllDatesInPeriodApril",e[e.DateAllDatesInPeriodMay=54]="DateAllDatesInPeriodMay",e[e.DateAllDatesInPeriodJune=55]="DateAllDatesInPeriodJune",e[e.DateAllDatesInPeriodJuly=56]="DateAllDatesInPeriodJuly",e[e.DateAllDatesInPeriodAugust=57]="DateAllDatesInPeriodAugust",e[e.DateAllDatesInPeriodSeptember=58]="DateAllDatesInPeriodSeptember",e[e.DateAllDatesInPeriodOctober=59]="DateAllDatesInPeriodOctober",e[e.DateAllDatesInPeriodNovember=60]="DateAllDatesInPeriodNovember",e[e.DateAllDatesInPeriodDecember=61]="DateAllDatesInPeriodDecember",e[e.DateNotEqual=62]="DateNotEqual",e[e.DateOlderOrEqual=63]="DateOlderOrEqual",e[e.DateNewerOrEqual=64]="DateNewerOrEqual",e[e.DateNotBetween=65]="DateNotBetween",e[e.Last=65]="Last"}(d||(d={})),function(e){e[e.None=0]="None",e[e.SortAscending=1]="SortAscending",e[e.SortDescending=2]="SortDescending",e[e.SortAscendingByValue=3]="SortAscendingByValue",e[e.SortDescendingByValue=4]="SortDescendingByValue"}(c||(c={})),function(e){e[e.None=0]="None",e[e.Explicit=1]="Explicit",e[e.Implicit=2]="Implicit"}(u||(u={})),function(e){e[e.Unknown=0]="Unknown",e[e.UsedRange=1]="UsedRange",e[e.PivotTable=2]="PivotTable",e[e.Hyperlink=3]="Hyperlink",e[e.Autofilter=4]="Autofilter",e[e.DataValidation=5]="DataValidation",e[e.Sparkline=6]="Sparkline",e[e.FloatingObjectAnchor=7]="FloatingObjectAnchor",e[e.DynamicArray=8]="DynamicArray",e[e.AutoDetect=9]="AutoDetect"}(g||(g={})),function(e){e[e.Default=0]="Default",e[e.NamedSheetView=1]="NamedSheetView",e[e.PresentMode=2]="PresentMode"}(h||(h={})),function(e){e[e.Vertical=0]="Vertical",e[e.Horizontal=1]="Horizontal",e[e.ReversedVertical=2]="ReversedVertical",e[e.ReversedHorizontal=3]="ReversedHorizontal",e[e.DiagonalUp=4]="DiagonalUp",e[e.DiagonalDown=5]="DiagonalDown",e[e.ReversedDiagonalUp=6]="ReversedDiagonalUp",e[e.ReversedDiagonalDown=7]="ReversedDiagonalDown",e[e.TopLeftCorner=8]="TopLeftCorner",e[e.TopRightCorner=9]="TopRightCorner",e[e.BottomLeftCorner=10]="BottomLeftCorner",e[e.BottomRightCorner=11]="BottomRightCorner",e[e.Center=12]="Center"}(C||(C={})),function(e){e[e.Solid=0]="Solid",e[e.Gradient=1]="Gradient"}(f||(f={})),function(e){e[e.Context=0]="Context",e[e.LeftToRight=1]="LeftToRight",e[e.RightToLeft=2]="RightToLeft"}(m||(m={})),function(e){e[e.Automatic=0]="Automatic",e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right",e[e.Fill=4]="Fill",e[e.Justify=5]="Justify",e[e.CenterAcrossSelection=6]="CenterAcrossSelection",e[e.Distributed=7]="Distributed",e[e.JustifyDistributed=8]="JustifyDistributed"}(p||(p={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom",e[e.Justify=3]="Justify",e[e.Distributed=4]="Distributed"}(y||(y={})),function(e){e[e.DefaultBorder=0]="DefaultBorder",e[e.Default=-1]="Default",e[e.Hyperlink=-2]="Hyperlink",e[e.FormulaError=-3]="FormulaError"}(S||(S={})),function(e){e[e.None=0]="None",e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=3]="Boolean",e[e.Error=4]="Error"}(R||(R={})),function(e){e[e.Value=0]="Value",e[e.Formula=1]="Formula",e[e.ArrayFormula=2]="ArrayFormula"}(F||(F={})),function(e){e[e.None=0]="None",e[e.Filtered=1]="Filtered",e[e.SortedAsc=2]="SortedAsc",e[e.SortedDesc=3]="SortedDesc",e[e.SortedTop=4]="SortedTop",e[e.SortedBottom=5]="SortedBottom",e[e.BothAsc=6]="BothAsc",e[e.BothDesc=7]="BothDesc",e[e.BothTop=8]="BothTop",e[e.BothBottom=9]="BothBottom",e[e.Sorted=10]="Sorted",e[e.Both=11]="Both"}(T||(T={})),function(e){e[e.None=0]="None",e[e.CData=1]="CData"}(w||(w={})),function(e){e[e.NewVerticalAlignExp=0]="NewVerticalAlignExp",e[e.InCellControls=1]="InCellControls",e[e.FontServiceIntegration=2]="FontServiceIntegration",e[e.TextWidthClientPhase2=3]="TextWidthClientPhase2",e[e.CanvasHitTest=4]="CanvasHitTest",e[e.TextWidthClientNewProcessing=5]="TextWidthClientNewProcessing",e[e.FiltersUXModernization=6]="FiltersUXModernization",e[e.HeaderDragImprovements=8]="HeaderDragImprovements",e[e.DelayRenderToNextAnimationFrame=9]="DelayRenderToNextAnimationFrame",e[e.ResizeHeaderUXModernization=10]="ResizeHeaderUXModernization",e[e.RenderHeaderOutlinesInCanvas=11]="RenderHeaderOutlinesInCanvas",e[e.RenderHeaderSnappingInCanvas=12]="RenderHeaderSnappingInCanvas",e[e.DoubleBorderFormattingFix=13]="DoubleBorderFormattingFix",e[e.WrapTextCse=14]="WrapTextCse",e[e.RenderResizePill=16]="RenderResizePill",e[e.FormulaViewCellImagesFix=17]="FormulaViewCellImagesFix",e[e.ModernFontPicker=19]="ModernFontPicker",e[e.DoubleBorderMergeCellFix=20]="DoubleBorderMergeCellFix",e[e.DoubleBorderBlockEdgeFix=21]="DoubleBorderBlockEdgeFix",e[e.TextWidthClientPhase1=22]="TextWidthClientPhase1",e[e.TableSelectorsHitTest=23]="TableSelectorsHitTest",e[e.CanvasHeaders=24]="CanvasHeaders",e[e.TextOrientationSlice1=25]="TextOrientationSlice1",e[e.ByExamplePreviewMode=26]="ByExamplePreviewMode",e[e.ShowDynamicImageCardOnHover=27]="ShowDynamicImageCardOnHover",e[e.TextOrientationSlice2=28]="TextOrientationSlice2",e[e.TableBordersInHighContrast=29]="TableBordersInHighContrast",e[e.UseOffscreenCanvas=30]="UseOffscreenCanvas",e[e.RenderPatternStyle=33]="RenderPatternStyle",e[e.GlobalStylesSlice1=34]="GlobalStylesSlice1",e[e.NewDefaultTemplate=35]="NewDefaultTemplate",e[e.GlobalStylesSlice2=37]="GlobalStylesSlice2",e[e.FluentStyle=38]="FluentStyle",e[e.GlobalStylesSlice3=39]="GlobalStylesSlice3",e[e.HideColumnSlice1=40]="HideColumnSlice1",e[e.HideColumnMergedCellSlice1=41]="HideColumnMergedCellSlice1",e[e.HideColumnAutoFilterSlice1=42]="HideColumnAutoFilterSlice1",e[e.HideColumnFormulaSlice1=43]="HideColumnFormulaSlice1",e[e.MoveSpillCellBeforeRendering=44]="MoveSpillCellBeforeRendering",e[e.NewThemeFontForHeaderFBarNBox=45]="NewThemeFontForHeaderFBarNBox"}(I||(I={})),function(e){e[e.None=0]="None",e[e.Flyout=1]="Flyout",e[e.Toggle=2]="Toggle",e[e.Button=3]="Button"}(b||(b={})),function(e){e[e.None=0]="None",e[e.Thin=1]="Thin",e[e.Medium=2]="Medium",e[e.Dashed=3]="Dashed",e[e.Dotted=4]="Dotted",e[e.Thick=5]="Thick",e[e.Double=6]="Double",e[e.Hair=7]="Hair",e[e.MediumDashed=8]="MediumDashed",e[e.DashDot=9]="DashDot",e[e.MediumDashDot=10]="MediumDashDot",e[e.DashDotDot=11]="DashDotDot",e[e.MediumDashDotDot=12]="MediumDashDotDot",e[e.SlantDashDot=13]="SlantDashDot"}(v||(v={})),function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Diagonal=4]="Diagonal",e[e.Vertical=5]="Vertical",e[e.Horizontal=6]="Horizontal",e[e.BorderMax=7]="BorderMax"}(x||(x={})),function(e){e[e.None=0]="None",e[e.Single=1]="Single",e[e.Double=2]="Double",e[e.SingleAccounting=3]="SingleAccounting",e[e.DoubleAccounting=4]="DoubleAccounting"}(D||(D={})),function(e){e[e.None=0]="None",e[e.Subscript=1]="Subscript",e[e.Superscript=2]="Superscript"}(A||(A={})),function(e){e[e.None=0]="None",e[e.Major=1]="Major",e[e.Minor=2]="Minor"}(P||(P={})),function(e){e[e.None=0]="None",e[e.Expanded=1]="Expanded",e[e.Collapsed=2]="Collapsed"}(M||(M={})),function(e){e[e.None=0]="None",e[e.CustomSort=1]="CustomSort",e[e.Filter=2]="Filter",e[e.SheetViewDefault=3]="SheetViewDefault",e[e.SheetViewTemp=4]="SheetViewTemp",e[e.SheetViewSwitch=5]="SheetViewSwitch",e[e.SheetViewMoreViews=6]="SheetViewMoreViews",e[e.SheetViewCreate=7]="SheetViewCreate",e[e.SheetViewOptions=8]="SheetViewOptions",e[e.GenericScript=9]="GenericScript",e[e.ClearFilter=10]="ClearFilter",e[e.ShowRichFieldsList=11]="ShowRichFieldsList",e[e.ShowPivotFilter=12]="ShowPivotFilter",e[e.SortByValue=13]="SortByValue",e[e.SortAscending=14]="SortAscending",e[e.SortDescending=15]="SortDescending",e[e.FieldListToReportFilter=16]="FieldListToReportFilter",e[e.FieldListToRowLabels=17]="FieldListToRowLabels",e[e.FieldListToColumnLabels=18]="FieldListToColumnLabels",e[e.FieldListToValues=19]="FieldListToValues",e[e.FieldListAddAsSlicer=20]="FieldListAddAsSlicer",e[e.RemoveFilter=21]="RemoveFilter",e[e.FilterType=22]="FilterType",e[e.FilterPivot=23]="FilterPivot",e[e.FilterSubMenu=24]="FilterSubMenu",e[e.FieldSubMenu=25]="FieldSubMenu",e[e.SheetViewSubMenu=26]="SheetViewSubMenu",e[e.GenericSortAscending=27]="GenericSortAscending",e[e.GenericSortDescending=28]="GenericSortDescending",e[e.RemovePivotFilter=29]="RemovePivotFilter",e[e.SortAtoZ=30]="SortAtoZ",e[e.SortZtoA=31]="SortZtoA",e[e.SortSmallestToLargest=32]="SortSmallestToLargest",e[e.SortLargestToSmallest=33]="SortLargestToSmallest",e[e.SortOldestToNewest=34]="SortOldestToNewest",e[e.SortNewestToOldest=35]="SortNewestToOldest",e[e.SortByColor=36]="SortByColor",e[e.FilterByColor=37]="FilterByColor",e[e.AnalyzeData=38]="AnalyzeData",e[e.Skeleton=39]="Skeleton"}(B||(B={})),function(e){e[e.None=0]="None",e[e.AmbiguousLinkedEntity=1]="AmbiguousLinkedEntity",e[e.ConnectedLinkedEntityBlocked=2]="ConnectedLinkedEntityBlocked",e[e.ConnectedLinkedEntityNotBlocked=3]="ConnectedLinkedEntityNotBlocked",e[e.DisconnectedLinkedEntity=4]="DisconnectedLinkedEntity",e[e.RichError=5]="RichError",e[e.ImageUrl=6]="ImageUrl",e[e.OtherRichValue=7]="OtherRichValue"}(H||(H={})),function(e){e[e.Disambiguation=0]="Disambiguation",e[e.Sync=1]="Sync",e[e.LinkedEntity=2]="LinkedEntity"}(O||(O={})),function(e){e[e.ThreeArrowsColored=0]="ThreeArrowsColored",e[e.ThreeArrowsGray=1]="ThreeArrowsGray",e[e.ThreeFlags=2]="ThreeFlags",e[e.ThreeTrafficLightsUnrimmed=3]="ThreeTrafficLightsUnrimmed",e[e.ThreeTrafficLightsRimmed=4]="ThreeTrafficLightsRimmed",e[e.ThreeSigns=5]="ThreeSigns",e[e.ThreeSymbolsCircled=6]="ThreeSymbolsCircled",e[e.ThreeSymbolsUncircled=7]="ThreeSymbolsUncircled",e[e.FourArrowsColored=8]="FourArrowsColored",e[e.FourArrowsGray=9]="FourArrowsGray",e[e.RedToBlack=10]="RedToBlack",e[e.FourRatings=11]="FourRatings",e[e.FourTrafficLights=12]="FourTrafficLights",e[e.FiveArrowsColored=13]="FiveArrowsColored",e[e.FiveArrowsGray=14]="FiveArrowsGray",e[e.FiveRatings=15]="FiveRatings",e[e.FiveQuarters=16]="FiveQuarters",e[e.ThreeStarts=17]="ThreeStarts",e[e.ThreeTriangles=18]="ThreeTriangles",e[e.FiveBoxes=19]="FiveBoxes"}(k||(k={})),function(e){e[e.Line=0]="Line",e[e.Column=1]="Column",e[e.Stacked=2]="Stacked"}(L||(L={})),function(e){e[e.None=0]="None",e[e.ModelCellChanges=2]="ModelCellChanges",e[e.ModelCoreChanges=4]="ModelCoreChanges",e[e.ScaleFactorChange=8]="ScaleFactorChange",e[e.ViewportChange=16]="ViewportChange",e[e.ExternalChanges=32]="ExternalChanges",e[e.NoCanvasCache=64]="NoCanvasCache",e[e.ModelCellPreviewChanges=128]="ModelCellPreviewChanges"}(N||(N={})),function(e){e[e.None=0]="None",e[e.Autofit=1]="Autofit",e[e.Spill=2]="Spill"}(E||(E={})),function(e){e[e.Default=-1]="Default",e[e.PartialRowColSelection=0]="PartialRowColSelection",e[e.WholeRowColSelection=1]="WholeRowColSelection",e[e.Hover=2]="Hover",e[e.PartialSelectionAndHover=3]="PartialSelectionAndHover",e[e.WholeSelectionAndHover=4]="WholeSelectionAndHover",e[e.NoHeadings=5]="NoHeadings",e[e.PartialRowColSelectionLeftAlignment=6]="PartialRowColSelectionLeftAlignment",e[e.PartialRowColSelectionRightAlignment=7]="PartialRowColSelectionRightAlignment",e[e.WholeRowColSelectionLeftAlignment=8]="WholeRowColSelectionLeftAlignment",e[e.WholeRowColSelectionRightAlignment=9]="WholeRowColSelectionRightAlignment",e[e.HoverLeftAlignment=10]="HoverLeftAlignment",e[e.HoverRightAlignment=11]="HoverRightAlignment",e[e.PartialSelectionAndHoverLeftAlignment=12]="PartialSelectionAndHoverLeftAlignment",e[e.PartialSelectionAndHoverRightAlignment=13]="PartialSelectionAndHoverRightAlignment",e[e.WholeSelectionAndHoverLeftAlignment=14]="WholeSelectionAndHoverLeftAlignment",e[e.WholeSelectionAndHoverRightAlignment=15]="WholeSelectionAndHoverRightAlignment",e[e.LeftAlignment=16]="LeftAlignment",e[e.RightAlignment=17]="RightAlignment"}(z||(z={})),function(e){e[e.Default=-1]="Default",e[e.Hover=0]="Hover",e[e.PartialSelection=1]="PartialSelection",e[e.PartialSelectionAndHover=2]="PartialSelectionAndHover",e[e.WholeSelection=3]="WholeSelection",e[e.WholeSelectionAndHover=4]="WholeSelectionAndHover"}(W||(W={})),function(e){e[e.None=0]="None",e[e.Solid=1]="Solid",e[e.Gray50=2]="Gray50",e[e.Gray75=3]="Gray75",e[e.Gray25=4]="Gray25",e[e.HorzStripe=5]="HorzStripe",e[e.VertStripe=6]="VertStripe",e[e.ReverseDiagStripe=7]="ReverseDiagStripe",e[e.DiagStripe=8]="DiagStripe",e[e.DiagCross=9]="DiagCross",e[e.ThickDiagCross=10]="ThickDiagCross",e[e.ThinHorzStripe=11]="ThinHorzStripe",e[e.ThinVertStripe=12]="ThinVertStripe",e[e.ThinReverseDiagStripe=13]="ThinReverseDiagStripe",e[e.ThinDiagStripe=14]="ThinDiagStripe",e[e.ThinHorzCross=15]="ThinHorzCross",e[e.ThinDiagCross=16]="ThinDiagCross",e[e.Gray125=17]="Gray125",e[e.Gray0625=18]="Gray0625"}(G||(G={})),function(e){e[e.GridBlockModel=0]="GridBlockModel",e[e.HeaderBlockModel=1]="HeaderBlockModel"}(V||(V={})),function(e){e[e.None=0]="None",e[e.Delay=1]="Delay",e[e.DoNotDelay=2]="DoNotDelay"}(j||(j={})),function(e){e[e.Start=-1]="Start",e[e.End=1]="End"}(_||(_={}));const U=["pointerdown","pointerup","click","mouseenter","mouseleave","touchstart","touchend","dblclick"];var q;!function(e){e[e.DebugWatermark=0]="DebugWatermark",e[e.Headers=1]="Headers",e[e.DataCleansing=2]="DataCleansing",e[e.HeaderResize=3]="HeaderResize",e[e.UnhideSkittle=4]="UnhideSkittle",e[e.HeaderDragDropSquares=5]="HeaderDragDropSquares",e[e.HeaderInsert=6]="HeaderInsert",e[e.GeneralCellTooltip=7]="GeneralCellTooltip",e[e.DynamicImage=8]="DynamicImage",e[e.Comments=9]="Comments",e[e.RichError=10]="RichError",e[e.DrillIndicator=11]="DrillIndicator",e[e.Hyperlink=12]="Hyperlink",e[e.ColumnOrRowSelector=13]="ColumnOrRowSelector",e[e.TableSelector=14]="TableSelector",e[e.RichValueIcon=15]="RichValueIcon",e[e.AutoFilter=16]="AutoFilter",e[e.CheckboxIcon=17]="CheckboxIcon"}(q||(q={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNullOrUndefined=void 0,t.isNullOrUndefined=function(e){return null==e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDisableProcessGlobalStylesTelemetryEnabled=t.isOptimizeGsProcessingEnabled=t.testMethod=t.isGlobalStylesRenderFlagsEnabled=t.verifyArgumentNotNull=t.overrideRenderFlagForMismatch=t.isRenderFlagEnabled=void 0;const o=n(34),r=n(81),i=n(25),l=n(24);let a=void 0,s=void 0;function d(e,t){if(!(0,i.isNullOrUndefined)(t.RenderFlagsArray)){const n=Math.floor(e/r.MaxBitsPerRenderFlag);if(n<t.RenderFlagsArray.length){const o=e%r.MaxBitsPerRenderFlag;return 0!=(t.RenderFlagsArray[n]&1<<o)}}return!1}t.isRenderFlagEnabled=d,t.overrideRenderFlagForMismatch=function(e,t,n){if(!(0,i.isNullOrUndefined)(e.RenderFlagsArray)){const o=Math.floor(t/r.MaxBitsPerRenderFlag);if(o<e.RenderFlagsArray.length){const i=1<<t%r.MaxBitsPerRenderFlag;n!==!!(e.RenderFlagsArray[o]&i)&&(e.RenderFlagsArray[o]^=i)}}},t.verifyArgumentNotNull=function(e,t,n){if(null==e)throw Error(`${n}.verifyArgumentNotNull: ${t} cannot be null or undefined`)};let c=void 0;function u(){c=void 0}t.isGlobalStylesRenderFlagsEnabled=function(e){return void 0===c&&(c=d(l.RenderFlagsArray.GlobalStylesSlice2,e)&&d(l.RenderFlagsArray.GlobalStylesSlice3,e)),!!c},t.testMethod=function(){return{resetGlobalStylesRenderFlags:u}},t.isOptimizeGsProcessingEnabled=function(){return void 0===a&&(a=(0,o.isChangeGateEnabled)(o.ChangeGate.OptimizeGsProcessing)),a},t.isDisableProcessGlobalStylesTelemetryEnabled=function(){return void 0===s&&(s=(0,o.isChangeGateEnabled)(o.ChangeGate.DisableProcessGlobalStylesTelemetry)),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawRoundRectangle=t.drawRectangle=void 0;const o=n(1),r=n(18);t.drawRectangle=function(e,t){(0,o.verifyArgumentNotNull)(e,"ctx","drawRectangle"),(0,o.verifyArgumentNotNull)(t,"drawingContext","drawRectangle");const{innerColor:n,outerColor:i,left:l,bottom:a,height:s,width:d}=t,c=l+r.ShapeLinesAdjustment,u=a-s-r.ShapeLinesAdjustment;i&&function(e,t,n,o,r,i){e.strokeStyle=i,e.beginPath(),e.rect(t,n,o,r),e.stroke()}(e,c,u,d,s,i),n&&function(e,t,n,o,r,i){e.fillStyle=i,e.beginPath(),e.fillRect(t,n,o,r),e.fill()}(e,l+r.ShapeOutlineWidthPx,a-s,d-r.ShapeOutlineWidthPx,s-r.ShapeOutlineWidthPx,n)},t.drawRoundRectangle=function(e,t){(0,o.verifyArgumentNotNull)(e,"ctx","drawRoundRectangle"),(0,o.verifyArgumentNotNull)(t,"drawingContext","drawRoundRectangle");const{innerColor:n,outerColor:i,left:l,bottom:a,height:s,width:d,radius:c}=t;if(0===c.length||c.length>4)throw new Error("Invalid radius array length: "+c.length);let u=[];switch(c.length){case 1:u=[c[0],c[0],c[0],c[0]];break;case 2:u=[c[0],c[1],c[0],c[1]];break;case 3:u=[c[0],c[1],c[2],c[1]];break;case 4:u=c}const g=l+r.ShapeLinesAdjustment,h=a-s-r.ShapeLinesAdjustment,C=g+d,f=h+s;e.beginPath(),e.roundRect?e.roundRect(g,h,d,s,u):(e.moveTo(g+u[0],h),e.lineTo(C-u[1],h),e.quadraticCurveTo(C,h,C,h+u[1]),e.lineTo(C,f-u[2]),e.quadraticCurveTo(C,f,C-u[2],f),e.lineTo(g+u[3],f),e.quadraticCurveTo(g,f,g,f-u[3]),e.lineTo(g,h+u[0]),e.quadraticCurveTo(g,h,g+u[0],h)),e.closePath(),n&&(e.fillStyle=n,e.fill()),i&&(e.strokeStyle=i,e.stroke())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SymbolHighOuterColor=t.SymbolMediumInnerColor=t.SymbolMediumOuterColor=t.SymbolLowInnerColor=t.SymbolLowOuterColor=t.SignLowInnerColor=t.SignLowOuterColor=t.SignMediumInnerColor=t.SignMediumOuterColor=t.StarEmptyInnerColor=t.StarEmptyOuterColor=t.StarFilledInnerColor=t.StarFilledOuterColor=t.TriangleHighInnerColor=t.TriangleHighOuterColor=t.TriangleMediumInnerColor=t.TriangleMediumOuterColor=t.TriangleLowInnerColor=t.TriangleLowOuterColor=t.FlagHighInnerColor=t.FlagHighOuterColor=t.FlagMediumInnerColor=t.FlagMediumOuterColor=t.FlagLowInnerColor=t.FlagLowOuterColor=t.FlagPoleColor=t.QuadrantBoxesOutlineColor=t.QuadrantBoxesFilledColor=t.QuadrantBoxesEmptyColor=t.SignalBarOutlineColor=t.SignalBarFilledColor=t.SignalBarEmptyColor=t.TrafficHighRimmedRectColor=t.FourCircleHighOuterColor=t.FourCircleHighInnerColor=t.FourCircleLowOuterColor=t.FourCircleMedium1OuterColor=t.FourCircleMedium1InnerColor=t.FourCircleMedium2OuterColor=t.FourCircleMedium2InnerColor=t.CircleEmptyOuterColor=t.CircleEmptyInnerColor=t.CircleFilledOuterColor=t.CircleFilledInnerColor=t.CircleHighOuterColor=t.CircleHighInnerColor=t.CircleMediumOuterColor=t.CircleMediumInnerColor=t.CircleLowOuterColor=t.CircleLowInnerColor=void 0,t.CircleSymbolInnerShapeInnerColor=t.ArrowRightOuterColor=t.ArrowDownOuterColor=t.ArrowUpOuterColor=t.ArrowRightInnerColor=t.ArrowDownInnerColor=t.ArrowUpInnerColor=t.ArrowGrayInnerColor=t.ArrowGrayOuterColor=t.SymbolHighInnerColor=void 0,t.CircleLowInnerColor="#FF9198",t.CircleLowOuterColor="#D42314",t.CircleMediumInnerColor="#F8DB8F",t.CircleMediumOuterColor="#DE6C00",t.CircleHighInnerColor="#A1DDAA",t.CircleHighOuterColor="#309048",t.CircleFilledInnerColor="#797774",t.CircleFilledOuterColor="#3A3A38",t.CircleEmptyInnerColor="#FAFAFA",t.CircleEmptyOuterColor="#3A3A38",t.FourCircleMedium2InnerColor="#D492D8",t.FourCircleMedium2OuterColor="#922E9B",t.FourCircleMedium1InnerColor="#C8C6C4",t.FourCircleMedium1OuterColor="#3A3A38",t.FourCircleLowOuterColor="#3A3A38",t.FourCircleHighInnerColor="#FF9198",t.FourCircleHighOuterColor="#D42314",t.TrafficHighRimmedRectColor="#3A3A38",t.SignalBarEmptyColor="#FAFAFA",t.SignalBarFilledColor="#83BEEC",t.SignalBarOutlineColor="#3A3A38",t.QuadrantBoxesEmptyColor="#FAFAFA",t.QuadrantBoxesFilledColor="#83BEEC",t.QuadrantBoxesOutlineColor="#3A3A38",t.FlagPoleColor="#3A3A38",t.FlagLowOuterColor="#D42314",t.FlagLowInnerColor="#FF9198",t.FlagMediumOuterColor="#DE6C00",t.FlagMediumInnerColor="#F8DB8F",t.FlagHighOuterColor="#309048",t.FlagHighInnerColor="#A1DDAA",t.TriangleLowOuterColor="#D42314",t.TriangleLowInnerColor="#FF9198",t.TriangleMediumOuterColor="#DE6C00",t.TriangleMediumInnerColor="#F8DB8F",t.TriangleHighOuterColor="#309048",t.TriangleHighInnerColor="#A1DDAA",t.StarFilledOuterColor="#DE6C00",t.StarFilledInnerColor="#F8DB8F",t.StarEmptyOuterColor="#3A3A38",t.StarEmptyInnerColor="#FAFAFA",t.SignMediumOuterColor="#DE6C00",t.SignMediumInnerColor="#F8DB8F",t.SignLowOuterColor="#D42314",t.SignLowInnerColor="#FF9198",t.SymbolLowOuterColor="#D42314",t.SymbolLowInnerColor="#FF9198",t.SymbolMediumOuterColor="#DE6C00",t.SymbolMediumInnerColor="#F8DB8F",t.SymbolHighOuterColor="#309048",t.SymbolHighInnerColor="#A1DDAA",t.ArrowGrayOuterColor="#797774",t.ArrowGrayInnerColor="#C8C6C4",t.ArrowUpInnerColor="#A1DDAA",t.ArrowDownInnerColor="#FF9198",t.ArrowRightInnerColor="#F8DB8F",t.ArrowUpOuterColor="#309048",t.ArrowDownOuterColor="#D42314",t.ArrowRightOuterColor="#DE6C00",t.CircleSymbolInnerShapeInnerColor="#FAFAFA"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GridCanvasClassName=t.CanvasTagName=t.PeriodToEvalInMs=t.CanvasHeight=t.CanvasWidth=t.ResultMessageCollectorDisabled=t.ResultMessageInsufficientData=void 0,t.ResultMessageInsufficientData="Insufficient Data",t.ResultMessageCollectorDisabled="Collector Disabled",t.CanvasWidth=1,t.CanvasHeight=1,t.PeriodToEvalInMs=10,t.CanvasTagName="canvas",t.GridCanvasClassName="ewr-sheettable"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractPassiveTelemetryCollector=void 0;const o=n(138);t.AbstractPassiveTelemetryCollector=class{canCollectorExecute(){return!this.isDisabled&&!!this.data}getCollectorName(){return this.name}disable(){this.isDisabled=!0}register(e){this.data.push(e),(0,o.registerCollector)(this)}constructor(e){this.isDisabled=!1,this.name=e,this.data=[]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testHelper=t.getOrLoadStaticImage=t.getOrLoadVersionedImage=t.clearImageFromCache=t.setStaticImageUrl=t.initializeGridRendererImageLoader=t.ImageType=t.ImageLoadStatus=void 0;const o=n(1);var r,i;!function(e){e[e.Initialized=0]="Initialized",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.LoadFailed=3]="LoadFailed"}(r||(t.ImageLoadStatus=r={})),function(e){e[e.Sparkline=0]="Sparkline",e[e.InCellImage=1]="InCellImage"}(i||(t.ImageType=i={}));const l={onImageLoadSuccessCallback:void 0,onImageLoadFailureCallback:void 0},a={};function s(e,t,n,o){let i=h(e);if(i||(i={blockIdentifiers:[t],status:r.Initialized,version:n,url:o},C(e,i),o))switch(i.status){case r.Loaded:return i.image;case r.LoadFailed:return;case r.Loading:return void u(t,i);case r.Initialized:return u(t,i),void(i.url&&g(i));default:throw Error("getOrLoadImageByKey: unexpected image statue: "+i.status)}}function d(e){return"STATIC"+e}function c(e,t){return e+t}function u(e,t){-1===t.blockIdentifiers.indexOf(e)&&t.blockIdentifiers.push(e)}function g(e){if(!e.url)throw Error("image url is not set, unexpected call");const t=new Image;t.onload=function(){e.status=r.Loaded,(0,o.verifyArgumentNotNull)(l.onImageLoadSuccessCallback,"onImageLoadSuccessCallback","imageLoader::onload"),l.onImageLoadSuccessCallback(e.blockIdentifiers),e.blockIdentifiers=[]},t.onerror=function(){e.status=r.LoadFailed,(0,o.verifyArgumentNotNull)(l.onImageLoadFailureCallback,"onImageLoadFailureCallback","imageLoader::onerror"),l.onImageLoadFailureCallback(`image failed to load, URL: ${e.url}, registeredModelsCount: ${e.blockIdentifiers.length}, registeredModelsCount: ${e.blockIdentifiers}`),e.blockIdentifiers=[]},t.src=e.url,e.image=t,e.status=r.Loading}function h(e){return a[e]}function C(e,t){a[e]=t}function f(e){a[e]=void 0}t.initializeGridRendererImageLoader=function(e,t){l.onImageLoadSuccessCallback=e,l.onImageLoadFailureCallback=t},t.setStaticImageUrl=function(e,t){(0,o.verifyArgumentNotNull)(t,"url","setStaticImageUrl");const n=d(e),i=h(n);if(i){if(i.url)throw Error(`setStaticImageUrl: image url already defined. image: ${e}, old url: ${i.url}, new url: ${t}`);i.url=t,g(i)}else C(n,{blockIdentifiers:[],status:r.Initialized,url:t})},t.clearImageFromCache=function(e,t){const n=c(e,t);h(n)&&f(n)},t.getOrLoadVersionedImage=function(e,t,n,o,r){const i=c(e,o),l=h(i);return!l||l.version===t&&l.url===n||f(i),s(i,r,t,n)},t.getOrLoadStaticImage=function(e,t){return s(d(e),t,void 0,void 0)},t.testHelper={getImageCacheItem:e=>h(e),resetImageCache:()=>{for(const e in a)delete a[e]},getImageKey:(e,t)=>c(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAdjustedOffsetXforHorizontalAlignment=t.measureFormattedTextWidth=t.substringFormattedText=t.fillRichTextFormat=void 0;const o=n(1),r=n(0),i=n(8),l=n(4),a=n(9),s=n(67),d=n(40),c=n(2),u=n(5),g=n(13),h=n(3),C=n(15),f=n(35),m=n(6),p=n(88),y=n(66),S=n(71),R=n(14),F=n(12),T=n(70),w=n(39),I=n(17);function b(e,t){return e>=t.StartIndex&&e<t.EndIndex}function v(e,t,n){const o=[];for(let n=0;n<t.length;n++){const r=t[n];if(b(e,r))return n;r&&o.push({index:n,startIndex:r.StartIndex,endIndex:r.EndIndex})}const{text:r,formattedTextLength:i,isCarriageReturnExists:l}=n,a=(0,T.breakToGraphemes)(r);throw Error(`Failed to find text run index for textOffsetIndex: ${e}, runs.length: ${t.length}, runsIndices: ${JSON.stringify(o)}, formattedTextLength: ${i}, isCarriageReturnExists:${l}, isGraphemeExists: ${(null==r?void 0:r.length)!==a.length} `)}function x(e,t,n){const o=e.CachedFont;e.ShrunkSize=o.Size*t,e.FontCss=(0,i.getFontCssStringFromFont)(o,e.ShrunkSize,n),e.WidthPx=e.WidthPx*t}function D(e,t,n){const o=t.CachedFont;t.ShrunkSize=n;const r=(0,a.getFontLineHeight)(e,t.ShrunkSize,null==o?void 0:o.FontName),l=(0,a.measureTextHeightForVerticalText)(r,t.Text);t.FontCss=(0,i.getFontCssStringFromFont)(o,t.ShrunkSize,e),t.MaxGlyphHeightPx=r,t.HeightPx=l}function A(e,t){let n=0,r=t,i=!1,l=!1;for(let a=t;a<e.length;a++){const t=e[a];if(t.Underline===o.FontUnderline.None)break;t.Underline===o.FontUnderline.Single?i=!0:t.Underline===o.FontUnderline.Double&&(l=!0);const s=t.CachedFont;n=Math.max(n,t.ShrunkSize||s.Size),r=a}return{maxFontSize:n,sequenceEndRunIndex:r,hasMixedUnderlineTypes:i&&l}}function P(e,t,n,o,r,i){const l=o&&!(0,m.isNullOrUndefined)(i)?i:r;return(0,C.adjustXForHorizontalAlignment)(e,t,n,l)}function M(e,t,n,o,r){return o?n:r?t:e}function B(e,t,n,r,i,l){let s=l,d=0,c=!1;return c=t===o.FontVerticalAlignment.Subscript||t===o.FontVerticalAlignment.Superscript,c&&(d=(0,a.calculateSubSuperOffsetY)(e,t||o.FontVerticalAlignment.None,n,r,i,c),s=!0),{subSuperOffsetY:d,hasVerticalAlignedFont:s,isFontVerticalAlignment:c}}function H(e,t,n,r,i,l,a,s,c,u,g,h,C,f){let m=l,y=i;if(C)!function(e,t,n,r,i,l,a,s,c,u,g){var h,C;if(!n.JustifyDistributedLine)return;let f=t+(c?0:n.JustifyDistributedLine.Start.Offset);const m=f,p=!0===n.Strikethrough;if(O(e,i,l,n.JustifyDistributedLine.Start,t,r,c,n.MaxGlyphHeightPx,a,p,s,u,g),f=t+(c?0:n.JustifyDistributedLine.Start.Offset+n.JustifyDistributedLine.Start.Width),null!==(h=n.JustifyDistributedLine)&&void 0!==h&&h.Middle&&(O(e,i,l,n.JustifyDistributedLine.Middle,t,r,c,n.MaxGlyphHeightPx,a,p,s,u,g),f=t+(c?0:n.JustifyDistributedLine.Middle.Offset+n.JustifyDistributedLine.Middle.Width)),null!==(C=n.JustifyDistributedLine)&&void 0!==C&&C.End&&(O(e,i,l,n.JustifyDistributedLine.End,t,r,c,n.MaxGlyphHeightPx,a,p,s,u,g),f=t+(c?0:n.JustifyDistributedLine.End.Offset+n.JustifyDistributedLine.End.Width)),!c&&(n.Underline!==o.FontUnderline.None||n.Strikethrough)){const e={clipRect:u,textPositionX:m,textPositionY:r,textWidth:f-m,partOfMixedUnderlineSequence:n.HasMixedUnderline};(0,d.cacheTextDecorationLayout)(i,l,a,e,s,n.UnderlineWidth)}}(e,i,a,l,t,n,r,a.CachedFont,h,u,f);else{if(k(e,t,n,a.Text,i,l,h,a.MaxGlyphHeightPx,r,!0===a.Strikethrough,a.CachedFont,u),!h&&(a.Underline!==o.FontUnderline.None||a.Strikethrough)){const e={clipRect:u,textPositionX:i,textPositionY:l,textWidth:a.WidthPx,containSubscript:g===o.FontVerticalAlignment.Subscript,partOfMixedUnderlineSequence:a.HasMixedUnderline};(0,d.cacheTextDecorationLayout)(t,n,r,e,a.CachedFont,a.UnderlineWidth)}h?m=function(e,t,n,r,i){const l=i+1<r.length?(0,p.getTextRun)(!0,r,i+1).HeightPx:0;switch(e){case o.VerticalAlignment.Top:return t-l;case o.VerticalAlignment.Center:return t-(n.HeightPx+l)/2;case o.VerticalAlignment.Bottom:case o.VerticalAlignment.Justify:case o.VerticalAlignment.Distributed:return t-n.HeightPx}}(n.CachedStyle.VerticalAlignment,l,a,s,c):y+=a.WidthPx}return{offsetX:y,offsetY:m}}function O(e,t,n,o,r,i,l,a,s,d,c,u,g){let h=r,C=i;l?C-=o.Offset:h+=o.Offset,k(e,t,n,o.Text,h,C,l,a,s,d,c,u,g)}function k(e,t,n,o,r,i,l,a,s,d,c,u,g){l?(0,S.fillVerticalTextForRTF)(e,t,n,o,r,i,a,s,d,c,u,g):e.fillText(o,r,i)}function L(e,t){let n=0,o=t[0];for(let t=0;t<e.length;t++){const r=e[t].CachedFont;n=Math.max(n,r.Size),o.Size<n&&(o=r)}return o}t.fillRichTextFormat=function(e,t,n,r,i,h,S,T,b,v){if((0,l.verifyArgumentNotNull)(r,"cell","fillRichTextFormat"),(0,l.verifyArgumentNotNull)(n,"model","fillRichTextFormat"),(0,l.verifyArgumentNotNull)(i,"formattedText","fillRichTextFormat"),(0,l.verifyArgumentNotNull)(i.TextRuns[0].CachedFont,"formattedText.CachedFont","fillRichTextFormat"),0===i.Text.length)return;const O=i.TextRuns;(0,l.verifyArgumentNotNull)(O[0].CachedFont,"formattedText.CachedFont","fillRichTextFormat");const k=function(e,t){return!!t&&((0,R.isVerticalAlignmentJustifiedOrDistributedForVerticalText)(e)?!(t.breakType===f.BreakType.Justify&&t.isProcessingLastLine):(0,C.isHorizontalAlignmentJustifiedAndDistributed)(e))}(r,v),{totalTextRunHeight:N,totalTextRunWidth:E,largestFont:z,preparedRuns:W}=function(e,t,n,r,i,l,d,h,C){const f=(0,a.getBidiContext)(n),y=(0,R.shouldRenderVerticalText)(n),S=function(e,t,n,o,r){let i,l;const s=t.Fonts;if(n.WrapText){const s=(0,a.measureTextRunsWidth)(e,o,r,t,(0,a.getBidiContext)(n));l=s.totalSize,i=s.textRunsDrawingInformation}else l=(0,a.getTextWidth)(e,t,n),i=n.CachedDrawingLayout.TextRunDrawingInformation;if(!i||!o)throw"Unexpected: cachedCellRuns and runs are supposed to be defined";return{totalTextRunWidth:l,largestFont:L(i,s),preparedRuns:i}}(e,t,n,i,l);let T=0,b=S.totalTextRunWidth;const v=S.largestFont,P=S.preparedRuns;return!y&&f.HasRtl&&(0,g.trackDuration)(g.RenderPerformanceMetric.ReorderBidiTextRuns,()=>{(0,s.reorderTextRunsForBidiDrawing)(P,l,f,b)},!0),y&&(T=function(e,t){let n=0;for(let o=0;o<t.length;o++){const r=t[o],i=r.CachedFont,l=(0,a.getFontLineHeight)(e,null==i?void 0:i.Size,null==i?void 0:i.FontName),s=(0,a.measureTextHeightForVerticalText)(l,r.Text);r.MaxGlyphHeightPx=l,r.HeightPx=s,n+=s}return n}(t,P)),n.CachedStyle.ShrinkToFit&&(y?T=function(e,t,n,o){const r=(0,u.getCellHeight)(e,t,!1);return o<r?o:function(e,t,n,o){let r=0;for(let n=0;n<t.length;n++){const i=t[n],l=i.CachedFont;D(e,i,Math.floor(l.Size*o)),r+=i.HeightPx}for(;r<n;){r=0;for(let n=0;n<t.length;n++){const o=t[n];if(o.ShrunkSize<w.MaxAllowedFontSize){D(e,o,o.ShrunkSize+1)}r+=o.HeightPx}}for(;r>n;){r=0;for(let n=0;n<t.length;n++){const o=t[n];if(o.ShrunkSize>w.MinAllowedFontSize){D(e,o,o.ShrunkSize-1)}r+=o.HeightPx}}return r}(e,n,r,r/o)}(t,n,P,T):b=function(e,t,n,o,r){const i=(0,u.getCellWidth)(e,t,!1),l=t.CachedStyle.Indentation||0,s=(0,I.shouldAddAutoFilterPadding)(e,t)?(0,I.getAutoFilterButtonPadding)(e,t,n.zoom,n.devicePixelRatio):0,d=o[0].CachedFont,g=(0,a.getHorizontalPadding)(e,t,d.Size,t.CachedFont.Italic,l||0,!0,s),h=(0,c.getTextDrawingMaxWidth)(i,g,(0,a.getDistanceFromCellStartToIconEnd)(e,t,n.zoom,n.devicePixelRatio),(0,F.getExpandCollapseButtonPadding)(t),0);if(r<h)return r;const C=h/(r+g);let f=0;for(let t=0;t<o.length;t++){const n=o[t];x(n,C,e),f+=n.WidthPx}return f}(t,n,r,P,b)),function(e){let t=0;for(;t<e.length;)if(e[t].Underline===o.FontUnderline.None)t++;else{const{maxFontSize:n,sequenceEndRunIndex:o,hasMixedUnderlineTypes:r}=A(e,t),i=(0,a.getTextDecorationLineWidth)(n);for(;t<=o;t++)e[t].UnderlineWidth=i,e[t].HasMixedUnderline=r}}(P),!d||(0,m.isNullOrUndefined)(h)||(0,m.isNullOrUndefined)(C)||(0,p.prepareTextRunsForJustifyAndDistributed)(e,t,C,h,P,y),{totalTextRunHeight:T,totalTextRunWidth:b,largestFont:v,preparedRuns:P}}(e,n,r,t,O,i.Text,k,b,v),G=(0,o.getCellStyle)(n,r);(0,l.verifyArgumentNotNull)(G,"cellStyle","fillRichTextFormat"),function(e,t,n,r,i,s,g,h,C,f,S,F,T){var I;const b=e.textAlign,v=e.textBaseline,x=e.font,D=e.fillStyle,A=(0,R.shouldRenderVerticalText)(r);let O=h;A&&(O=function(e,t,n,r,i,l,a){var s;if(!l&&(null===(s=t.CachedStyle)||void 0===s?void 0:s.VerticalAlignment)===o.VerticalAlignment.Justify){const o=L(n,e.Fonts),i=(0,y.getCachedFontMetrics)(o.FontName,o.Size,e).baseline;return(0,u.getCellBottom)(e,t)-w.LineHeightBottomConstantPx-i-(a-r)}return i}(n,r,C,f,O,S,T)),O=function(e,t,n,r,i,s,d){return t?function(e,t,n,r){const i=e.CachedStyle.VerticalAlignment,l=r[r.length-1].HeightPx||0;switch(i){case o.VerticalAlignment.Top:return t+n-l;case o.VerticalAlignment.Justify:case o.VerticalAlignment.Distributed:case o.VerticalAlignment.Bottom:return t;case o.VerticalAlignment.Center:return t+(n-l)/2}}(n,r,i,s):function(e,t,n,r){const i=n.CachedStyle.VerticalAlignment,s=(0,a.getFontLineHeight)(e,t.Size,t.FontName),d=(0,y.getCachedFontMetrics)(t.FontName,t.Size,e).baseline;(0,l.verifyArgumentNotNull)(d,"textBaselineAdjustY","adjustYForVerticalAlignment");const c=r-d;return i===o.VerticalAlignment.Center?c+(s-d)/2:c}(e,d,n,r)}(n,A,r,O,f,C,s);let k=A?g:P(n,r,g,S,i,T),N=!1;e.textAlign="left",e.textBaseline="alphabetic",t.highContrastScheme&&(e.fillStyle=(0,c.getHighContrastTextColor)(r,t.highContrastScheme));for(let o=0;o<C.length;o++){const i=(0,p.getTextRun)(A,C,o);(0,l.verifyArgumentNotNull)(i.CachedFont,"run.CachedFont","drawTextRuns");const a=i.CachedFont,s=a.VerticalAlign;let d=0,c=!1;A||r.WrapText||({subSuperOffsetY:d,isFontVerticalAlignment:c,hasVerticalAlignedFont:N}=B(r,s,a,h,(0,y.getCachedFontMetrics)(a.FontName,a.Size,n),N)),e.font=i.FontCss,t.highContrastScheme||(e.fillStyle=i.CachedFont.Color),({offsetX:k,offsetY:O}=H(e,n,r,t,k,M(h,d,O,A,c),i,C,o,F,s,A,S,T))}N&&!(0,m.isNullOrUndefined)(null===(I=r.CachedDrawingLayout)||void 0===I?void 0:I.UnderlineRuns)&&(0,d.alignVerticalUnderlineRuns)(n,r,r.CachedDrawingLayout.UnderlineRuns),e.textAlign=b,e.textBaseline=v,e.font=x,e.fillStyle=D}(e,t,n,r,E,z,h,S,W,N,k,T,null==v?void 0:v.maxWidth)},t.substringFormattedText=function(e,t,n){if((0,l.verifyArgumentNotNull)(e.Text,"formattedText.Text","substringFormattedText"),0===e.Text.length)return h.EmptyFormattedText;const i=e.Text.substring(t,n);if(0===i.length)return{Text:i,Fonts:e.Fonts,TextRuns:[]};const a=e.TextRuns;if((0,l.verifyArgumentNotNull)(a,"formattedText.runs","substringFormattedText"),0===a.length)throw Error("Invalid param: formattedText runs.length === 0");(0,r.prepareTextRunRanges)(a,e.Text);const s=e.Text.length,d={isCarriageReturnExists:-1!==e.Text.indexOf("\r"),formattedTextLength:s,text:e.Text},c=v(t,a,d),u=n&&n<e.Text.length?v(n-1,a,d):a.length-1,g=[],C=(0,o.isGetStyleFixChangeGateEnabled)(),f=a[c];g.push({StartIndex:0,FontID:f.FontID||0,GlobalFontID:C?f.GlobalFontID||0:void 0,CachedFont:f.CachedFont});for(let e=c+1;e<=u;e++){const n=a[e],o=n.StartIndex-t;g.push({StartIndex:o,FontID:n.FontID||0,GlobalFontID:C?n.GlobalFontID||0:void 0,CachedFont:n.CachedFont})}return{Text:i,Fonts:e.Fonts,TextRuns:g}},t.measureFormattedTextWidth=function(e,t,n){return(0,a.measureTextRunsWidth)(e,t.TextRuns,t.Text,n).totalSize},t.getAdjustedOffsetXforHorizontalAlignment=P},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPassRibbonCommandsToCanvasRendererEnabled=t.initializeArraysTestOnly=t.initializeChangeGatesDataStructure=t.isChangeGateEnabled=t.ChangeGate=void 0;const o=n(11);var r;!function(e){e[e.WrapTextNullFontFix=0]="WrapTextNullFontFix",e[e.TreatZeroAndUndefinedAsEqual=1]="TreatZeroAndUndefinedAsEqual",e[e.AdjacentCellsMergeFix=2]="AdjacentCellsMergeFix",e[e.FixBoldFontsOnMac=3]="FixBoldFontsOnMac",e[e.PassRibbonCommandsToCanvasRenderer=4]="PassRibbonCommandsToCanvasRenderer",e[e.TableSelectionDragSelection=5]="TableSelectionDragSelection",e[e.FixUserContentList=6]="FixUserContentList",e[e.FixRotatedTextWidth=7]="FixRotatedTextWidth",e[e.ResetContentList=8]="ResetContentList",e[e.addTelemetryForStyleIdCrash=9]="addTelemetryForStyleIdCrash",e[e.protectIsCellPartiallySelected=10]="protectIsCellPartiallySelected",e[e.RichIconFilterScale=11]="RichIconFilterScale",e[e.FixCellImageAlignmentWithRichPivotDrill=12]="FixCellImageAlignmentWithRichPivotDrill",e[e.DontShowRichValueIconForSpilledArrayFormulasInFormulaView=13]="DontShowRichValueIconForSpilledArrayFormulasInFormulaView",e[e.UseClippedX=14]="UseClippedX",e[e.CellIconBottomPadding=15]="CellIconBottomPadding",e[e.FBEFormattedCellsPreviewStyle=16]="FBEFormattedCellsPreviewStyle",e[e.HeaderWithGlobalStyles=17]="HeaderWithGlobalStyles",e[e.HideColMergeCellTelemetry=18]="HideColMergeCellTelemetry",e[e.FixHeaderSnappingAutoFilterNone=19]="FixHeaderSnappingAutoFilterNone",e[e.FixBorderStylesEqual=20]="FixBorderStylesEqual",e[e.PreviewCellsSettings=21]="PreviewCellsSettings",e[e.FixBorderWithMergeCellComparison=22]="FixBorderWithMergeCellComparison",e[e.RotatedTextDecorationWithMergeCellBugFix=23]="RotatedTextDecorationWithMergeCellBugFix",e[e.HandlePointerLeaveEventFromHeaderCanvas=24]="HandlePointerLeaveEventFromHeaderCanvas",e[e.GlobalStyleTrace=25]="GlobalStyleTrace",e[e.CheckboxFallbackFont=26]="CheckboxFallbackFont",e[e.ModernHeaderResizeHitRegion=27]="ModernHeaderResizeHitRegion",e[e.ResizePillHighContrastFix=28]="ResizePillHighContrastFix",e[e.ResizePillAlignmentFix=29]="ResizePillAlignmentFix",e[e.EnablingRowColCSEForComplexCellsSlice2=30]="EnablingRowColCSEForComplexCellsSlice2",e[e.BlockEdgeBorderThicknessFix=31]="BlockEdgeBorderThicknessFix",e[e.HideCheckboxOnShowFormula=32]="HideCheckboxOnShowFormula",e[e.CellHoverStateProperty=33]="CellHoverStateProperty",e[e.UseClippedXCheckbox=34]="UseClippedXCheckbox",e[e.BorderRowColOps=35]="BorderRowColOps",e[e.BorderRowColOpsV2=36]="BorderRowColOpsV2",e[e.StyleIdCrashFix=37]="StyleIdCrashFix",e[e.FixCopyBlankCellToACellWithCheckbox=38]="FixCopyBlankCellToACellWithCheckbox",e[e.CanvasTextMeasure=39]="CanvasTextMeasure",e[e.BetterExceptionHandling=40]="BetterExceptionHandling",e[e.AutofitWidthGlobalStyle=41]="AutofitWidthGlobalStyle",e[e.HideCommentIndicators=42]="HideCommentIndicators",e[e.HideColMergedCellAcrossBlocks=43]="HideColMergedCellAcrossBlocks",e[e.EnableMergeCellSupportForFreezePanesCse=44]="EnableMergeCellSupportForFreezePanesCse",e[e.CheckboxInCellImageCheck=45]="CheckboxInCellImageCheck",e[e.ImprovedExceptionHandling=46]="ImprovedExceptionHandling",e[e.GridRenderPerfFix=47]="GridRenderPerfFix",e[e.FixStyleIdIssue=48]="FixStyleIdIssue",e[e.TakeAutoFilterBeforePivotFilter=49]="TakeAutoFilterBeforePivotFilter",e[e.MergeCellBorderScenarios=50]="MergeCellBorderScenarios",e[e.PLTRegressionInMFPFix=51]="PLTRegressionInMFPFix",e[e.BorderScenarioForCascade=52]="BorderScenarioForCascade",e[e.PreLoadAutoFilterSlicesOnMouseEnter=53]="PreLoadAutoFilterSlicesOnMouseEnter",e[e.EnableFreezePanesCSEForMergedEdgeCells=54]="EnableFreezePanesCSEForMergedEdgeCells",e[e.InsertDrawingsClarity=55]="InsertDrawingsClarity",e[e.RestrictStylesPreProcess=56]="RestrictStylesPreProcess",e[e.DoubleBorderFormattingFix=57]="DoubleBorderFormattingFix",e[e.CalcCellRichValueType=58]="CalcCellRichValueType",e[e.UseSetForKnownFonts=59]="UseSetForKnownFonts",e[e.DismissUnhideSkittleOnResize=60]="DismissUnhideSkittleOnResize",e[e.ChangeAutoFilterTagLevel=61]="ChangeAutoFilterTagLevel",e[e.OptimizeGsProcessing=62]="OptimizeGsProcessing",e[e.UseOldAPIForFontLoadCheck=63]="UseOldAPIForFontLoadCheck",e[e.CacheCannonizedFont=64]="CacheCannonizedFont",e[e.MungedBorderBugFixes=65]="MungedBorderBugFixes",e[e.HideDeleteCSEBlockEdgeBorderFix=66]="HideDeleteCSEBlockEdgeBorderFix",e[e.IncreaseFontLoadTimeout=67]="IncreaseFontLoadTimeout",e[e.UseNewKnownFontList=68]="UseNewKnownFontList",e[e.RemoveRefCountCheckForFontLoad=69]="RemoveRefCountCheckForFontLoad",e[e.DiffRenderingOptimization=70]="DiffRenderingOptimization",e[e.StopCursorChangeForCheckboxWhenComponentRangePicker=71]="StopCursorChangeForCheckboxWhenComponentRangePicker",e[e.GroupRowColBugFix=72]="GroupRowColBugFix",e[e.XLYellowFontLoadCheckNew=73]="XLYellowFontLoadCheckNew",e[e.DisableProcessGlobalStylesTelemetry=74]="DisableProcessGlobalStylesTelemetry",e[e.HiddenIndicatorZoomFixEnabled=75]="HiddenIndicatorZoomFixEnabled",e[e.GetStyleFix=76]="GetStyleFix",e[e.ModernFontRendering=77]="ModernFontRendering",e[e.AddFontFlickerTelemetry=78]="AddFontFlickerTelemetry",e[e.SkeletonWithoutGridLines=79]="SkeletonWithoutGridLines",e[e.PromotedRenderingTelemetry=80]="PromotedRenderingTelemetry",e[e.CacheIsResizeAllowedValue=81]="CacheIsResizeAllowedValue",e[e.LastChangeGateDontDelete=82]="LastChangeGateDontDelete"}(r||(t.ChangeGate=r={}));let i=r.LastChangeGateDontDelete,{changeGatesNamesArray:l,changeGatesBitMap:a,cachedChangeGatesBitMap:s}=h(i,32);l[r.WrapTextNullFontFix]="OfficeVSO:8547550_WrapTextNullFontFix",l[r.TreatZeroAndUndefinedAsEqual]="OfficeVSO:5010362_TreatZeroAndUndefinedAsEqual",l[r.AdjacentCellsMergeFix]="OfficeVSO:5230472_adjacentCellsMergeFix2",l[r.FixBoldFontsOnMac]="OfficeVSO:7477362_FixBoldFontsOnMacn",l[r.PassRibbonCommandsToCanvasRenderer]="OfficeVSO:9134712_PassRibbonCommandsToCanvasRenderer",l[r.TableSelectionDragSelection]="OfficeVSO:5501896_TableSelectionDragSelection",l[r.FixUserContentList]="OfficeVSO:6006812_FixUserContentList",l[r.FixRotatedTextWidth]="OfficeVSO:6582281_FixRotatedTextWidth",l[r.ResetContentList]="OfficeVSO:7259557_ResetContentList",l[r.addTelemetryForStyleIdCrash]="OfficeVSO:7426943_addTelemetryForStyleIdCrash2",l[r.protectIsCellPartiallySelected]="OfficeVSO:7733119_protectIsCellPartiallySelected",l[r.RichIconFilterScale]="OfficeVSO:7525144_RichIconFilterScale",l[r.FixCellImageAlignmentWithRichPivotDrill]="OfficeVSO:7910214_FixCellImageAlignmentWithRichPivotDrill",l[r.UseClippedX]="OfficeVSO:7868644_InCellControlCheckboxClippingInXLO",l[r.CellIconBottomPadding]="OfficeVSO:7944046_CellIconBottomPadding",l[r.FixHeaderSnappingAutoFilterNone]="OfficeVSO:8161977_fixHeaderSnappingAutoFilterNone",l[r.DontShowRichValueIconForSpilledArrayFormulasInFormulaView]="OfficeVSO:7971025_dontShowRichValueIconForSpilledArrayFormulasInFormulaView",l[r.HeaderWithGlobalStyles]="OfficeVSO:8126763_HeaderWithGlobalStyles",l[r.HideColMergeCellTelemetry]="OfficeVSO:8137545_HideColMergeCellTelemetry",l[r.FixBorderStylesEqual]="OfficeVSO:8353755_fixBorderStylesEqual",l[r.FixBorderWithMergeCellComparison]="OfficeVSO:8381160_FixBorderWithMergeCellComparison",l[r.PreviewCellsSettings]="OfficeVSO:8390976_PreviewCellsSettings",l[r.RotatedTextDecorationWithMergeCellBugFix]="OfficeVSO:8429004_RotatedTextDecorationWithMergeCellBugFix",l[r.HandlePointerLeaveEventFromHeaderCanvas]="OfficeVSO:8444516_HandlePointerLeaveEventFromHeaderCanvas",l[r.GlobalStyleTrace]="OfficeVSO:8546428_globalStyleTrace",l[r.CheckboxFallbackFont]="OfficeVSO:8573746_CheckboxFallbackFontEnabled",l[r.ModernHeaderResizeHitRegion]="OfficeVSO:8553924_ResizeNewHitRegion",l[r.ResizePillHighContrastFix]="OfficeVSO:8606316_ResizePillHighContrastFix",l[r.ResizePillAlignmentFix]="OfficeVSO:8596873_ResizePillAlignmentFix",l[r.EnablingRowColCSEForComplexCellsSlice2]="OfficeVSO:8633190_EnablingRowColCSEForComplexCellsSlice2",l[r.BlockEdgeBorderThicknessFix]="OfficeVSO:8612257_BlockEdgeBorderThicknessFix",l[r.HideCheckboxOnShowFormula]="OfficeVSO:8595087_HideCheckboxOnShowFormula",l[r.CellHoverStateProperty]="OfficeVSO:8640780_CellHoverStateProperty",l[r.BorderRowColOps]="OfficeVSO:8675285_borderRowColOps",l[r.BorderRowColOpsV2]="OfficeVSO:8675285_borderRowColOpsV2",l[r.UseClippedXCheckbox]="OfficeVSO:8654438_UseClippedXCheckbox",l[r.StyleIdCrashFix]="OfficeVSO:8683770_StyleIdCrashV2",l[r.CanvasTextMeasure]="OfficeVSO:8699044_canvasTextMeasure",l[r.FixCopyBlankCellToACellWithCheckbox]="OfficeVSO:8689743_FixCopyBlankCellToACellWithCheckbox",l[r.AutofitWidthGlobalStyle]="OfficeVSO:8708631_AutofitWidthGlobalStyles",l[r.BetterExceptionHandling]="OfficeVSO:8712993_BetterExceptionHandlingForGlobalStyle",l[r.HideCommentIndicators]="OfficeVSO:8608691_HideCommentIndicators",l[r.HideColMergedCellAcrossBlocks]=" OfficeVSO:8776386_HideColMergedCellAcrossBlocksEnabled",l[r.EnableMergeCellSupportForFreezePanesCse]="OfficeVSO:8778653_enableFreezePanesCseForSheetsWithMergeCells",l[r.CheckboxInCellImageCheck]="OfficeVSO:8766511_CheckboxInCellImageCheck",l[r.ImprovedExceptionHandling]="OfficeVSO:8793263_improvedExceptionHandlingGlobalStyles",l[r.GridRenderPerfFix]="OfficeVSO:8752178_GridRenderPerfFix",l[r.FixStyleIdIssue]="OfficeVSO:8805047_FixStyleIdIssue",l[r.TakeAutoFilterBeforePivotFilter]="OfficeVSO:8812177_TakeAutoFilterBeforePivotFilter",l[r.MergeCellBorderScenarios]="OfficeVSO:8834380_MergeCellBorderScenarios",l[r.BorderScenarioForCascade]="OfficeVSO:8852132_BorderScenarioForCascade",l[r.PLTRegressionInMFPFix]="OfficeVSO:8830767_PLTRegressionInMFPFixV2",l[r.PreLoadAutoFilterSlicesOnMouseEnter]="OfficeVSO:8963142_PreLoadAutoFilterSlicesOnMouseEnter",l[r.EnableFreezePanesCSEForMergedEdgeCells]="OfficeVSO:8864410_EnableFreezePanesCSEForMergedEdgeCells",l[r.InsertDrawingsClarity]="OfficeVSO:8864199_insertDrawingsClarity",l[r.RestrictStylesPreProcess]="OfficeVSO:8923280_MinimizeStylesProcessing",l[r.DoubleBorderFormattingFix]="OfficeVSO:8875644_DoubleBorderFormattingFix",l[r.CalcCellRichValueType]="OfficeVSO:8917378_CalcCellRichValueType",l[r.UseSetForKnownFonts]="OfficeVSO:8922969_useSetForKnownFonts",l[r.DismissUnhideSkittleOnResize]="OfficeVSO:8917567_dismissUnhideSkittleOnResize",l[r.ChangeAutoFilterTagLevel]="OfficeVSO:8938003_changeAutoFilterTagLevel",l[r.OptimizeGsProcessing]="OfficeVSO:9010334_OptimizeGsProcessings",l[r.MungedBorderBugFixes]="OfficeVSO:9010304_MungedBorderBugFixes",l[r.HideDeleteCSEBlockEdgeBorderFix]="OfficeVSO:9013637_HideDeleteCSEBlockEdgeBorderFix",l[r.UseOldAPIForFontLoadCheck]="OfficeVSO:8968745_UseOldAPIForFontLoadCheck",l[r.CacheCannonizedFont]="OfficeVSO:9005975_cacheCannonizeFontName",l[r.IncreaseFontLoadTimeout]="OfficeVSO:8989289_IncreaseFontLoadTimeout",l[r.UseNewKnownFontList]="OfficeVSO:9009674_UseNewKnownFontList",l[r.DiffRenderingOptimization]="OfficeVSO:9040294_DiffRenderingOptimization",l[r.RemoveRefCountCheckForFontLoad]="OfficeVSO:9019367_RemoveRefCountCheckForFontLoad",l[r.StopCursorChangeForCheckboxWhenComponentRangePicker]="OfficeVSO:8850652_stopCursorChangeForCheckboxWhenComponentRangePicker",l[r.GroupRowColBugFix]="OfficeVSO:9078919_RowColGroupBugFix",l[r.XLYellowFontLoadCheckNew]="OfficeVSO:9072398_XLYellowFontLoadCheckNew",l[r.DisableProcessGlobalStylesTelemetry]="OfficeVSO:9086219_DisableProcessGlobalStylesTelemetry",l[r.HiddenIndicatorZoomFixEnabled]="OfficeVSO:9019696_HiddenIndicatorZoomFixEnabled",l[r.ModernFontRendering]="OfficeVSO:9093964_ModernFontRenderingFlight",l[r.GetStyleFix]="OfficeVSO:9086842_FixGlobalStylesACEError",l[r.SkeletonWithoutGridLines]="OfficeVSO:9155388_SkeletonWithoutGridLines",l[r.AddFontFlickerTelemetry]="OfficeVSO:8927459_AddFontFlickerTelemetry",l[r.PromotedRenderingTelemetry]="OfficeVSO:9062697_PromotedRenderingTelemetry",l[r.CacheIsResizeAllowedValue]="OfficeVSO:9159241_cacheIsResizeAllowedValue";let d=void 0;function c(e){const t=Math.floor(e/32),n=1<<e%32;return function(e,t,n){u(s,t,n)||((0,o.isChangeGateEnabled)(l[e])&&g(a,t,n),g(s,t,n))}(e,t,n),u(a,t,n)}function u(e,t,n){return 0!=(e[t]&n)}function g(e,t,n){e[t]|=n}function h(e,t){const n=new Array(e),o=Math.ceil(e/t);return{changeGatesNamesArray:n,changeGatesBitMap:C(o),cachedChangeGatesBitMap:C(o)}}function C(e){return Array.apply(null,new Array(e)).map(()=>0)}t.isChangeGateEnabled=c,t.initializeChangeGatesDataStructure=h,t.initializeArraysTestOnly=function(e){i=e.length,l=e;const t=Math.ceil(i/32);a=new Array(t).fill(0),s=new Array(t).fill(0)},t.isPassRibbonCommandsToCanvasRendererEnabled=function(){return void 0===d&&(d=c(r.PassRibbonCommandsToCanvasRenderer)),d}},function(e,t,n){"use strict";var o,r;Object.defineProperty(t,"__esModule",{value:!0}),t.LineDirection=t.BreakType=void 0,function(e){e[e.Wrap=0]="Wrap",e[e.Justify=1]="Justify",e[e.Distributed=2]="Distributed"}(o||(t.BreakType=o={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(r||(t.LineDirection=r={}))},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pixelsPerPoint=t.DistanceBetweenCFIconAndExpandCollapseButton=t.DefaultFallbackFontName=t.IconTextMinimalPadding=t.DefaultTextBaseline=void 0,t.DefaultTextBaseline="alphabetic",t.IconTextMinimalPadding=1,t.DefaultFallbackFontName="calibri",t.DistanceBetweenCFIconAndExpandCollapseButton=2,t.pixelsPerPoint=1.33333333333333},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDimensionAdjustedForDrawing=t.getColumnHeaderGutterOffsetForDrawing=t.getColumnHeaderGutterSizeForDrawing=t.getCellAbsoluteIndex=t.isCellWhollySelected=t.isCellPartiallySelected=void 0;const o=n(1),r=n(7),i=n(3);function l(e,t){return t?a(i.ColumnHeaderGutterSize,e):0}function a(e,t){return Math.round(e*t)}t.isCellPartiallySelected=function(e){return e?o.PartiallySelectionHeadersStylesSet.has(e.StyleID||0):(r.ULS.sendTraceTag(509097937,r.LogCategory.msoulscat_ES_EWAJSGrid,r.TraceLevel.Error,"isCellPartiallySelected: cell is not defined"),!1)},t.isCellWhollySelected=function(e){return e?o.WholeSelectionHeadersStylesSet.has(e.StyleID||0):(r.ULS.sendTraceTag(508059907,r.LogCategory.msoulscat_ES_EWAJSGrid,r.TraceLevel.Error,"isCellWhollySelected: cell is not defined"),!1)},t.getCellAbsoluteIndex=function(e,t,n){return n?e.RowNumbers[t]:e.ColumnNumbers[t]},t.getColumnHeaderGutterSizeForDrawing=l,t.getColumnHeaderGutterOffsetForDrawing=function(e,t){return t?l(e,t)+1:0},t.getDimensionAdjustedForDrawing=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubscriptVerticalPaddingForUnderlinePx=t.KnownFontNamesLowerCaseSet=t.getKnownFontNamesLowerCase=t.KnownFontNamesLowerCase=t.LineHeightBottomConstantPx=t.LineHeightUsingDivFontFactor=t.LineLeading=t.LineHeightFontFactor=t.CannonizedAptosNarrow=t.DefaultCanvasFontString=t.DefaultFontName=t.DefaultFontSizePt=t.MaxAllowedFontSize=t.MinAllowedFontSize=void 0;const o=n(1);let r;t.MinAllowedFontSize=1,t.MaxAllowedFontSize=409,t.DefaultFontSizePt=11,t.DefaultFontName="Calibri",t.DefaultCanvasFontString=`${t.DefaultFontSizePt}pt ${t.DefaultFontName}`,t.CannonizedAptosNarrow="aptos narrow",t.LineHeightFontFactor=1.28,t.LineLeading=.06,t.LineHeightUsingDivFontFactor=1+t.LineLeading,t.LineHeightBottomConstantPx=1,t.KnownFontNamesLowerCase=["angsananew","aptosnarrow","aptosdisplay","arial","arialblack","batang","bookantiqua","browallianew","calibri","cambria","candara","century","comicsansms","consolas","constantia","corbel","cordianew","dilleniaupc","courier","couriernew","dotum","fangsong","garamond","georgia","gulim","gungsuh","kaiti","jasmineupc","malgungothic","mangal","meiryo","microsoftjhengHei","microsoftyahei","mingliu","mingliuhkscs","msgothic","msmincho","mspgothic","mspmincho","pmingliu","pmingliuextb","simhei","simsun","simsunextb","sourcesanspro","tahoma","thsarabunpsk","times","timesnewroman","trebuchetms","verdana","yugothic","yumincho","xlyellow"];const i=["aharoni","aptos","aptosmono","aptosserif","","batangche","","dengxian","","","dotumche","","","","",""," ","","","_hkscs","ms ","ms ","ms p","ms p","opensans","","-extb","roboto","",""];t.getKnownFontNamesLowerCase=()=>{return(r=null!==(e=r)&&void 0!==e?e:(0,o.isChangeGateEnabled)(o.ChangeGate.UseNewKnownFontList))?t.KnownFontNamesLowerCase.concat(i):t.KnownFontNamesLowerCase;var e},t.KnownFontNamesLowerCaseSet=new Set((0,t.getKnownFontNamesLowerCase)()),t.SubscriptVerticalPaddingForUnderlinePx=2},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.alignVerticalUnderlineRuns=t.drawTextDecoration=t.cacheTextDecorationLayout=t.measureAndCacheTextDecorationLayout=void 0;const o=n(1),r=n(3),i=n(0),l=n(8),a=n(4),s=n(2),d=n(9),c=n(5),u=n(15),g=n(6),h=n(14),C=n(22),f=(0,o.isChangeGateEnabled)(o.ChangeGate.RotatedTextDecorationWithMergeCellBugFix);function m(e,t,n,r,i,l){if((0,a.verifyArgumentNotNull)(t,"cell","CacheUnderlineLayout"),(0,a.verifyArgumentNotNull)(t.CachedFont,"cell.CachedFont","CacheUnderlineLayout"),(0,a.verifyArgumentNotNull)(t.CachedStyle,"cell.CachedStyle","CacheUnderlineLayout"),(0,a.verifyArgumentNotNull)(t.CachedDrawingLayout,"cell.CachedDrawingLayout","CacheUnderlineLayout"),i.Underline!==o.FontUnderline.None&&!(0,h.shouldRenderVerticalText)(t)){const a={underline:i.Underline},s=R(e,t,n,r,a,i,!1,l),d=t.CachedDrawingLayout.UnderlineRuns;if(s&&d.push(s),F(a)){const s=R(e,t,n,r,{underline:a.underline===o.FontUnderline.DoubleAccounting?o.FontUnderline.SingleAccounting:o.FontUnderline.Single},i,!0,l);s&&d.push(s)}}if(i.StrikeThrough){const o=R(e,t,n,r,{strikethrough:!0},i,!1,void 0);o&&t.CachedDrawingLayout.StrikethroughRuns.push(o)}}function p(e,t,n){const o=n.CachedDrawingLayout.TextOrientationLayout,r=n.CachedDrawingLayout.UnderlineRuns,i=n.CachedDrawingLayout.StrikethroughRuns,l=t.highContrastScheme?(0,s.getHighContrastTextColor)(n,t.highContrastScheme):void 0,a=null==o?void 0:o.clipRect;let d=void 0;a&&(d={x:a.x*t.scaleFactor,y:a.y*t.scaleFactor,width:a.width*t.scaleFactor,height:a.height*t.scaleFactor}),(0,s.applyClipping)(e,d),(0,C.applyRotation)(e,o.TranslateX*t.scaleFactor,o.TranslateY*t.scaleFactor,o.Angle),e.beginPath(),y(e,void 0,void 0,l,r,i),e.stroke(),e.restore(),(0,s.restoreClipping)(e,d)}function y(e,t,n,o,r,i){for(const l of[r,i])if(l&&l.length>0){if(!t||!n){const r=l[0],i=null!=o?o:r.Color;t=i,n=r.LineWidth,e.strokeStyle=i,e.lineWidth=r.LineWidth}for(let r=0;r<l.length;r++){const i=l[r],a=null!=o?o:i.Color,s=t!==a,d=n!==i.LineWidth;(s||d)&&(t=a,n=i.LineWidth,e.stroke(),e.strokeStyle=a,e.lineWidth=i.LineWidth,e.beginPath()),b(e,i)}}return{lineColor:t,lineWidth:n}}function S(e){return e[0].Y>e[1].Y?{top:e[1],bottom:e[0]}:{top:e[0],bottom:e[1]}}function R(e,t,n,i,s,f,m,p){const{scaleFactor:y}=n,S=m||i.partOfMixedUnderlineSequence&&s.underline===o.FontUnderline.Single,R=(0,l.getActualFontSizeFromFont)(t,f,!1),T=function(e,t,n,r,i,l,s,C){const{textPositionX:f,textWidth:m}=r,{scaleFactor:p}=n;let y,S,R;if(i.underline===o.FontUnderline.SingleAccounting||i.underline===o.FontUnderline.DoubleAccounting){const o=(0,d.getCellTextHorizontalPadding)(t,e,n.zoom,n.devicePixelRatio);y=(0,c.getCellLeft)(e,t,e.BlockWidth)+o,S=(0,c.getCellRight)(e,t,e.BlockWidth)-o}else{const n=!(0,g.isNullOrUndefined)(t.TextRuns)||(0,u.isHorizontalAlignmentJustifiedAndDistributed)(t);({startX:y,endX:S}=function(e,t,n,r,i){let l,a,s=i?o.HorizontalAlignment.Left:(0,u.getEffectiveHorizontalAlignment)(e,t);switch((0,h.shouldRenderVerticalText)(t)&&(s=o.HorizontalAlignment.Center),s){case o.HorizontalAlignment.Automatic:case o.HorizontalAlignment.Left:l=n,a=n+r;break;case o.HorizontalAlignment.Right:l=n-r,a=n;break;case o.HorizontalAlignment.CenterAcrossSelection:case o.HorizontalAlignment.Center:l=n-r/2,a=n+r/2;break;default:l=n,a=n+r}return{startX:l,endX:a}}(e,t,f,m,n))}return R=i.strikethrough?function(e,t,n,o,r){const{textPositionY:i}=n;(0,a.verifyArgumentNotNull)(t.CachedFont,"cell.CachedFont","calculateStrikethroughY");const l=(0,d.getTextDecorationLineWidth)(r.Size);return(0,d.getMiddleBaseline)(e,i,r,o)-l/2}(e,t,r,l,s):function(e,t,n,o){const{textPositionY:r}=t;(0,a.verifyArgumentNotNull)(e.CachedFont,"cell.CachedFont","calculateUnderlineY");return r+2*(null!=o?o:(0,d.getTextDecorationLineWidth)(n))}(t,r,l,C),y=Math.round(y*p),S=Math.round(S*p),R=Math.round(R*p),{startX:y,endX:S,Y:R}}(e,t,n,i,s,R,f,p),b=T.startX,v=T.endX;let x=T.Y;const D=function(e,t,n){const o=(null!=n?n:(0,d.getTextDecorationLineWidth)(t))*e;return Math.max(Math.floor(o),1)}(y,R,p),A=Math.round(r.UnderlineMarginFromTextBaseline*D);F(s)&&(x+=A);const P=(0,C.shouldDrawRotatedText)(e,t.CachedStyle,t.CachedFont);return S&&(x=x-D*(P?r.GapBetweenRotatedDoubleUnderline:r.GapBetweenDoubleUnderline)+A),P?{StartX:b,EndX:v,Y:x,LineWidth:D,Color:f.Color}:function(e,t,n,o,i,l,a,s,d){const{clipRect:u}=o,{scaleFactor:g}=n;if(!function(e,t,n,o,r,i,l,a){return function(e,t,n,o){const r=(0,c.getCellTopAdjustedForDrawing)(e,t,!1);return o<=r&&o+n<=r}(e,t,r,i)||w(e,t,r,i)||function(e,t,n,o){const{clipRect:r}=e,{scaleFactor:i}=t,l=r?(r.x+r.width)*i:0;let a=!1;return r&&(a=n>=l&&o>=l),a}(o,n,l,a)||function(e,t,n,o){const{clipRect:r}=e,{scaleFactor:i}=t,l=r?r.x*i:0;let a=!1;return r&&(a=n<=l&&o<=l),a}(o,n,l,a)}(e,t,n,o,i,l,a,s)||o.containSubscript&&w(e,t,i,l)){if(u){const e=Math.round(u.x*g),t=I(a,s,e,Math.round(u.width*g)+e);a=t.start,s=t.end}if(function(e,t,n,o){const i=o+n,l=(0,c.getCellTopAdjustedForDrawing)(e,t,!1)+r.GridLineWidthPx,a=(0,c.getCellBottomAdjustedForDrawing)(e,t)-r.GridLineWidthPx;return o<=l||i>=a}(e,t,i,l)&&(!o.containSubscript||!w(e,t,i,l))){const n=I(l,l+i,(0,c.getCellTopAdjustedForDrawing)(e,t,!1),(0,c.getCellBottomAdjustedForDrawing)(e,t)-r.GridLineWidthPx);l=n.start,i=n.end-l}return{StartX:a,EndX:s,Y:l,LineWidth:i,Color:d.Color}}}(e,t,n,i,D,x,b,v,f)}function F(e){return e.underline===o.FontUnderline.Double||e.underline===o.FontUnderline.DoubleAccounting}function T(e,t){return e[t].StartX===e[t+1].StartX}function w(e,t,n,o){const r=(0,c.getCellBottomAdjustedForDrawing)(e,t);return o>=r&&o+n>=r}function I(e,t,n,o){const r=Math.min(e,t),i=Math.max(e,t),l=Math.min(n,o),a=Math.max(n,o);return{start:Math.max(r,l),end:Math.min(i,a)}}function b(e,t){if(0===t.LineWidth)return;const n=t.Y+(0,i.getLinePixelTranslation)(t.LineWidth);!function(e,t,n,o){e.moveTo(t,o),e.lineTo(n,o)}(e,t.StartX,t.EndX,n)}t.measureAndCacheTextDecorationLayout=function(e,t,n,o,r){const i=n.CachedFont.Underline,l=n.CachedFont.StrikeThrough;(i||l)&&""!==n.CachedDisplayText&&(r.textWidth=(0,d.getTextWidth)(e,t,n),m(t,n,o,r,n.CachedFont))},t.cacheTextDecorationLayout=m,t.drawTextDecoration=function(e,t,n){let o,i;e.beginPath();const l=[],d=t.ClientOnlyCache.CellsToRender;for(let r=0;r<d.length;r++){var u,g;const c=d[r];if(!(0,s.cellIntersectsRenderingRegion)(c,n.renderingRegion))continue;if((0,a.verifyArgumentNotNull)(c.CachedFont,"cell.CachedFont","drawTextDecoration"),!c.CachedFont.StrikeThrough&&!c.CachedFont.Underline&&!c.TextRuns)continue;if(c.CondFormat&&null!==(u=c.CondFormat)&&void 0!==u&&u.Icon&&null!==(g=c.CondFormat)&&void 0!==g&&null!==(g=g.Icon)&&void 0!==g&&g.IconOnly)continue;if(c.ShowSkeleton)continue;(0,a.verifyArgumentNotNull)(c.CachedDrawingLayout,"cell.CachedDrawingLayout","drawTextDecoration");const h=c.CachedDrawingLayout.TextOrientationLayout,f=c.CachedDrawingLayout.UnderlineRuns,m=c.CachedDrawingLayout.StrikethroughRuns,p=n.highContrastScheme?(0,s.getHighContrastTextColor)(c,n.highContrastScheme):void 0;if(h&&(0,C.shouldDrawRotatedText)(t,c.CachedStyle,c.CachedFont)){l.push(c);continue}const{lineColor:S,lineWidth:R}=y(e,o,i,p,f,m);o=S,i=R}e.stroke(),l.length>0&&function(e,t,n,o){let i=void 0,l=-1;const a=[];for(let d=0;d<o.length;d++){const u=o[d],g=(e.RowHeights[u.Row]-r.GridLineWidthPx)*n.scaleFactor,h=e.ClientOnlyCache?e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[u.Row]:e.RowOffsets[u.Row];u.Row!==l&&(-1!==l&&(0,s.restoreClipping)(t,i),i={x:0,y:h,width:e.BlockWidth*n.scaleFactor,height:g},(0,s.applyClipping)(t,i),l=u.Row),f&&(0,c.isCellSpansMultipleRowsOrBlocks)(u)?a.push(u):p(t,n,u)}if((0,s.restoreClipping)(t,i),f)for(const e of a)p(t,n,e)}(t,e,n,l)},t.alignVerticalUnderlineRuns=function(e,t,n){if((0,g.isNullOrUndefined)(n)||n.length<=0)return;const o=function(e,t,n){let o=-1,r=-1,i=0,l=!1;for(let e=0;e<n.length;e++)if(!(e>0&&T(n,e-1)))if(e<n.length-1&&T(n,e)){const{top:t,bottom:a}=S([n[e],n[e+1]]);t.Y>o&&(o=t.Y),a.Y>r&&(r=a.Y,i=Math.max(a.LineWidth,1),l=!0)}else n[e].Y>o&&(o=n[e].Y,l||(i=Math.max(n[e].LineWidth,1)));return w(e,t,i,r)&&(r=(0,c.getCellBottomAdjustedForDrawing)(e,t)-i,o=r-2*i),o-r<2*i&&(o=r-2*i),{closestToBottomUnderline:o,closestToBottomDoubleUnderline:r,closestToBottomUnderlineWidth:i}}(e,t,n);for(let e=0;e<n.length;e++)if(!(e>0&&n[e].StartX===n[e-1].StartX)){if(e<n.length-1&&n[e].StartX===n[e+1].StartX){const{top:t,bottom:r}=S([n[e],n[e+1]]);t.Y=o.closestToBottomUnderline,r.Y=o.closestToBottomDoubleUnderline,n[e+1].LineWidth=o.closestToBottomUnderlineWidth}else n[e].Y=o.closestToBottomUnderline;n[e].LineWidth=o.closestToBottomUnderlineWidth}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClippedDrawingContext=t.createShapePath=t.shouldClipHorizontally=t.shouldClipVertically=t.getClipRect=void 0;const o=n(1),r=n(5),i=n(3);function l(e,t,n,o){return n>=(0,r.getCellBottomAdjustedForDrawing)(e,t)-i.GridLineWidthPx||n-o<=(0,r.getCellTopAdjustedForDrawing)(e,t,!1)}function a(e,t,n,o,l){var a;const s=e.IsRtl,d=t.Spill&&(l||(null===(a=t.PivotTable)||void 0===a?void 0:a.HasExpandCollapseIndicator));return n<=(d?(0,r.getSpillCellLeftAdjustedForDrawing)(e,t):(0,r.getCellLeftAdjustedForDrawing)(e,t,s,!1))||n+o>=(d?(0,r.getSpillCellRightAdjustedForDrawing)(e,t):(0,r.getCellRightAdjustedForDrawing)(e,t,!1)-i.GridLineWidthPx)}function s(e,t,n){return e>n?n:e<t?t:e}t.getClipRect=function(e,t,n,o,s,d){const c=function(e,t,n,o,r,i){return a(e,t,n,r,i)||l(e,t,o,r)}(e,t,n,o,s,d),u=t.Spill&&d;if(c)return{x:u?(0,r.getSpillCellLeftAdjustedForDrawing)(e,t):(0,r.getCellLeftAdjustedForDrawing)(e,t,!1,!1),y:(0,r.getCellTopAdjustedForDrawing)(e,t,!1),width:u?(0,r.getSpillCellWidthAdjustedForDrawing)(t,e)-i.GridLineWidthPx:(0,r.getCellWidthAdjustedForDrawing)(e,t)-i.GridLineWidthPx,height:(0,r.getCellHeightAdjustedForDrawing)(e,t)-i.GridLineWidthPx}},t.shouldClipVertically=l,t.shouldClipHorizontally=a,t.createShapePath=function(e,t){if(!t||t.length<2)return;const n=t[0];e.moveTo(n.x,n.y);for(let n=1;n<t.length;n++){const o=t[n];e.lineTo(o.x,o.y)}},t.getClippedDrawingContext=function(e,t,n,l){const{x:a,y:d,width:c,height:u}=l,g=i.GridLineWidthPx*n.scaleFactor,h=(0,r.getCellLeftAdjustedForDrawing)(e,t,!1,!1),C=(0,r.getCellRightAdjustedForDrawing)(e,t,!1),f=(0,r.getCellTopAdjustedForDrawing)(e,t,!1),m=(0,r.getCellBottomAdjustedForDrawing)(e,t)-g,p=s(a,h,C),y=s(d,f,m);let S=a+c;S=s(S,h,C);const R=S-((0,o.isChangeGateEnabled)(o.ChangeGate.UseClippedXCheckbox)?p:a);let F=d+u;return F=s(F,f,m),{x:p,y:y,width:R,height:F-y}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isRenderResizePillAcrossBlockEnabled=t.isIncreasedHeaderSizeEnabled=t.isHeaderInsertEnabled=t.processGlobalStyles=t.preprocessStyles=t.modelType=t.getCellBorderStyle=t.cloneOutlines=t.initCellLookup=t.getSpilledOverCount=t.uniqueValuesFilter=t.cellsPositionComparer=t.getCellStyle=t.getCell=t.isDifferentialRenderingSupported=t.getRenderingRegionHitTestCache=t.cleanHitTestCache=t.isFontRefactorFGV3Enabled=t.initModelClientCache=t.validateCellShouldExistInModelUnsafe=t.getOrCreateCell=t.getModelClientCache=t.getAdjacentCellsKeys=t.getAdjacentCellsKeysOld=t.getAllSpillingOverCells=t.getAllSpanningCellsKeys=t.getDefaultCell=t.isAccAndCustomNumFmtApplicable=t.shouldOverrideText=t.getReferencedObjectToCache=t.getRowColFromCellKey=t.getCellLookupKey=void 0;const o=n(62),r=n(24),i=n(25),l=n(81),a=n(34),s=n(104),d=n(26),c=n(7),u=n(105),g=n(153),h=n(52),C=n(54),f=n(11),m=n(44);let p,y=void 0,S=void 0,R=void 0;function F(e,t){return(e<<l.CellLookupRowShift)+t}function T(e){const t=e%l.CellLookupColumnMod;return{row:e>>l.CellLookupRowShift,column:t}}function w(e,t,n,i){const l=n&&0!==n.length?(0,o.getReferencedObjectById)(r.UniqueStyleID.Default,n):void 0;return{Col:t,CachedStyle:l,CachedFont:i&&0!==i.length&&l?(0,o.getReferencedObjectById)(l.FontID||0,i):void 0,HorizontalAlignmentSet:!1,Ifmt:0,IfmtStamped:0,Row:e,StyleID:r.UniqueStyleID.Default,BorderStyleID:r.UniqueStyleID.DefaultBorder,CachedBorderStyle:{Borders:[],ID:0},Text:"",ValueType:r.CellValueType.None,CachedDrawingLayout:{UnderlineRuns:[],StrikethroughRuns:[],CellTextLayout:{}}}}function I(e,t){const n=[];for(let o=0;o<t.length;o++){const i=t[o],{row:l,column:a}=T(i),{cellBefore:s,cellAfter:d}=G(e,l,a);s&&E(s)&&W(s,a,r.SpillDirection.End)&&n.push(F(s.Row,s.Col)),d&&E(d)&&W(d,a,r.SpillDirection.Start)&&n.push(F(d.Row,d.Col))}return n}function b(e){return e.ClientOnlyCache||D(e),e.ClientOnlyCache}function v(e,t,n){return B(t,n,e)||(x(e,t,n),w(t,n,e.Styles,e.Fonts))}function x(e,t,n){if((0,d.verifyArgumentNotNull)(e.RowNumbers,"RowNumbers","validateCellShouldExistInModelUnsafe"),(0,d.verifyArgumentNotNull)(e.ColumnNumbers,"ColumnNumbers","validateCellShouldExistInModelUnsafe"),(0,d.verifyArgumentNotNull)(e.Styles,"Styles","validateCellShouldExistInModelUnsafe"),t<0||n<0||t>=e.RowNumbers.length||n>=e.ColumnNumbers.length)throw Error(`validateCellShouldExistInModelUnsafe: cell requested for a cell which is not in range of the model. rowIndex:  ${t}, RowNumbers.length: ${e.RowNumbers.length},  colIndex:  ${n}, ColumnNumbers.length: ${e.ColumnNumbers.length}`)}function D(e){e.ClientOnlyCache||(e.ClientOnlyCache={},e.ClientOnlyCache.DirtyType=r.DirtyType.None),e.ClientOnlyCache.RenderingRegionsHitTestCache||function(e){e.ClientOnlyCache&&(e.ClientOnlyCache.RenderingRegionsHitTestCache={})}(e);const t=e.ClientOnlyCache;if(M(e)){const e=t.DirtyCellsKeys.filter(O);t.DirtyCellsKeys=e.sort(V)}t.CellsToRender=function(e){return M(e)?(e.ClientOnlyCache.CellLookup=L(e),_(e,e.ClientOnlyCache.DirtyCellsKeys)):e.Cells}(e),t.GridlineOverridingCellsToRender=function(e,t){if(!M(e))return e.Cells;if(U(e)===r.ModelType.HeaderBlockModel)return[];const n=[];for(let o=0;o<t.length;o++){const r=t[o],i=q(e,r);n.push(r);for(let e=0;e<i.length;e++)n.push(i[e])}return _(e,n.filter(O).sort(V))}(e,t.DirtyCellsKeys),e.ClientOnlyCache.FallbackFonts={},A()&&(e.ClientOnlyCache.renderWithOldDefaultFont=!1)}function A(){return void 0!==p||(p=(0,f.getBooleanFeatureGate)("Microsoft.Office.Excel.FontLoadRefactorV3",!1)),!!p}function P(e,t){e.ClientOnlyCache&&e.ClientOnlyCache.RenderingRegionsHitTestCache||D(e);return e.ClientOnlyCache.RenderingRegionsHitTestCache[t]||(e.ClientOnlyCache.RenderingRegionsHitTestCache[t]={CellCursorHitRegions:{},CellHitRegions:{},CellLongPressHitRegions:{},CellTooltipHitRegions:{}},e.ClientOnlyCache.RenderingRegionsHitTestCache[t])}function M(e){const t=b(e);return t.IsDirty&&!t.DisableDiffRendering&&t.DirtyCellsKeys&&t.DirtyCellsKeys.length>0}function B(e,t,n){(0,d.verifyArgumentNotNull)(n,"model","initCellLookup");const o=b(n);return o.CellLookup||(o.CellLookup=L(n)),o.CellLookup[F(e,t)]}function H(e,t){return(0,d.verifyArgumentNotNull)(t,"cell","getCellStyle"),(0,d.verifyArgumentNotNull)(e.Styles,"Styles","getCellStyle"),t.CachedStyle||(t.CachedStyle=(0,s.getCellStyleByID)(t,e)),t.CachedStyle}function O(e,t,n){return n.indexOf(e)===t}function k(e,t){return t.Spill?e===r.SpillDirection.Start?t.Spill.SpanToStart:t.Spill.SpanToEnd:0}function L(e){(0,d.verifyArgumentNotNull)(e,"model","initCellLookup"),(0,d.verifyArgumentNotNull)(e.Cells,"model.Cells","initCellLookup");const t={};for(let n=0;n<e.Cells.length;n++){const o=e.Cells[n];if(o)if(t[F(o.Row,o.Col)]=o,o.Merge)for(let e=0;e<=o.Merge.Rows;e++)for(let n=0;n<=o.Merge.Columns;n++)t[F(o.Row+e,o.Col+n)]=o;else t[F(o.Row,o.Col)]=o}return t}function N(e,t){return(0,d.verifyArgumentNotNull)(t,"cell","getCellBorderStyle"),(0,d.verifyArgumentNotNull)(e.BorderStyles,"BorderStyles","getCellBorderStyle"),t.CachedBorderStyle?t.CachedBorderStyle:(0,s.getBorderStyleByID)(t,e)}function E(e){return e&&!!e.Text&&""!==e.Text}function z(e,t,n,o,r){let i=t+n;for(;i>=0&&i<e.length;){const t=e[i];if(t.Row!==o)return;if(E(t))return W(t,r,-n)?t:void 0;i+=n}}function W(e,t,n){const o=Math.abs(t-e.Col);return!!(e.Spill&&k(n,e)>=o)}function G(e,t,n){let o=void 0,r=void 0;for(let i=0;i<e.length;i++){const l=e[i];if(!(l.Row<t)){if(l.Row>t)break;if(l.Col<n&&(o=l),l.Col>n){r=l;break}}}return{cellBefore:o,cellAfter:r}}function V(e,t){const n=T(e),o=T(t);return j(n.row,n.column,o.row,o.column)}function j(e,t,n,o){return e===n&&t===o?0:e>n||e===n&&t>o?1:-1}function _(e,t){const n=[],o=e.ClientOnlyCache;for(let e=0;e<t.length;e++){const r=t[e],i=o.CellLookup[r],{row:l,column:a}=T(r);i&&i.Row===l&&i.Col===a&&n.push(i)}return n}function U(e){return(0,d.verifyArgumentNotNull)(e,"model","modelType"),void 0!==e.IsRow?r.ModelType.HeaderBlockModel:r.ModelType.GridBlockModel}function q(e,t){const n=[],{row:o,column:r}=T(t),i=Math.max(0,r-1),l=Math.min(e.ColumnNumbers.length-1,r+1),a=Math.max(0,o-1),s=Math.min(e.RowNumbers.length,o+1);for(let t=a;t<=s;t++)for(let o=i;o<=l;o++){const r=B(t,o,e);r&&$(e,r)&&n.push(F(r.Row,r.Col))}return n}function $(e,t){const n=H(e,t),o=N(e,t);return!!n.BackgroundColor||!!n.Gradient||o.Borders.length>0||!!t.HasError||(0,d.isRenderFlagEnabled)(r.RenderFlagsArray.RenderPatternStyle,e)&&!!n.PatternStyle}function Y(e,t){for(let n=0;n<t.length;n++){const o=t[n];e[o]&&(e[o]=[])}}function X(e,t,n,o){try{x(e,n,o);const r=v(e,n,o);t.push(F(r.Row,r.Col)),r.Row===n&&r.Col===o||t.push(F(n,o))}catch(e){return}}function K(e){if(!(0,d.isOptimizeGsProcessingEnabled)()&&!function(e){return!(0,i.isNullOrUndefined)(e.Cells)&&((0,d.isGlobalStylesRenderFlagsEnabled)(e)||!(0,i.isNullOrUndefined)(e.BorderStyles))||!(0,i.isNullOrUndefined)(e.Fonts)&&!(0,i.isNullOrUndefined)(e.Styles)}(e))return;void 0===R&&(R=(0,f.getBooleanFeatureGate)("Microsoft.Office.Excel.DisableProcessingOfGlobalStylesForLargeNumberOfStyles",!1)),R&&(e.BorderStyles&&e.BorderStyles.length>120&&(0,h.disableGlobalBorderStyles)("Border styles processing disabled due to large number."),e.Fonts&&e.Fonts.length>35&&(0,C.disableGlobalFonts)("Font styles processing disabled due to large number."),e.Styles&&e.Styles.length>160&&(0,m.disableGlobalCellStyles)("Cell styles processing disabled due to large number."));const t=!(0,d.isDisableProcessGlobalStylesTelemetryEnabled)()&&((0,d.isOptimizeGsProcessingEnabled)()?performance.now()%10<1:Math.random()<l.LogSamplingPercentage),n=(0,g.trackDuration)(()=>(0,u.preprocessModelStyles)(e));if(t&&n>=0){let t=`processGlobalStyles: preprocessing time: ${n}, Cells count: ${e.Cells?e.Cells.length:0}`;(0,h.isGlobalBorderStylesEnabled)(e)&&!(0,i.isNullOrUndefined)(e.BorderStyles)&&(t+=", Borders Styles count: "+e.BorderStyles.length),!(0,C.isGlobalFontsAndCellStylesFlightEnabled)(e)||(0,i.isNullOrUndefined)(e.Fonts)||(0,i.isNullOrUndefined)(e.Styles)||(t+=", Fonts count: "+e.Fonts.length,t+=", Cell styles count: "+e.Styles.length),window.requestIdleCallback?window.requestIdleCallback(()=>{J(t)}):setTimeout(()=>{J(t)},100)}}function J(e){c.ULS.sendTraceTag(508363660,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Info,e)}function Z(){return(0,f.getBooleanFeatureGate)("Microsoft.Office.Excel.HeaderInsert",!1)}t.getCellLookupKey=F,t.getRowColFromCellKey=T,t.getReferencedObjectToCache=function(e,t){if((0,a.isChangeGateEnabled)(a.ChangeGate.TreatZeroAndUndefinedAsEqual)){if((0,d.verifyArgumentNotNull)(e,"Id","helpers.getReferencedObjectToCache"),!(0,i.isNullOrUndefined)(t))return(0,o.getReferencedObjectById)(e,t)}else if(!(0,i.isNullOrUndefined)(t)&&!(0,i.isNullOrUndefined)(e))return(0,o.getReferencedObjectById)(e,t)},t.shouldOverrideText=function(e){if(e.RichValueType)return!1;const t=e.ValueType;return t===r.CellValueType.Number||t===r.CellValueType.Boolean||t===r.CellValueType.Error},t.isAccAndCustomNumFmtApplicable=function(e){return!!function(e){return e.ValueType===r.CellValueType.Number}(e)&&!(0,i.isNullOrUndefined)(e.NumFmt)&&""!==e.Text},t.getDefaultCell=w,t.getAllSpanningCellsKeys=function(e,t,n){let o=[];if(o=o.concat(function(e,t,n){if(!t.Merge&&!t.Spill)return[];const o=[];if(t.Merge)for(let e=0;e<=t.Merge.Rows;e++)for(let n=0;n<=t.Merge.Columns;n++)o.push(F(t.Row+e,t.Col+n));if(t.Spill){for(let e=0;e<t.Spill.SpanToEnd;e++)o.push(F(t.Row,t.Col+e+1));for(let e=0;e<t.Spill.SpanToStart;e++)o.push(F(t.Row,t.Col-e-1));if(t.Spill.SpanToEnd){const i=t.Col+t.Spill.SpanToEnd,l=z(e,n,r.SpillDirection.End,t.Row,i);l&&o.push(F(l.Row,l.Col))}if(t.Spill.SpanToStart){const i=t.Col-t.Spill.SpanToStart,l=z(e,n,r.SpillDirection.Start,t.Row,i);l&&o.push(F(l.Row,l.Col))}}return o}(e,t,n)),0===o.length){const i=z(e,n,r.SpillDirection.Start,t.Row,t.Col);i&&o.push(F(i.Row,i.Col));const l=z(e,n,r.SpillDirection.End,t.Row,t.Col);l&&o.push(F(l.Row,l.Col))}return o},t.getAllSpillingOverCells=I,t.getAdjacentCellsKeysOld=function(e,t,n){const o=[];if(t-1>=0){const r=v(e,t-1,n);o.push(F(r.Row,r.Col))}if(n-1>=0){const r=v(e,t,n-1);o.push(F(r.Row,r.Col))}if(t+1<e.RowNumbers.length){const r=v(e,t+1,n);o.push(F(r.Row,r.Col))}if(n+1<e.ColumnNumbers.length){const r=v(e,t,n+1);o.push(F(r.Row,r.Col))}return o},t.getAdjacentCellsKeys=function(e,t){var n,o;let r=[];const i=Math.max(0,t.Row-1),l=Math.min(e.RowNumbers.length-1,t.Row+1+((null==t||null===(n=t.Merge)||void 0===n?void 0:n.Rows)||0)),a=Math.max(0,t.Col-1),s=Math.min(e.ColumnNumbers.length-1,t.Col+1+((null===(o=t.Merge)||void 0===o?void 0:o.Columns)||0));for(let t=i;t<=l;t++)X(e,r,t,a),X(e,r,t,s);for(let t=a;t<=s;t++)X(e,r,i,t),X(e,r,l,t);return r=r.concat(I(e.Cells,r)),r},t.getModelClientCache=b,t.getOrCreateCell=v,t.validateCellShouldExistInModelUnsafe=x,t.initModelClientCache=D,t.isFontRefactorFGV3Enabled=A,t.cleanHitTestCache=function(e,t){const n=P(e,t),o=e.ClientOnlyCache;M(e)?(Y(n.CellHitRegions,o.DirtyCellsKeys),Y(n.CellCursorHitRegions,o.DirtyCellsKeys),Y(n.CellTooltipHitRegions,o.DirtyCellsKeys),Y(n.CellLongPressHitRegions,o.DirtyCellsKeys)):o.RenderingRegionsHitTestCache&&(o.RenderingRegionsHitTestCache[t]={CellCursorHitRegions:{},CellHitRegions:{},CellLongPressHitRegions:{},CellTooltipHitRegions:{}})},t.getRenderingRegionHitTestCache=P,t.isDifferentialRenderingSupported=M,t.getCell=B,t.getCellStyle=H,t.cellsPositionComparer=function(e,t){return j(e.Row,e.Col,t.Row,t.Col)},t.uniqueValuesFilter=O,t.getSpilledOverCount=k,t.initCellLookup=L,t.cloneOutlines=function(e){if(!e||0===e.length)return;const t=[];for(let n=0;n<e.length;++n){const o=e[n],r={Outlines:[]};for(let e=0;e<o.Outlines.length;++e){const t=_object_spread({},o.Outlines[e]);r.Outlines.push(t)}t.push(r)}return t},t.getCellBorderStyle=N,t.modelType=U,t.preprocessStyles=function(e){if(void 0===S&&(S=(0,f.getBooleanFeatureGate)("Microsoft.Office.Excel.GlobalStylesRegressionFix",!1)),!S)if(void 0===y&&(y=(0,a.isChangeGateEnabled)(a.ChangeGate.RestrictStylesPreProcess)),y){const t=U(e);t!==r.ModelType.HeaderBlockModel||e.AreStylesProcessed?t!==r.ModelType.GridBlockModel||M(e)||K(e):(K(e),e.AreStylesProcessed=!0)}else K(e)},t.processGlobalStyles=K,t.isHeaderInsertEnabled=Z,t.isIncreasedHeaderSizeEnabled=function(e){return(0,d.isRenderFlagEnabled)(r.RenderFlagsArray.HeaderDragImprovements,e)||Z()},t.isRenderResizePillAcrossBlockEnabled=function(){return(0,f.getBooleanFeatureGate)("Microsoft.Office.Excel.RenderResizePillAcrossBlock",!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.duplicateFont=t.updateGlobalFontIDInCell=t.isGlobalFontsEnabled=t.isGlobalFontsFlightEnabled=t.getGlobalFontsMap=t.getDefaultFont=t.getFontByGlobalID=t.GlobalFonts=void 0;const o=n(63),r=n(53),i=n(7),l=n(64),a=n(26);class s extends r.GlobalStyles{initializeDefaultStyles(){s.DefaultFontID=this.getOrCreateID(l.DefaultGridFont)}static getInstance(){return s.instance||(s.instance=new s),s.instance}getOrCreateID(e){const t=(0,o.generateKeyFromFont)(e);let n=this.keyToGlobalIDMap.get(t);if(void 0===n){n=this.count,e.GlobalId=n;const o=u(e,e.ID||0,e.RefCount||0);return this.styles.push(o),this.keyToGlobalIDMap.set(t,this.count),this.count=this.count+1,n}return n}clear(){i.ULS.sendTraceTag(508389603,i.LogCategory.msoulscat_ES_EWAJSGrid,i.TraceLevel.Warning,"GlobalFonts: Total unique style count is "+this.count),super.clear(),this.initializeDefaultStyles()}getDefaultFont(){return this.styles[s.DefaultFontID]}isEnabled(){return this.enabled}testExports(){return{forceEnableGlobalFonts:this.forceEnableGlobalFonts}}forceEnableGlobalFonts(){s.getInstance().enabled=!0}constructor(){super(),this.initializeDefaultStyles()}}function d(){return s.getInstance()}function c(){return d().isEnabled()}function u(e,t,n){return{Bold:e.Bold,Color:e.Color,FontName:e.FontName,FontScheme:e.FontScheme,ID:t||0,GlobalId:e.GlobalId,Italic:e.Italic,RefCount:n||0,Size:e.Size,StrikeThrough:e.StrikeThrough,Underline:e.Underline,VerticalAlign:e.VerticalAlign}}t.GlobalFonts=s,s.instance=void 0,t.getFontByGlobalID=function(e){return d().getObject(e)},t.getDefaultFont=function(){return d().getDefaultFont()},t.getGlobalFontsMap=d,t.isGlobalFontsFlightEnabled=function(e){return(0,a.isGlobalStylesRenderFlagsEnabled)(e)&&c()},t.isGlobalFontsEnabled=c,t.updateGlobalFontIDInCell=function(e){e.CachedStyle&&e.CachedStyle.FontID&&e.CachedFont&&(e.CachedStyle.GlobalFontID=d().getOrCreateID(e.CachedFont))},t.duplicateFont=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateCellStyleKey=t.disableGlobalCellStyles=t.getCellStyleByGlobalID=t.isGlobalCellStylesEnabled=t.getGlobalCellStylesMap=t.GlobalCellStyles=void 0;const o=n(53),r=n(64),i=n(152),l=n(63),a=n(43),s=n(11);let d=void 0;class c extends o.GlobalStyles{initializeDefaultStyles(){c.DefaultCellStyleID=this.getOrCreateID(r.DefaultCellStyle)}static getInstance(){if(!c.instance)try{return c.instance=new c,c.instance}catch(e){throw new Error("exception while creating GlobalCellStyles: "+e)}return c.instance}getOrCreateID(e){const t=h(e);if(void 0===t)return;let n=this.keyToGlobalIDMap.get(t);if(void 0===n){n=this.count,e.GlobalId=n;const o=(0,i.duplicateOnlyStyleWithoutFont)(e,e.ID||0,e.RefCount||0);return this.styles.push(o),this.keyToGlobalIDMap.set(t,this.count),this.count=this.count+1,n}return n}getDefaultCellStyle(){return this.styles[c.DefaultCellStyleID]}isEnabled(){return this.enabled}testExports(){return{forceEnableGlobalCellStyles:this.forceEnableGlobalCellStyles}}forceEnableGlobalCellStyles(){c.getInstance().enabled=!0}constructor(){super(),this.initializeDefaultStyles()}}function u(){return c.getInstance()}function g(e){u().disable(e),(0,a.getGlobalFontsMap)().disable("GlobalCellStyles: Due to disabling of Global Cell Styles")}function h(e){if(null!==e.GlobalFontID&&void 0!==e.GlobalFontID)try{const t=(0,a.getFontByGlobalID)(e.GlobalFontID),n=(void 0===d&&(d=(0,s.getBooleanFeatureGate)("Microsoft.Office.Excel.CellStyleKeyGenerationOptimization")),d?e.GlobalFontID.toString():(0,l.generateKeyFromFont)(t));return(0,l.generateKeyFromCellStyle)(e)+n+"|"}catch(e){g(""+e)}else g("GenerateCellStyleKey:: Global font ID is not present")}t.GlobalCellStyles=c,c.instance=void 0,t.getGlobalCellStylesMap=u,t.isGlobalCellStylesEnabled=function(){return u().isEnabled()},t.getCellStyleByGlobalID=function(e){return u().getObject(e)},t.disableGlobalCellStyles=g,t.generateCellStyleKey=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCFIconAlignedToTheLeft=t.drawIconFromPoints=t.fillAndStroke=void 0;const o=n(1),r=n(15);function i(e,t,n){t&&(e.fillStyle=t,e.fill()),e.strokeStyle=n,e.stroke()}t.fillAndStroke=i,t.drawIconFromPoints=function(e,t,n,o){e.beginPath(),e.moveTo(o[0].x,o[0].y);for(let t=1;t<o.length;t++)e.lineTo(o[t].x,o[t].y);i(e,t,n)},t.isCFIconAlignedToTheLeft=function(e,t){var n;const i=null===(n=t.CondFormat)||void 0===n?void 0:n.Icon;if(i){if(i.IconOnly){const n=(0,r.getEffectiveHorizontalAlignment)(e,t);return n===o.HorizontalAlignment.Left||n===o.HorizontalAlignment.Automatic}return!0}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFlickeredFontsInBootPhase=t.isFontUsedInModel=t.shouldUseOldApiForFontLoadCheck=t.updateFontLoadStatus=t.isFontAvailable=t.setFontVisited=t.isFontVisited=t.doesFontExist=t.setFontLoadStatus=t.getFontLoadStatus=t.getFontsLoadStatus=t.getFontFaceLoadStatus=t.verifyFontLoadStatus=t.isValidCellFontLoaded=t.setFontLoadDivWithFontFamily=t.isFontValid=t.getFontFaceSetReady=t.fontFaceSetSupported=t.pendingToLoadedFonts=t.FontLoadStatus=void 0;const o=n(1),r=n(8),i=n(10),l=n(0),a=n(56),s=!!document.fonts&&!!document.fonts.check;var d;!function(e){e[e.Pending=0]="Pending",e[e.Loaded=1]="Loaded",e[e.Failed=2]="Failed"}(d||(t.FontLoadStatus=d={}));const c=new Set(["aptos","aptos narrow","aptos display"]),u=new Set,g=new Set,h=new Set;t.pendingToLoadedFonts=new Set;const C={},f=new Set;let m,p,y;function S(){return void 0!==document.fonts}function R(e){switch(e){case"inherit":case"initial":case"unset":case"revert":return!1}return!0}function F(e){if(s)return(0,a.documentFontsCheck)("11pt "+e,e)?"loaded":"loading"}function T(e,t){switch(e){case 0:return!1;case 1:return 0===t;case 2:return 0===t||1===t;default:return!0}}function w(e){switch(e){case d.Loaded:return 0;case d.Failed:return 1;case d.Pending:return 2;default:return 6}}function I(e){switch(e){case"loaded":return 0;case"error":return 1;case"loading":return 2;case"unloaded":return 3;default:return 6}}function b(e,t=!0){return A()&&t&&(e=(0,a.canonizeFontName)(e)),C[e]}function v(e,n,r=!0){A()&&r&&(e=(0,a.canonizeFontName)(e)),void 0===p&&(p=(0,l.isModernFontRenderingEnabled)()&&(0,o.isChangeGateEnabled)(o.ChangeGate.AddFontFlickerTelemetry)),!!p&&(void 0===y&&(0,i.isAppVisuallyReady)()&&(y=!0,window.setTimeout(()=>{y=!1},5e3)),!0===y&&C[e]===d.Pending&&n===d.Loaded&&t.pendingToLoadedFonts.add(e)),C[e]=n}function x(e,t=!0){return A()&&t&&(e=(0,a.canonizeFontName)(e)),null!==C[e]&&void 0!==C[e]}function D(e){let t=e;(0,l.isGridRenderPerfFixEnabled)()&&(t=e.toLowerCase());const n="11pt "+t;return(0,a.documentFontsCheck)(n,t)}function A(){return void 0===m&&(m=(0,o.isChangeGateEnabled)(o.ChangeGate.UseOldAPIForFontLoadCheck)),m}t.fontFaceSetSupported=S,t.getFontFaceSetReady=function(){return document.fonts.ready},t.isFontValid=R,t.setFontLoadDivWithFontFamily=function(e,t){e.style.fontFamily=t},t.isValidCellFontLoaded=function(e,t){var n,o;const i=null===(n=t.CachedFont)||void 0===n?void 0:n.FontName;return!!R(null===(o=t.CachedFont)||void 0===o?void 0:o.FontName)&&(0,a.documentFontsCheck)((0,r.getFontCssStringFromCell)(t,e),i)},t.verifyFontLoadStatus=function(e,t){return(0,l.isFontRefactorFGEnabled)()?function(e,t){return"loaded"===F(e)?t===d.Loaded:t===d.Pending}(e,t):function(e,t){if("function"!=typeof document.fonts.values)return!1;const n=document.fonts.values();let o=n.next();for(;!o.done;){if(o.value&&o.value.family.replace(/[\""]/g,"").toLowerCase()===e.toLowerCase())switch(t){case d.Loaded:if("loaded"===o.value.status)return!0;break;case d.Failed:if("error"===o.value.status)return!0}o=n.next()}return!1}(e,t)},t.getFontFaceLoadStatus=function(e){return(0,l.isFontRefactorFGEnabled)()?F(e):function(e){if("function"!=typeof document.fonts.values)return;const t=document.fonts.values();let n=t.next();for(;!n.done;){if(n.value&&n.value.family.replace(/[\""]/g,"").toLowerCase()===e.toLowerCase())return n.value.status;n=t.next()}}(e)},t.getFontsLoadStatus=function(e){if(0===e.length)return[];const t=new Map;return e.forEach(e=>{t.set(e.toLowerCase(),{font:e,status:5,fromCache:!1})}),function(e){let t=0;for(const n in C){const o=w(b(n)),r=e.get(n);void 0!==r&&T(r.status,o)&&(void 0===r.status&&t++,r.status=o,r.fromCache=!0)}return t===e.size}(t)||function(e){if("function"!=typeof document.fonts.values)return;e.forEach(e=>{5===e.status&&(e.status=4)});const t=document.fonts.values();let n=t.next();for(;!n.done;){if(n.value){const t=n.value.family.replace(/[\""]/g,"").toLowerCase(),o=e.get(t),r=I(n.value.status);void 0!==o&&T(o.status,r)&&(o.status=r)}n=t.next()}}(t),Array.from(t.values())},t.getFontLoadStatus=b,t.setFontLoadStatus=v,t.doesFontExist=x,t.isFontVisited=function(e){return f.has(e)},t.setFontVisited=function(e){f.add(e)},t.isFontAvailable=D,t.updateFontLoadStatus=function(e){let t=e;(0,l.isGridRenderPerfFixEnabled)()&&(t=e.toLowerCase());const n=(0,l.isModernFontRenderingEnabled)()&&!A()?i.isFontSupported:D;return!(!S()||x(t)||!R(t)||!n(e)||(v(t,d.Loaded),0))},t.shouldUseOldApiForFontLoadCheck=A,t.isFontUsedInModel=function(e,t){return!!(e.Fonts&&e.Fonts[t]&&e.Fonts[t].RefCount)},t.getFlickeredFontsInBootPhase=function(){return t.pendingToLoadedFonts.forEach(e=>{c.has(e)?u.add(e):(0,r.isKnownFont)(e)?g.add(e):h.add(e)}),{defaultAptosFonts:Array.from(u),oldFonts:Array.from(g),newOrCustomFonts:Array.from(h)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRibbonCommandsInstance=void 0;const o=n(10);let r;t.getRibbonCommandsInstance=function(){return r||(r=(0,o.getRibbonCommandsMapping)()),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RightArrowPosition=t.LeftArrowPosition=t.ArrowTipWidthPx=t.ArrowLengthPx=t.FilterPoints=t.MiniChevronPoints=t.ChevronPoints=t.FilterDrawingThresholdPx=t.AutoFilterRectRadius=t.AutoFilterIconRectPx=t.FilterStrokeColor=t.NoneFilterTypeStrokeColor=t.AutoFilterStrokeColor=t.AutoFilterBackgroundColor=t.AutoFilterBorderColor=t.AutoFilterLineWidthPx=t.AutoFilterDefaultSizePx=t.AutoFilterTextHorizontalPaddingPx=t.AutoFilterHorizontalPaddingPx=t.AutoFilterPaddingBottomPx=t.AutoFilterColor=void 0,t.AutoFilterColor="#3A3A38",t.AutoFilterPaddingBottomPx=1,t.AutoFilterHorizontalPaddingPx=1,t.AutoFilterTextHorizontalPaddingPx=2,t.AutoFilterDefaultSizePx=17,t.AutoFilterLineWidthPx=1,t.AutoFilterBorderColor="gray",t.AutoFilterBackgroundColor="white",t.AutoFilterStrokeColor="black",t.NoneFilterTypeStrokeColor="#858585",t.FilterStrokeColor="#10893c",t.AutoFilterIconRectPx=16,t.AutoFilterRectRadius=2,t.FilterDrawingThresholdPx=3,t.ChevronPoints=[{x:5,y:6},{x:8,y:9},{x:11,y:6}],t.MiniChevronPoints=[{x:3,y:9},{x:5,y:11},{x:7,y:9}];const o={x:8,y:3};t.FilterPoints=[o,{x:8,y:5},{x:10,y:6},{x:10,y:10},{x:12,y:10},{x:12,y:6},{x:14,y:5},{x:14,y:3},o],t.ArrowLengthPx=8,t.ArrowTipWidthPx=3,t.LeftArrowPosition={x:4,y:3},t.RightArrowPosition={x:11,y:3}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAdvancedVerticalAlignmentOffsetYForWrapText=t.getAdvancedVerticalAlignmentLineGapHeightForWraptext=t.getEffectiveVerticalAlignment=t.isVerticalAlignmentJustifyOrDistributed=t.AdvVerticalAlignmentFormat=void 0;const o=n(1);var r;!function(e){e[e.WrapText=0]="WrapText",e[e.CFIcon=1]="CFIcon"}(r||(t.AdvVerticalAlignmentFormat=r={})),t.isVerticalAlignmentJustifyOrDistributed=function(e){switch(e){case o.VerticalAlignment.Justify:case o.VerticalAlignment.Distributed:return!0}return!1},t.getEffectiveVerticalAlignment=function(e,t,n,i,l,a,s){if(s)return o.VerticalAlignment.Bottom;switch(e){case o.VerticalAlignment.Top:case o.VerticalAlignment.Bottom:case o.VerticalAlignment.Center:return e;case o.VerticalAlignment.Justify:case o.VerticalAlignment.Distributed:return function(e,t,n,i,l,a){switch(t){case r.WrapText:return function(e,t,n,r,i){if(1===i||t<r)switch(e){case o.VerticalAlignment.Justify:return o.VerticalAlignment.Top;case o.VerticalAlignment.Distributed:return o.VerticalAlignment.Center}if(t<n&&t>=r)switch(e){case o.VerticalAlignment.Justify:case o.VerticalAlignment.Distributed:return o.VerticalAlignment.Top}return e}(e,n,i,l,a);case r.CFIcon:return function(e){switch(e){case o.VerticalAlignment.Justify:return o.VerticalAlignment.Top;case o.VerticalAlignment.Distributed:default:return o.VerticalAlignment.Center}}(e)}}(e,t,n,i,l,a)}},t.getAdvancedVerticalAlignmentLineGapHeightForWraptext=function(e,t,n){return(e-t)/(n-1)},t.getAdvancedVerticalAlignmentOffsetYForWrapText=function(e,t,n){return e-t*n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));class o{sendTraceTag(){}shipAssertTag(){}debugAssertTag(){}setCorrelationId(){}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return l}));var o=n(50);class r{setCorrelationId(e){this.externalLogger.setCorrelationId(e)}setLogger(e){this.externalLogger=e}sendTraceTag(e,t,n,o){this.externalLogger.sendTraceTag(e,t,n,o)}debugAssertTag(e,t,n,o){this.externalLogger.debugAssertTag(e,t,n,o)}shipAssertTag(e,t,n,o){this.externalLogger.shipAssertTag(e,t,n,o)}constructor(){this.externalLogger=new o.a}}const i=new r;function l(e){if(!e)throw new Error("The 'logger' argument is missing");i.setLogger(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.duplicateBorderStyle=t.disableGlobalBorderStyles=t.isGlobalBorderStylesEnabledNew=t.isGlobalBorderStylesEnabled=t.getGlobalBorderStyleMap=t.getDefaultBorderStyle=t.getBorderStyleByGlobalID=t.GlobalBorderStyles=void 0;const o=n(24),r=n(63),i=n(53),l=n(7),a=n(26),s=n(64);class d extends i.GlobalStyles{initializeDefaultStyles(){d.DefaultBorderStyleID=this.getOrCreateID({Borders:[],ID:s.DefaultGlobalBorderID})}static getInstance(){return d.instance||(d.instance=new d),d.instance}getOrCreateID(e){const t=(0,r.generateKeyFromBorderStyle)(e);let n=this.keyToGlobalIDMap.get(t);if(void 0===n){n=this.count,e.GlobalId=n;const o=u(e,e.ID||0,e.RefCount||0);return this.styles.push(o),this.keyToGlobalIDMap.set(t,this.count),this.count=this.count+1,n}return n}clear(){l.ULS.sendTraceTag(508941207,l.LogCategory.msoulscat_ES_EWAJSGrid,l.TraceLevel.Warning,"GlobalBorderStyles: Total unique style count is "+this.count),super.clear(),this.initializeDefaultStyles()}getDefaultBorderStyle(){return this.styles[d.DefaultBorderStyleID]}isEnabled(){return this.enabled}testExports(){return{forceEnableGlobalBorderStyles:this.forceEnableGlobalBorderStyles}}forceEnableGlobalBorderStyles(){d.getInstance().enabled=!0}constructor(){super(),this.initializeDefaultStyles()}}function c(){return d.getInstance()}function u(e,t,n){const o=[];for(let t=0;t<e.Borders.length;t++){const n=e.Borders[t],r={BorderLineStyle:n.BorderLineStyle,BorderPosition:n.BorderPosition,Weight:n.Weight,Color:{Red:n.Color.Red,Blue:n.Color.Blue,Green:n.Color.Green}};o.push(r)}return{Borders:o,GlobalId:e.GlobalId,ID:t||0,RefCount:n||0}}t.GlobalBorderStyles=d,d.instance=void 0,t.getBorderStyleByGlobalID=function(e){return c().getObject(e)},t.getDefaultBorderStyle=function(){return c().getDefaultBorderStyle()},t.getGlobalBorderStyleMap=c,t.isGlobalBorderStylesEnabled=function(e){return(0,a.isRenderFlagEnabled)(o.RenderFlagsArray.GlobalStylesSlice1,e)&&c().isEnabled()},t.isGlobalBorderStylesEnabledNew=function(){return c().isEnabled()},t.disableGlobalBorderStyles=function(e){return c().disable(e)},t.duplicateBorderStyle=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalStyles=t.StyleType=void 0;const o=n(34),r=n(25),i=n(64),l=n(7);var a;!function(e){e[e.CellStyle=0]="CellStyle",e[e.BorderStyle=1]="BorderStyle",e[e.Font=2]="Font"}(a||(t.StyleType=a={})),t.GlobalStyles=class{process(e){if(0!==e.length)for(let t=0;t<e.length;t++)if(e[t]){const n=e[t];if(!(0,r.isNullOrUndefined)(n.GlobalId))continue;n.ID||(n.ID=i.DefaultGlobalStyleID);const o=this.getOrCreateID(n);if(void 0===o)throw new Error("GlobalStyle::Interface::Process: global style ID is undefined");n.GlobalId=o}}getObject(e){if(e<0||e>=this.count)throw new Error(`GlobalStyle::Interface::GetStyle: global style ID ${e} is not valid`);return this.styles[e]}clear(){this.count=0,this.styles.splice(0,this.styles.length),this.keyToGlobalIDMap.clear(),this.initializeDefaultStyles()}disable(e){this.enabled=!1;const t=`GlobalStyle::Interface::Disable: ${e} ${(0,o.isChangeGateEnabled)(o.ChangeGate.GlobalStyleTrace)&&new Error(e).stack||""}`;l.ULS.sendTraceTag(508900295,l.LogCategory.msoulscat_ES_EWAJSGrid,l.TraceLevel.Warning,t)}constructor(){this.count=0,this.styles=[],this.keyToGlobalIDMap=new Map,this.enabled=!0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGlobalFontsAndCellStylesEnabled=t.isGlobalFontsAndCellStylesFlightEnabled=t.disableGlobalFonts=void 0;const o=n(44),r=n(43),i=n(26);function l(){return(0,o.isGlobalCellStylesEnabled)()&&(0,r.isGlobalFontsEnabled)()}t.disableGlobalFonts=function(e){(0,r.getGlobalFontsMap)().disable(e),(0,o.getGlobalCellStylesMap)().disable("GlobalFonts: Due to disabling of Global Fonts")},t.isGlobalFontsAndCellStylesFlightEnabled=function(e){return(0,i.isGlobalStylesRenderFlagsEnabled)(e)&&l()},t.isGlobalFontsAndCellStylesEnabled=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAdjustedHeaderDrawingOffset=t.getAdjustedDrawingOffset=t.getMaxLineOffset=t.shouldDrawGridLinesAndValidation=t.drawHeadersGridLines=t.drawGridLines=void 0;const o=n(1),r=n(3),i=n(2),l=n(0),a=n(6),s=n(0),d=n(38),c=n(7),u=n(27);function g(e,t){if(!(e.RowOffsets&&e.ColumnOffsets&&e.RowHeights&&e.ColumnWidths))throw`drawGridLines:: one or more elements is null: RowOffset: ${!e.RowOffsets}, ColumnOffsets: ${!e.ColumnOffsets}, RowHeights: ${!e.RowHeights}, ColumnWidths: ${!e.ColumnWidths}`;if(e.RowOffsets.length!==e.RowHeights.length)throw"drawGridLines:: RowOffsets.length !== RowHeights.length";if(e.ColumnOffsets.length!==e.ColumnWidths.length)throw"drawGridLines:: ColumnOffsets.length !== ColumnWidths.length";return!(!e.ShowGridLines||t.scaleFactor<r.MinimalScaleFactorForGridlinesRendering||!(0,i.shouldRenderGridLines)((0,l.isHighContrastMode)(t),(0,l.hasWorkbookBackgroundColor)(e.BackgroundColor)))}function h(e,t,n){let o=Math.round(e*t)-r.GridLineWidthPx/2;if(n&&(0,s.isSafari)()){const e=window?window.devicePixelRatio:-1,n=t===e/2;2===e&&n&&(o-=1)}return o}function C(e,t,n,o){const r=e+t-n;return Math.min(r,o)}function f(e,t,n){const o=Math.max(e-t,0);return Math.min(o,n)}function m(e,t,n,o,r,l){const a=l.startRow,s=l.endRow;for(let l=a;l<=s;l++){const a=C(t[l],(0,i.getRowHeightFromOffsets)(l,t),o,r);(0,i.drawLine)(e,0,a,n,a)}}function p(e,t,n,o,r,l){const a=l.startColumn,s=l.endColumn;for(let l=a;l<=s;l++){const a=C(t[l],(0,i.getColWidthFromOffsets)(l,t),o,r);(0,i.drawLine)(e,a,0,a,n)}}function y(e,t,n,i){return(0,a.isNullOrUndefined)(t.highContrastScheme)?(0,a.isNullOrUndefined)(e.GridLineColor)?n&&t.viewMode===o.ViewMode.NamedSheetView?i?r.NSVDefaultBorderGridLineColor:r.NSVDefaultGridLineColor:i?r.DefaultBorderGridLineColor:r.DefaultGridLineColor:e.GridLineColor:""+(0,s.rgbToColorHex)(t.highContrastScheme.TextColor)}function S(e){return e.viewMode===o.ViewMode.NamedSheetView?r.NSVSelectedCellsGridLineColor:r.SelectedCellsGridLineColor}function R(e,t){e.lineWidth=r.GridLineWidthPx,e.setLineDash(function(e){return(0,a.isNullOrUndefined)(e.GridLineColor)?r.DefaultDash:r.ColoredGridLineDash}(t))}t.drawGridLines=function(e,t,n){if(!g(t,n))return;R(e,t);const o=(0,l.getLinePixelTranslation)(r.GridLineWidthPx),i=h(t.BlockWidth,n.scaleFactor,!1),a=h(t.BlockHeight,n.scaleFactor,!0);e.beginPath(),e.strokeStyle=y(t,n,!1,!1),m(e,t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,t.BlockWidth*n.scaleFactor,o,a,n.renderingRegion),e.stroke(),e.beginPath(),e.strokeStyle=y(t,n,!1,!1),p(e,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,t.BlockHeight*n.scaleFactor,o,i,n.renderingRegion),e.stroke()},t.drawHeadersGridLines=function(e,t,n,a){if(!g(t,n))return;if(function(e,t,n){if(!g(t,n))return;R(e,t);const o=(0,l.getLinePixelTranslation)(r.GridLineWidthPx),i=n.scaleFactor,a=h(t.BlockWidth,i,!1),s=h(t.BlockHeight,i,!0),d=!!t.IsRow,c=t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,u=t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,C=t.BlockWidth*i,f=t.BlockHeight*i,S=n.renderingRegion,F=y(t,n,!0,!0),T=y(t,n,!0,!1);e.beginPath(),e.strokeStyle=T,d?m(e,c,C,o,s,S):p(e,u,f,o,a,S),e.stroke(),e.beginPath(),e.strokeStyle=F,d?p(e,u,f,o,a,S):m(e,c,C,o,s,S),e.stroke()}(e,t,n),(0,l.isHighContrastMode)(n))return;const s=t.IsRow,C=function(e,t,n){const o=[],r=n?t.startRow:t.startColumn,i=n?t.endRow:t.endColumn,l=i+1;let a=!1;for(let t=r;t<l;++t){const n=e[t];if(!n){const n=(e,...t)=>t.reduce((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t),{}),o=e.map((e,t,o)=>n(e,"Row","Col"));c.ULS.sendTraceTag(509677844,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Error,`getHeaderSelectedGridLines: firstGridLine:${r}, lastRowColInRenderingRegion:${i}, gridLineIndex:${t}, cells.length:${e.length}, cells:${JSON.stringify(o)}, `)}(0,d.isCellPartiallySelected)(n)?(o.push(t),a=!0):a&&(o.push(t),a=!1)}return a&&o.push(l),o}(t.Cells,n.renderingRegion,s),F=(0,l.getLinePixelTranslation)(r.GridLineWidthPx),T=n.scaleFactor,w=h(t.BlockHeight,T,!0),I=h(t.BlockWidth,T,!1);s?(function(e,t,n,o,r,l,a){const s=a.length,d=n[n.length-1];e.beginPath(),e.strokeStyle=S(t);for(let t=0;t<s;++t){const n=a[t];if(0===n)continue;const s=f(o[n],r,l);(0,i.drawLine)(e,0,s,d,s)}e.stroke()}(e,n,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,F,w,C),function(e,t,n,i,l,a){const s=i.scaleFactor,d=r.SelectionBorderWidth*s,c=r.HeaderCornerRadius*s,g=a,h=Math.max(d,c),[C,f]=[o.WholeRowColSelectionBackgroundColor,o.WholeRowColSelectionBackgroundColor];if(0===t.length)return;let m=!1;for(let r=0;r<t.length;r++){const i=t[r];if(o.WholeSelectionHeadersStylesSet.has(i.StyleID||0)){if(r>0&&!m&&e[r-1]===e[r]-1){const e=Math.max(c-d,0),t={outerColor:f,innerColor:C,left:0,bottom:l[r]+1+e,width:g,height:h,radius:[c,0,0,0]};(0,u.drawRoundRectangle)(n,t)}if(r<t.length-1){const i=t[r+1];if(!o.WholeSelectionHeadersStylesSet.has(i.StyleID||0)&&e[r+1]===e[r]+1){const e={outerColor:f,innerColor:C,left:0,bottom:l[r+1]+d-1,width:g,height:h,radius:[0,0,0,c]};(0,u.drawRoundRectangle)(n,e)}m=!0}}else m=!1}n.stroke()}(t.RowNumbers,t.Cells,e,n,t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,t.BlockWidth*T)):(function(e,t,n,o,r,l,a){const s=a.length,d=o[o.length-1];e.beginPath(),e.strokeStyle=S(t);for(let t=0;t<s;++t){const o=a[t];if(0===o)continue;const s=f(n[o],r,l);(0,i.drawLine)(e,s,0,s,d)}e.stroke()}(e,n,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,F,I,C),function(e,t,n,i,l,a,s){const c=i.scaleFactor,g=r.SelectionBorderWidth*c,h=r.HeaderCornerRadius*c,C=Math.max(g,h),f=a-(0,d.getColumnHeaderGutterSizeForDrawing)(c,s),m=a,[p,y]=[o.WholeRowColSelectionBackgroundColor,o.WholeRowColSelectionBackgroundColor];if(0===t.length)return;let S=!1;for(let i=0;i<t.length;i++){const a=t[i];if(o.WholeSelectionHeadersStylesSet.has(a.StyleID||0)){if(i>0&&!S&&e[i-1]===e[i]-1){const e={outerColor:y,innerColor:p,left:l[i]-g,bottom:m,width:C,height:f,radius:[h,0,0,0]};(0,u.drawRoundRectangle)(n,e)}if(i<t.length-1){const a=t[i+1];if(!o.WholeSelectionHeadersStylesSet.has(a.StyleID||0)&&e[i+1]===e[i]+1){const e=Math.max(h-g,0),t={outerColor:y,innerColor:p,left:l[i+1]-r.SelectionBorderWidth-e,bottom:m,width:C,height:f,radius:[0,h,0,0]};(0,u.drawRoundRectangle)(n,t)}S=!0}}else S=!1}n.stroke()}(t.ColumnNumbers,t.Cells,e,n,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,t.BlockHeight*T,a))},t.shouldDrawGridLinesAndValidation=g,t.getMaxLineOffset=h,t.getAdjustedDrawingOffset=C,t.getAdjustedHeaderDrawingOffset=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDocumentFontsCheckCount=t.documentFontsCheck=t.canonizeFontName=t.canonizeFontNameNoLowercase=void 0;const o=n(1),r=n(13),i=n(11),l=new Map;let a=void 0,s=0;function d(e){if(u()){const t=l.get(e);if(t&&t.fontNameCannoizedNoLowercase)return t.fontNameCannoizedNoLowercase}let t=e;const n=e.indexOf("(Body)");n>0&&(t=e.substring(0,n).trim());const o=t.replace(/[\""]/g,"");if(u()){const t=l.get(e)||{};l.set(e,_object_spread_props(_object_spread({},t),{fontNameCannoizedNoLowercase:o}))}return o}function c(e){if(u()){const t=l.get(e);if(t&&t.fontNameCannonized)return t.fontNameCannonized}const t=d(e).toLowerCase();if(u()){const n=l.get(e)||{};l.set(e,_object_spread_props(_object_spread({},n),{fontNameCannonized:t}))}return t}function u(){return void 0===a&&(a=(0,o.isChangeGateEnabled)(o.ChangeGate.CacheCannonizedFont)&&((0,o.isChangeGateEnabled)(o.ChangeGate.ModernFontRendering)?(0,i.getBooleanFeatureGate)("Microsoft.Office.Excel.ModernFontRendering"):(0,i.getBooleanFeatureGate)("Microsoft.Office.Excel.ModernFontPicker"))),!!a}t.canonizeFontNameNoLowercase=d,t.canonizeFontName=c,t.documentFontsCheck=function(e,t){try{return!!document.fonts.check(e)||(!t||"arial"!==c(t))&&!(0,o.isFontRefactorFGV3Enabled)()&&window.parent.document.fonts.check(e)}catch(e){return(0,r.setRenderingResultInfo)("Error in documentFontsCheck"),!1}finally{s++}},t.getDocumentFontsCheckCount=function(){return s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoIndent=t.ExpandCollapseButtonVerticalPaddingPx=t.PaddingBetweenExpandCollapseButtonAndTextPx=t.ExpandCollapseButtonOuterColor=t.ExpandCollapseButtonInnerColor=t.ExpandCollapseButtonSizePx=t.EmptyPivotTableImageWidthHeightRatio=t.EmptyPivotTableMinimalImageWidthPx=t.EmptyPivotTableMinimalHeightForDrawingImage=t.EmptyPivotTableImageMinimalPaddingYPx=t.EmptyPivotTableTitleContainerWidthRatio=t.EmptyPivotTableMinimalHeightForDrawingTitle=t.EmptyPivotTableTitleContainerHeightPx=t.EmptyPivotTableTitleContainerTopPaddingPx=t.EmptyPivotTableImagePlaceholderThicknessPx=t.EmptyPivotTableTitleContainerBorderThicknessPx=t.EmptyPivotTableTitleTextColor=t.EmptyPivotTableTitleContainerBorderColor=void 0,t.EmptyPivotTableTitleContainerBorderColor="#969696",t.EmptyPivotTableTitleTextColor="#969696",t.EmptyPivotTableTitleContainerBorderThicknessPx=2,t.EmptyPivotTableImagePlaceholderThicknessPx=1,t.EmptyPivotTableTitleContainerTopPaddingPx=32,t.EmptyPivotTableTitleContainerHeightPx=19,t.EmptyPivotTableMinimalHeightForDrawingTitle=t.EmptyPivotTableTitleContainerTopPaddingPx+t.EmptyPivotTableTitleContainerHeightPx,t.EmptyPivotTableTitleContainerWidthRatio=.75,t.EmptyPivotTableImageMinimalPaddingYPx=24,t.EmptyPivotTableMinimalHeightForDrawingImage=t.EmptyPivotTableMinimalHeightForDrawingTitle+t.EmptyPivotTableTitleContainerHeightPx+t.EmptyPivotTableImageMinimalPaddingYPx,t.EmptyPivotTableMinimalImageWidthPx=80,t.EmptyPivotTableImageWidthHeightRatio=184/164,t.ExpandCollapseButtonSizePx=9,t.ExpandCollapseButtonInnerColor="#FAFAFA",t.ExpandCollapseButtonOuterColor="#3A3A38",t.PaddingBetweenExpandCollapseButtonAndTextPx=3,t.ExpandCollapseButtonVerticalPaddingPx=4,t.NoIndent=0},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCellFontColor=t.updateContextForCurrentCell=t.getDefaultContextState=void 0;const o=n(1),r=n(0),i=n(8),l=n(37),a=n(15),s=n(3),d=n(2);function c(e,t,n){var r;return t?(0,d.getHighContrastTextColor)(e,t):(0,o.isChangeGateEnabled)(o.ChangeGate.PreviewCellsSettings)&&e.PreviewText&&null!==(r=n.ClientOnlyCache.PreviewCellsSettings)&&void 0!==r&&r.RetainCellTextOnPreview&&!e.RetainTextOnPreview?s.DefaultPreviewSuggestionContentFontColor:e.HasError?s.FormulaErrorFontColor:e.CachedFont.Color}function u(e){return e?"rtl":"ltr"}t.getDefaultContextState=function(e,t){return{fontColor:e?(0,r.rgbToColorHex)(e.TextColor):s.DefaultCellFontColor,fontProperties:"",direction:u(t),textBaseline:"bottom",textAlign:"start"}},t.updateContextForCurrentCell=function(e,t,n,r,s){const d=(0,a.getTextAlignment)(r,n);t.textAlign!==d&&(t.textAlign=d,e.textAlign=d);const g=l.DefaultTextBaseline;g!==t.textBaseline&&(e.textBaseline=g,t.textBaseline=g);const h=(0,i.getFontCssStringFromCell)(n,r);t.fontProperties===h&&e.font===h||(t.fontProperties=h,e.font=h);const C=c(n,s,r);t.fontColor!==C&&(t.fontColor=C,e.fillStyle=C);const f=function(e,t){switch(e){case o.ReadingOrderType.RightToLeft:return"rtl";case o.ReadingOrderType.LeftToRight:return"ltr";case o.ReadingOrderType.Context:return u(t);default:throw Error("getCanvasDirection: unsupported readingOrder: "+e)}}(n.CachedStyle.ReadingOrder||o.ReadingOrderType.Context,r.IsRtl);f!==t.direction&&(t.direction=f,e.direction=f)},t.getCellFontColor=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGridRendererStringsInitialized=t.initGridRendererStrings=t.gridRendererStrings=void 0;const o=n(7),r=n(6);void 0===window.gridRendererStringsCounter?window.gridRendererStringsCounter=1:window.gridRendererStringsCounter++,t.initGridRendererStrings=function(e){t.gridRendererStrings=e,(0,r.isNullOrUndefined)(t.gridRendererStrings)&&o.ULS.sendTraceTag(507847511,o.LogCategory.msoulscat_ES_EWAJSGrid,o.TraceLevel.Error,"initGridRendererStrings: gridRendererStrings is null or undefined")},t.isGridRendererStringsInitialized=function(){return!(0,r.isNullOrUndefined)(t.gridRendererStrings)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTrianglePathOnCellCorner=t.getRightAngledTriangleSize=t.drawTriangle=void 0;const o=n(0),r=n(4),i=n(94),l=n(41),a=n(21),s=n(3);t.drawTriangle=function(e,t,n){(0,r.verifyArgumentNotNull)(e,"ctx","drawTriangle"),(0,r.verifyArgumentNotNull)(t,"drawingContext","drawTriangle");const{innerColor:o,outerColor:i,left:l,bottom:a,height:s,width:d}=t,c=l+d/2,u=n?a+s:a-s;e.beginPath(),e.moveTo(l,a),e.lineTo(l+d,a),e.lineTo(c,u),e.closePath(),o&&(e.fillStyle=o,e.fill()),i&&(e.strokeStyle=i,e.stroke())},t.getRightAngledTriangleSize=function(e,t,n,o,r){return(0,a.getInteractiveIconMaxSizeAdjustedForDrawing)(n,e,t,o,r,!0,!0)},t.createTrianglePathOnCellCorner=function(e,t,n){const r=(0,o.getLinePixelTranslation)(s.GridLineWidthPx),{left:a,bottom:d,height:c,width:u}=t,g=n===i.Position.Right,h=d-c,C=g?a-r:a,f=[{x:C,y:h},{x:C+u+r,y:h},{x:C+(g?u+r:0),y:h+c+r},{x:C,y:h}];(0,l.createShapePath)(e,f)}},function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",(function(){return r})),n.d(t,"__assign",(function(){return i})),n.d(t,"__rest",(function(){return l})),n.d(t,"__decorate",(function(){return a})),n.d(t,"__param",(function(){return s})),n.d(t,"__esDecorate",(function(){return d})),n.d(t,"__runInitializers",(function(){return c})),n.d(t,"__propKey",(function(){return u})),n.d(t,"__setFunctionName",(function(){return g})),n.d(t,"__metadata",(function(){return h})),n.d(t,"__awaiter",(function(){return C})),n.d(t,"__generator",(function(){return f})),n.d(t,"__createBinding",(function(){return m})),n.d(t,"__exportStar",(function(){return p})),n.d(t,"__values",(function(){return y})),n.d(t,"__read",(function(){return S})),n.d(t,"__spread",(function(){return R})),n.d(t,"__spreadArrays",(function(){return F})),n.d(t,"__spreadArray",(function(){return T})),n.d(t,"__await",(function(){return w})),n.d(t,"__asyncGenerator",(function(){return I})),n.d(t,"__asyncDelegator",(function(){return b})),n.d(t,"__asyncValues",(function(){return v})),n.d(t,"__makeTemplateObject",(function(){return x})),n.d(t,"__importStar",(function(){return A})),n.d(t,"__importDefault",(function(){return P})),n.d(t,"__classPrivateFieldGet",(function(){return M})),n.d(t,"__classPrivateFieldSet",(function(){return B})),n.d(t,"__classPrivateFieldIn",(function(){return H}));var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function l(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}function a(e,t,n,o){var r,i=arguments.length,l=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(i<3?r(l):i>3?r(t,n,l):r(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l}function s(e,t){return function(n,o){t(n,o,e)}}function d(e,t,n,o,r,i){function l(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,s=o.kind,d="getter"===s?"get":"setter"===s?"set":"value",c=!t&&e?o.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,o.name):{}),g=!1,h=n.length-1;h>=0;h--){var C={};for(var f in o)C[f]="access"===f?{}:o[f];for(var f in o.access)C.access[f]=o.access[f];C.addInitializer=function(e){if(g)throw new TypeError("Cannot add initializers after decoration has completed");i.push(l(e||null))};var m=(0,n[h])("accessor"===s?{get:u.get,set:u.set}:u[d],C);if("accessor"===s){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(a=l(m.get))&&(u.get=a),(a=l(m.set))&&(u.set=a),(a=l(m.init))&&r.push(a)}else(a=l(m))&&("field"===s?r.push(a):u[d]=a)}c&&Object.defineProperty(c,o.name,u),g=!0}function c(e,t,n){for(var o=arguments.length>2,r=0;r<t.length;r++)n=o?t[r].call(e,n):t[r].call(e);return o?n:void 0}function u(e){return"symbol"==typeof e?e:"".concat(e)}function g(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function h(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function C(e,t,n,o){return new(n||(n=Promise))((function(r,i){function l(e){try{s(o.next(e))}catch(e){i(e)}}function a(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}s((o=o.apply(e,t||[])).next())}))}function f(e,t){var n,o,r,i,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(l=0)),l;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return l.label++,{value:a[1],done:!1};case 5:l.label++,o=a[1],a=[0];continue;case 7:a=l.ops.pop(),l.trys.pop();continue;default:if(!((r=(r=l.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){l=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){l.label=a[1];break}if(6===a[0]&&l.label<r[1]){l.label=r[1],r=a;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(a);break}r[2]&&l.ops.pop(),l.trys.pop();continue}a=t.call(e,l)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var m=Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]};function p(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||m(t,e,n)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],o=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function S(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),l=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)l.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return l}function R(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(S(arguments[t]));return e}function F(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var i=arguments[t],l=0,a=i.length;l<a;l++,r++)o[r]=i[l];return o}function T(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}function w(e){return this instanceof w?(this.v=e,this):new w(e)}function I(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,r=n.apply(e,t||[]),i=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(e){r[e]&&(o[e]=function(t){return new Promise((function(n,o){i.push([e,t,n,o])>1||a(e,t)}))})}function a(e,t){try{(n=r[e](t)).value instanceof w?Promise.resolve(n.value.v).then(s,d):c(i[0][2],n)}catch(e){c(i[0][3],e)}var n}function s(e){a("next",e)}function d(e){a("throw",e)}function c(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}function b(e){var t,n;return t={},o("next"),o("throw",(function(e){throw e})),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,r){t[o]=e[o]?function(t){return(n=!n)?{value:w(e[o](t)),done:!1}:r?r(t):t}:r}}function v(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=y(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise((function(o,r){!function(e,t,n,o){Promise.resolve(o).then((function(t){e({value:t,done:n})}),t)}(o,r,(t=e[n](t)).done,t.value)}))}}}function x(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var D=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function A(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&m(t,e,n);return D(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function M(e,t,n,o){if("a"===n&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?o:"a"===n?o.call(e):o?o.value:t.get(e)}function B(e,t,n,o,r){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?r.call(e,n):r?r.value=n:t.set(e,n),n}function H(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getReferencedObjectById=void 0;const o=n(24),r=n(25);t.getReferencedObjectById=function(e,t){let n;switch(e){case o.UniqueStyleID.Default:case o.UniqueStyleID.Hyperlink:n=t[t.length+e];break;default:n=t[e]}if((0,r.isNullOrUndefined)(n))throw Error("RefObject is null or undefined, id: "+e);if((n.ID||0)!==e)throw Error("RefIDs are not sorted as expected");return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateKeyFromBorderStyle=t.generateKeyFromFont=t.generateKeyFromCellStyle=t.generateKeyFromModelStyles=void 0;const o=n(53);function r(e){return[c(e.VerticalText),"|",c(e.ShrinkToFit),"|",u(e.HorizontalAlignment),"|",u(e.VerticalAlignment),"|",u(e.ReadingOrder),"|",u(e.Orientation||0),"|",u(e.Indentation||0),"|",u(e.BackgroundColor),"|",s(e.Gradient),"|",c(e.IsUnlocked),"|",c(e.IsHidden),"|",u(e.NamedStyleId||0),"|",u(e.PatternStyle),"|",u(e.PatternColor),"|"].join("")}function i(e){return[c(e.Bold),"|",c(e.Italic),"|",c(e.StrikeThrough),"|",u(e.FontName),"|",u(e.Size),"|",u(e.Color),"|",u(e.Underline),"|",u(e.VerticalAlign),"|",u(e.FontScheme),"|"].join("")}function l(e){const t=[c(e.HasDiagBorder),"|"];for(let o=0;o<(null===(n=e.Borders)||void 0===n?void 0:n.length);o++){var n;const r=e.Borders[o];r&&t.push(a(r),"|")}return t.join("")}function a(e){return[u(e.BorderLineStyle),"|",u(e.BorderPosition),"|",u(e.Weight),"|",(t=e.Color,[u(t.Red),"|",u(t.Green),"|",u(t.Blue)].join(""))].join("");var t}function s(e){if(!e)return"0";const t=[u(e.ShadingStyle)];for(let o=0;o<(null===(n=e.Stops)||void 0===n?void 0:n.length);o++){var n;const r=e.Stops[o];r&&t.push("|",d(r))}return t.join("")}function d(e){return[u(e.Color),"|",u(e.Position)].join("")}function c(e){return e?"1":"0"}function u(e){return e?e.toString():"0"}t.generateKeyFromModelStyles=function(e,t){if(!t)return"0";switch(e){case o.StyleType.CellStyle:return r(t);case o.StyleType.BorderStyle:return l(t);case o.StyleType.Font:return i(t);default:return""}},t.generateKeyFromCellStyle=r,t.generateKeyFromFont=i,t.generateKeyFromBorderStyle=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultCellStyle=t.DefaultCellStyleID=t.DefaultGridFont=t.DefaultGlobalBorderID=t.DefaultGlobalFontID=t.DefaultGlobalStyleID=void 0,t.DefaultGlobalStyleID=0,t.DefaultGlobalFontID=0,t.DefaultGlobalBorderID=0,t.DefaultGridFont={Color:"#000000",FontName:"Calibri",FontScheme:2,Size:11,Underline:0,VerticalAlign:0},t.DefaultCellStyleID=0,t.DefaultCellStyle={VerticalAlignment:2,GlobalFontID:0,ID:-1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderIncludeLists=t.SerializationClasses=t.SerializationPropertyKey=t.SerializationProperties=t.UserContentList=t.propertyToClassMap=t.propertyNameToTypeMap=t.propertyLists=t.ignoreCaseLists=t.comparisonIgnoreLists=void 0,t.comparisonIgnoreLists={},t.comparisonIgnoreLists.GridBlockModel=["ColMetadata","FixedColumns","IsBitwiseFixedRows","RowOutlines","ColumnOutlines","RowOutlinesInformation","ColumnOutlinesInformation","MaxRowOutlineLevelInSheet","MaxColOutlineLevelInSheet","UniqueId","ShowHeaders","IsRow","Styles","Fonts","BorderStyles","CellsEncoding","RenderFlagsArray","HandleFlagsMismatch","AllRichValueFields","ClientOnlyCache","AdjacentBlocksHiddensInfo","RichValueTypes","IsCanvasHeadersSupported","HeadersFallbackReason","HasTable","HasOutline","IsEmptyBlocksSupported","EmptyBlocksFallbackReasonBitFlag","AreStylesProcessed"],t.comparisonIgnoreLists.Cell=["StyleID","GlobalCellStyleID","Ifmt","IfmtStamped","BorderStyleID","GlobalBorderStyleID","HorizontalAlignmentSet","Spill","ShrunkSize","RichValueType","RichValueFieldsIndexes","DynamicArrayInfo","ValueType","SrvDx","SrvDy","TolType","BitwiseBorderPosition","IsCellSnapped","CachedDrawingLayout","CachedDisplayText","CachedDisplayTextRuns","CachedIsTextWidthExceedsCellWidth","CachedIndent","DisplayFormula","PreviewText","PreviewNumFmt","PreviewCellStyle","RetainTextOnPreview","ShowSkeleton","Value","UserInput","PhoneticInfo","OriginalText","ErrorTooltip"],t.comparisonIgnoreLists.HeaderCell=["ShowResizePill","ResizePillLocation","InsertButtons","IsHovered","DataCleansingIcon"],t.comparisonIgnoreLists.InsertButtons=["Start","End"],t.comparisonIgnoreLists.InsertButton=["Type","Offset"],t.comparisonIgnoreLists.AutoFilter=["Menu","CommandData"],t.comparisonIgnoreLists.PivotFilter=["IsPivotPageField","CommandData","IsHeaderSnapped"],t.comparisonIgnoreLists.ReferencedObject=["ID","RefCount","GlobalId"],t.comparisonIgnoreLists.CellStyle=["IsPattern","NamedStyleId","FontID","GlobalFontID","IsUnlocked","IsHidden"],t.comparisonIgnoreLists.SpillInformation=["IsSpillingOutsideOfBlock"],t.comparisonIgnoreLists.FormulaInformation=["Formula","FormulaType","IsArrayRoot"],t.comparisonIgnoreLists.DynamicArrayInformation=["IsAnchor","Range"],t.comparisonIgnoreLists.MergeInformation=["IsOrigin","WidthAdjustedForDrawing","HeightAdjustedForDrawing","OriginDeltaXAdjustedForDrawing","OriginDeltaYAdjustedForDrawing","SpansNextBlockVertically","SpansNextBlockHorizontally"],t.comparisonIgnoreLists.BorderStyle=["HasDiagBorder"],t.comparisonIgnoreLists.Font=["FontScheme"],t.comparisonIgnoreLists.TextRun=["FontID","GlobalFontID","EndIndex","IsSpecialCharTextRun"],t.comparisonIgnoreLists.RangeInformation=["RangeType"],t.comparisonIgnoreLists.PivotTableRangeInformation=["ConnectionName","ConfirmationRequiredForDataOps","FieldListVersion","FieldWellVersion","ColumnTotalIndexes","RowTotalIndexes","ColumnMemberPropIndexes","RowMemberPropIndexes","ColumnHeaderRange","RowHeaderRange","RowAreaCaptions","ExternalSourceIndex","IsActionable","IsOlap","SupportsBIExplore","Xluid","ShowDrillIndicators","ShowColumnStripes","ShowRowStripes","ShowRowHeaders","ShowColumnHeaders","DataSource","RowLocation","ColGrandTotalOn","RwGrandTotalOn","IndentIncrement","AutoFormatOnUpdate","ShowItemsWithNoDataOnRw","ShowItemsWithNoDataOnCol","SaveSourceDataWithFile","RefreshOnLoad","AltText","AltTextSummary","ErrorString","NullString","DataPivotFieldCaption","DataPivotFieldIndex","DisplayErrorString","DisplayNullString","HasActiveFilter","IsPageArea","RowAreaFields","ColumnAreaFields","ValueAreaFields","PageAreaFields","CurrentStyleName","StyleIndex","IsRefreshableTabularOlap","SlicerConnections","AutoRefresh","SupportsAutoRefresh","OriginPTWidthAdjustedForDrawing","OriginPTHeightAdjustedForDrawing","DeltaXFromOriginPTAdjustedForDrawing","DeltaYFromOriginPTAdjustedForDrawing"],t.comparisonIgnoreLists.Hyperlink=["IsHyperlinkChecked"],t.comparisonIgnoreLists.DynamicImageInformation=["AltText"],t.comparisonIgnoreLists.Sparklines=["Ranges"],t.comparisonIgnoreLists.LinkedEntityInformation=["Domain"],t.comparisonIgnoreLists.PivotTableCellInformation=["ShouldShowExpandCollapseMenu","SourceIndex","ConfirmRequired","CanShowDetails"],t.ignoreCaseLists={},t.ignoreCaseLists.Font=["Color"],t.propertyLists={},t.propertyLists.GridBlockModel=["BlockWidth","BlockHeight","RowOffsets","ColumnOffsets","RowHeights","ColumnWidths","RowNumbers","ColumnNumbers","ColMetadata","FixedColumns","IsBitwiseFixedRows","RowOutlines","ColumnOutlines","RowOutlinesInformation","ColumnOutlinesInformation","MaxRowOutlineLevelInSheet","MaxColOutlineLevelInSheet","UniqueId","ShowGridLines","ShowHeaders","IsRtl","IsRow","PermissionSet","GridLineColor","BackgroundColor","Cells","Styles","Fonts","BorderStyles","CellsEncoding","RenderFlagsArray","HandleFlagsMismatch","PageBreaks","PrintAreas","PivotTables","Sparklines","InCellImages","AllRichValueFields","RibbonCommands","AdjacentBlocksHiddensInfo","RichValueTypes","IsCanvasHeadersSupported","HeadersFallbackReason","HasTable","HasOutline","IsEmptyBlocksSupported","EmptyBlocksFallbackReasonBitFlag"],t.propertyLists.Cell=["Col","Row","Text","StyleID","Ifmt","IfmtStamped","BorderStyleID","HorizontalAlignmentSet","Spill","Merge","NumFmt","WrapText","AutoFilter","PivotFilter","TextRuns","CondFormat","PhonInfo","Comment","RichValueType","RichValueFieldsIndexes","FormulaInfo","DynamicArrayInfo","ValueType","HasError","Hyperlink","Sparkline","InCellImage","LinkedEntity","RichValueIcon","PivotTable","HasIgnorableError","SrvDx","SrvDy","TolType","TableColHeader","TableRowHeader","InCellControlOptions","BitwiseBorderPosition","Value","PhoneticInfo","OriginalText","ErrorTooltip"],t.propertyLists.AutoFilter=["Type","Title","Menu","RenderingContext","CommandData"],t.propertyLists.ShowAutoFilterMenuCommandData=["MenuId","Cell","IsHeaderSnapped"],t.propertyLists.PivotFilter=["Type","DisplayFilter","IsPivotPageField","CommandData","Title","IsHeaderSnapped"],t.propertyLists.ConditionalFormattingInformation=["Icon","DataBar"],t.propertyLists.ConditionalFormattingIcon=["Set","Index","IconOnly","CFIconHorizontalAlignment"],t.propertyLists.DataBarInformation=["AxisPostion","AxisColor","Length","Color","GradientColor","BorderColor","Direction"],t.propertyLists.PhoneticInformation=["Text","PhoneticTextRuns"],t.propertyLists.WrapTextInformation=["BreakOp"],t.propertyLists.AutoFilterMenu=["Id","Sections"],t.propertyLists.AutoFilterRenderingContext=["IsRenderingPermitted","IsHeaderSnapped","IsHidden"],t.propertyLists.MenuSection=["Id","MenuItems","Title","DisplayType"],t.propertyLists.MenuItem=["Disabled","Type","Identifier","RibbonCommand","CommandData","Label","SubMenu","IsChecked","IconName","Id","TooltipText"],t.propertyLists.ReferencedObject=["ID","RefCount"],t.propertyLists.CellStyle=["HorizontalAlignment","VerticalAlignment","BackgroundColor","Gradient","IsPattern","Indentation","ReadingOrder","ShrinkToFit","NamedStyleId","FontID","IsUnlocked","IsHidden","VerticalText","Orientation","PatternStyle","PatternColor"],t.propertyLists.SpillInformation=["SpanToEnd","SpanToStart","IsSpillBlocked"],t.propertyLists.FormulaInformation=["Formula","FormulaType","IsArrayRoot"],t.propertyLists.DynamicArrayInformation=["IsAnchor","Range"],t.propertyLists.MergeInformation=["Columns","Rows","IsOrigin","OriginRow","OriginColumn","SpansBlocks","Width","Height","OriginDeltaX","OriginDeltaY"],t.propertyLists.NumberFormatInformation=["Start","End","Separator"],t.propertyLists.InCellControlOptions=["Type"],t.propertyLists.BorderStyle=["Borders","HasDiagBorder"],t.propertyLists.Border=["BorderLineStyle","BorderPosition","Weight","Color"],t.propertyLists.RGBColor=["Red","Green","Blue"],t.propertyLists.FormattedText=["Text","TextRuns","Fonts"],t.propertyLists.PhoneticRun=["BaseStartIndex","PhoneticStartIndex","BaseTextLength","PhoneticLength"],t.propertyLists.Font=["Size","FontName","FontScheme","Color","Bold","Italic","StrikeThrough","VerticalAlign","Underline"],t.propertyLists.TextRun=["FontID","StartIndex"],t.propertyLists.ColorScheme=["BackgroundColor","LinkColor","TextColor"],t.propertyLists.GradientFill=["Stops","ShadingStyle"],t.propertyLists.ColorStop=["Color","Position"],t.propertyLists.PageBreaksInformation=["Row","Col"],t.propertyLists.RowColBreak=["Index","Min","Max"],t.propertyLists.SharedRange=["FirstRow","FirstColumn","LastRow","LastColumn"],t.propertyLists.RangeInformation=["RangeType"],t.propertyLists.PivotTableRangeInformation=["ConnectionName","PivotTableName","ConfirmationRequiredForDataOps","FieldListVersion","FieldWellVersion","ColumnTotalIndexes","RowTotalIndexes","ColumnMemberPropIndexes","RowMemberPropIndexes","OriginPTWidth","OriginPTHeight","DeltaXFromOriginPT","DeltaYFromOriginPT","ColumnHeaderRange","RowHeaderRange","RowAreaCaptions","ExternalSourceIndex","IsActionable","IsOlap","SupportsBIExplore","HideGridLines","IsEmptyPivot","Xluid","ShowDrillIndicators","ShowColumnStripes","ShowRowStripes","ShowRowHeaders","ShowColumnHeaders","DataSource","RowLocation","ColGrandTotalOn","RwGrandTotalOn","IndentIncrement","AutoFormatOnUpdate","ShowItemsWithNoDataOnRw","ShowItemsWithNoDataOnCol","SaveSourceDataWithFile","RefreshOnLoad","AltText","AltTextSummary","ErrorString","NullString","DataPivotFieldCaption","DataPivotFieldIndex","DisplayErrorString","DisplayNullString","HasActiveFilter","IsPageArea","RowAreaFields","ColumnAreaFields","ValueAreaFields","PageAreaFields","CurrentStyleName","FirstRowIndex","FirstColIndex","LastRowIndex","LastColIndex","StyleIndex","IsRefreshableTabularOlap","SlicerConnections","AutoRefresh","SupportsAutoRefresh"],t.propertyLists.PivotTableFieldInfo=["Index","Caption","ShowBlankLineAfterEachItem","ShowSubtotal","RepeatItemLabels","ShowItemsWithNoData","ShowSubtotalAtTop","IsCompactLayout","BaseFieldIndex","DataFieldAggregationType","DataFieldFormatType","SortInfo","LabelOrDateFilterType","ValueFilterType","MeasureType","HasManualFilter","IsDateField","IsImplicitMeasure","IsNumeric"],t.propertyLists.Hyperlink=["Text","IsValidHyperlink","IsHyperlinkFormula","IsHyperlinkExternal","IsHyperlinkChecked","Tooltip","InternalLink"],t.propertyLists.Outline=["StartIndex","ButtonIndex","IsExpanded","IsButtonHidden","IsNonDefaultDirection","ECTitle"],t.propertyLists.OutlinesLevel=["Outlines"],t.propertyLists.InternalLink=["ObjectName","SheetName"],t.propertyLists.DynamicImages=["ImageUrl","Version"],t.propertyLists.DynamicImageInformation=["ClusterOffsetY","ClusterOffsetX","AltText","Height","Width","ClusterImageHeight","ClusterImageWidth"],t.propertyLists.Sparklines=["Ranges"],t.propertyLists.SparklineRangeInformation=["LocationRow","LocationColumn","SparklineType"],t.propertyLists.LinkedEntityInformation=["Domain","IconWidth"],t.propertyLists.RichValueIconInformation=["Width","Type","Unicode"],t.propertyLists.LinkedEntityServiceDomainId=["Id","StringId"],t.propertyLists.RichValueField=["Value","Index","RefersToDotFunction"],t.propertyLists.PivotTableCellInformation=["HasExpandCollapseIndicator","IsExpanded","ECButtonTitle","ShouldShowExpandCollapseMenu","CanExpandCollapse","SourceIndex","ConfirmRequired","CanShowDetails"],t.propertyLists.SharedSheetCell=["SheetName","NamedObjectName","FirstRow","FirstColumn"],t.propertyLists.SharedSheetRange=["LastRow","LastColumn"],t.propertyLists.SharedSheetFilterRange=["FilteredColumns"],t.propertyLists.RibbonCommands=["ShowAutoFilterMenu","CardViewShowTemporaryDataCard","CardViewShowTemporaryErrorCard","CardViewHideTemporaryCard","CardViewShowDataCardOrDisambiguationPane","ToggleInCellControlCheckbox","DataCleansingShowTaskPane"],t.propertyLists.PermissionSet=["IsAutoFilterDisabled","IsSortDisabled"],t.propertyLists.CommentData=["Row","Column","IsThreadedComment","IsResolved"],t.propertyLists.ColMetadata=["SrvDx","Text","CellValueType","CellStyleId","Autofilter","ExpandColButton","CondWidthIcon","RichValueIcon","IconWidth","TextRuns"],t.propertyLists.PivotTableSlicerConnectionInfo=["Name","Caption","WorksheetName","Enabled"],t.propertyLists.AdjacentBlocksHiddensInfo=["IsFirstRowOfNextBlockHidden","IsFirstColOfNextBlockHidden","IsLastRowOfPrevBlockHidden","IsLastColOfPrevBlockHidden"],t.propertyLists.PreviewCellsSettings=["PreviewCellsRange","RetainCellTextOnPreview"],t.propertyNameToTypeMap={},t.propertyNameToTypeMap.ColMetadata="ColMetadata",t.propertyNameToTypeMap.RowOutlines="OutlineState",t.propertyNameToTypeMap.ColumnOutlines="OutlineState",t.propertyNameToTypeMap.RowOutlinesInformation="OutlinesLevel",t.propertyNameToTypeMap.ColumnOutlinesInformation="OutlinesLevel",t.propertyNameToTypeMap.PermissionSet="PermissionSet",t.propertyNameToTypeMap.Cells="Cell",t.propertyNameToTypeMap.Styles="CellStyle",t.propertyNameToTypeMap.Fonts="Font",t.propertyNameToTypeMap.BorderStyles="BorderStyle",t.propertyNameToTypeMap.PageBreaks="PageBreaksInformation",t.propertyNameToTypeMap.PrintAreas="SharedRange",t.propertyNameToTypeMap.PivotTables="PivotTableRangeInformation",t.propertyNameToTypeMap.Sparklines="Sparklines",t.propertyNameToTypeMap.InCellImages="InCellImages",t.propertyNameToTypeMap.AllRichValueFields="RichValueField",t.propertyNameToTypeMap.RibbonCommands="RibbonCommands",t.propertyNameToTypeMap.AdjacentBlocksHiddensInfo="AdjacentBlocksHiddensInfo",t.propertyNameToTypeMap.RichValueTypes="RichValueCellType",t.propertyNameToTypeMap.Spill="SpillInformation",t.propertyNameToTypeMap.Merge="MergeInformation",t.propertyNameToTypeMap.NumFmt="NumberFormatInformation",t.propertyNameToTypeMap.WrapText="WrapTextInformation",t.propertyNameToTypeMap.AutoFilter="AutoFilter",t.propertyNameToTypeMap.PivotFilter="PivotFilter",t.propertyNameToTypeMap.TextRuns="TextRun",t.propertyNameToTypeMap.CondFormat="ConditionalFormattingInformation",t.propertyNameToTypeMap.PhonInfo="PhoneticInformation",t.propertyNameToTypeMap.Comment="CommentData",t.propertyNameToTypeMap.RichValueType="RichValueCellType",t.propertyNameToTypeMap.FormulaInfo="FormulaInformation",t.propertyNameToTypeMap.DynamicArrayInfo="DynamicArrayInformation",t.propertyNameToTypeMap.ValueType="CellValueType",t.propertyNameToTypeMap.Hyperlink="Hyperlink",t.propertyNameToTypeMap.Sparkline="SparklineInformation",t.propertyNameToTypeMap.InCellImage="InCellImageInformation",t.propertyNameToTypeMap.LinkedEntity="LinkedEntityInformation",t.propertyNameToTypeMap.RichValueIcon="RichValueIconInformation",t.propertyNameToTypeMap.PivotTable="PivotTableCellInformation",t.propertyNameToTypeMap.TolType="TolType",t.propertyNameToTypeMap.InCellControlOptions="InCellControlOptions",t.propertyNameToTypeMap.Type="RichValueIconType",t.propertyNameToTypeMap.Menu="AutoFilterMenu",t.propertyNameToTypeMap.RenderingContext="AutoFilterRenderingContext",t.propertyNameToTypeMap.Cell="SharedSheetCell",t.propertyNameToTypeMap.Icon="ConditionalFormattingIcon",t.propertyNameToTypeMap.DataBar="DataBarInformation",t.propertyNameToTypeMap.Set="CFIconSet",t.propertyNameToTypeMap.CFIconHorizontalAlignment="HorizontalAlignment",t.propertyNameToTypeMap.Direction="ReadingOrderType",t.propertyNameToTypeMap.PhoneticTextRuns="PhoneticRun",t.propertyNameToTypeMap.Sections="MenuSection",t.propertyNameToTypeMap.MenuItems="MenuItem",t.propertyNameToTypeMap.DisplayType="MenuDisplayType",t.propertyNameToTypeMap.Identifier="MenuEntryIdentifier",t.propertyNameToTypeMap.SubMenu="AutoFilterMenu",t.propertyNameToTypeMap.HorizontalAlignment="HorizontalAlignment",t.propertyNameToTypeMap.VerticalAlignment="VerticalAlignment",t.propertyNameToTypeMap.Gradient="GradientFill",t.propertyNameToTypeMap.ReadingOrder="ReadingOrderType",t.propertyNameToTypeMap.PatternStyle="PatternStyleType",t.propertyNameToTypeMap.FormulaType="CellFormulaType",t.propertyNameToTypeMap.Range="SharedRange",t.propertyNameToTypeMap.Borders="Border",t.propertyNameToTypeMap.BorderLineStyle="BorderLineType",t.propertyNameToTypeMap.BorderPosition="BorderPositionType",t.propertyNameToTypeMap.Color="RGBColor",t.propertyNameToTypeMap.FontScheme="FontSchemeOption",t.propertyNameToTypeMap.VerticalAlign="FontVerticalAlignment",t.propertyNameToTypeMap.Underline="FontUnderline",t.propertyNameToTypeMap.Stops="ColorStop",t.propertyNameToTypeMap.ShadingStyle="GradientShadingStyle",t.propertyNameToTypeMap.Row="RowColBreak",t.propertyNameToTypeMap.Col="RowColBreak",t.propertyNameToTypeMap.RangeType="RangeType",t.propertyNameToTypeMap.ColumnHeaderRange="RangeInformation",t.propertyNameToTypeMap.RowHeaderRange="RangeInformation",t.propertyNameToTypeMap.RowAreaFields="PivotTableFieldInfo",t.propertyNameToTypeMap.ColumnAreaFields="PivotTableFieldInfo",t.propertyNameToTypeMap.ValueAreaFields="PivotTableFieldInfo",t.propertyNameToTypeMap.PageAreaFields="PivotTableFieldInfo",t.propertyNameToTypeMap.SlicerConnections="PivotTableSlicerConnectionInfo",t.propertyNameToTypeMap.DataFieldAggregationType="PivotTableDataFieldAggregationType",t.propertyNameToTypeMap.DataFieldFormatType="PivotTableDataFieldFormatType",t.propertyNameToTypeMap.SortInfo="PivotSortInfo",t.propertyNameToTypeMap.LabelOrDateFilterType="PivotFilterType",t.propertyNameToTypeMap.ValueFilterType="PivotFilterType",t.propertyNameToTypeMap.MeasureType="PivotMeasureType",t.propertyNameToTypeMap.InternalLink="InternalLink",t.propertyNameToTypeMap.Outlines="Outline",t.propertyNameToTypeMap.Ranges="SparklineRangeInformation",t.propertyNameToTypeMap.SparklineType="SparklineType",t.propertyNameToTypeMap.Domain="LinkedEntityServiceDomainId",t.propertyNameToTypeMap.CellValueType="CellValueType",t.propertyNameToTypeMap.PreviewCellsRange="SharedRange",t.propertyToClassMap={},t.propertyToClassMap.ColMetadata=["ColMetadata"],t.propertyToClassMap.RowOutlinesInformation=["OutlinesLevel"],t.propertyToClassMap.ColumnOutlinesInformation=["OutlinesLevel"],t.propertyToClassMap.PermissionSet=["PermissionSet"],t.propertyToClassMap.Cells=["Cell"],t.propertyToClassMap.Styles=["CellStyle","ReferencedObject"],t.propertyToClassMap.Fonts=["Font","ReferencedObject"],t.propertyToClassMap.BorderStyles=["BorderStyle","ReferencedObject"],t.propertyToClassMap.PageBreaks=["PageBreaksInformation"],t.propertyToClassMap.PrintAreas=["SharedRange"],t.propertyToClassMap.PivotTables=["PivotTableRangeInformation","RangeInformation","SharedRange"],t.propertyToClassMap.Sparklines=["Sparklines","DynamicImages"],t.propertyToClassMap.InCellImages=["InCellImages","DynamicImages"],t.propertyToClassMap.AllRichValueFields=["RichValueField"],t.propertyToClassMap.RibbonCommands=["RibbonCommands"],t.propertyToClassMap.AdjacentBlocksHiddensInfo=["AdjacentBlocksHiddensInfo"],t.propertyToClassMap.Spill=["SpillInformation"],t.propertyToClassMap.Merge=["MergeInformation"],t.propertyToClassMap.NumFmt=["NumberFormatInformation"],t.propertyToClassMap.WrapText=["WrapTextInformation"],t.propertyToClassMap.AutoFilter=["AutoFilter"],t.propertyToClassMap.PivotFilter=["PivotFilter"],t.propertyToClassMap.TextRuns=["TextRun"],t.propertyToClassMap.CondFormat=["ConditionalFormattingInformation"],t.propertyToClassMap.PhonInfo=["PhoneticInformation"],t.propertyToClassMap.Comment=["CommentData"],t.propertyToClassMap.FormulaInfo=["FormulaInformation"],t.propertyToClassMap.DynamicArrayInfo=["DynamicArrayInformation"],t.propertyToClassMap.Hyperlink=["Hyperlink"],t.propertyToClassMap.Sparkline=["SparklineInformation","DynamicImageInformation"],t.propertyToClassMap.InCellImage=["InCellImageInformation","DynamicImageInformation"],t.propertyToClassMap.LinkedEntity=["LinkedEntityInformation"],t.propertyToClassMap.RichValueIcon=["RichValueIconInformation"],t.propertyToClassMap.PivotTable=["PivotTableCellInformation"],t.propertyToClassMap.InCellControlOptions=["InCellControlOptions"],t.propertyToClassMap.CachedStyle=["CellStyle","ReferencedObject"],t.propertyToClassMap.CachedFont=["Font","ReferencedObject"],t.propertyToClassMap.CachedBorderStyle=["BorderStyle","ReferencedObject"],t.propertyToClassMap.CachedDisplayTextRuns=["TextRun"],t.propertyToClassMap.PreviewNumFmt=["NumberFormatInformation"],t.propertyToClassMap.PreviewCellStyle=["CellStyle","ReferencedObject"],t.propertyToClassMap.InsertButtons=["InsertButtons"],t.propertyToClassMap.Start=["InsertButton"],t.propertyToClassMap.End=["InsertButton"],t.propertyToClassMap.Menu=["AutoFilterMenu"],t.propertyToClassMap.RenderingContext=["AutoFilterRenderingContext"],t.propertyToClassMap.Cell=["SharedSheetCell"],t.propertyToClassMap.Icon=["ConditionalFormattingIcon"],t.propertyToClassMap.DataBar=["DataBarInformation"],t.propertyToClassMap.PhoneticTextRuns=["PhoneticRun"],t.propertyToClassMap.Sections=["MenuSection"],t.propertyToClassMap.MenuItems=["MenuItem"],t.propertyToClassMap.SubMenu=["AutoFilterMenu"],t.propertyToClassMap.Gradient=["GradientFill"],t.propertyToClassMap.Range=["SharedRange"],t.propertyToClassMap.Borders=["Border"],t.propertyToClassMap.Color=["RGBColor"],t.propertyToClassMap.Stops=["ColorStop"],t.propertyToClassMap.Row=["RowColBreak"],t.propertyToClassMap.Col=["RowColBreak"],t.propertyToClassMap.ColumnHeaderRange=["RangeInformation","SharedRange"],t.propertyToClassMap.RowHeaderRange=["RangeInformation","SharedRange"],t.propertyToClassMap.RowAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.ColumnAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.ValueAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.PageAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.SlicerConnections=["PivotTableSlicerConnectionInfo"],t.propertyToClassMap.InternalLink=["InternalLink","SharedRange"],t.propertyToClassMap.Outlines=["Outline"],t.propertyToClassMap.Ranges=["SparklineRangeInformation","RangeInformation","SharedRange"],t.propertyToClassMap.Domain=["LinkedEntityServiceDomainId"],t.propertyToClassMap.CachedFormattedText=["FormattedText"],t.propertyToClassMap.PreviewCellsRange=["SharedRange"],t.UserContentList={},t.UserContentList.Cell=["Text","CachedDisplayText","PreviewText","Value","UserInput","OriginalText"],t.UserContentList.AutoFilter=["CommandData"],t.UserContentList.PivotFilter=["CommandData"],t.UserContentList.PhoneticInformation=["Text"],t.UserContentList.MenuItem=["CommandData","Label"],t.UserContentList.FormulaInformation=["Formula"],t.UserContentList.NumberFormatInformation=["Start","End","Separator"],t.UserContentList.FormattedText=["Text"],t.UserContentList.Font=["FontName"],t.UserContentList.PivotTableFieldInfo=["Caption"],t.UserContentList.Hyperlink=["Text","Tooltip"],t.UserContentList.InternalLink=["ObjectName","SheetName"],t.UserContentList.DynamicImages=["ImageUrl"],t.UserContentList.SharedSheetCell=["SheetName"],t.UserContentList.ColMetadata=["Text"],t.SerializationProperties={},t.SerializationPropertyKey="{className}.{propertyName}",t.SerializationProperties["GridBlockModel.BlockWidth"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.BlockHeight"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowOffsets"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnOffsets"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowHeights"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnWidths"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowNumbers"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnNumbers"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColMetadata"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.FixedColumns"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.IsBitwiseFixedRows"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowOutlines"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnOutlines"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowOutlinesInformation"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnOutlinesInformation"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.MaxRowOutlineLevelInSheet"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.MaxColOutlineLevelInSheet"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.UniqueId"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ShowGridLines"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ShowHeaders"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.IsRtl"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.IsRow"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.PermissionSet"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.GridLineColor"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.BackgroundColor"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.Cells"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.Styles"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.Fonts"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.BorderStyles"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.CellsEncoding"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RenderFlagsArray"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.HandleFlagsMismatch"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.PageBreaks"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.PrintAreas"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.PivotTables"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.Sparklines"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.InCellImages"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.AllRichValueFields"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RibbonCommands"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ClientOnlyCache"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["GridBlockModel.AdjacentBlocksHiddensInfo"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RichValueTypes"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.IsCanvasHeadersSupported"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.HeadersFallbackReason"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.HasTable"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.HasOutline"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.IsEmptyBlocksSupported"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.EmptyBlocksFallbackReasonBitFlag"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.AreStylesProcessed"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.Col"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Row"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Text"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.StyleID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.GlobalCellStyleID"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Cell.Ifmt"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.IfmtStamped"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.BorderStyleID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.GlobalBorderStyleID"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Cell.HorizontalAlignmentSet"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Spill"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Merge"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.NumFmt"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.WrapText"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.ShrunkSize"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Cell.AutoFilter"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.PivotFilter"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.TextRuns"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.CondFormat"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.PhonInfo"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Comment"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.RichValueType"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.RichValueFieldsIndexes"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.FormulaInfo"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.DynamicArrayInfo"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.ValueType"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.HasError"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Hyperlink"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Sparkline"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.InCellImage"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.LinkedEntity"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.RichValueIcon"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.PivotTable"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.HasIgnorableError"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.SrvDx"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Cell.SrvDy"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Cell.TolType"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.TableColHeader"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.TableRowHeader"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.InCellControlOptions"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.BitwiseBorderPosition"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.CachedStyle"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedFont"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedBorderStyle"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.IsCellSnapped"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedDrawingLayout"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedDisplayText"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedDisplayTextRuns"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedIsTextWidthExceedsCellWidth"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedIndent"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.DisplayFormula"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.PreviewText"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.PreviewNumFmt"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.PreviewCellStyle"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.RetainTextOnPreview"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.ShowSkeleton"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.Value"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.UserInput"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.PhoneticInfo"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.OriginalText"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.ErrorTooltip"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.HorizontalAlignment"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.VerticalAlignment"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.BackgroundColor"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.Gradient"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.IsPattern"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.Indentation"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.ReadingOrder"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.ShrinkToFit"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.NamedStyleId"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.FontID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.GlobalFontID"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["CellStyle.IsUnlocked"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.IsHidden"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.VerticalText"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.Orientation"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.PatternStyle"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.PatternColor"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.ID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.RefCount"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.GlobalId"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["BorderStyle.Borders"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["BorderStyle.HasDiagBorder"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["BorderStyle.ID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["BorderStyle.RefCount"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["BorderStyle.GlobalId"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Font.Size"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.FontName"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Font.FontScheme"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.Color"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Font.Bold"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Font.Italic"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Font.StrikeThrough"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Font.VerticalAlign"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.Underline"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.ID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.RefCount"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.GlobalId"]={type:"number",ignoreOnSerialize:!0},t.SerializationClasses={},t.SerializationClasses.Cell="Cells",t.SerializationClasses.CellStyle="Styles",t.SerializationClasses.Font="Fonts",t.SerializationClasses.BorderStyle="BorderStyles",t.HeaderIncludeLists={},t.HeaderIncludeLists.GridBlockModel=["BlockWidth","BlockHeight","RowOffsets","ColumnOffsets","RowHeights","ColumnWidths","RowNumbers","ColumnNumbers","RowOutlinesInformation","ColumnOutlinesInformation","MaxRowOutlineLevelInSheet","MaxColOutlineLevelInSheet","ShowHeaders","IsRtl","AdjacentBlocksHiddensInfo","IsCanvasHeadersSupported","HasTable","HasOutline"],t.HeaderIncludeLists.Cell=["Col","Row","Text","CachedStyle","CachedFont"],t.HeaderIncludeLists.HeaderCell=["InsertButtons"],t.HeaderIncludeLists.InsertButtons=["Start","End"],t.HeaderIncludeLists.InsertButton=["Type","Offset"],t.HeaderIncludeLists.CellStyle=["BackgroundColor"],t.HeaderIncludeLists.Font=["Color"],t.HeaderIncludeLists.Outline=["StartIndex","ButtonIndex","IsExpanded","IsButtonHidden","IsNonDefaultDirection"],t.HeaderIncludeLists.OutlinesLevel=["Outlines"],t.HeaderIncludeLists.AdjacentBlocksHiddensInfo=["IsFirstRowOfNextBlockHidden","IsFirstColOfNextBlockHidden","IsLastRowOfPrevBlockHidden","IsLastColOfPrevBlockHidden"]},function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.recalculateFontMetrics=t.getCachedFontMetrics=void 0;const r=n(13),i=n(8),l=n(46),a=n(37),s=n(0),d=n(56);let c=!0;const u=document.createElement("div"),g=document.createElement("img"),h=document.createElement("img");u.innerText=".",u.style.visibility="hidden",g.style.height="0px",h.style.height="0px",u.appendChild(g),u.appendChild(h),null!==(o=document)&&void 0!==o&&o.body&&document.body.appendChild(u);let C={"6pt arial":{fontSize:6,fontMetrics:{height:9,baseline:2,middle:4.072916}},"7pt arial":{fontSize:7,fontMetrics:{height:11,baseline:2,middle:4.416666698}},"8pt arial":{fontSize:8,fontMetrics:{height:12,baseline:2.666666030883789,middle:4.765625}},"9pt arial":{fontSize:9,fontMetrics:{height:14,baseline:3.33333,middle:6.109375}},"10pt arial":{fontSize:10,fontMetrics:{height:15,baseline:3.6666666,middle:6.453125}},"11pt arial":{fontSize:11,fontMetrics:{height:16,baseline:4,middle:6.796875}},"12pt arial":{fontSize:12,fontMetrics:{height:19,baseline:4.33333333,middle:8.15625}},"13pt arial":{fontSize:13,fontMetrics:{height:21,baseline:4.6666666679,middle:9.15625}},"14pt arial":{fontSize:14,fontMetrics:{height:22,baseline:4.666666030883789,middle:9.84375}},"16pt arial":{fontSize:16,fontMetrics:{height:25,baseline:5.33333333,middle:11.53125}},"18pt arial":{fontSize:18,fontMetrics:{height:28,baseline:5.66666666,middle:12.21875}},"20pt arial":{fontSize:20,fontMetrics:{height:30,baseline:6,middle:12.9166666}},"22pt arial":{fontSize:22,fontMetrics:{height:34,baseline:6.666667938232422,middle:14.609375}},"24pt arial":{fontSize:24,fontMetrics:{height:37,baseline:7.333333,middle:15.63541}},"25pt arial":{fontSize:25,fontMetrics:{height:39,baseline:8,middle:16.6458339}},"26pt arial":{fontSize:26,fontMetrics:{height:40,baseline:8,middle:16.984375}},"28pt arial":{fontSize:28,fontMetrics:{height:43,baseline:8.6666666,middle:18.3437}},"36pt arial":{fontSize:36,fontMetrics:{height:55,baseline:10.666667938232422,middle:23.453125}},"20pt arial black":{fontSize:20,fontMetrics:{height:37,baseline:8,middle:14.90625}},"16pt browallia new":{fontSize:16,fontMetrics:{height:27,baseline:8,middle:11.6145839}},"1pt calibri":{fontSize:1,fontMetrics:{height:1,baseline:0,middle:.3125}},"2pt calibri":{fontSize:2,fontMetrics:{height:3,baseline:.7407407760620117,middle:1.3541667461395264}},"3pt calibri":{fontSize:3,fontMetrics:{height:4,baseline:.7407407760620117,middle:1.6666667461395264}},"4pt calibri":{fontSize:4,fontMetrics:{height:7,baseline:1.4814815521240234,middle:2.719907522201538}},"5pt calibri":{fontSize:5,fontMetrics:{height:8,baseline:1.4814815521240234,middle:3.032407760620117}},"6pt calibri":{fontSize:6,fontMetrics:{height:9,baseline:2,middle:3.8541669}},"7pt calibri":{fontSize:7,fontMetrics:{height:11,baseline:2.666666698,middle:4.8333333969}},"8pt calibri":{fontSize:8,fontMetrics:{height:13,baseline:2.6666669845581055,middle:5.46875}},"9pt calibri":{fontSize:9,fontMetrics:{height:15,baseline:3.3333330154418945,middle:5.78125}},"10pt calibri":{fontSize:10,fontMetrics:{height:17,baseline:3.3333330154418945,middle:7.09375}},"11pt calibri":{fontSize:11,fontMetrics:{height:18,baseline:4,middle:7.40625}},"12pt calibri":{fontSize:12,fontMetrics:{height:19,baseline:4,middle:7.71875}},"13pt calibri":{fontSize:13,fontMetrics:{height:21,baseline:4.6666666,middle:8.6875}},"14pt calibri":{fontSize:14,fontMetrics:{height:21,baseline:5.33333396911621,middle:9.328125}},"15pt calibri":{fontSize:15,fontMetrics:{height:23,baseline:5.6666666667,middle:9.640625}},"16pt calibri":{fontSize:16,fontMetrics:{height:26,baseline:6,middle:10.953125}},"17pt calibri":{fontSize:17,fontMetrics:{height:27,baseline:5.925926208496094,middle:11.192131042480469}},"18pt calibri":{fontSize:18,fontMetrics:{height:29,baseline:6.666666030883789,middle:11.578125}},"19pt calibri":{fontSize:19,fontMetrics:{height:31,baseline:6.666666030883789,middle:12.546297073364258}},"20pt calibri":{fontSize:20,fontMetrics:{height:32,baseline:7.333333969116211,middle:13.1875}},"21pt calibri":{fontSize:21,fontMetrics:{height:34,baseline:7.407405853271484,middle:13.91203498840332}},"22pt calibri":{fontSize:22,fontMetrics:{height:36,baseline:8,middle:14.8125}},"23pt calibri":{fontSize:23,fontMetrics:{height:37,baseline:8.148151397705078,middle:15.266206741333008}},"24pt calibri":{fontSize:24,fontMetrics:{height:39,baseline:8.666666793,middle:16.09375}},"25pt calibri":{fontSize:25,fontMetrics:{height:41,baseline:8.88888931274414,middle:16.63194465637207}},"26pt calibri":{fontSize:26,fontMetrics:{height:43,baseline:9.333333,middle:17.3854179}},"27pt calibri":{fontSize:27,fontMetrics:{height:44,baseline:9.629631042480469,middle:17.98611068725586}},"28pt calibri":{fontSize:28,fontMetrics:{height:45,baseline:10,middle:18.666666}},"29pt calibri":{fontSize:29,fontMetrics:{height:47,baseline:10.370368957519531,middle:19.351852416992188}},"30pt calibri":{fontSize:30,fontMetrics:{height:48,baseline:10.370372772216797,middle:19.652780532836914}},"31pt calibri":{fontSize:31,fontMetrics:{height:50,baseline:11.11111068725586,middle:20.70602035522461}},"32pt calibri":{fontSize:32,fontMetrics:{height:52,baseline:11.11111068725586,middle:21.018518447875977}},"33pt calibri":{fontSize:33,fontMetrics:{height:54,baseline:11.851852416992188,middle:22.06018829345703}},"34pt calibri":{fontSize:34,fontMetrics:{height:55,baseline:11.851852416992188,middle:22.37268829345703}},"35pt calibri":{fontSize:35,fontMetrics:{height:57,baseline:12.592594146728516,middle:23.425926208496094}},"36pt calibri":{fontSize:36,fontMetrics:{height:59,baseline:12.666666679,middle:24.140625}},"37pt calibri":{fontSize:37,fontMetrics:{height:60,baseline:13.333335876464844,middle:24.791667938232422}},"38pt calibri":{fontSize:38,fontMetrics:{height:61,baseline:13.333335876464844,middle:25.104167938232422}},"39pt calibri":{fontSize:39,fontMetrics:{height:64,baseline:14.444446563720703,middle:26.510421752929688}},"40pt calibri":{fontSize:40,fontMetrics:{height:65,baseline:14.074073791503906,middle:26.458335876464844}},"41pt calibri":{fontSize:41,fontMetrics:{height:67,baseline:14.444446563720703,middle:27.135421752929688}},"42pt calibri":{fontSize:42,fontMetrics:{height:68,baseline:14.814811706542969,middle:27.812496185302734}},"43pt calibri":{fontSize:43,fontMetrics:{height:70,baseline:15.555553436279297,middle:28.871524810791016}},"44pt calibri":{fontSize:44,fontMetrics:{height:71,baseline:15.555557250976562,middle:29.18402862548828}},"45pt calibri":{fontSize:45,fontMetrics:{height:73,baseline:16.296295166015625,middle:30.21990966796875}},"46pt calibri":{fontSize:46,fontMetrics:{height:76,baseline:16.666664123535156,middle:30.90277862548828}},"47pt calibri":{fontSize:47,fontMetrics:{height:77,baseline:16.666667938232422,middle:31.215282440185547}},"48pt calibri":{fontSize:48,fontMetrics:{height:72,baseline:17.333332061767578,middle:31.859375}},"49pt calibri":{fontSize:49,fontMetrics:{height:80,baseline:17.777774810791016,middle:32.951385498046875}},"50pt calibri":{fontSize:50,fontMetrics:{height:81,baseline:17.77777862548828,middle:33.24652862548828}},"51pt calibri":{fontSize:51,fontMetrics:{height:83,baseline:18.518516540527344,middle:34.30555725097656}},"52pt calibri":{fontSize:52,fontMetrics:{height:84,baseline:18.888893127441406,middle:34.982643127441406}},"53pt calibri":{fontSize:53,fontMetrics:{height:87,baseline:18.888893127441406,middle:35.295143127441406}},"54pt calibri":{fontSize:54,fontMetrics:{height:88,baseline:18.888885498046875,middle:35.607635498046875}},"55pt calibri":{fontSize:55,fontMetrics:{height:90,baseline:20,middle:37.02546310424805}},"56pt calibri":{fontSize:56,fontMetrics:{height:91,baseline:20,middle:37.32638931274414}},"57pt calibri":{fontSize:57,fontMetrics:{height:92,baseline:20,middle:37.638893127441406}},"58pt calibri":{fontSize:58,fontMetrics:{height:94,baseline:21.111114501953125,middle:39.062503814697266}},"59pt calibri":{fontSize:59,fontMetrics:{height:96,baseline:21.111106872558594,middle:39.375}},"60pt calibri":{fontSize:60,fontMetrics:{height:98,baseline:21.111114501953125,middle:39.687503814697266}},"61pt calibri":{fontSize:61,fontMetrics:{height:100,baseline:22.22222900390625,middle:41.111114501953125}},"62pt calibri":{fontSize:62,fontMetrics:{height:101,baseline:22.22222137451172,middle:41.40625}},"63pt calibri":{fontSize:63,fontMetrics:{height:102,baseline:22.22222900390625,middle:41.718753814697266}},"64pt calibri":{fontSize:64,fontMetrics:{height:104,baseline:23.333335876464844,middle:43.142364501953125}},"65pt calibri":{fontSize:65,fontMetrics:{height:106,baseline:23.3333328,middle:43.458332061}},"66pt calibri":{fontSize:66,fontMetrics:{height:107,baseline:23.333335876464844,middle:43.767364501953125}},"67pt calibri":{fontSize:67,fontMetrics:{height:110,baseline:24.44445037841797,middle:45.19097900390625}},"68pt calibri":{fontSize:68,fontMetrics:{height:111,baseline:24.444442749023438,middle:45.50347137451172}},"69pt calibri":{fontSize:69,fontMetrics:{height:112,baseline:24.44445037841797,middle:45.798614501953125}},"70pt calibri":{fontSize:70,fontMetrics:{height:114,baseline:25.555557250976562,middle:47.22222137451172}},"71pt calibri":{fontSize:71,fontMetrics:{height:116,baseline:25.55554962158203,middle:47.53472137451172}},"72pt calibri":{fontSize:72,fontMetrics:{height:117,baseline:25.925926208496094,middle:48.21759033203125}},"85pt calibri":{fontSize:85,fontMetrics:{height:138,baseline:30,middle:56.31945037841797}},"98pt calibri":{fontSize:98,fontMetrics:{height:160,baseline:35.55554962158203,middle:65.88541412353516}},"100pt calibri":{fontSize:100,fontMetrics:{height:162,baseline:35.55555725097656,middle:66.51620483398438}},"111pt calibri":{fontSize:111,fontMetrics:{height:181,baseline:40,middle:74.35763549804688}},"124pt calibri":{fontSize:124,fontMetrics:{height:202,baseline:44.44444274902344,middle:82.82986450195312}},"137pt calibri":{fontSize:137,fontMetrics:{height:223,baseline:48.888885498046875,middle:91.30209350585938}},"150pt calibri":{fontSize:150,fontMetrics:{height:243,baseline:53.33332824707031,middle:99.77430725097656}},"163pt calibri":{fontSize:163,fontMetrics:{height:266,baseline:58.88890075683594,middle:109.34028625488281}},"176pt calibri":{fontSize:176,fontMetrics:{height:287,baseline:63.333343505859375,middle:117.81251525878906}},"189pt calibri":{fontSize:189,fontMetrics:{height:308,baseline:67.77778625488281,middle:126.28474426269531}},"202pt calibri":{fontSize:202,fontMetrics:{height:329,baseline:72.22222900390625,middle:134.7569580078125}},"215pt calibri":{fontSize:215,fontMetrics:{height:350,baseline:76.66668701171875,middle:143.22918701171875}},"228pt calibri":{fontSize:228,fontMetrics:{height:371,baseline:81.11111450195312,middle:151.70138549804688}},"241pt calibri":{fontSize:241,fontMetrics:{height:392,baseline:86.66665649414062,middle:161.26736450195312}},"254pt calibri":{fontSize:254,fontMetrics:{height:413,baseline:91.11111450195312,middle:169.7395782470703}},"267pt calibri":{fontSize:267,fontMetrics:{height:434,baseline:95.5555419921875,middle:178.2117919921875}},"280pt calibri":{fontSize:280,fontMetrics:{height:456,baseline:100,middle:186.68402099609375}},"293pt calibri":{fontSize:293,fontMetrics:{height:477,baseline:104.4444580078125,middle:195.13888549804688}},"306pt calibri":{fontSize:306,fontMetrics:{height:499,baseline:110,middle:204.72222900390625}},"319pt calibri":{fontSize:319,fontMetrics:{height:519,baseline:114.4444580078125,middle:213.1944580078125}},"332pt calibri":{fontSize:332,fontMetrics:{height:540,baseline:118.88885498046875,middle:221.66665649414062}},"345pt calibri":{fontSize:345,fontMetrics:{height:561,baseline:123.33334350585938,middle:230.138916015625}},"358pt calibri":{fontSize:358,fontMetrics:{height:582,baseline:127.77777099609375,middle:238.61111450195312}},"371pt calibri":{fontSize:371,fontMetrics:{height:604,baseline:133.33331298828125,middle:248.17709350585938}},"384pt calibri":{fontSize:384,fontMetrics:{height:626,baseline:137.77780151367188,middle:256.6493225097656}},"397pt calibri":{fontSize:397,fontMetrics:{height:647,baseline:142.22222900390625,middle:265.12152099609375}},"409pt calibri":{fontSize:409,fontMetrics:{height:666,baseline:146.66668701171875,middle:273.2812805175781}},"12pt calibri light":{fontSize:12,fontMetrics:{height:19,baseline:4,middle:7.6979169845581055}},"14pt comic sans ms":{fontSize:14,fontMetrics:{height:26,baseline:5.3333332061,middle:10.03125}},"9pt georgia":{fontSize:9,fontMetrics:{height:14,baseline:3,middle:5.890625}},"8pt microsoft sans serif":{fontSize:8,fontMetrics:{height:12,baseline:2,middle:4.760416507720947}},"8pt meiryo ui":{fontSize:8,fontMetrics:{height:13,baseline:2,middle:4.9375}},"9pt meiryo ui":{fontSize:9,fontMetrics:{height:16,baseline:3,middle:6.3125}},"11pt meiryo ui":{fontSize:11,fontMetrics:{height:19,baseline:3,middle:7.046875}},"10pt segoe ui":{fontSize:10,fontMetrics:{height:18,baseline:3.3333330154418945,middle:6.666666030883789}},"6pt times new roman":{fontSize:6,fontMetrics:{height:10,baseline:2.666665,middle:4.45833301}},"7pt times new roman":{fontSize:7,fontMetrics:{height:11,baseline:2.666666698,middle:4.75}},"8pt times new roman":{fontSize:8,fontMetrics:{height:11,baseline:2.666666030883789,middle:4.390625}},"8.5pt times new roman":{fontSize:8.5,fontMetrics:{height:12,baseline:2.8888888888884,middle:4.53125}},"9pt times new roman":{fontSize:9,fontMetrics:{height:14,baseline:3,middle:6.6875}},"10pt times new roman":{fontSize:10,fontMetrics:{height:15,baseline:3.3333333,middle:6.984375}},"11pt times new roman":{fontSize:11,fontMetrics:{height:17,baseline:4,middle:7.28125}},"12pt times new roman":{fontSize:12,fontMetrics:{height:18,baseline:4.3333333,middle:7.578125}},"13pt times new roman":{fontSize:13,fontMetrics:{height:19,baseline:4.5,middle:8.875}},"14pt times new roman":{fontSize:14,fontMetrics:{height:22,baseline:4.666666030883789,middle:9.171875}},"15pt times new roman":{fontSize:15,fontMetrics:{height:23,baseline:4.6666667938,middle:9.13541793}},"16pt times new roman":{fontSize:16,fontMetrics:{height:25,baseline:5.333333,middle:10.765625}},"18pt times new roman":{fontSize:18,fontMetrics:{height:28,baseline:6,middle:11.375}},"19pt times new roman":{fontSize:19,fontMetrics:{height:29,baseline:6,middle:11.666666603}},"20pt times new roman":{fontSize:20,fontMetrics:{height:31,baseline:6.666666603,middle:12.635416}},"8pt tahoma":{fontSize:8,fontMetrics:{height:13,baseline:2,middle:4.90625}},"10pt tahoma":{fontSize:10,fontMetrics:{height:16,baseline:2.6666666,middle:6.30208301}},"11pt tahoma":{fontSize:11,fontMetrics:{height:18,baseline:3.3333333015,middle:7.333333015}},"12pt trebuchet ms":{fontSize:12,fontMetrics:{height:19,baseline:3.333333,middle:7.5208339691}},"14pt trebuchet ms":{fontSize:14,fontMetrics:{height:22,baseline:4,middle:8.875}},"8pt verdana":{fontSize:8,fontMetrics:{height:13,baseline:2,middle:4.90625}},"9pt verdana":{fontSize:9,fontMetrics:{height:15,baseline:3,middle:6.265625}},"10pt verdana":{fontSize:10,fontMetrics:{height:16,baseline:2.66666603,middle:6.302083015}},"14pt webdings":{fontSize:14,fontMetrics:{height:19,baseline:4.000000953674316,middle:8.666667938232422}},"36pt wingdings":{fontSize:36,fontMetrics:{height:53,baseline:10,middle:22.000001907348633}}};function f(e){let t=-1,n=-1,o=-1;const i=g,l=h;return u.style.font=e,i.style.verticalAlign="baseline",l.style.verticalAlign="middle",(0,r.trackDuration)(r.RenderPerformanceMetric.GetFontMetrics,()=>{t=u.clientHeight,n=m(i),o=m(l)},!0),{height:t,baseline:n,middle:o}}function m(e){if(!u||!e)throw Error(`getFontBaselineHeight: arguments cannot be null or undefined, fontMetricsDiv: ${u}, baselineLocator: ${e}`);try{const t=u.getBoundingClientRect(),n=e.getBoundingClientRect();return t.bottom-n.bottom}catch(e){return(0,r.setRenderingResultInfo)("Error in getFontBaselineHeight: "+e),0}}function p(e,t){const n=(0,i.getFontLookupKey)(e,t);if(t>=0&&t<1)return C[n]={fontSize:t,fontMetrics:{baseline:0,height:1,middle:0}},C[n].fontMetrics;let o;try{o=f(n)}catch(o){return S(t,e,n,"Exception in getFontMetrics, error:"+o)}return 0===o.height&&t>=1?S(t,e,n,"fontMetricsDivHeight == 0."):(C[n]={fontSize:t,fontMetrics:o},o)}function y(e){return{height:e.height,baseline:e.baseline,middle:e.middle}}function S(e,t,n,o){var l;const a=null!==u.parentNode?"Has Parent":"Parent is null",s=window.getComputedStyle(u).getPropertyValue("display");u.style.display="block",null!==(l=document)&&void 0!==l&&l.body&&document.body.appendChild(u);const d=f(n),c=window.getComputedStyle(u),g=c.getPropertyValue("display"),h=c.getPropertyValue("height"),m=u.getBoundingClientRect();if(0!==d.height)return C[n]={fontSize:e,fontMetrics:d},d;u.style.overflow="hidden";const p=f(n);if(0!==p.height)return C[n]={fontSize:e,fontMetrics:d},p;const y=`\n       ${o}\n       Font name: ${(0,i.getFontNameForLogging)(t)} }, font size: ${e}.\n       fontMetricsDiv ${a}. fontMetricsDivDisplayMode: ${s}.\n       After another appendChild:\n       FontMetricsDivHeight2: ${d.height} (getFontMetricsDivHeight), fontMetricsDivDisplayMode: ${g} (getComputedStyle),\n       fontBoundingClientRect.height: ${m.height} }, top:${m.top} }, bottom:${m.bottom}.\n       css.height: ${c.height} }, css.line-height: ${c.lineHeight} }, computedHeight: ${h}.\n       FontMetricsDiv.scrollWidth: ${u.scrollWidth} }, fontMetricsDiv.scrollHeight: ${u.scrollHeight}`;if((0,r.setRenderingResultInfo)(y),!(0,i.isKnownFont)(t)){const t=Math.round(e)+"pt calibri";if(C[t])return C[t].fontMetrics}throw Error(y)}function R(e){const t=C[(0,i.getFontLookupKey)(a.DefaultFallbackFontName,e)];return y(t?t.fontMetrics:p(a.DefaultFallbackFontName,e))}t.getCachedFontMetrics=function(e,t,n){if(!(0,s.isPLTRegressionInMFPFixEnabled)()){const t=(0,s.isGridRenderPerfFixEnabled)()?(0,d.canonizeFontNameNoLowercase)(e):(0,d.canonizeFontName)(e);(0,l.updateFontLoadStatus)(t)}c&&(C=_object_spread({},C,{"8pt aptos narrow":{fontSize:8,fontMetrics:{height:13,baseline:3,middle:5.640625}},"9pt aptos narrow":{fontSize:9,fontMetrics:{height:14,baseline:3,middle:5.984375}},"10pt aptos narrow":{fontSize:10,fontMetrics:{height:17,baseline:4,middle:7.3125}},"11pt aptos narrow":{fontSize:11,fontMetrics:{height:18,baseline:4,middle:7.640625}},"12pt aptos narrow":{fontSize:12,fontMetrics:{height:20,baseline:5,middle:8.96875}},"14pt aptos narrow":{fontSize:14,fontMetrics:{height:23,baseline:5,middle:9.625}},"16pt aptos narrow":{fontSize:16,fontMetrics:{height:26,baseline:6,middle:11.296875}},"18pt aptos narrow":{fontSize:18,fontMetrics:{height:30,baseline:7,middle:12.953125}},"20pt aptos narrow":{fontSize:20,fontMetrics:{height:33,baseline:8,middle:14.609375}},"24pt aptos narrow":{fontSize:24,fontMetrics:{height:39,baseline:9,middle:16.9375}},"26pt aptos narrow":{fontSize:26,fontMetrics:{height:43,baseline:10,middle:18.59375}},"28pt aptos narrow":{fontSize:28,fontMetrics:{height:46,baseline:11,middle:20.265625}},"36pt aptos narrow":{fontSize:36,fontMetrics:{height:59,baseline:14,middle:25.90625}},"48pt aptos narrow":{fontSize:48,fontMetrics:{height:78,baseline:18,middle:33.875}},"72pt aptos narrow":{fontSize:72,fontMetrics:{height:117,baseline:27,middle:50.8125}}}),c=!1);const o=(0,i.getFontLookupKey)(e,t),a=C[o];if(a)return y(a.fontMetrics);try{return y(p(e,t))}catch(l){(0,r.setRenderingResultInfo)(`FontName:${(0,i.getFontNameForLogging)(e)}, FontSize:${t} is trying to fallback to calibri ${l}`),n.ClientOnlyCache.FallbackFonts[o]=!0;try{return R(t)}catch(e){const n=Math.max(Math.round(t),1);try{return R(n)}catch(e){let t=13*Math.round((n-72)/13)+72;return t=Math.min(t,409),R(t)}}throw l}},t.recalculateFontMetrics=function(e){const t=Object.getOwnPropertyNames(C),n=e.toLowerCase();for(let e=0;e<t.length;e++){const o=t[e];if(o.indexOf(n)>=0){const e=C[o].fontSize;try{p(n,e)}catch(t){p(a.DefaultFallbackFontName,e)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reorderTextRunsForBidiDrawing=t.prepareTextRunsForBidiLayout=t.analyzeBidiText=void 0;const o=n(1),r=n(0),i=n(2);function l(e,t){const n=[d(e,0)];if(1===t.length)return n;let o=void 0;for(let i=0;i<t.length;i++)if(" "===(r=t[i])||'"'===r||"'"===r||"."===r||"?"===r||":"===r||";"===r||"-"===r||","===r||"!"===r||"("===r||")"===r){a(i,o)&&n.push(c(e,i));const r=i+1;s(r,t.length)&&n.push(d(e,r)),o=i}var r;return n}function a(e,t){return e>0&&!(e-1===t)}function s(e,t){return e<t}function d(e,t){return{FontID:e.FontID||0,StartIndex:e.StartIndex+t,CachedFont:e.CachedFont}}function c(e,t){return{FontID:e.FontID||0,StartIndex:e.StartIndex+t,CachedFont:e.CachedFont,IsSpecialCharTextRun:!0}}t.analyzeBidiText=function(e,t){let n=!1,r=!1;for(let t=0;t<e.length;t++){const o=e[t];if((0,i.isRtlChar)(o)?n=!0:r=!0,r&&n)break}return{HasLtr:r,HasRtl:n,HasBidi:r&&n,BaseDir:function(e,t){if(!e)return"ltr";switch(t){case o.ReadingOrderType.LeftToRight:return"ltr";case o.ReadingOrderType.RightToLeft:return"rtl";case o.ReadingOrderType.Context:return(0,i.isRtlChar)(e[0])?"rtl":"ltr"}}(e,t)}},t.prepareTextRunsForBidiLayout=function(e,t){const n=[];for(let o=0;o<e.length;o++){const i=l(e[o],(0,r.getTextRunText)(o,e,t));n.push(...i)}return n},t.reorderTextRunsForBidiDrawing=function(e,t,n,o){if(n.HasRtl&&!n.HasLtr)return void e.reverse();const l=(0,i.getReOrderDiv)(n,o);for(let n=0;n<e.length;n++){const o=(0,r.getTextRunText)(n,e,t),i=document.createElement("span");i.innerText=o,i.setAttribute("rid",n.toString()),l.appendChild(i)}document.body.appendChild(l);for(let t=0;t<l.children.length;t++){const n=l.children[t],o=n.getAttribute("rid");if(!o)throw Error("reorderTextRunsForBidiDrawing: runIndexAttr is undefined");const r=n.getBoundingClientRect().left;e[parseInt(o,10)].OffsetX=r}e.sort((e,t)=>e.OffsetX-t.OffsetX),document.body.removeChild(l)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RichValueIconRightHorizontalPadding=t.RichValueIconLeftHorizontalPadding=void 0,t.RichValueIconLeftHorizontalPadding=2,t.RichValueIconRightHorizontalPadding=1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canCellContainExpandCollapseAndCFIcon=t.isPivotIntersectsRenderingRegion=t.getPivotTableLeftAdjustedForDrawing=t.getPivotTableTopAdjustedForDrawing=void 0;const o=n(1),r=n(6),i=n(0),l=n(12);function a(e,t){if(!t)return e.FirstRow;const n=e.ColumnHeaderRange;return(0,r.isNullOrUndefined)(n)||n.FirstColumn===n.LastColumn||n.FirstRow===n.LastRow?e.RowHeaderRange.FirstRow:e.ColumnHeaderRange.FirstRow}t.getPivotTableTopAdjustedForDrawing=function(e,t,n){(0,o.verifyArgumentNotNull)(e,"model","getPivotTableTopAdjustedForDrawing"),(0,o.verifyArgumentNotNull)(e.ClientOnlyCache,"ClientOnlyCache","getPivotTableTopAdjustedForDrawing");const r=e.ClientOnlyCache.RowOffsetsAdjustedForDrawing;if((0,o.verifyArgumentNotNull)(r,"RowOffsetsAdjustedForDrawing","getPivotTableTopAdjustedForDrawing"),(0,o.verifyArgumentNotNull)(t,"pivotTable","getPivotTableTopAdjustedForDrawing"),n&&!t.IsEmptyPivot&&0===t.DeltaYFromOriginPTAdjustedForDrawing){const o=a(t,n);return r[(0,i.getModelRowIndex)(e,o)]}return r[t.FirstRowIndex]+t.DeltaYFromOriginPTAdjustedForDrawing},t.getPivotTableLeftAdjustedForDrawing=function(e,t,n){(0,o.verifyArgumentNotNull)(e,"model","getPivotTableLeftAdjustedForDrawing"),(0,o.verifyArgumentNotNull)(e.ClientOnlyCache,"ClientOnlyCache","getPivotTableTopAdjustedForDrawing");const r=e.ClientOnlyCache.ColOffsetsAdjustedForDrawing;return(0,o.verifyArgumentNotNull)(r,"ColOffsetsAdjustedForDrawing","getPivotTableLeftAdjustedForDrawing"),(0,o.verifyArgumentNotNull)(t,"pivotTable","getPivotTableLeftAdjustedForDrawing"),n||!e.IsRtl?r[t.FirstColIndex]+t.DeltaXFromOriginPTAdjustedForDrawing:r[r.length-1]-t.DeltaXFromOriginPTAdjustedForDrawing-r[t.FirstColIndex]-t.OriginPTWidthAdjustedForDrawing},t.isPivotIntersectsRenderingRegion=function(e,t,n,r){return(0,o.verifyArgumentNotNull)(e,"model","isPivotIntersectsRenderingRegion"),(0,o.verifyArgumentNotNull)(t,"pivotTable","isPivotIntersectsRenderingRegion"),(0,o.verifyArgumentNotNull)(n,"renderingRegion","isPivotIntersectsRenderingRegion"),!(t.LastRowIndex<n.startRow||(t.IsEmptyPivot?t.FirstRowIndex:(0,i.getModelRowIndex)(e,a(t,r)))>n.endRow||t.FirstColIndex<n.startColumn||t.LastColIndex>n.endColumn)},t.canCellContainExpandCollapseAndCFIcon=function(e,t,n){var r;if(null===(r=e.CondFormat)||void 0===r||null===(r=r.Icon)||void 0===r||!r.IconOnly)return!0;const i=e.CachedFont.Size,a=(0,l.getIconHorizontalPadding)(i,n),s=(0,l.getIconSize)(i,n),d=(0,l.getExpandCollapseButtonPadding)(e)*n;switch(e.CondFormat.Icon.CFIconHorizontalAlignment){case o.HorizontalAlignment.Left:case o.HorizontalAlignment.Right:return t-s-a-d>0;case o.HorizontalAlignment.Center:return t/2-s/2-d>0;default:return!0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.breakToGraphemes=void 0;const o=n(116),r=n(165);function i(e,t){return 55296<=e&&e<=56319&&56320<=t&&t<=57343}t.breakToGraphemes=function(e){if(!e)return[];const t=[];let n=0,l=e.charCodeAt(n),a=(0,r.classifyChar)(e.codePointAt(n)),s=o.CombiningClass.Other;for(let d=1;d<e.length;d++){const c=e.charCodeAt(d);d>=1&&i(l,c)||(s=(0,r.classifyChar)(e.codePointAt(d)),(0,o.shouldBreak)(a,s)&&(t.push(e.substring(n,d)),n=d),a=s,l=c)}return n<=e.length-1&&t.push(e.substring(n)),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fillVerticalTextForRTF=t.getVerticalTextMetadata=t.fillVerticalText=void 0;const o=n(1),r=n(9),i=n(70),l=n(40),a=n(14),s=n(117),d=n(87);function c(e,t,n,o,r,i,l,a,s,d,c,g){const C=e.textAlign;"center"!==C&&(e.textAlign="center");const{graphemes:f,maxFontHeight:m,adjustedOffsetY:p}=h(t,n,o,l,r,g);!function(e,t,n,o,r,i,l,a,s,d,c){let g=i;for(let i=o.length-1;i>=0;i--){const h=o[i];" "!==h&&(e.fillText(h,r,g),u(e,t,n,r,g,h,a,s,d,c)),g-=l}}(e,t,n,f,i,p,m,a,s,d,c),"center"!==C&&(e.textAlign=C)}function u(e,t,n,i,s,c,u,g,h,C){g&&(0,a.shouldRenderVerticalText)(n)&&(0,l.cacheTextDecorationLayout)(t,n,u,{textPositionX:i,textPositionY:s,textWidth:(0,r.measureTextWidth)(e,c,!(0,d.isTestRun)(),(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.TextWidthClientPhase1,t)),clipRect:C},h)}function g(e,t,n,r,i){const l=function(e,t,n,r){const i=(0,s.getVerticalTextPadding)(t);switch(e){case o.VerticalAlignment.Top:return n+r+i;case o.VerticalAlignment.Center:return n+r/2;case o.VerticalAlignment.Bottom:default:return n-i}}(e,t,n,r);return i&&e===o.VerticalAlignment.Distributed&&i<=0?l-i:l}function h(e,t,n,o,l,a){var s;const d=(0,i.breakToGraphemes)(n),c=o||(0,r.getTextLineHeight)(t,e),u=function(e,t){return(e.length-1)*t}(d,c);return{graphemes:d,maxFontHeight:c,adjustedOffsetY:g(t.CachedStyle.VerticalAlignment,(null===(s=t.CachedStyle)||void 0===s?void 0:s.Indentation)||0,l,u,a),textHeight:u}}t.fillVerticalText=function(e,t,n,o,r,i,l,a,s){c(e,t,n,o,i,r,void 0,l,!0===n.CachedFont.StrikeThrough,n.CachedFont,a,s)},t.getVerticalTextMetadata=function(e,t,n,o,r,i){const l=h(e,t,n,o,r,i);return{adjustedOffsetY:l.adjustedOffsetY,textHeight:l.textHeight}},t.fillVerticalTextForRTF=function(e,t,n,o,r,i,l,a,s,d,u,g){c(e,t,n,o,i,r,l,a,s,d,u,g)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBreakType=t.computeMaxTextWidthForWrapText=t.getSpaceWidthBetweenLines=t.getOffsetXForVerticalText=t.adjustOrderingOfLinesForVerticalText=t.drawTextLine=void 0;const o=n(1),r=n(35),i=n(32),l=n(14),a=n(71),s=n(15),d=n(5),c=n(9),u=n(12);t.drawTextLine=function(e,t,n,o,r,s,d,c,u,g,h,C,f){g?(0,i.fillRichTextFormat)(e,t,n,o,g,d,c,h,C,f):(0,l.shouldRenderVerticalText)(o)?(0,a.fillVerticalText)(e,n,o,s,d,c,t,h,u):r?e.fillText(s,d,c):e.fillText(s,d,c,u)},t.adjustOrderingOfLinesForVerticalText=function(e,t,n){var r;(null===(r=e.CachedStyle)||void 0===r?void 0:r.ReadingOrder)!==o.ReadingOrderType.RightToLeft&&n.HasLtr&&!n.HasBidi&&(t.textLines=t.textLines.reverse(),t.tokensPerLine=t.tokensPerLine.reverse())},t.getOffsetXForVerticalText=function(e,t,n,r,i,a){return function(e,t,n,r,i){switch((0,s.getEffectiveHorizontalAlignment)(e,t)){case o.HorizontalAlignment.Right:return n-r*(i-1);case o.HorizontalAlignment.CenterAcrossSelection:case o.HorizontalAlignment.Center:return n-r*(i-1)/2;default:case o.HorizontalAlignment.Left:return n}}(e,t,function(e,t,n,r,i){if(1===i&&(0,l.isHorizontalAlignmentJustifiedOrDistributedForVerticalText)(t)){var a;const r=(0,c.getCellTextHorizontalPadding)(t,e,n.zoom,n.devicePixelRatio);switch((null===(a=t.CachedStyle)||void 0===a?void 0:a.HorizontalAlignment)||o.HorizontalAlignment.Automatic){case o.HorizontalAlignment.Distributed:return(0,c.getCellTextCenterX)(e,t,n.zoom,n.devicePixelRatio);case o.HorizontalAlignment.Justify:case o.HorizontalAlignment.JustifyDistributed:return(0,d.getCellLeft)(e,t,e.BlockWidth)+r}}return r}(e,t,n,r,a),i,a)},t.getSpaceWidthBetweenLines=function(e,t,n,o,r){if(!(0,l.isHorizontalAlignmentJustifiedOrDistributedForVerticalText)(t)||1===o)return 0;const i=(0,u.getCellRightVisualElementsPadding)(e,t),a=n,s=(0,d.getCellRight)(e,t,e.BlockWidth)-(0,c.getCellTextHorizontalPaddingWithoutVisualElements)(e,t)-i-a-r*(o-1);return s<0?0:s/(o-1)},t.computeMaxTextWidthForWrapText=function(e,t,n,o,i){let l=n-(0,c.getWrapTextAdditionalPadding)(o,e,i);return t===r.BreakType.Distributed&&(l-=(0,c.getIndentationPaddingPx)(e.CachedStyle.Indentation||0)),l},t.getBreakType=function(e){var t;return(0,l.shouldRenderVerticalText)(e)?function(e){switch(e){case o.VerticalAlignment.Justify:return r.BreakType.Justify;case o.VerticalAlignment.Distributed:return r.BreakType.Distributed;default:return r.BreakType.Wrap}}(e.CachedStyle.VerticalAlignment):function(e){switch(e){case o.HorizontalAlignment.Justify:return r.BreakType.Justify;case o.HorizontalAlignment.JustifyDistributed:case o.HorizontalAlignment.Distributed:return r.BreakType.Distributed;default:return r.BreakType.Wrap}}((null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment)||o.HorizontalAlignment.Automatic)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PhoneticTextHeightPx=t.PhoneticRotatedTextAlign=t.PhoneticTextAlign=t.PhoneticTextDirection=t.VerticalDistancePhoneticFromTopCellPx=t.PhoneticFontSizePt=t.PhoneticFontName=void 0,t.PhoneticFontName="Yu Gothic",t.PhoneticFontSizePt=6,t.VerticalDistancePhoneticFromTopCellPx=7,t.PhoneticTextDirection="ltr",t.PhoneticTextAlign="start",t.PhoneticRotatedTextAlign="left",t.PhoneticTextHeightPx=14},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isIconOutOfCellVerticalBoundaries=t.getIconBottomWhenAlignedWithMiddleBaseline=t.getIconLeftPosition=t.getIconVerticalPosition=t.getVerticalAlignmentForIcons=void 0;const o=n(1),r=n(9),i=n(5),l=n(12),a=n(19),s=n(8),d=n(49),c=n(15),u=n(69),g=n(37),h=n(3);function C(e,t){const n=e.RowHeights[t.Row]-h.GridLineWidthPx,o=(0,r.getTextLineHeight)(t,e);return(0,r.calculateVerticalAlignment)(e,t,o,n,t.DisplayFormula)}function f(e,t,n,o,l){const a=(0,r.getTextVerticalPosition)(t,e,(0,r.getTextLineHeight)(t,e),(0,i.getCellHeight)(e,t,!1),l,void 0).absoluteY,d=(0,r.getMiddleBaseline)(e,a,t.CachedFont,(0,s.getActualFontSize)(t))*n+.5*o;return Math.round(d)}function m(e,t,n,o){return(0,i.getCellBottomAdjustedForDrawing)(e,t)-a.MinimalIconPadding<n||(0,i.getCellTopAdjustedForDrawing)(e,t,!1)+a.MinimalIconPadding>n+o}t.getVerticalAlignmentForIcons=C,t.getIconVerticalPosition=function(e,t,n,r){var s;const c=(0,d.getEffectiveVerticalAlignment)(C(e,t),d.AdvVerticalAlignmentFormat.CFIcon,void 0,void 0,void 0,void 0,t.DisplayFormula),u=f(e,t,n,r,c),g=null===(s=t.CondFormat)||void 0===s||null===(s=s.Icon)||void 0===s?void 0:s.IconOnly,h=(0,i.getCellBottomAdjustedForDrawing)(e,t)-a.MinimalIconPadding,p=(0,i.getCellTopAdjustedForDrawing)(e,t,!1)+a.MinimalIconPadding+r;switch(c){case o.VerticalAlignment.Bottom:return g?h:(0,l.adjustNumberToRange)(u,p,h);case o.VerticalAlignment.Top:return g?p:(0,l.adjustNumberToRange)(u,p,h);case o.VerticalAlignment.Center:return g||m(e,t,u,r)?Math.floor((0,i.getCellCenterYAdjustedForDrawing)(e,t)+r/2):u;default:throw Error(`getIconVerticalPosition: Vertical alignment ${c} is not supported in CF Icon!`)}},t.getIconLeftPosition=function(e,t,n,r,a){var s;return null!==(s=t.CondFormat)&&void 0!==s&&null!==(s=s.Icon)&&void 0!==s&&s.IconOnly?function(e,t,n,r,a){const s=t.CondFormat.Icon.CFIconHorizontalAlignment;switch(s){case o.HorizontalAlignment.Right:const d=(0,l.getIconHorizontalPadding)(r,a)+function(e,t,n,r){return t.PivotTable&&t.PivotTable.HasExpandCollapseIndicator&&(0,u.canCellContainExpandCollapseAndCFIcon)(t,(0,i.getCellWidthAdjustedForDrawing)(e,t),r)&&n===o.HorizontalAlignment.Right?((0,l.getExpandCollapseButtonPadding)(t)+g.DistanceBetweenCFIconAndExpandCollapseButton)*r:0}(e,t,s,a)+n;return Math.floor((0,i.getCellRightAdjustedForDrawing)(e,t,!1)-d);case o.HorizontalAlignment.Fill:case o.HorizontalAlignment.Justify:case o.HorizontalAlignment.CenterAcrossSelection:case o.HorizontalAlignment.Distributed:case o.HorizontalAlignment.JustifyDistributed:case o.HorizontalAlignment.Automatic:case o.HorizontalAlignment.Left:return Math.floor((0,i.getCellLeftAdjustedForDrawing)(e,t,!1,!1)+(0,l.getIconHorizontalPadding)(r,a));case o.HorizontalAlignment.Center:return Math.floor((0,i.getCellCenterXAdjustedForDrawing)(e,t,!1)-n/2);default:throw Error("getIconLeftOnlyPosition: unsupported horizontalAlignment: "+s)}}(e,t,n,r,a):((0,c.isHorizontalAlignmentCenteredAcrossSelection)(t)&&t.Spill?(0,i.getSpillCellLeftAdjustedForDrawing)(e,t):(0,i.getCellLeftAdjustedForDrawing)(e,t,!1,!1))+(0,l.getIconHorizontalPadding)(r,a)},t.getIconBottomWhenAlignedWithMiddleBaseline=f,t.isIconOutOfCellVerticalBoundaries=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawCircle=t.drawCircleIcon=void 0;const o=n(0),r=n(4),i=n(19),l=n(28),a=n(179),s=n(18);function d(e,t,n,r){const{image:d,highContrastScheme:g}=t,h=function(e){const{left:t,bottom:n,size:o}=e,r=o/2,i=r-s.ShapeOutlineWidthPx;return{centerX:Math.round(t+r),centerY:Math.round(n-r),innerRadius:i,outlineRadius:r}}(t),{outlineRadius:C}=h;C<=0||(c(e,h.centerX,h.centerY,C,i.Circle0Deg,i.Circle360Deg,n),r&&h.innerRadius>0&&function(e,t,n,r,s){const{centerX:d,centerY:g,innerRadius:h}=t;if(s)!function(e,t,n,r){const{centerX:l,centerY:s}=t,d=t.innerRadius,g=(0,a.getHighContrastFillingType)(r),h=(0,o.rgbToColorHex)(n.BackgroundColor),C=(0,o.rgbToColorHex)(n.TextColor);switch(g){case a.FillType.Full:break;case a.FillType.FillPortion:c(e,l,s,d,u(r),i.Circle270Deg,h);break;case a.FillType.Empty:c(e,l,s,d,i.Circle0Deg,i.Circle360Deg,h);break;case a.FillType.InnerCircle:c(e,l,s,d,i.Circle0Deg,i.Circle360Deg,h);c(e,l,s,(0,a.getInnerCircleRadius)(r,d),i.Circle0Deg,i.Circle360Deg,C);break;case a.FillType.Stripes:c(e,l,s,d,i.Circle0Deg,i.Circle360Deg,h),(0,a.drawStripes)(e,l,s,d,C);break;default:throw Error("circle-fillHighContrastCircle: unsupported filling type")}}(e,t,s,r);else switch(r){case i.CFIconImage.Circle25:case i.CFIconImage.CircleHalf:case i.CFIconImage.Circle75:const t=u(r);c(e,d,g,h,i.Circle270Deg,t,n),c(e,d,g,h,t,i.Circle270Deg,l.CircleEmptyInnerColor);break;default:c(e,d,g,h,i.Circle0Deg,i.Circle360Deg,n)}}(e,h,r,d,g))}function c(e,t,n,o,r,i,l){e.fillStyle=l,e.beginPath(),e.moveTo(t,n),e.arc(t,n,o,r,i),e.fill()}function u(e){switch(e){case i.CFIconImage.Circle25:return i.Circle0Deg;case i.CFIconImage.CircleHalf:return i.Circle90Deg;case i.CFIconImage.Circle75:return i.Circle180Deg;default:throw Error(`getFillAngle: image: ${e} not supported`)}}t.drawCircleIcon=function(e,t){(0,r.verifyArgumentNotNull)(e,"ctx","drawCircleIcon"),(0,r.verifyArgumentNotNull)(t,"drawingContext","drawCircleIcon");const{image:n,highContrastScheme:a}=t;d(e,t,function(e,t){if(t)return(0,o.rgbToColorHex)(t.TextColor);switch(e){case i.CFIconImage.CircleHigh:case i.CFIconImage.TrafficHigh:case i.CFIconImage.CircleSymbolHigh:return l.CircleHighOuterColor;case i.CFIconImage.CircleMedium:case i.CFIconImage.TrafficMedium:case i.CFIconImage.CircleSymbolMedium:return l.CircleMediumOuterColor;case i.CFIconImage.CircleLow:case i.CFIconImage.TrafficLow:case i.CFIconImage.CircleSymbolLow:return l.CircleLowOuterColor;case i.CFIconImage.CircleEmpty:return l.CircleEmptyOuterColor;case i.CFIconImage.CircleFilled:case i.CFIconImage.Circle25:case i.CFIconImage.CircleHalf:case i.CFIconImage.Circle75:return l.CircleFilledOuterColor;case i.CFIconImage.FourCircleHigh:return l.FourCircleHighOuterColor;case i.CFIconImage.FourCircleLow:return l.FourCircleLowOuterColor;case i.CFIconImage.FourCircleMedium1:return l.FourCircleMedium1OuterColor;case i.CFIconImage.FourCircleMedium2:return l.FourCircleMedium2OuterColor;default:throw Error("getCircleOutlineColor: unsupported image type = "+e)}}(n,a),function(e,t){if(t)return(0,o.rgbToColorHex)(t.TextColor);switch(e){case i.CFIconImage.CircleHigh:case i.CFIconImage.TrafficHigh:case i.CFIconImage.CircleSymbolHigh:return l.CircleHighInnerColor;case i.CFIconImage.CircleMedium:case i.CFIconImage.TrafficMedium:case i.CFIconImage.CircleSymbolMedium:return l.CircleMediumInnerColor;case i.CFIconImage.CircleLow:case i.CFIconImage.TrafficLow:case i.CFIconImage.CircleSymbolLow:return l.CircleLowInnerColor;case i.CFIconImage.CircleEmpty:return l.CircleEmptyInnerColor;case i.CFIconImage.CircleFilled:return l.CircleFilledInnerColor;case i.CFIconImage.FourCircleHigh:return l.FourCircleHighInnerColor;case i.CFIconImage.FourCircleLow:return;case i.CFIconImage.FourCircleMedium1:return l.FourCircleMedium1InnerColor;case i.CFIconImage.FourCircleMedium2:return l.FourCircleMedium2InnerColor;case i.CFIconImage.Circle25:case i.CFIconImage.CircleHalf:case i.CFIconImage.Circle75:return l.CircleFilledInnerColor;default:throw Error("getCircleInnerColor: unsupported image type = "+e)}}(n,a))},t.drawCircle=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateClosestNonEmptyCellsSpill=t.updateCellSpill=void 0;const o=n(1),r=n(15),i=n(22),l=n(93),a=n(14),s=n(0),d=n(8),c=n(4),u=n(12),g=n(9);function h(e,t,n,r,u){if((0,c.verifyArgumentNotNull)(n,"cell","spillCell.updateCellSpill"),(0,c.verifyArgumentNotNull)(t,"model","spillCell.updateCellSpill"),!n.Text||n.WrapText||n.Merge||(0,d.cellHasShrinkToFit)(n)||n.ValueType===o.CellValueType.Number||(0,a.shouldRenderVerticalText)(n))return;(0,s.verifyCellStyleAndFont)(t,n,"updateCellSpill");const h=(0,i.shouldDrawRotatedText)(t,n.CachedStyle,n.CachedFont);e.font=(0,d.getFontCssStringFromCell)(n,t);let f=(0,g.getTextWidth)(e,t,n);if(h){const e=(0,g.getTextLineHeight)(n,t);f=(0,l.getRotatedTextWidth)(t,f,e,n.CachedStyle),n.Spill=void 0}const y=C(n,t,f,o.SpillDirection.End,h,r,u),S=C(n,t,f,o.SpillDirection.Start,h,r,u),R=y.isSpillingOutsideOfBlock||S.isSpillingOutsideOfBlock,F=y.isBlockedByCellContent||S.isBlockedByCellContent;if(0===y.spilledOverCellsCount&&0===S.spilledOverCellsCount)return void((R||F)&&(n.Spill={SpanToStart:0,SpanToEnd:0,IsSpillBlocked:!0,IsSpillingOutsideOfBlock:R}));const T=m(n,t,o.SpillDirection.Start,h),w=m(n,t,o.SpillDirection.End,h),I=p(T,n,t,o.SpillDirection.Start),b=p(w,n,t,o.SpillDirection.End);n.Spill={SpanToStart:Math.min(S.spilledOverCellsCount,I),SpanToEnd:Math.min(y.spilledOverCellsCount,b),IsSpillBlocked:R||S.spilledOverCellsCount>I||y.spilledOverCellsCount>b,IsSpillingOutsideOfBlock:R}}function C(e,t,n,i,l,a,d){const h=(0,o.getCellStyle)(t,e);(0,c.verifyArgumentNotNull)(h,"cell.CachedStyle","spillCell.getNumberOfSpilledOverCells");const C=h.HorizontalAlignment||o.HorizontalAlignment.Automatic,m=!!l||F(e,C,t.IsRtl);return m?function(e,t,n,i,l,a,d){let c=e.Col,h=function(e,t,n,i,l,a,d){const c=(0,s.getColumnWidth)(t.Col,e),h=function(e,t){var n;if(null===(n=t.PivotTable)||void 0===n||!n.HasExpandCollapseIndicator)return!1;const i=(0,r.getEffectiveHorizontalAlignment)(e,t);return!(0,g.doesExpandCollapseButtonShiftText)(e,t)||i===o.HorizontalAlignment.Center}(e,t)?(0,u.getExpandCollapseButtonPadding)(t):0,C=(0,g.getCellTextHorizontalPadding)(t,e,a,d)+n+h-c;if(C<=0)return 0;if(i===o.HorizontalAlignment.Center)return C/2;return R(i,l,e.IsRtl)?C:0}(t,e,n,i,l,a,d),C=0,m=!1;if(0===h)return{spilledOverCellsCount:C,isSpillingOutsideOfBlock:m,isBlockedByCellContent:!1};const p=t.ColumnNumbers.length;for(c+=l;f(c,p)&&h>0;)C++,h-=(0,s.getColumnWidth)(c,t),c+=l;return m=!f(c,p)&&h>0,{spilledOverCellsCount:C,isSpillingOutsideOfBlock:m,isBlockedByCellContent:!1}}(e,t,n,C,i,a,d):{spilledOverCellsCount:0,isSpillingOutsideOfBlock:!1,isBlockedByCellContent:!m}}function f(e,t){return e>=0&&e<t}function m(e,t,n,r){const i=e.Row;let l=e.Col+n;for(;!r&&f(l,t.ColumnNumbers.length);){const e=(0,o.getCell)(i,l,t);if(e&&y(e))return e;l+=n}return null}function p(e,t,n,r){return e?Math.abs(e.Col-t.Col)-1:r===o.SpillDirection.End?n.ColumnNumbers.length-t.Col:t.Col}function y(e){var t;return!!(e&&(e.Text||null!==(t=e.FormulaInfo)&&void 0!==t&&t.Formula||e.PreviewText))}function S(e,t,n,r,i,l,a){const d=p(t,n,r,i);if(t&&t.Spill){const u=(0,o.getCellStyle)(r,t);(0,c.verifyArgumentNotNull)(u,"blockingCellStyle","spillCell.updateClosestNonEmptyCell");const g=u.HorizontalAlignment||o.HorizontalAlignment.Automatic,C=-i,f=F(t,g,r.IsRtl),m=R(g,C,r.IsRtl);if(f&&m)if(n&&n.Text&&""!==n.Text){const e=(0,o.getSpilledOverCount)(C,t);t.Spill.IsSpillBlocked=d<=e;const n=Math.min(e,d);n!==e&&((0,s.setCellAndSpannedOverCellsDirty)(r,t),C===o.SpillDirection.Start?t.Spill.SpanToStart=n:t.Spill.SpanToEnd=n)}else{n.Spill=void 0;const i=(0,o.getSpilledOverCount)(C,t);h(e,r,t,l,a),i!==(0,o.getSpilledOverCount)(C,t)&&(0,s.setCellAndSpannedOverCellsDirty)(r,t)}}return d}function R(e,t,n){return e===o.HorizontalAlignment.Center||(t===o.SpillDirection.Start?n?e===o.HorizontalAlignment.Left:e===o.HorizontalAlignment.Right:t===o.SpillDirection.End&&(e===o.HorizontalAlignment.Automatic||(n?e===o.HorizontalAlignment.Right:e===o.HorizontalAlignment.Left)))}function F(e,t,n){return!e.RichValueIcon||t===o.HorizontalAlignment.Left||!n&&t===o.HorizontalAlignment.Automatic}t.updateCellSpill=h,t.updateClosestNonEmptyCellsSpill=function(e,t,n,r,l){const a=(0,i.shouldDrawRotatedText)(n,t.CachedStyle,t.CachedFont),s=m(t,n,o.SpillDirection.Start,a),d=m(t,n,o.SpillDirection.End,a);S(e,s,t,n,o.SpillDirection.Start,r,l),S(e,d,t,n,o.SpillDirection.End,r,l)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetColWidthCacheByCol=t.resetCache=t.setColMetadata=t.getColSrvDx=t.removeColMetadata=t.getColMetadata=void 0;let o={};t.getColMetadata=function(e){return o[e]},t.removeColMetadata=function(e){o[e]=void 0},t.getColSrvDx=function(e){const t=o[e];return t?t.SrvDx:-1},t.setColMetadata=function(e,t){o[e]=t},t.resetCache=function(){o={}},t.resetColWidthCacheByCol=function(e){o[e]=void 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderDrawingsWhiteColor=t.HeaderDrawingsGreenColor=t.RowHeaderDragAndInsertHitRegionWidth=t.MaxRowValue=t.MaxColValue=t.MaxCellPixelsAllocatedToUnhideZone=t.OverlappingUnhideZonePercentage=t.MinCellPixelsAllocatedToResizeZone=t.MaxCellPixelsAllocatedToResizeZone=t.CellPercentageAllocatedToResizeZone=void 0,t.CellPercentageAllocatedToResizeZone=.1,t.MaxCellPixelsAllocatedToResizeZone=5,t.MinCellPixelsAllocatedToResizeZone=0,t.OverlappingUnhideZonePercentage=.5,t.MaxCellPixelsAllocatedToUnhideZone=12,t.MaxColValue=16384,t.MaxRowValue=1048576,t.RowHeaderDragAndInsertHitRegionWidth=17,t.HeaderDrawingsGreenColor="#107C41",t.HeaderDrawingsWhiteColor="#ffffff"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldTextBeClipped=t.getCurrentTimeInMs=t.calculateExecutionsPerSecond=void 0;const o=n(1),r=n(15);function i(){return Date.now()}t.calculateExecutionsPerSecond=function(e,t){const n=i();let o=0;for(;i()-n<t;)e(o),o++;return o*(1e3/t)},t.getCurrentTimeInMs=i,t.shouldTextBeClipped=function(e,t){var n,i,l,a;return t.CachedStyle||(0,o.getCellStyle)(e,t),t.TextRuns||t.Spill||t.Merge||t.DisplayFormula||t.PreviewText||(null===(n=t.CachedStyle)||void 0===n?void 0:n.VerticalText)||t.WrapText||(0,r.isHorizontalAlignmentCenteredAcrossSelection)(t)||(null===(i=t.CachedStyle)||void 0===i?void 0:i.HorizontalAlignment)===o.HorizontalAlignment.Fill||(null===(l=t.CachedStyle)||void 0===l?void 0:l.ShrinkToFit)||((null===(a=t.CachedStyle)||void 0===a?void 0:a.Indentation)||0)>0}},function(e,t,n){"use strict";var o;n.d(t,"a",(function(){return o})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",e[e.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",e[e.msoulscat_Wac_PptGc2EditCanvas=852]="msoulscat_Wac_PptGc2EditCanvas",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles",e[e.msoulscat_Wac_CopilotChat=3050]="msoulscat_Wac_CopilotChat",e[e.msoulscat_Wac_Syntex=3051]="msoulscat_Wac_Syntex",e[e.msoulscat_Wac_WireGraph=3052]="msoulscat_Wac_WireGraph",e[e.msoulscat_Wac_CshCopilot=3053]="msoulscat_Wac_CshCopilot",e[e.msoulscat_Wac_CopilotComposeLaunchpad=3054]="msoulscat_Wac_CopilotComposeLaunchpad",e[e.msoulscat_Wac_CopilotProactiveSummary=3055]="msoulscat_Wac_CopilotProactiveSummary",e[e.msoulscat_Wac_CopilotProactiveShared=3056]="msoulscat_Wac_CopilotProactiveShared",e[e.msoulscat_Wac_CopilotCursor=3057]="msoulscat_Wac_CopilotCursor"}(o||(o={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogSamplingPercentage=t.CellLookupColumnMod=t.MaxAllowedRowColCount=t.CellLookupRowShift=t.MaxBitsPerRenderFlag=void 0,t.MaxBitsPerRenderFlag=32,t.CellLookupRowShift=5,t.MaxAllowedRowColCount=32,t.CellLookupColumnMod=1<<t.CellLookupRowShift,t.LogSamplingPercentage=.01},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;const o={};function r(){return void 0===globalThis.__get_feature_gate_dictionary_variable?o:globalThis.__get_feature_gate_dictionary_variable()}function i(e,t){var n;return null!==(n=r()[e])&&void 0!==n?n:t}t.getFeatureGateDictionary=r,t.getStringFeatureGate=i,t.getBooleanFeatureGate=function(e,t){var n;const o=null===(n=i(e))||void 0===n?void 0:n.trim().toLowerCase();return"true"===o||"false"!==o&&t},t.getNumberFeatureGate=function(e,t){var n;const o=null===(n=i(e))||void 0===n?void 0:n.trim().toLowerCase();if(void 0===o)return t;if("infinity"===o||"+infinity"===o)return 1/0;if("-infinity"===o)return-1/0;const r=parseFloat(o);return isNaN(r)?t:r},t.getIntFeatureGate=function(e,t){var n;const o=null===(n=i(e))||void 0===n?void 0:n.trim();if(void 0===o)return t;const r=parseInt(o,10);return isNaN(r)?t:r},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,n){"use strict";function o(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0,t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t;return null===(t=o()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(16),r=n(80);class i{static tagIntToString(e){return e<=i.maxNumericTag?e.toString():e>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e):i.map.charAt(e>>24&63)+i.map.charAt(e>>18&63)+i.map.charAt(e>>12&63)+i.map.charAt(e>>6&63)+i.map.charAt(63&e)}getLogMessage(e,t,n){let o=`tag_${i.tagIntToString(e)} [${r.a[t]}] ${n}`;return this.correlationId&&""!==this.correlationId&&(o+="\t\t"+this.correlationId),o}sendTraceTag(e,t,n,r){let i=this.logMessage;switch(n){case o.a.Error:i=this.logError;break;case o.a.Warning:i=this.logWarning;break;case o.a.Info:i=this.logInfo;break;case o.a.Verbose:i=this.logVerbose;break;case o.a.Spam:default:i=this.logMessage}try{i(this.getLogMessage(e,t,r))}catch(e){const t="undefined"!=typeof navigator?navigator:void 0;if(t&&!/rv:11.0/i.test(t.userAgent))throw e}}shipAssertTag(e,t,n,o){console.assert(n,this.getLogMessage(e,t,o))}debugAssertTag(e,t,n,o){this.shipAssertTag(e,t,n,o)}setCorrelationId(e){this.correlationId=e}logMessage(e){"log"in console&&console.log(e)}logError(e){"error"in console&&console.error(e)}logWarning(e){"warn"in console&&console.warn(e)}logInfo(e){"info"in console&&console.info(e)}logVerbose(e){"debug"in console&&console.debug(e)}constructor(){this.correlationId=""}}i.maxNumericTag=65535,i.minOldSchemeHighByteValue=36,i.map="abcdefghijklmnopqrstuvwxyz0123456789"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.approximateValue=void 0;const o=n(39);t.approximateValue=function(e,t){let n=Math.round(e);if(n<o.MinAllowedFontSize&&e>0&&(n=o.MinAllowedFontSize),n>o.MaxAllowedFontSize&&(n=o.MaxAllowedFontSize),n<0)throw Error(`TextLayout.approximateValue: ${n} in Excel must be between 1pt and 409pt`);let r=t[n];if(r)return r;let i=n;for(;i>o.MinAllowedFontSize&&!t[i];)i--;let l=n;for(;l<o.MaxAllowedFontSize&&!t[l];)l++;return r=function(e,t,n,o,r){const i=(n-o)/(r-o)*(e-t);return Math.round(t+i)}(t[l],t[i],n,i,l),t[n]=r,r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IconHorizontalPadding=t.FontSizeToIconSize=t.CalibriTextDecorationLineWidth=t.CalibriRegularPadding=t.CalibriItalicPadding=void 0,t.CalibriItalicPadding={1:1,2:1,3:1,4:1,5:2,6:3,7:3,8:4,9:4,10:5,11:5,12:6,13:5,14:7,16:8,18:9,20:11,22:11,24:11,26:13,28:13,36:17,48:23,72:35,100:49,150:74,200:97,300:145,409:194},t.CalibriRegularPadding={1:1,2:1,3:1,4:1,5:1,6:2,7:2,8:2,9:2,10:2,11:2,12:2,13:3,14:3,15:3,16:3,17:3,18:3,19:4,20:4,21:4,22:4,23:4,24:4,25:5,26:5,27:5,28:5,29:5,30:5,31:6,32:6,33:6,34:6,35:6,36:6,37:7,38:7,39:7,40:7,41:7,42:7,43:8,44:8,45:8,46:8,47:8,48:8,49:9,50:9,51:9,52:9,53:9,54:10,55:10,56:10,57:10,58:10,59:10,60:11,61:11,62:11,63:11,64:11,65:11,66:12,67:12,68:12,69:12,70:12,71:12,72:13,73:13,74:13,75:13,76:13,77:13,78:13,79:14,80:14,81:14,82:14,83:14,84:15,85:15,86:15,87:15,88:15,89:15,90:16,91:16,92:16,93:16,94:16,95:16,96:17,97:17,98:17,99:17,100:17,101:17,102:17,103:17,104:17,105:17,106:17,107:17,108:18,150:25,200:33,300:85,409:115},t.CalibriTextDecorationLineWidth={1:0,2:0,3:0,4:0,5:0,6:1,11:1,17:1,18:2,35:2,36:3,47:3,48:4,64:5,72:6,100:8,200:17,300:26,409:37},t.FontSizeToIconSize={1:3,3:5,4:6,5:8,8:12,10:12,11:16,12:16,14:20,16:22,18:22,20:26,22:26,24:28,26:32,28:34,36:42,48:57,72:85,100:118,200:234,300:351,400:468,409:478},t.IconHorizontalPadding={1:0,3:0,4:0,5:1,8:1,10:1,11:1,12:1,14:2,16:2,18:2,20:3,22:3,24:4,26:5,28:5,36:7,48:10,72:16,100:22,200:44,300:67,400:89,409:90}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTestRun=void 0,t.isTestRun=function(){return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStartOffset=t.getTextRun=t.reorderTextTokens=t.prepareTextRunsForJustifyAndDistributed=t.getSpaceWidthBetweenWords=t.getJustifyDistributedLine=void 0;const o=n(6),r=n(35),i=n(3),l=n(1),a=n(9),s=n(67),d=n(166),c=n(13);function u(e,t,n,l=0){if(e.isProcessingLastLine&&e.breakType===r.BreakType.Justify){const n=function(e,t,n=0){let o="",r=0;for(let n=0;n<e.length;n++)o+=e[n].text,r+=e[n].width,n!==e.length-1&&(o+=i.Whitespace,r+=t);return{Start:{Offset:n,Text:o,Width:r},SpaceWidthBetweenWords:t}}(t,e.singleSpaceWidth,l);return e.lineDirection===r.LineDirection.Vertical&&(n.Start.Offset=e.maxWidth-n.Start.Width),n}if(e.lineDirection===r.LineDirection.Vertical&&function(e){if(e.length>=2){const t=e[0];e[0]=e[e.length-1],e[e.length-1]=t}}(t),t.length>0){let a=l,s=0,d=t[s];const u={Start:{Offset:a,Text:d.text,Width:d.width},SpaceWidthBetweenWords:n};let g=Math.floor(n/e.singleSpaceWidth);g<1&&(g=1);const h=function(e,t,n,o){return e.lineDirection===r.LineDirection.Vertical&&o>3&&n-t*e.singleSpaceWidth>=0?Math.floor((n-t*e.singleSpaceWidth)*(o-3)/2):0}(e,g,n,t.length);a+=d.width+n+h,s++,(void 0===g||isNaN(g)||g===1/0)&&((0,c.setRenderingResultInfo)(`getJustifyDistributedLine: Invalid count variable. numberOfSpaces: ${g}, spaceWidthBetweenTokens: ${n}, singleSpaceWidth: ${e.singleSpaceWidth} `),g=1);let C="";const f=a;let m=0;for(;s<t.length-1;s++)d=t[s],C+=d.text,m+=d.width,s!==t.length-2&&(C+=i.Whitespace.repeat(g),m+=e.singleSpaceWidth*g);if(""!==C&&(u.Middle={Offset:f,Text:C,Width:m}),t.length>1){const e=t[t.length-1],r=(0,o.isNullOrUndefined)(u.Middle)?a:f+m+n+h;u.End={Offset:r,Text:e.text,Width:e.width}}return u}}function g(e,t){const n=e;if(n.length<=1)return 0;if(t.breakType===r.BreakType.Justify&&t.isProcessingLastLine)return t.singleSpaceWidth;let o=0;for(let e=0;e<n.length;e++)o+=n[e].width;const i=(t.maxWidth-o)/(n.length-1);return i<t.singleSpaceWidth?t.singleSpaceWidth:i}function h(e,t,n){return e?t[t.length-1-n]:t[n]}function C(e,t){return e.isProcessingLastLine&&e.breakType===r.BreakType.Distributed&&1===t.length&&e.isCompleteTextVisible?(e.maxWidth-t[0].width)/2:0}function f(e,t,n,o,r,i,l){const a=[];let s=0,d=!1;for(let c=0;c<n.length;c++){const u=n[c];if(p(u,o,r))if(y(u,o,r))a.push(u),s+=u.width;else{const n=S(e,t,u,o,r,i,l);d=i?d||!u.text.startsWith(n.text):R(u.text)?!u.text.startsWith(n.text):!u.text.endsWith(n.text),a.push(n),s+=n.width}}return{currentTextTokens:a,currentTokenWidthPx:s,combinePartialTokens:d}}function m(e){if(e.Start&&e.End){const t={Start:{Offset:e.Start.Offset,Text:e.End.Text,Width:e.End.Width},SpaceWidthBetweenWords:e.SpaceWidthBetweenWords};let n=t.Start.Offset;return e.Middle&&(t.Middle=e.Middle,n=t.Start.Offset+t.Start.Width+t.SpaceWidthBetweenWords,t.Middle.Offset=n,t.Middle.Text=e.Middle.Text.split(" ").reverse().join(" "),n=t.Middle.Offset+t.Middle.Width),t.End={Text:e.Start.Text,Width:e.Start.Width,Offset:n+t.SpaceWidthBetweenWords},t}return e}function p(e,t,n){return e.start<n&&e.start+e.text.length>t}function y(e,t,n){return t<=e.start&&e.start+e.text.length<=n}function S(e,t,n,o,r,i,s){const d=n.start<o?o-n.start:0,c=d+r-(o>n.start?o:n.start),u=n.text.substring(d,c);return{text:u,start:n.start>o?n.start:o,width:i?(0,a.measureTextHeightForVerticalText)(s,u):(0,a.measureTextWidth)(e,u,!0,(0,l.isRenderFlagEnabled)(l.RenderFlagsArray.TextWidthClientPhase1,t)),containsThaiCharacters:n.containsThaiCharacters}}function R(e){return!!e&&(0,s.analyzeBidiText)(e,l.ReadingOrderType.LeftToRight).HasRtl}function F(e){return{singleSpaceWidth:e.singleSpaceWidth,breakType:e.breakType,isCompleteTextVisible:e.isCompleteTextVisible,isProcessingLastLine:e.isProcessingLastLine,maxWidth:e.maxWidth,lineDirection:e.lineDirection}}function T(e,t,n){return e===r.LineDirection.Vertical?n:t.measureText(" ").width}t.getJustifyDistributedLine=u,t.getSpaceWidthBetweenWords=g,t.prepareTextRunsForJustifyAndDistributed=function(e,t,n,l,a,s){if(0===a.length)throw Error("prepareTextRunsForJustifyAndDistributed: At least one textRun expected");if(0===l.length)return;s&&(n.maxWidth=n.maxWidth-2*i.GridLineWidthPx);const d=C(n,l);if(1===a.length){const t=e.font;let i=t;const c=a[0],h=c.FontCss;i!==h&&(e.font=h,i=h);const C=F(n);C.singleSpaceWidth=T(n.lineDirection,e,c.MaxGlyphHeightPx);let f=u(C,l,g(l,n),d);s||!R(c.Text)||(0,o.isNullOrUndefined)(f)||(f=m(f)),c.JustifyDistributedLine=f,c.WidthPx=function(e,t){let n=0;return t&&e.breakType===r.BreakType.Justify?(n+=null==t?void 0:t.Start.Width,null!=t&&t.Middle&&(n+=null==t?void 0:t.Middle.Width),null!=t&&t.End&&(n+=null==t?void 0:t.End.Width),n):e.maxWidth}(n,f),i!==t&&(e.font=t)}else!function(e,t,n,i,l,a,s=0){const d=g(n,i),c=function(e){let t=e[0].start;for(let n=1;n<e.length;n++)e[n].start<t&&(t=e[n].start);return t}(n),C=e.font;let p=C,y=s;for(let s=0;s<l.length;s++){const g=h(a,l,s),C=g.FontCss;p!==C&&(e.font=C,p=C);const S=F(i);S.singleSpaceWidth=T(i.lineDirection,e,g.MaxGlyphHeightPx);const w=g.StartIndex+c,I=w+(void 0!==g.Text?g.Text.length:0),{currentTextTokens:b,currentTokenWidthPx:v,combinePartialTokens:x}=f(e,t,n,w,I,a,g.MaxGlyphHeightPx);if(0!==b.length){let e=u(S,b,d,y);a||(0,o.isNullOrUndefined)(e)||R(g.Text)&&(e=m(e)),g.JustifyDistributedLine=e,a&&i.lineDirection===r.LineDirection.Vertical?g.HeightPx=v+d*(b.length-1):g.WidthPx=v+d*(b.length-1),x||g.IsSpecialCharTextRun?y+=v+d*(b.length-1):y+=v+d*b.length}}p!==C&&(e.font=C)}(e,t,l,n,a,s,d)},t.reorderTextTokens=function(e,t,n,o){if(!n.HasRtl||n.HasLtr)(0,d.reorderTextTokensUsingDom)(e,t,n,o);else for(let t=0;t<e.tokensPerLine.length;t++)e.tokensPerLine[t].tokens.reverse()},t.getTextRun=h,t.getStartOffset=C},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testCombineThaiTokensPerLine=t.breakTextToLines=void 0;const o=n(4),r=n(168),i=n(169),l=n(3),a=n(1),s=n(32),d=n(35),c=n(9),u=n(14),g=n(0);function h(e,t){e.curLineWidth+=t.width,e.curLineWidth>e.maxWidth&&(A(e,t.width),e.curLineStart=t.start,e.curLineWidth=t.width),e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(t),e.lastFittingToken=t}function C(e,t,n,o,l,a){if(t.type===r.BreakOpTokenType.Space)return void y(e,t,n);void 0!==e.lastFittingToken&&(e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(e.lastFittingToken),A(e));const d=a?(0,s.substringFormattedText)(a,t.start,t.start+t.len):void 0,c=e.isVerticalText?(0,i.breakWideWordVerticalText)(t.value,e.maxWidth,e.textLineHeight):(0,i.breakWideWord)(o,t.value,e.maxWidth,l,d);let u=t.start;for(let t=0;t<c.length-1;t++){const n=c[t],o={text:n.value,width:n.size,underlineWidth:n.size,startIndex:u,endIndex:u+n.value.length};if(u+=n.value.length,e.textLines.push(o),e.isBreakTypeJustifyOrDistributed){const t=(0,g.doesTextContainThaiCharacter)(n.value);e.tokensPerLine.push({tokens:[{text:n.value,width:n.size,start:u,containsThaiCharacters:t}],containsThaiCharacters:t}),M(e,t)}e.isSingleCharTooWide=b(o.width,o.text.length,e.maxWidth,e.isSingleCharTooWide)}const h=function(e,t){const n=e[e.length-1],o=t.start+t.len-n.value.length,i=n.size;return{start:o,len:n.value.length,value:n.value,type:r.BreakOpTokenType.Word,width:i}}(c,t);e.lastFittingToken=h,e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(h),e.curLineWidth=e.lastFittingToken.width,e.curLineStart=e.lastFittingToken.start}function f(e,t,n){void 0!==e.lastFittingToken&&A(e);let o=function(e){switch(e.type){case r.BreakOpTokenType.HardBreak:return e.len;case r.BreakOpTokenType.HardBreakCRLF:return e.len/2;default:throw"breakToLines - this token should be hardBreak token"}}(t);0!==n&&n!==e.tokens.length-1&&o--;for(let n=0;n<o;n++)e.isBreakTypeJustifyOrDistributed&&e.tokensPerLine.push(l.EmptyLineTextToken),e.textLines.push(m(n,t));e.curLineStart=t.start+t.len,e.curLineWidth=0,e.lastFittingToken=void 0}function m(e,t){const n=t.start+e;return{text:"",width:0,underlineWidth:0,startIndex:n,endIndex:n+function(e){return e.type===r.BreakOpTokenType.HardBreakCRLF?l.HardBreakCRLF.length:l.HardBreak.length}(t)}}function p(e,t,n){if(x(t),1===t.len)return e.curLineWidth+=t.width,void(e.lastFittingToken=t);!function(e,t,n){return I(e.tokens,n),!!F(e,n)&&(n===e.tokens.length-1||e.curLineWidth+t.width>e.maxWidth||w(e,t,n))}(e,t,n)?e.curLineWidth+t.width>e.maxWidth||w(e,t,n)?y(e,t,n):(e.curLineWidth+=t.width,e.lastFittingToken=t):T(e,t)}function y(e,t,n){x(t);const o=t.width/t.len,r=e.maxWidth-e.curLineWidth;if(r<0)return;const i=Math.floor(r/o);t.width=o*i,e.curLineWidth+=t.width,e.lastFittingToken=t,(R(e.tokens,n)||F(e,n))&&T(e,t)}function S(e,t){if(I(e,t),!e[t])throw"breakTextToLines - validateToken - tokens[index] is undefined"}function R(e,t){return I(e,t),S(e,t),0===t&&e[t].type===r.BreakOpTokenType.Space}function F(e,t){const n=e.tokens;return I(n,t),t>0&&n[t].type===r.BreakOpTokenType.Space&&D(n[t-1])&&void 0===e.lastFittingToken}function T(e,t){if(t.type!==r.BreakOpTokenType.Space)throw"breakTextToLines - addEmptyLineToTextLines - wrong token type, this function should get only spaces token";const n=_object_spread({},l.EmptyLine),o=t.start+t.len;n.underlineWidth=t.width,n.startIndex=t.start,n.endIndex=o,e.textLines.push(n),e.isBreakTypeJustifyOrDistributed&&e.tokensPerLine.push(l.EmptyLineTextToken),e.curLineStart=o,e.curLineWidth=0,e.lastFittingToken=void 0}function w(e,t,n){if(x(t),n>=e.tokens.length-1)return!1;const o=e.tokens[n+1];return e.curLineWidth+t.width+o.width>e.maxWidth}function I(e,t){if(t<0||t>=e.length)throw"breakTextToLines - invalid token index"}function b(e,t,n,o){if(o)return!0;if(e>n){if(1!==t)throw"breakTextToLines - non single char line is too wide!";return!0}return o}function v(e,t){return e.width<t}function x(e){if(e.type!==r.BreakOpTokenType.Space)throw"breakTextToLines - wrong token type, expected spaces token!"}function D(e){return e.type===r.BreakOpTokenType.HardBreak||e.type===r.BreakOpTokenType.HardBreakCRLF}function A(e,t=0){(0,o.verifyArgumentNotNull)(e.lastFittingToken,"lineBreakCtx.lastFittingToken","createCurrentFittingLine");const n=e.curLineWidth-t;let i=n;if(e.lastFittingToken.type===r.BreakOpTokenType.Space&&(i-=e.lastFittingToken.width),e.isBreakTypeJustifyOrDistributed){const t=function(e){const t=[];let n=!1;for(let o=0;o<e.length;o++){const r=e[o],i=(0,g.doesTextContainThaiCharacter)(r.value);t.push({text:r.value,width:r.width,start:r.start,containsThaiCharacters:i}),i&&!n&&(n=!0)}return{tokens:t,containsThaiCharacters:n}}(e.unprocessedTokens);e.tokensPerLine.push(t),M(e,t.containsThaiCharacters),e.unprocessedTokens=[]}const{text:l,start:a,end:s}=function(e){if(void 0===e.lastFittingToken)throw"breakTextToLines -invalid lastFittingToken - no token was set";const t=e.lastFittingToken.start+e.lastFittingToken.len;return{text:e.text.substring(e.curLineStart,t).trimRight(),start:e.curLineStart,end:t}}(e);e.textLines.push({text:l,underlineWidth:n,width:i,startIndex:a,endIndex:s})}function P(e){const t={tokens:[],containsThaiCharacters:!0};let n=void 0;for(let i=0;i<e.length;i++){const l=e[i];(0,g.doesTextContainThaiCharacter)(l.text)?n?(r=l,n={text:(o=n).text+r.text,width:o.width+r.width,start:o.start,containsThaiCharacters:o.containsThaiCharacters||r.containsThaiCharacters}):n=l:(n&&(t.tokens.push(n),n=void 0),t.tokens.push(l))}var o,r;return n&&t.tokens.push(n),t}function M(e,t){!e.containsThaiCharacters&&t&&(e.containsThaiCharacters=!0)}t.breakTextToLines=function(e,t,n,i,l,s,g,m,y){if((0,o.verifyArgumentNotNull)(e,"canvas2dCtx","breakTextToLines"),""===t)return{textLines:[],tokensPerLine:[],requireClipping:!1};const F=(0,u.shouldRenderVerticalText)(g),T=F?(0,c.getTextLineHeight)(g,s):0,w=(0,r.tokenizeTextToWrap)(e,t,l,s,F,T,m,y),I={text:t,tokens:w,maxWidth:n,unprocessedTokens:[],isSingleCharTooWide:!1,textLines:[],tokensPerLine:[],curLineStart:0,curLineWidth:0,lastFittingToken:void 0,isBreakTypeJustifyOrDistributed:(x=i,x===d.BreakType.Justify||x===d.BreakType.Distributed),containsThaiCharacters:!1,isVerticalText:F,textLineHeight:T};var x;for(let t=0;t<w.length;t++){const o=w[t];if(S(w,t),D(o))f(I,o,t);else if(v(o,n)){if(o.type===r.BreakOpTokenType.Space&&!R(w,t)){p(I,o,t);continue}h(I,o)}else C(I,o,t,e,s,m)}if(void 0!==I.lastFittingToken&&function(e){A(e),e.isSingleCharTooWide=b(e.lastFittingToken.width,e.lastFittingToken.len,e.maxWidth,e.isSingleCharTooWide)}(I),I.isBreakTypeJustifyOrDistributed&&I.textLines.length!==I.tokensPerLine.length)throw new Error(`breakTextToLines::breakTextToLines Mismatch in textLines and textTokenLines.\n      textTokenLines = ${I.tokensPerLine.length}, textLineLength = ${I.textLines.length}, MaxWidth = ${n}, Text = ${(0,a.annonymize)(I.text)}`);return I.isBreakTypeJustifyOrDistributed&&null!=y&&y.BreakOp&&I.containsThaiCharacters&&(I.tokensPerLine=function(e){const t=[];for(let n=0;n<e.length;n++){const o=e[n];o.containsThaiCharacters?t.push(P(o.tokens)):t.push(o)}return t}(I.tokensPerLine)),{textLines:I.textLines,tokensPerLine:I.tokensPerLine,requireClipping:I.isSingleCharTooWide}},t.testCombineThaiTokensPerLine=function(e){return P(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateContextForPhonetic=t.drawPhoneticText=t.drawCellsPhoneticText=void 0;const o=n(9),r=n(22),i=n(0),l=n(8),a=n(4),s=n(5),d=n(58),c=n(2),u=n(73),g=n(91),h=n(92),C=n(32),f=n(14),m=n(13),p=n(3);function y(e,t,n,r,i,l){if(!n.PhonInfo||!n.PhonInfo.Text)return;if(function(e){return e.TextRuns||e.WrapText||(0,f.shouldRenderVerticalText)(e)}(n)||n.PhonInfo&&!n.PhonInfo.PhoneticTextRuns){let a=l;a||(n.TextRuns?(e.save(),a=(0,o.getTextWidth)(e,t,n),e.restore()):a=(0,o.getTextWidth)(e,t,n));const s=R(t,n,a,i),d=(0,h.getNoControlPhoneticText)(n.PhonInfo,n.Text);return e.fillText(d,s,r),void(0,m.setRenderingResultMonitorable)("drawPhoneticText: Row:"+n.Row.toString()+" Col:"+n.Col.toString())}const{phoneticTextRuns:a,textRuns:s}=(0,h.getPhoneticTextRunsForRendering)(n);e.save();const d=(0,o.measureTextRunsWidth)(e,s,n.Text,t,void 0);e.restore();let c=R(t,n,d.totalSize,i);for(let t=0;t<a.length;t++){const o=a[t];if(d.textRunsDrawingInformation[t]){var u;if(0!==o.PhoneticLength){const t=n.PhonInfo.Text.substr(o.PhoneticStartIndex,o.PhoneticLength);e.fillText(t,c,r)}c+=null!==(u=d.textRunsDrawingInformation[t].WidthPx)&&void 0!==u?u:0}}}function S(e,t,n){const o=(0,l.getCellFontWeightStyle)(!1,!1);e.font=(0,l.getFontCssString)(t,o,u.PhoneticFontSizePt,u.PhoneticFontName);const r=(0,d.getDefaultContextState)(n,t.IsRtl);e.fillStyle=r.fontColor,e.direction=u.PhoneticTextDirection,e.textAlign=u.PhoneticTextAlign}function R(e,t,n,i){if((0,r.shouldDrawRotatedText)(e,t.CachedStyle,t.CachedFont))return t.CachedDrawingLayout.TextOrientationLayout.Angle>0?-n:0;if((0,f.shouldRenderVerticalText)(t)||t.WrapText){const n=(0,o.getCellTextHorizontalPadding)(t,e,i.zoom,i.devicePixelRatio);return(0,s.getCellLeft)(e,t,e.BlockWidth)+n}const l=(0,o.getTextHorizontalPosition)(e,t,i);return(0,C.getAdjustedOffsetXforHorizontalAlignment)(e,t,l,!1,n,void 0)}function F(e,t){return!(!t||!(0,c.cellIntersectsRenderingRegion)(t,e.renderingRegion)||(0,g.shouldDrawWrapText)(t)||(0,i.isCellPreviewTextDefined)(t.PreviewText)||t.ShowSkeleton||!t.Text||!t.PhonInfo||t.PhonInfo.Text===p.EmptyString)}function T(e,t,n,i){const l=(0,h.getPhoneticTextVerticalPosition)(t,i),a=function(e,t,n,r){const i=(0,g.shouldDrawSpillCell)(t),l=(0,g.shouldDrawWrapText)(t),a=(0,s.getCellWidth)(e,t,!0),d=(0,s.getCellHeight)(e,t,!0),c=(0,s.getCellTop)(e,t),u=(0,o.getDistanceFromCellStartToIconEnd)(e,t,n,r);return(0,g.getCellClippingForPhonetic)(e,t,l,i,a,d,u,c)}(t,i,n.zoom,n.devicePixelRatio);(0,c.applyClipping)(e,a),function(e,t,n){if((0,r.shouldDrawRotatedText)(t,n.CachedStyle,n.CachedFont)){const t=n.CachedDrawingLayout.TextOrientationLayout;(0,r.applyRotation)(e,t.TranslateX,t.TranslateY,t.Angle),e.textAlign=u.PhoneticRotatedTextAlign}}(e,t,i),y(e,t,i,l,n),function(e,t,n){(0,r.shouldDrawRotatedText)(t,n.CachedStyle,n.CachedFont)&&(e.restore(),e.textAlign=u.PhoneticTextAlign)}(e,t,i),(0,c.restoreClipping)(e,a)}t.drawCellsPhoneticText=function(e,t,n){(0,a.verifyArgumentNotNull)(e,"ctx","drawCellsPhoneticText"),(0,a.verifyArgumentNotNull)(t,"model","drawCellsPhoneticText"),(0,a.verifyArgumentNotNull)(n,"context","drawCellsPhoneticText"),(0,a.verifyArgumentNotNull)(t.Cells,"model.Cells","drawCellsPhoneticText");const o=t.ClientOnlyCache.CellsToRender;let r=!1;S(e,t,n.highContrastScheme);for(let i=0;i<o.length;i++){const l=o[i];if(F(n,l))try{T(e,t,n,l),r=!0}catch(e){throw(0,m.setRenderingResultMonitorable)("Error drawSingleCellPhoneticText: "+e),e}}r&&(0,m.setRenderingResultMonitorable)("drawCellsPhoneticText: Phonetic rendered")},t.drawPhoneticText=y,t.updateContextForPhonetic=S},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldDrawWrapText=t.shouldDrawSpillCell=t.getCellClippingForPhonetic=t.shouldClipText=t.getCellClipping=void 0;const o=n(1),r=n(5),i=n(12),l=n(9),a=n(49),s=n(15),d=n(2),c=n(118),u=n(14),g=n(0);function h(e,t,n){return!!t||n||(0,s.isHorizontalAlignmentCenteredAcrossSelection)(e)||(0,u.shouldRenderVerticalText)(e)||!!e.DisplayFormula||(0,g.isCellPreviewTextDefined)(e.PreviewText)}t.getCellClipping=function(e,t,n,o,i,a,s,d,g,C,f,m){var p;const y=(0,r.getCellLeft)(e,t,e.BlockWidth),S=(0,r.getCellTop)(e,t),R=!(null===(p=t.CondFormat)||void 0===p||!p.Icon)||!!t.RichValueIcon;return t.Merge||a?function(e,t,n,o,i,a,s,d,c,g,h,C){if(t.Merge&&((0,r.isCellSpansMultipleRowsOrBlocks)(t)||i||(0,l.getTextWidth)(n,e,t)>=o||(0,u.shouldRenderVerticalText)(t))||C)return(0,l.getCellTextClipMask)(e,d,c,a,s,g,h)}(e,t,n,o,i,d,g,y,S,C,R,a):s?(0,c.getClipMaskForSpillCell)(e,t,i,C,m,f,g):h(t,i,m)?(0,l.getCellTextClipMask)(e,y,S,d,g,C,R):void 0},t.shouldClipText=h,t.getCellClippingForPhonetic=function(e,t,n,o,a,s,c,u){var g;const h=(0,r.getCellLeft)(e,t,e.BlockWidth),C=(0,r.getCellTop)(e,t),f=void 0!==(null===(g=t.CondFormat)||void 0===g?void 0:g.Icon);if(t.Merge||n)return(0,l.getCellTextClipMask)(e,h,C,a,s,c,f);if(o){const n=(0,i.getExpandCollapseButtonPadding)(t),o=(0,r.getSpillCellWidth)(t,e),l=(0,d.getClipMaskWidth)(o,c,n);return{x:(0,r.getSpillCellStartOffset)(t,e,c,n),y:u,width:l,height:s}}return(0,l.getCellTextClipMask)(e,h,C,a,s,c,f)},t.shouldDrawSpillCell=function(e){return!e.DisplayFormula&&!(0,g.isCellPreviewTextDefined)(e.PreviewText)&&!!e.Spill},t.shouldDrawWrapText=function(e){var t;return!e.DisplayFormula&&!(0,g.isCellPreviewTextDefined)(e.PreviewText)&&!!e.WrapText&&function(e){return!!(0,u.shouldRenderVerticalText)(e)||((0,s.isHorizontalAlignmentJustifiedAndDistributed)(e)||(0,a.isVerticalAlignmentJustifyOrDistributed)(e.CachedStyle.VerticalAlignment)?!(e.CachedIsTextWidthExceedsCellWidth&&e.ValueType===o.CellValueType.Number):!(e.ValueType===o.CellValueType.Number))}(e)&&!((null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment)===o.HorizontalAlignment.Fill)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPhoneticTextRunsForRendering=t.getNoControlPhoneticText=t.getPhoneticVerticalPosition=t.getPhoneticTextVerticalPosition=void 0;const o=n(5),r=n(71),i=n(14),l=n(9),a=n(73),s=n(22);function d(e,t,n,l,a){const d=n+l-a;return(0,i.shouldRenderVerticalText)(t)?function(e,t,n){const i=(0,r.getVerticalTextMetadata)(e,t,t.Text,void 0,n,(0,o.getCellHeight)(e,t,!0));return i.adjustedOffsetY-i.textHeight}(e,t,d):(0,s.shouldDrawRotatedText)(e,t.CachedStyle,t.CachedFont)?l-a:d}t.getPhoneticTextVerticalPosition=function(e,t){const n=(0,l.getTextLineHeight)(t,e),r=a.PhoneticTextHeightPx,i=(0,o.getCellHeight)(e,t,!0),s=(0,l.calculateVerticalAlignment)(e,t,n,i,!!t.DisplayFormula),{absoluteY:c,lastTextLineAlphabeticBaselineOffset:u}=(0,l.getTextVerticalPosition)(t,e,n+r,i,s,void 0);return d(e,t,c,u,n)},t.getPhoneticVerticalPosition=d,t.getNoControlPhoneticText=function(e,t){if(!e.PhoneticTextRuns)return e.Text?e.Text:"";let n="",o=0;for(let r=0;r<e.PhoneticTextRuns.length;r++){const i=e.PhoneticTextRuns[r];o<i.BaseStartIndex&&(n+=t.substring(o,i.BaseStartIndex)),n+=e.Text.substring(i.PhoneticStartIndex,i.PhoneticStartIndex+i.PhoneticLength),o=i.BaseStartIndex+i.BaseTextLength}return o<t.length&&(n+=t.substring(o)),n},t.getPhoneticTextRunsForRendering=function(e){const t=[],n=[];if(!e.PhonInfo||!e.PhonInfo.PhoneticTextRuns)return{phoneticTextRuns:t,textRuns:n};let o=0;for(let d=0;d<e.PhonInfo.PhoneticTextRuns.length;d++){var r,i,l;const c=e.PhonInfo.PhoneticTextRuns[d];if(o<c.BaseStartIndex){var a,s;const r={FontID:null!==(a=null===(s=e.CachedFont)||void 0===s?void 0:s.ID)&&void 0!==a?a:0,StartIndex:o,EndIndex:c.BaseStartIndex,IsSpecialCharTextRun:!1,CachedFont:e.CachedFont};n.push(r),t.push({BaseStartIndex:o,PhoneticStartIndex:0,BaseTextLength:c.BaseStartIndex-o,PhoneticLength:0})}const u={FontID:null!==(r=null===(i=e.CachedFont)||void 0===i?void 0:i.ID)&&void 0!==r?r:0,StartIndex:c.BaseStartIndex,EndIndex:c.BaseStartIndex+(null!==(l=c.BaseTextLength)&&void 0!==l?l:0),IsSpecialCharTextRun:!1,CachedFont:e.CachedFont};n.push(u),t.push(c),o=c.BaseStartIndex+c.BaseTextLength}return{phoneticTextRuns:t,textRuns:n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRotatedTextWidth=void 0;const o=n(1),r=n(22);t.getRotatedTextWidth=function(e,t,n,i){const l=(0,r.degreeToRadians)((0,r.getOrientationInCanvas)(e.IsRtl,i.Orientation||0));return(0,o.isChangeGateEnabled)(o.ChangeGate.FixRotatedTextWidth)?t*Math.abs(Math.cos(l))+n*Math.abs(Math.sin(l)):(0,r.getRotatedTextBoxWidth)(t,n,l)}},function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.Position=void 0,function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(o||(t.Position=o={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAdjustedButtonSize=t.drawExpandCollapseButton=void 0;const o=n(41),r=n(2),i=n(27),l=n(194);function a(e,t,n,o){const i=Math.round(n+o/2)-l.MinusPlusLineAdjustment,a=t.left+l.MinusPlusPaddingPx+l.MinusPlusWidthPx,s=t.left+o-l.MinusPlusWidthPx;e.strokeStyle=t.outerColor,e.beginPath(),(0,r.drawLine)(e,a,i,s,i),e.stroke()}t.drawExpandCollapseButton=function(e,t,n,s,d,c){const u=s.width;let g;c&&(g=(0,o.getClipRect)(t,n,s.left,s.bottom,u,!0)),(0,r.applyClipping)(e,g),(0,i.drawRectangle)(e,s);const h=s.bottom-u;d?a(e,s,h,u):function(e,t,n,o){a(e,t,n,o),function(e,t,n,o){const i=t+Math.round(o/2)+l.MinusPlusLineAdjustment,a=n+l.MinusPlusPaddingPx,s=n+o-l.MinusPlusPaddingPx-l.MinusPlusWidthPx;e.beginPath(),(0,r.drawLine)(e,i,a,i,s),e.stroke()}(e,t.left,n,o)}(e,s,h,u),(0,r.restoreClipping)(e,g)},t.getAdjustedButtonSize=function(e,t){const n=Math.floor(t*e);return n%2==0?n:n-1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldDrawAutoFilter=t.drawAutoFilters=void 0;const o=n(1),r=n(0),i=n(23),l=n(20),a=n(3),s=n(2),d=n(48),c=n(195),u=n(27),g=n(10),h=n(17),C=n(21),f=n(7),m=n(11),p=n(47);function y(e,t){const n=e.AutoFilter;if(!n&&!e.PivotFilter)return!1;if(!(0,s.cellIntersectsRenderingRegion)(e,t.renderingRegion))return!1;if(e.PivotFilter)return e.PivotFilter.DisplayFilter;if(!n.RenderingContext)return!1;const{IsHidden:o,IsRenderingPermitted:i}=n.RenderingContext;return!(o||!i||(0,r.isCellPreviewTextDefined)(e.PreviewText)||e.ShowSkeleton)}function S(e,t,n,a,s,C,y){const S=function(e,t,n,o,r){const i=n.devicePixelRatio,l=(0,h.getFilterSizeAdjustedForDrawing)(e,t,i,n.zoom);return{bottom:(0,h.getFilterBottomAdjustedForDrawing)(e,t,l,i,n.zoom),left:(0,h.getFilterLeftAdjustedForDrawing)(e,t,l,i,n.zoom),height:l,width:l,outerColor:o,innerColor:r,radius:[d.AutoFilterRectRadius]}}(t,n,a,s,C);(0,u.drawRoundRectangle)(e,S);const R=n.PivotFilter,T=n.AutoFilter,w=!(!R||(0,o.isChangeGateEnabled)(o.ChangeGate.TakeAutoFilterBeforePivotFilter)&&T);S.width>d.FilterDrawingThresholdPx&&function(e,t,n,r){switch(e.strokeStyle=r,t){case o.AutoFilterType.Both:case o.AutoFilterType.Filtered:(0,c.drawFilterDownChevronIcon)(e,n);break;case o.AutoFilterType.BothAsc:case o.AutoFilterType.BothTop:(0,c.drawSortUpFilterIcon)(e,n);break;case o.AutoFilterType.BothDesc:case o.AutoFilterType.BothBottom:(0,c.drawSortDownFilterIcon)(e,n);break;case o.AutoFilterType.SortedAsc:case o.AutoFilterType.SortedTop:(0,c.drawSortUpChevronDownIcon)(e,n);break;case o.AutoFilterType.SortedDesc:case o.AutoFilterType.SortedBottom:(0,c.drawSortDownChevronDownIcon)(e,n);break;default:(0,c.drawDownChevronIcon)(e,n)}}(e,w?R.Type:T.Type,S,y);const I=w?R.Title:T.Title;if(!w&&(0,m.getBooleanFeatureGate)("Microsoft.Office.Excel.AddLocalizedAutoFilterTitleMapping",!1)){const e=(0,g.getTooltipTitle)(T.Type)===T.Title;(0,o.isChangeGateEnabled)(o.ChangeGate.ChangeAutoFilterTagLevel)&&!e?f.ULS.sendTraceTag(507561123,f.LogCategory.msoulscat_ES_EWAJSGrid,f.TraceLevel.Important,`AutoFilter title mapping is correct: ${e}, title in model: ${T.Title} , title in mapping: ${(0,g.getTooltipTitle)(T.Type)}`):f.ULS.sendTraceTag(507118223,f.LogCategory.msoulscat_ES_EWAJSGrid,f.TraceLevel.Info,`AutoFilter title mapping is correct: ${e}, title in model: ${T.Title} , title in mapping: ${(0,g.getTooltipTitle)(T.Type)}`)}if(function(e,t){const n=t.PivotFilter;if(n)return n.DisplayFilter&&!n.IsHeaderSnapped;if(!e.PermissionSet)return!1;const{IsAutoFilterDisabled:r,IsSortDisabled:i}=e.PermissionSet,l=(0,o.isPassRibbonCommandsToCanvasRendererEnabled)()||!!e.RibbonCommands;return!(r&&i)&&l}(t,n)){const e=function(e,t){const n=e.RowNumbers[t.Row];return void 0===e.IsRow||e.IsRow?n:-1}(t,n),s=t.ColumnNumbers[n.Col];!function(e,t,n,a,s,d,c){const u=F(e,n,a),h=(0,o.getRenderingRegionHitTestCache)(e,(0,r.getRenderingRegionKey)(n.renderingRegion));(0,l.registerCursorHitRegion)(t,h,u,i.PointerCursorType,o.RenderFeaturesZIndex.AutoFilter),(0,l.registerTooltipHitRegion)(t,h,u,d,o.RenderFeaturesZIndex.AutoFilter),(0,l.registerHitRegion)(t,h,u,o.RenderFeaturesZIndex.AutoFilter,s,"click"),(0,l.registerHitRegion)(t,h,u,o.RenderFeaturesZIndex.AutoFilter,s,"touchend"),(0,l.registerHitRegion)(t,h,u,o.RenderFeaturesZIndex.AutoFilter,e=>!0,"pointerdown"),(0,l.registerHitRegion)(t,h,u,o.RenderFeaturesZIndex.AutoFilter,e=>!0,"dblclick"),(0,l.registerHitRegion)(t,h,u,o.RenderFeaturesZIndex.AutoFilter,i.TouchCallback,"touchstart"),(0,o.isChangeGateEnabled)(o.ChangeGate.PreLoadAutoFilterSlicesOnMouseEnter)&&!c&&(0,l.registerMouseEnterHitRegion)(t,h,u,o.RenderFeaturesZIndex.AutoFilter,e=>((0,g.onAutoFilterMouseEnter)(),!1))}(t,n,a,S,w?t=>((0,g.pivotFilterClickHandler)(t,R.CommandData,R.IsPivotPageField,e,s),!0):n=>{const r=(0,o.isPassRibbonCommandsToCanvasRendererEnabled)()?(0,p.getRibbonCommandsInstance)().ShowAutoFilterMenu:t.RibbonCommands.ShowAutoFilterMenu;return(0,g.handleRibbonCommand)(n,r,T.CommandData,void 0,e,s),!0},I,w)}else{const e=F(t,a,S),s=(0,o.getRenderingRegionHitTestCache)(t,(0,r.getRenderingRegionKey)(a.renderingRegion));(0,l.registerTooltipHitRegion)(n,s,e,I,o.RenderFeaturesZIndex.AutoFilter),(0,l.registerCursorHitRegion)(n,s,e,i.DefaultCursorType,o.RenderFeaturesZIndex.AutoFilter)}}function R(e,t){return e?(0,r.rgbToColorHex)(e.TextColor):t===o.AutoFilterType.None?d.NoneFilterTypeStrokeColor:d.FilterStrokeColor}function F(e,t,n){const o={x:n.left,y:n.bottom-n.height,width:n.width,height:n.height};return(0,C.getUnadjustedHitRegionFromRect)(e,t,o,!1)}t.drawAutoFilters=function(e,t,n){(0,o.verifyArgumentNotNull)(e,"ctx","drawAutoFilters"),(0,o.verifyArgumentNotNull)(t,"model","drawAutoFilters"),(0,o.verifyArgumentNotNull)(n,"context","drawAutoFilters");const i=t.ClientOnlyCache.CellsToRender;let l=!1;const s=function(e){return e?(0,r.rgbToColorHex)(e.TextColor):d.AutoFilterBorderColor}(n.highContrastScheme),c=function(e){return e?(0,r.rgbToColorHex)(e.BackgroundColor):d.AutoFilterBackgroundColor}(n.highContrastScheme),u=(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.FiltersUXModernization,t),g=n.highContrastScheme;let h;u||(h=function(e){return e?(0,r.rgbToColorHex)(e.TextColor):d.AutoFilterStrokeColor}(n.highContrastScheme)),u&&g&&(h=R(g,void 0));for(let o=0;o<i.length;o++){const r=i[o];y(r,n)&&(l||(e.setLineDash(a.DefaultDash),e.lineWidth=d.AutoFilterLineWidthPx,l=!0),u&&!g&&(h=R(g,r.AutoFilter?r.AutoFilter.Type:r.PivotFilter.Type)),S(e,t,r,n,s,c,h))}},t.shouldDrawAutoFilter=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGridRendererCustomCursorsInitialized=t.initGridRendererCustomCursors=t.gridRendererCustomCursors=void 0;const o=n(7),r=n(6);t.initGridRendererCustomCursors=function(e){o.ULS.sendTraceTag(509110487,o.LogCategory.msoulscat_ES_EWAJSGrid,o.TraceLevel.Info,"GridRendererCustomCursors: initGridRendererCustomCursors:: isNullOrUndefined(strings): "+(0,r.isNullOrUndefined)(e)),t.gridRendererCustomCursors=e},t.isGridRendererCustomCursorsInitialized=function(){return!(0,r.isNullOrUndefined)(t.gridRendererCustomCursors)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeTableRanges=t.initializeCachedObjects=t.updateCellsBeforeDrawing=t.updatePivotTablesInformationBeforeDrawing=t.preprocessAutofitWidth=void 0;const o=n(1),r=n(0),i=n(8),l=n(4),a=n(76),s=n(216),d=n(39),c=n(131),u=n(77),g=n(3),h=n(10),C=n(6),f=n(2),m=n(7);let p=!1;t.preprocessAutofitWidth=function(e,t,n,i){const l=[];if(!t.ColMetadata)return l;try{for(let e=0;e<t.ColMetadata.length;e++){const n=t.ColMetadata[e],o=t.ColumnNumbers[e];n?n.SrvDx&&n.SrvDx>0&&(0,u.getColSrvDx)(o)!==n.SrvDx&&(0,u.removeColMetadata)(o):(0,u.removeColMetadata)(o)}let s=0;for(let n=0;n<t.ColMetadata.length;n++){const r=t.ColMetadata[n],i=t.ColumnNumbers[n];if(t.ColumnOffsets[n]=s,r&&r.SrvDx&&r.SrvDx>0){const a=(0,u.getColMetadata)(i);if(a&&r.SrvDx===a.SrvDx)a.CachedColWidth&&(l.push({colIndex:i,newWidth:a.CachedColWidth,isCacheChanged:!1}),t.ColumnWidths[n]=a.CachedColWidth);else{if(r.CachedStyle=(0,o.getReferencedObjectById)(r.CellStyleId||0,t.Styles),r.CachedFont=(0,o.getReferencedObjectById)(r.CachedStyle.FontID||0,t.Fonts),r.CachedStyle.VerticalText)continue;r.CachedColWidth=(0,c.calculateColWidthForMetadata)(e,t,r),l.push({colIndex:i,newWidth:r.CachedColWidth,isCacheChanged:!0}),t.ColumnWidths[n]=r.CachedColWidth,(0,u.setColMetadata)(i,r)}}s+=t.ColumnWidths[n]}return t.BlockWidth=s,(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.TextWidthClientNewProcessing,t)&&void 0!==n&&void 0!==i&&function(e,t,n,i){(0,o.initModelClientCache)(t),(0,f.initializeOffsetsForDrawing)(t,n*i);const l=t.Cells;for(let s=0;s<l.length;s++){const c=l[s];if(c.CachedStyle=(0,o.getReferencedObjectById)(c.StyleID||0,t.Styles),c.CachedFont=(0,o.getReferencedObjectById)(c.CachedStyle.FontID||0,t.Fonts),!(0,C.isNullOrUndefined)(c.TextRuns))for(let e=0;e<c.TextRuns.length;e++){const n=c.TextRuns[e];n.CachedFont=(0,o.getReferencedObjectById)(n.FontID||0,t.Fonts)}const u=c.CachedFont.Italic,g=c.CachedFont.FontName!==d.DefaultFontName,h=!!c.TextRuns,f=c.CachedFont.Underline!==o.FontUnderline.None||c.CachedFont.StrikeThrough,m=!!c.AutoFilter;if(c.Text&&(c.CachedDisplayText=(0,r.getDisplayText)(c,t)),!c.DisplayFormula&&!(0,r.isCellPreviewTextDefined)(c.PreviewText))if(c.TolType===o.TolType.Autofit)switch(c.ValueType){case o.CellValueType.Number:c.Spill=void 0;break;case o.CellValueType.String:(u||g||f||h||m)&&(0,a.updateCellSpill)(e,t,c,n,i)}else(c.TolType===o.TolType.Spill||m)&&(0,a.updateCellSpill)(e,t,c,n,i)}}(e,t,n,i),l}catch(e){if((0,o.isChangeGateEnabled)(o.ChangeGate.ImprovedExceptionHandling))return m.ULS.sendTraceTag(507360604,m.LogCategory.msoulscat_ES_EWAJSGrid,m.TraceLevel.Warning,"GridCanvasRenderer.preprocessAutofitWidth: Error occurred while preprocessing autofit width. Error: "+e),l;throw e}},t.updatePivotTablesInformationBeforeDrawing=function(e,t){if(e&&0!==e.length)for(let n=0;n<e.length;n++){const o=e[n];o.DeltaXFromOriginPTAdjustedForDrawing=Math.round(o.DeltaXFromOriginPT*t),o.DeltaYFromOriginPTAdjustedForDrawing=Math.round(o.DeltaYFromOriginPT*t),o.OriginPTHeightAdjustedForDrawing=Math.round(o.OriginPTHeight*t),o.OriginPTWidthAdjustedForDrawing=Math.round(o.OriginPTWidth*t)}},t.updateCellsBeforeDrawing=function(e,t,n){const l=t.ClientOnlyCache.CellsToRender,c=(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.ByExamplePreviewMode,t);for(let u=0;u<l.length;u++){const g=l[u],h=g.CachedFont.Italic,C=g.CachedFont.FontName!==d.DefaultFontName,f=!!g.TextRuns,m=g.CachedFont.Underline!==o.FontUnderline.None||g.CachedFont.StrikeThrough,p=!!g.AutoFilter;if(g.DisplayFormula=(0,r.shouldRenderFormulaOnCell)(g,n.isFormulaView),c){const e=(0,r.getPreviewCellsRange)(t);e&&n.isCellsPreviewMode&&(0,o.isModelCellContainedInRange)(t,e,g)||(g.PreviewText=void 0,g.PreviewNumFmt=void 0,g.PreviewCellStyle=void 0,(0,o.isChangeGateEnabled)(o.ChangeGate.PreviewCellsSettings)&&(g.RetainTextOnPreview=void 0))}else g.PreviewText&&(g.PreviewText=void 0),g.PreviewNumFmt&&(g.PreviewNumFmt=void 0),g.PreviewCellStyle&&(g.PreviewCellStyle=void 0),(0,o.isChangeGateEnabled)(o.ChangeGate.PreviewCellsSettings)&&(g.RetainTextOnPreview=void 0);if(g.Text&&(g.CachedDisplayText=(0,r.getDisplayText)(g,t)),!g.DisplayFormula&&!(0,r.isCellPreviewTextDefined)(g.PreviewText))if(g.Text&&(0,i.cellHasShrinkToFit)(g)&&(0,s.updateCellShrinkToFit)(e,t,g,n),(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.TextWidthClientPhase1,t))if(g.TolType===o.TolType.Autofit)switch(g.ValueType){case o.CellValueType.Number:g.Spill=void 0;break;case o.CellValueType.String:(h||C||m||f||p)&&(0,a.updateCellSpill)(e,t,g,n.zoom,n.devicePixelRatio)}else(g.TolType===o.TolType.Spill||p)&&((0,a.updateCellSpill)(e,t,g,n.zoom,n.devicePixelRatio),(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.MoveSpillCellBeforeRendering,t)&&((0,r.setCellAndSpannedOverCellsDirty)(t,g),g.Spill&&(0,r.removeBordersWithinASpillCell)(t,g)));else(h||C||m||f||p)&&(0,a.updateCellSpill)(e,t,g,n.zoom,n.devicePixelRatio);g.Merge&&(0,r.updateCellMergeInformation)(t,g,n.scaleFactor)}},t.initializeCachedObjects=function(e,t,n){(0,l.verifyArgumentNotNull)(e.Cells,"cells","GridCanvasRenderer.initializeCachedObjects"),(0,l.verifyArgumentNotNull)(e.Styles,"styles","GridCanvasRenderer.initializeCachedObjects"),(0,l.verifyArgumentNotNull)(e.Fonts,"fonts","GridCanvasRenderer.initializeCachedObjects"),(0,o.preprocessStyles)(e),(0,o.initModelClientCache)(e),n&&(0,o.cleanHitTestCache)(e,(0,r.getRenderingRegionKey)(t));const i=function(e){return void 0===p&&(p=(0,o.isGlobalFontsAndCellStylesFlightEnabled)(e)&&(0,o.isChangeGateEnabled)(o.ChangeGate.DiffRenderingOptimization)),p}(e)?e.ClientOnlyCache.CellsToRender:e.Cells;for(let t=0;t<i.length;t++){const n=i[t];(0,r.initializeCellCachedObjects)(e,n,!1)}},t.initializeTableRanges=function(e){const t={FirstRow:e.RowNumbers[g.BlockRowStartIndex],FirstColumn:e.ColumnNumbers[g.BlockColumnStartIndex],LastRow:e.RowNumbers[g.BlockRowEndIndex],LastColumn:e.ColumnNumbers[g.BlockColumnEndIndex]},n=(0,h.getTablesRangeContainingRange)(t,!1);if(n){const t=(0,o.getModelClientCache)(e);t.TableRangesCache=n,t.DisableDiffRendering=!0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InsertButtonStrokeWidth=t.ThreeSixtyDegreeInRadians=t.InsertButtonLineHeight=t.InsertButtonRowPadding=t.InsertButtonColumnPadding=t.InsertButtonRadius=t.InsertDotRowPadding=t.InsertDotColumnPadding=t.InsertDotRadius=t.RowHeaderBottomInsertHitRegionHeight=t.RowHeaderTopInsertHitRegionHeight=t.ColumnHeaderEndInsertHitRegionWidth=t.ColumnHeaderStartInsertHitRegionWidth=void 0,t.ColumnHeaderStartInsertHitRegionWidth=7,t.ColumnHeaderEndInsertHitRegionWidth=8,t.RowHeaderTopInsertHitRegionHeight=5,t.RowHeaderBottomInsertHitRegionHeight=6,t.InsertDotRadius=2,t.InsertDotColumnPadding=1,t.InsertDotRowPadding=6,t.InsertButtonRadius=5,t.InsertButtonColumnPadding=0,t.InsertButtonRowPadding=4,t.InsertButtonLineHeight=7,t.ThreeSixtyDegreeInRadians=2*Math.PI,t.InsertButtonStrokeWidth=1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.duplicateCell=t.duplicateModel=void 0;const o=n(0),r=(0,n(11).isChangeGateEnabled)("OfficeVSO:8688175_bitwiseBorderDuplicate");function i(e){const t=function(e){if(e)return{SpanToEnd:e.SpanToEnd,SpanToStart:e.SpanToStart,IsSpillBlocked:e.IsSpillBlocked,IsSpillingOutsideOfBlock:e.IsSpillingOutsideOfBlock}}(e.Spill),n=function(e){if(e)return{Columns:e.Columns,Rows:e.Rows,IsOrigin:e.IsOrigin,OriginRow:e.OriginRow||0,OriginColumn:e.OriginColumn||0,SpansBlocks:e.SpansBlocks,Width:e.Width,Height:e.Height,OriginDeltaX:e.OriginDeltaX,OriginDeltaY:e.OriginDeltaY,WidthAdjustedForDrawing:e.WidthAdjustedForDrawing,HeightAdjustedForDrawing:e.HeightAdjustedForDrawing,OriginDeltaXAdjustedForDrawing:e.OriginDeltaXAdjustedForDrawing,OriginDeltaYAdjustedForDrawing:e.OriginDeltaYAdjustedForDrawing,SpansNextBlockVertically:e.SpansNextBlockVertically,SpansNextBlockHorizontally:e.SpansNextBlockHorizontally}}(e.Merge),i=function(e){if(e)return{Start:e.Start,End:e.End,Separator:e.Separator}}(e.NumFmt),l=function(e){if(!e)return;const t=[];if(e.PhoneticTextRuns)for(let o=0;o<e.PhoneticTextRuns.length;o++)t.push({BaseStartIndex:(n=e.PhoneticTextRuns[o]).BaseStartIndex,PhoneticStartIndex:n.PhoneticStartIndex,BaseTextLength:n.BaseTextLength,PhoneticLength:n.PhoneticLength});var n;return{Text:e.Text,PhoneticTextRuns:t}}(e.PhonInfo),u=function(e){if(!e)return;let t=void 0;var n,o;return e.Domain&&(t={Id:null===(n=e.Domain)||void 0===n?void 0:n.Id,StringId:null===(o=e.Domain)||void 0===o?void 0:o.StringId}),{Domain:t,IconWidth:e.IconWidth}}(e.LinkedEntity),g=function(e){if(e)return{Width:e.Width,Type:e.Type,Unicode:e.Unicode}}(e.RichValueIcon),h=function(e){if(e)return{Type:e.Type}}(e.InCellControlOptions),C=function(e){if(e)return{Icon:a(e.Icon),DataBar:s(e.DataBar)}}(e.CondFormat),f=function(e){if(!e)return;let t=void 0;return e.InternalLink&&(t={ObjectName:e.InternalLink.ObjectName,SheetName:e.InternalLink.SheetName,FirstRow:e.InternalLink.FirstRow,FirstColumn:e.InternalLink.FirstColumn,LastRow:e.InternalLink.LastRow,LastColumn:e.InternalLink.LastColumn}),{Text:e.Text,IsValidHyperlink:e.IsValidHyperlink,IsHyperlinkFormula:e.IsHyperlinkFormula,IsHyperlinkExternal:e.IsHyperlinkExternal,IsHyperlinkChecked:e.IsHyperlinkChecked,Tooltip:e.Tooltip,InternalLink:t}}(e.Hyperlink),m=d(e.Sparkline),p=d(e.InCellImage),y=function(e){if(e)return{HasExpandCollapseIndicator:e.HasExpandCollapseIndicator,IsExpanded:e.IsExpanded,ECButtonTitle:e.ECButtonTitle,ShouldShowExpandCollapseMenu:e.ShouldShowExpandCollapseMenu,CanExpandCollapse:e.CanExpandCollapse,SourceIndex:e.SourceIndex,ConfirmRequired:e.ConfirmRequired,CanShowDetails:e.CanShowDetails}}(e.PivotTable),S=function(e){if(e)return{Row:e.Row,Column:e.Column,IsThreadedComment:e.IsThreadedComment,HideCommentIndicator:e.HideCommentIndicator}}(e.Comment),R=function(e){if(e)return{Formula:e.Formula,FormulaType:e.FormulaType,IsArrayRoot:e.IsArrayRoot}}(e.FormulaInfo),F=function(e){if(e)return{Type:e.Type,Title:e.Title,Menu:e.Menu,RenderingContext:e.RenderingContext,CommandData:e.CommandData?e.CommandData:void 0}}(e.AutoFilter),T=function(e){if(e)return{Type:e.Type,DisplayFilter:e.DisplayFilter,IsPivotPageField:e.IsPivotPageField,CommandData:e.CommandData,Title:e.Title,IsHeaderSnapped:e.IsHeaderSnapped}}(e.PivotFilter),w=function(e){if(e)return{IsAnchor:e.IsAnchor,Range:e.Range?c(e.Range):void 0}}(e.DynamicArrayInfo);let I=[];if(e.TextRuns)for(let t=0;t<e.TextRuns.length;t++)I.push((0,o.duplicateTextRun)(e.TextRuns[t],e.TextRuns[t].FontID||0));else I=void 0;return{Col:e.Col,Row:e.Row,Text:e.Text,StyleID:e.StyleID||0,GlobalCellStyleID:e.GlobalCellStyleID,Ifmt:e.Ifmt||0,IfmtStamped:e.IfmtStamped||0,BorderStyleID:e.BorderStyleID||0,GlobalBorderStyleID:e.GlobalBorderStyleID,HorizontalAlignmentSet:e.HorizontalAlignmentSet,Spill:t,Merge:n,NumFmt:i,WrapText:e.WrapText,ShrunkSize:e.ShrunkSize,AutoFilter:F,PivotFilter:T,TextRuns:I,CondFormat:C,PhonInfo:l,Comment:S,RichValueType:e.RichValueType,RichValueFieldsIndexes:e.RichValueFieldsIndexes?[...e.RichValueFieldsIndexes]:void 0,FormulaInfo:R,ValueType:e.ValueType,HasError:e.HasError,Hyperlink:f,Sparkline:m,InCellImage:p,LinkedEntity:u,RichValueIcon:g,InCellControlOptions:h,PivotTable:y,HasIgnorableError:e.HasIgnorableError,SrvDx:e.SrvDx||0,SrvDy:e.SrvDy||0,TolType:e.TolType,TableColHeader:e.TableColHeader,TableRowHeader:e.TableRowHeader,Value:e.Value,PhoneticInfo:e.PhoneticInfo,OriginalText:e.OriginalText,ErrorTooltip:e.ErrorTooltip,DynamicArrayInfo:w,BitwiseBorderPosition:r&&e.BitwiseBorderPosition||0}}function l(e){const t=[];if(e.Outlines)for(let o=0;o<e.Outlines.length;o++)t.push({StartIndex:(n=e.Outlines[o]).StartIndex,ButtonIndex:n.ButtonIndex,IsExpanded:n.IsExpanded,IsButtonHidden:n.IsButtonHidden,IsNonDefaultDirection:n.IsNonDefaultDirection,ECTitle:n.ECTitle});var n;return{Outlines:t}}function a(e){if(e)return{Set:e.Set,Index:e.Index,IconOnly:e.IconOnly,CFIconHorizontalAlignment:e.CFIconHorizontalAlignment}}function s(e){if(e)return{AxisColor:e.AxisColor,AxisPostion:e.AxisPostion,Length:e.Length,Color:e.Color,GradientColor:e.GradientColor,BorderColor:e.BorderColor,Direction:e.Direction}}function d(e){if(e)return{ClusterOffsetX:e.ClusterOffsetX,ClusterOffsetY:e.ClusterOffsetY,AltText:e.AltText,Width:e.Width,Height:e.Height,ClusterImageWidth:e.ClusterImageWidth,ClusterImageHeight:e.ClusterImageHeight}}function c(e){return{FirstRow:e.FirstRow,FirstColumn:e.FirstColumn,LastRow:e.LastRow,LastColumn:e.LastColumn}}function u(e){return{Index:e.Index,Caption:e.Caption,ShowBlankLineAfterEachItem:e.ShowBlankLineAfterEachItem,ShowSubtotal:e.ShowSubtotal,RepeatItemLabels:e.RepeatItemLabels,ShowItemsWithNoData:e.ShowItemsWithNoData,ShowSubtotalAtTop:e.ShowSubtotalAtTop,IsCompactLayout:e.IsCompactLayout,BaseFieldIndex:e.BaseFieldIndex,DataFieldAggregationType:e.DataFieldAggregationType,DataFieldFormatType:e.DataFieldFormatType,SortInfo:e.SortInfo,LabelOrDateFilterType:e.LabelOrDateFilterType,ValueFilterType:e.ValueFilterType,MeasureType:e.MeasureType,HasManualFilter:e.HasManualFilter,IsDateField:e.IsDateField,IsImplicitMeasure:e.IsImplicitMeasure,IsNumeric:e.IsNumeric}}function g(e){const t=e.RowAreaCaptions?[...e.RowAreaCaptions]:void 0,n=e.RowAreaFields?[]:void 0;if(e.RowAreaFields)for(let t=0;t<e.RowAreaFields.length;t++)n.push(u(e.RowAreaFields[t]));const o=e.ColumnAreaFields?[]:void 0;if(e.ColumnAreaFields)for(let t=0;t<e.ColumnAreaFields.length;t++)o.push(u(e.ColumnAreaFields[t]));const r=e.ValueAreaFields?[]:void 0;if(e.ValueAreaFields)for(let t=0;t<e.ValueAreaFields.length;t++)r.push(u(e.ValueAreaFields[t]));const i=e.PageAreaFields?[]:void 0;if(e.PageAreaFields)for(let t=0;t<e.PageAreaFields.length;t++)i.push(u(e.PageAreaFields[t]));const l=e.SlicerConnections?[]:void 0;if(e.SlicerConnections)for(let t=0;t<e.SlicerConnections.length;t++)l.push({Name:(a=e.SlicerConnections[t]).Name,Caption:a.Caption,WorksheetName:a.WorksheetName,Enabled:a.Enabled});var a;return{FirstRow:e.FirstRow,FirstColumn:e.FirstColumn,LastRow:e.LastRow,LastColumn:e.LastColumn,RangeType:e.RangeType,ConnectionName:e.ConnectionName,PivotTableName:e.PivotTableName,ConfirmationRequiredForDataOps:e.ConfirmationRequiredForDataOps,FieldListVersion:e.FieldListVersion,FieldWellVersion:e.FieldWellVersion,ColumnTotalIndexes:e.ColumnTotalIndexes,RowTotalIndexes:e.RowTotalIndexes,ColumnMemberPropIndexes:e.ColumnMemberPropIndexes,RowMemberPropIndexes:e.RowMemberPropIndexes,OriginPTWidth:e.OriginPTWidth,OriginPTHeight:e.OriginPTHeight,DeltaXFromOriginPT:e.DeltaXFromOriginPT,DeltaYFromOriginPT:e.DeltaYFromOriginPT,ColumnHeaderRange:e.ColumnHeaderRange,RowHeaderRange:e.RowHeaderRange,RowAreaCaptions:t,ExternalSourceIndex:e.ExternalSourceIndex,IsActionable:e.IsActionable,IsOlap:e.IsOlap,SupportsBIExplore:e.SupportsBIExplore,HideGridLines:e.HideGridLines,IsEmptyPivot:e.IsEmptyPivot,Xluid:e.Xluid,ShowDrillIndicators:e.ShowDrillIndicators,ShowColumnStripes:e.ShowColumnStripes,ShowRowStripes:e.ShowRowStripes,ShowRowHeaders:e.ShowRowHeaders,ShowColumnHeaders:e.ShowColumnHeaders,DataSource:e.DataSource,RowLocation:e.RowLocation,ColGrandTotalOn:e.ColGrandTotalOn,RwGrandTotalOn:e.RwGrandTotalOn,IndentIncrement:e.IndentIncrement,AutoFormatOnUpdate:e.AutoFormatOnUpdate,ShowItemsWithNoDataOnRw:e.ShowItemsWithNoDataOnRw,ShowItemsWithNoDataOnCol:e.ShowItemsWithNoDataOnCol,SaveSourceDataWithFile:e.SaveSourceDataWithFile,RefreshOnLoad:e.RefreshOnLoad,AltText:e.AltText,AltTextSummary:e.AltTextSummary,ErrorString:e.ErrorString,NullString:e.NullString,DataPivotFieldCaption:e.DataPivotFieldCaption,DataPivotFieldIndex:e.DataPivotFieldIndex,DisplayErrorString:e.DisplayErrorString,DisplayNullString:e.DisplayNullString,HasActiveFilter:e.HasActiveFilter,IsPageArea:e.IsPageArea,RowAreaFields:n,ColumnAreaFields:o,ValueAreaFields:r,PageAreaFields:i,CurrentStyleName:e.CurrentStyleName,FirstRowIndex:e.FirstRowIndex,FirstColIndex:e.FirstColIndex,LastRowIndex:e.LastRowIndex,LastColIndex:e.LastColIndex,StyleIndex:e.StyleIndex,IsRefreshableTabularOlap:e.IsRefreshableTabularOlap,SlicerConnections:l,OriginPTWidthAdjustedForDrawing:e.OriginPTWidthAdjustedForDrawing,OriginPTHeightAdjustedForDrawing:e.OriginPTHeightAdjustedForDrawing,DeltaXFromOriginPTAdjustedForDrawing:e.DeltaXFromOriginPTAdjustedForDrawing,DeltaYFromOriginPTAdjustedForDrawing:e.DeltaYFromOriginPTAdjustedForDrawing,AutoRefresh:e.AutoRefresh,SupportsAutoRefresh:e.SupportsAutoRefresh}}t.duplicateModel=function(e){if(!e)return null;const t=e.ColumnNumbers?[...e.ColumnNumbers]:void 0,n=e.ColumnWidths?[...e.ColumnWidths]:void 0,r=e.ColumnOffsets?[...e.ColumnOffsets]:void 0,a=e.ColMetadata?[...e.ColMetadata]:void 0,s=e.FixedColumns?[...e.FixedColumns]:void 0,d=e.RowNumbers?[...e.RowNumbers]:void 0,u=e.RowHeights?[...e.RowHeights]:void 0,h=e.RowOffsets?[...e.RowOffsets]:void 0,C=[];if(e.Cells)for(let t=0;t<e.Cells.length;t++)C.push(i(e.Cells[t]));const f=[];if(e.Styles)for(let t=0;t<e.Styles.length;t++){let n=e.Styles[t];n&&(n=(0,o.duplicateOnlyStyleWithoutFont)(n,n.ID||0,n.RefCount||0)),f.push(n)}const m=[];if(e.BorderStyles)for(let t=0;t<e.BorderStyles.length;t++){let n=e.BorderStyles[t];n&&(n=(0,o.duplicateBorderStyle)(n,n.ID||0,n.RefCount||0)),m.push(n)}const p=[];if(e.Fonts)for(let t=0;t<e.Fonts.length;t++){let n=e.Fonts[t];n&&(n=(0,o.duplicateFont)(n,n.ID||0,n.RefCount||0)),p.push(n)}const y=e.PrintAreas?[]:void 0;if(e.PrintAreas)for(let t=0;t<e.PrintAreas.length;t++)y.push(c(e.PrintAreas[t]));const S=e.PivotTables?[]:void 0;if(e.PivotTables)for(let t=0;t<e.PivotTables.length;t++)S.push(g(e.PivotTables[t]));const R=e.AllRichValueFields?[]:void 0;if(e.AllRichValueFields)for(let t=0;t<e.AllRichValueFields.length;t++)R.push({Index:(F=e.AllRichValueFields[t]).Index,RefersToDotFunction:F.RefersToDotFunction,Value:F.Value});var F;const T=[...e.RenderFlagsArray],w=e.RibbonCommands?{ShowAutoFilterMenu:(I=e.RibbonCommands).ShowAutoFilterMenu,CardViewShowTemporaryDataCard:I.CardViewShowTemporaryDataCard,CardViewShowTemporaryErrorCard:I.CardViewShowTemporaryErrorCard,CardViewHideTemporaryCard:I.CardViewHideTemporaryCard,CardViewShowDataCardOrDisambiguationPane:I.CardViewShowDataCardOrDisambiguationPane,ToggleInCellControlCheckbox:I.ToggleInCellControlCheckbox}:void 0;var I;const b=e.PageBreaks?{Row:(D=e.PageBreaks).Row?[...D.Row]:void 0,Col:D.Col?[...D.Col]:void 0}:void 0,v=e.Sparklines?function(e){const t=[];for(let o=0;o<e.Ranges.length;o++)t.push({LocationRow:(n=e.Ranges[o]).LocationRow,LocationColumn:n.LocationColumn,SparklineType:n.SparklineType,FirstRow:n.FirstRow,FirstColumn:n.FirstColumn,LastRow:n.LastRow,LastColumn:n.LastColumn,RangeType:n.RangeType});var n;return{Ranges:t,ImageUrl:e.ImageUrl,Version:e.Version}}(e.Sparklines):void 0,x=e.InCellImages?{ImageUrl:(A=e.InCellImages).ImageUrl,Version:A.Version}:void 0;var D,A;const P=e.PermissionSet?{IsAutoFilterDisabled:(M=e.PermissionSet).IsAutoFilterDisabled,IsSortDisabled:M.IsSortDisabled}:void 0;var M;const B=e.AdjacentBlocksHiddensInfo?{IsFirstColOfNextBlockHidden:(H=e.AdjacentBlocksHiddensInfo).IsFirstColOfNextBlockHidden,IsFirstRowOfNextBlockHidden:H.IsFirstRowOfNextBlockHidden,IsLastRowOfPrevBlockHidden:H.IsLastRowOfPrevBlockHidden,IsLastColOfPrevBlockHidden:H.IsLastColOfPrevBlockHidden}:void 0;var H;const O=e.RowOutlinesInformation?[]:void 0;if(e.RowOutlinesInformation)for(let t=0;t<e.RowOutlinesInformation.length;t++)O.push(l(e.RowOutlinesInformation[t]));const k=e.ColumnOutlinesInformation?[]:void 0;if(e.ColumnOutlinesInformation)for(let t=0;t<e.ColumnOutlinesInformation.length;t++)k.push(l(e.ColumnOutlinesInformation[t]));return{BlockWidth:e.BlockWidth,BlockHeight:e.BlockHeight,RowOffsets:h,ColumnOffsets:r,RowHeights:u,ColumnWidths:n,RowNumbers:d,ColumnNumbers:t,ColMetadata:a,FixedColumns:s,RowOutlinesInformation:O,ColumnOutlinesInformation:k,MaxRowOutlineLevelInSheet:e.MaxRowOutlineLevelInSheet,MaxColOutlineLevelInSheet:e.MaxColOutlineLevelInSheet,UniqueId:e.UniqueId,ShowGridLines:e.ShowGridLines,ShowHeaders:e.ShowHeaders,IsRtl:e.IsRtl,PermissionSet:P,GridLineColor:e.GridLineColor,BackgroundColor:e.BackgroundColor,Cells:C,Styles:f,Fonts:p,BorderStyles:m,CellsEncoding:e.CellsEncoding||0,RenderFlagsArray:T,HandleFlagsMismatch:e.HandleFlagsMismatch,PageBreaks:b,PrintAreas:y,PivotTables:S,Sparklines:v,InCellImages:x,AllRichValueFields:R,RibbonCommands:w,AdjacentBlocksHiddensInfo:B,IsCanvasHeadersSupported:e.IsCanvasHeadersSupported,HeadersFallbackReason:e.HeadersFallbackReason,HasTable:e.HasTable,HasOutline:e.HasOutline,IsBitwiseFixedRows:e.IsBitwiseFixedRows}},t.duplicateCell=i},function(e,t,n){"use strict";n.r(t);var o=n(102);for(var r in o)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(r);var i=n(141);n.d(t,"toastElementId",(function(){return i.d})),n.d(t,"UnavailabilityToast",(function(){return i.a})),n.d(t,"UnavailabilityToastFactory",(function(){return i.b})),n.d(t,"UnavailabilityToastManager",(function(){return i.c}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(61);o.__exportStar(n(254),t),o.__exportStar(n(103),t),o.__exportStar(n(218),t),o.__exportStar(n(234),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GridCanvasRenderer=void 0;const o=n(1),r=n(55),i=n(161),l=n(111),a=n(13),s=n(112),d=n(122),c=n(177),u=n(0),g=n(114),h=n(115),C=n(40),f=n(178),m=n(188),p=n(189),y=n(190),S=n(191),R=n(193),F=n(126),T=n(96),w=n(31),I=n(127),b=n(196),v=n(198),x=n(200),D=n(120),A=n(90),P=n(201),M=n(202),B=n(204),H=n(129),O=n(98),k=n(2),L=n(217);class N extends H.CanvasRenderer{renderInternal(e,t,n){try{(0,u.validateRenderingRegion)(n.renderingRegion,t,n);const l=n.scaleFactor,H=Math.round(t.BlockWidth*l),O=n.renderingRegion,k=-1*O.startOffsetY*l,N=(0,u.getDrawingOffsetXForRenderingRegion)(t,O)*l,E=(0,o.isDifferentialRenderingSupported)(t);return E&&(this.setTransform(1,!1,N,k,H),(0,I.maskDifferentialRenderingAreas)(t,this.ctx)),this.setTransform(1,!1,0,0,H),this.clearCanvas(t,e.getWidth(),e.getHeight(),n),this.setTransform(1,t.IsRtl,N,k,H),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawGridlinesDurationMs,()=>(0,r.drawGridLines)(this.ctx,t,n)),n.skeletonMode?(this.setTransform(1,!1,N,k,H),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawSkeletonMs,()=>(0,i.drawSkeleton)(this.ctx,t,n)),this.debugModeDrawings(t,n,N,k,H,E,l),(0,a.createRenderResult)(!0,"finished grid skeleton rendering")):((0,a.trackDuration)(a.RenderPerformanceMetric.ClearGridlinesMs,()=>{(0,a.trackDuration)(a.RenderPerformanceMetric.ClearGridLinesForSpannedCellsMs,()=>{(0,h.clearGridLinesForSpannedCells)(this.ctx,t,n)}),(0,a.trackDuration)(a.RenderPerformanceMetric.ClearGridLinesForPivotTable,()=>{(0,h.clearGridLinesForPivotTables)(this.ctx,t,n)})}),this.setTransform(1,!1,N,k,H),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawBackgroundFillMs,()=>(0,d.drawGridCellsBackgroundFill)(this.ctx,t,n)),(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.RenderPatternStyle,t)&&(0,a.trackDuration)(a.RenderPerformanceMetric.DrawPatternMs,()=>(0,c.drawGridCellsPattern)(this.ctx,t,n)),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawEmptyPivotTableTitleContainers,()=>(0,y.drawEmptyPivotTableTitleContainers)(this.ctx,t,n)),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawEmptyPivotTableImages,()=>(0,y.drawEmptyPivotTableImages)(this.ctx,t,n)),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawDataBarsMs,()=>(0,S.drawDataBars)(this.ctx,t,n)),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawCFIconsMs,()=>(0,f.drawConditionalFormattingIcons)(this.ctx,t,n)),n.modelFromCache||((0,a.trackDuration)(a.RenderPerformanceMetric.DrawSparklines,()=>{(0,R.drawDynamicImages)(this.ctx,t,n,w.ImageType.Sparkline)}),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawInCellImagesMs,()=>(0,R.drawDynamicImages)(this.ctx,t,n,w.ImageType.InCellImage))),(0,a.trackDuration)(a.RenderPerformanceMetric.ClearGridlinesForBorderMs,()=>{(0,g.clearGridLinesForBorder)(this.ctx,t,n)}),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawBordersMs,()=>(0,g.drawBorders)(this.ctx,t,n)),(0,u.isHighContrastMode)(n)&&(0,a.trackDuration)(a.RenderPerformanceMetric.DrawTableBordersMs,()=>(0,L.drawTableBordersInHighContrast)(this.ctx,t,n)),this.setTransform(1,t.IsRtl,N,k,H),(0,a.trackDuration)(a.RenderPerformanceMetric.CellTooltipRegistrationMs,()=>(0,P.registerCellsGeneralTooltip)(this.ctx,t,n)),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawCommentsMs,()=>(0,b.drawComments)(this.ctx,t,n)),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawRichErrorMs,()=>(0,v.drawRichError)(this.ctx,t,n)),(0,a.trackDuration)(a.RenderPerformanceMetric.RegisterTableSelectorsMs,()=>(0,M.registerTableSelectors)(this.ctx,t,n)),this.setTransform(n.scaleFactor,!1,N,k,H),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawTextDurationMs,()=>(0,s.drawText)(this.ctx,t,n)),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawPhoneticTextDurationMs,()=>(0,A.drawCellsPhoneticText)(this.ctx,t,n)),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawEmptyPivotTableTitleText,()=>(0,y.drawEmptyPivotTableTitleText)(this.ctx,t,n)),this.setTransform(1,!1,N,k,H),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawTextDecoration,()=>(0,C.drawTextDecoration)(this.ctx,t,n)),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawExpandCollapseButtonsMs,()=>(0,F.drawExpandCollapseButtons)(this.ctx,t,n)),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawRichValueIcons,()=>(0,x.drawRichValueIcons)(this.ctx,t,n)),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawAutoFiltersMs,()=>(0,T.drawAutoFilters)(this.ctx,t,n)),(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.InCellControls,t)&&(0,a.trackDuration)(a.RenderPerformanceMetric.DrawInCellControls,()=>(0,D.drawInCellControls)(this.ctx,t,n)),(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.ByExamplePreviewMode,t)&&(0,a.trackDuration)(a.RenderPerformanceMetric.DrawSkeletonCellsMs,()=>(0,i.drawSkeletonCells)(this.ctx,t,n)),this.setTransform(1,t.IsRtl,N,k,H),n.renderPageLayout&&((0,a.trackDuration)(a.RenderPerformanceMetric.DrawPrintAreasDurationMs,()=>(0,p.drawPrintAreas)(this.ctx,t,n)),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawPageBreaksDurationMs,()=>(0,m.drawPageBreaks)(this.ctx,t,n))),(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.ByExamplePreviewMode,t)&&(0,a.trackDuration)(a.RenderPerformanceMetric.DrawPreviewCellsModeOverlayMs,()=>(0,B.drawPreviewModeOverlay)(t,this.ctx,n)),E&&this.ctx.restore(),this.debugModeDrawings(t,n,N,k,H,E,l),(0,a.createRenderResult)(!0,"finished rendering"))}catch(e){return(0,a.createRenderResult)(!1,`exception caught in renderInternal: message: ${e.message} name: ${e.name} stack: ${e.stack} error: ${e}`)}}shouldInitializeCanvasHitTest(e,t){return!t}preprocessModel(e,t,n,r){(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.TableBordersInHighContrast,e)&&(0,u.isHighContrastMode)(n)&&(0,O.initializeTableRanges)(e),(0,O.initializeCachedObjects)(e,t,this.shouldInitializeCanvasHitTest(e,r)),(0,k.initializeOffsetsForDrawing)(e,n.scaleFactor),(0,O.updateCellsBeforeDrawing)(this.ctx,e,n),(0,O.updatePivotTablesInformationBeforeDrawing)(e.PivotTables,n.scaleFactor)}clearCanvas(e,t,n,o){o.subPixelRenderingEnabled||(0,u.hasWorkbookBackgroundColor)(e.BackgroundColor)?(0,a.trackDuration)(a.RenderPerformanceMetric.FillRectDurationMs,()=>{this.ctx.fillStyle=(0,u.getWorkbookBackgroundColor)(o.highContrastScheme,e.BackgroundColor),this.ctx.fillRect(0,0,t,n)}):(0,a.trackDuration)(a.RenderPerformanceMetric.ClearRectDurationMs,()=>{this.ctx.clearRect(0,0,t,n)})}debugModeDrawings(e,t,n,o,r,i,a){t.debugMode&&(this.setTransform(1,e.IsRtl,n,o,r),(0,l.addWatermark)(e,this.ctx,t,i),this.setTransform(a,!1,0,0,0),t.isCanvasHitTestDebugHighlight&&(0,l.highlightHitRegions)(e,this.ctx,t.renderingRegion))}}t.GridCanvasRenderer=N},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGetStyleFixChangeGateEnabled=t.getCellStyleByID=t.getFontByID=t.getBorderStyleByID=void 0;const o=n(62),r=n(52),i=n(43),l=n(54),a=n(44),s=n(25),d=n(34),c=n(7),u=n(26);let g=void 0;function h(){return void 0===g&&(g=(0,d.isChangeGateEnabled)(d.ChangeGate.GetStyleFix)),g}t.getBorderStyleByID=function(e,t){let n=void 0;if((0,r.isGlobalBorderStylesEnabled)(t)&&!(0,s.isNullOrUndefined)(e.GlobalBorderStyleID))try{try{if(!h()&&(0,u.isOptimizeGsProcessingEnabled)()&&e.GlobalBorderStyleID){const n=(0,o.getReferencedObjectById)(e.BorderStyleID||0,t.BorderStyles);if(n&&n.GlobalId===e.GlobalBorderStyleID)return n}}catch(e){c.ULS.sendTraceTag(507000596,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Warning,"GlobalStyle: getBorderStyleByID exception in getting optimized border style "+e.message)}return(0,r.getBorderStyleByGlobalID)(e.GlobalBorderStyleID)}catch(e){n=void 0,(0,r.disableGlobalBorderStyles)("getBorderStyleByID failed with exception: "+e.message)}return void 0===n?(0,o.getReferencedObjectById)(e.BorderStyleID||0,t.BorderStyles):n},t.getFontByID=function(e,t,n){let r=void 0;const a=e.GlobalFontID,c=e.FontID||0,u=(0,l.isGlobalFontsAndCellStylesFlightEnabled)(t);if(u&&!(0,s.isNullOrUndefined)(a))try{r=(0,i.getFontByGlobalID)(a),r||(0,l.disableGlobalFonts)("getFontByGlobalID returned null or undefined")}catch(e){r=void 0,(0,l.disableGlobalFonts)("getFontByID failed with exception: "+e.message)}if(void 0===r){try{if(u&&!(0,s.isNullOrUndefined)(n)){const e=(0,o.getReferencedObjectById)(n||0,t.Styles);return(0,o.getReferencedObjectById)(e.FontID||0,t.Fonts)}}catch(e){if((0,d.isChangeGateEnabled)(d.ChangeGate.BetterExceptionHandling))return(0,o.getReferencedObjectById)(c||0,t.Fonts);throw e}return(0,o.getReferencedObjectById)(c||0,t.Fonts)}return r},t.getCellStyleByID=function(e,t){let n=void 0;if((0,l.isGlobalFontsAndCellStylesFlightEnabled)(t)&&!(0,s.isNullOrUndefined)(e.GlobalCellStyleID))try{try{if(!h()&&(0,u.isOptimizeGsProcessingEnabled)()&&e.GlobalCellStyleID){const n=(0,o.getReferencedObjectById)(e.StyleID||0,t.Styles);if(n&&n.GlobalId===e.GlobalCellStyleID)return n}}catch(e){c.ULS.sendTraceTag(507000595,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Warning,"GlobalStyle: getCellStyleByID exception in getting optimized cell style "+e.message)}return(0,a.getCellStyleByGlobalID)(e.GlobalCellStyleID)}catch(e){n=void 0,(0,a.disableGlobalCellStyles)("getCellStyleByID failed with exception: "+e.message)}return void 0===n?(0,o.getReferencedObjectById)(e.StyleID||0,t.Styles):n},t.isGetStyleFixChangeGateEnabled=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getGlobalStyleId=t.getGlobalStylesTelemetry=t.preprocessModelStyles=void 0;const o=n(25),r=n(52),i=n(43),l=n(54),a=n(44),s=n(26),d=n(62),c=n(11);let u=void 0,g=void 0;function h(e,t){try{return(0,d.getReferencedObjectById)(e,t).GlobalId}catch(e){return}}function C(e,t){const n=e.BorderStyleID||0;if(void 0===e.GlobalBorderStyleID||null===e.GlobalBorderStyleID)try{e.GlobalBorderStyleID=h(n,t)}catch(e){throw new Error("GlobalStyle::GlobalStylesManager::preprocessGlobalBorderStyleIdOfCell: "+e)}}function f(e,t){if(e&&e.TextRuns){const n=e.TextRuns;for(let e=0;e<n.length;e++){const o=n[e];if(void 0===o.GlobalFontID||null===o.GlobalFontID)try{o.GlobalFontID=h(o.FontID||0,t)}catch(e){throw new Error("GlobalStyle::GlobalStylesManager::preprocessGlobalFontIdOfCell: "+e)}}}}function m(e,t){const n=e.StyleID||0;if(void 0===e.GlobalCellStyleID||null===e.GlobalCellStyleID)try{e.GlobalCellStyleID=h(n,t)}catch(e){throw new Error("GlobalStyle::GlobalStylesManager::preprocessGlobalCellStyleIdOfCell: "+e)}}t.preprocessModelStyles=function(e){var t;(0,s.verifyArgumentNotNull)(e,"model","preprocessModelStyles"),(0,s.verifyArgumentNotNull)(e.Cells,"model.Cells","preprocessModelStyles");const n=(0,l.isGlobalFontsAndCellStylesFlightEnabled)(e);if(void 0===g&&(g=(0,c.getBooleanFeatureGate)("Microsoft.Office.Excel.CombinedStylesProcessingForCells",!1)),void 0===u&&(u=(0,c.getBooleanFeatureGate)("Microsoft.Office.Excel.OptimizeProcessing")),!u||null===(t=e.ClientOnlyCache)||void 0===t||!t.isProcessedForGlobalStyles){if(g&&n&&(0,r.isGlobalBorderStylesEnabled)(e))try{!function(e){const t=e.Cells,n=e.BorderStyles,l=e.Styles,s=e.Fonts,d=!(0,o.isNullOrUndefined)(n)&&n.length>0,c=!(0,o.isNullOrUndefined)(l)&&l.length>0,u=!(0,o.isNullOrUndefined)(s)&&s.length>0;let g=void 0,p=void 0,y=void 0;if(d&&(g=(0,r.getGlobalBorderStyleMap)(),g.process(n)),u&&c){p=(0,i.getGlobalFontsMap)(),p.process(s);for(let e=0;e<l.length;e++){const t=l[e];if(t){const e=t.FontID||0;if(void 0===t.GlobalFontID||null===t.GlobalFontID)try{t.GlobalFontID=h(e,s)}catch(e){throw new Error("GlobalStyle::GlobalStylesManager::preprocessCellsWithGlobalStyles while preprocessModelFontsWithGlobalStyles: "+e)}}}y=(0,a.getGlobalCellStylesMap)(),y.process(l)}for(let e=0;e<t.length;e++){const o=t[e];try{d&&C(o,n),u&&f(o,s),c&&m(o,l)}catch(e){throw new Error("GlobalStyle::GlobalStylesManager::preprocessCellsWithGlobalStyles: "+e)}}}(e)}catch(e){if(u)return(0,r.disableGlobalBorderStyles)(""+e),(0,l.disableGlobalFonts)(""+e),void(0,a.disableGlobalCellStyles)(""+e);(0,r.disableGlobalBorderStyles)(""+e),(0,l.disableGlobalFonts)(""+e),(0,a.disableGlobalCellStyles)(""+e)}else{if((0,r.isGlobalBorderStylesEnabled)(e)&&!(0,o.isNullOrUndefined)(e.BorderStyles))try{!function(e,t){const n=(0,r.getGlobalBorderStyleMap)();n.process(t);for(let o=0;o<e.length;o++){const r=e[o],i=r.BorderStyleID||0;let l;if(l=void 0!==r.GlobalBorderStyleID&&null!==r.GlobalBorderStyleID&&n.getObject(r.GlobalBorderStyleID)?r.GlobalBorderStyleID:h(i,t),null==l)throw new Error(`GlobalStyle::GlobalStylesManager::preprocessCellsWithGlobalBorderStyles: Local Cell BorderStyleID ${i} not mapped to a Global Border Style ID`);r.GlobalBorderStyleID=l}}(e.Cells,e.BorderStyles)}catch(e){if(u)return(0,r.disableGlobalBorderStyles)(""+e),(0,l.disableGlobalFonts)(""+e),void(0,a.disableGlobalCellStyles)(""+e);(0,r.disableGlobalBorderStyles)(""+e)}if(n&&!(0,o.isNullOrUndefined)(e.Fonts)&&!(0,o.isNullOrUndefined)(e.Styles))try{!function(e,t,n){const o=(0,i.getGlobalFontsMap)();o.process(n);for(let e=0;e<t.length;e++){const r=t[e];if(r){const e=r.FontID||0;let t;if(t=void 0!==r.GlobalFontID&&null!==r.GlobalFontID&&o.getObject(r.GlobalFontID)?r.GlobalFontID:h(e,n),null==t)throw new Error(`GlobalStyle::GlobalStylesManager::preprocessModelFontsWithGlobalStyles: Local FontID ${e} not mapped to a Global Font ID`);r.GlobalFontID=t}}for(let t=0;t<e.length;t++){const r=e[t];if(r&&r.TextRuns){const e=r.TextRuns;for(let t=0;t<e.length;t++){const r=e[t];let i;if(i=void 0!==r.GlobalFontID&&null!==r.GlobalFontID&&o.getObject(r.GlobalFontID)?r.GlobalFontID:h(r.FontID||0,n),null==i)throw new Error(`GlobalStyle::GlobalStylesManager::preprocessModelFontsWithGlobalStyles: Local Cell Text run FontID ${r.FontID} not mapped to a Global Font ID`);r.GlobalFontID=i}}}}(e.Cells,e.Styles,e.Fonts)}catch(e){if(u)return(0,r.disableGlobalBorderStyles)(""+e),(0,l.disableGlobalFonts)(""+e),void(0,a.disableGlobalCellStyles)(""+e);(0,l.disableGlobalFonts)(""+e)}if(n&&!(0,o.isNullOrUndefined)(e.Styles))try{!function(e,t){const n=(0,a.getGlobalCellStylesMap)();n.process(t);for(let o=0;o<e.length;o++){const r=e[o],i=r.StyleID||0;let l;if(l=void 0!==r.GlobalCellStyleID&&null!==r.GlobalCellStyleID&&n.getObject(r.GlobalCellStyleID)?r.GlobalCellStyleID:h(i,t),null==l)throw new Error(`GlobalStyle::GlobalStylesManager::preprocessCellsWithGlobalStyles: Local Cell StyleID ${i} not mapped to a Global Style ID`);r.GlobalCellStyleID=l}}(e.Cells,e.Styles)}catch(e){if(u)return(0,r.disableGlobalBorderStyles)(""+e),(0,l.disableGlobalFonts)(""+e),void(0,a.disableGlobalCellStyles)(""+e);(0,a.disableGlobalCellStyles)(""+e)}}u&&(e.ClientOnlyCache||(e.ClientOnlyCache={}),e.ClientOnlyCache.isProcessedForGlobalStyles=!0)}},t.getGlobalStylesTelemetry=function(){return`{"GlobalBorderStylesCount": ${(0,r.getGlobalBorderStyleMap)().count}, "GlobalFontsCount": ${(0,i.getGlobalFontsMap)().count}, "GlobalCellStylesCount": ${(0,a.getGlobalCellStylesMap)().count} }`},t.getGlobalStyleId=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColumnHeadersNSVStylesArray=t.RowHeadersNSVStylesArrayBeforeHeaderDragImprovements=t.RowHeadersNSVStylesArray=t.ColumnHeadersStylesArray=t.RowHeadersStylesArrayBeforeHeaderDragImprovements=t.RowHeadersStylesArray=t.OldHeadersNSVFonts=t.HeadersNSVFonts=t.OldHeadersFonts=t.HeadersFonts=t.AlphaRadix=t.LetterA=t.DefaultHiddenRowColInnerGapPx=t.RowWidthExtensionPerDigitPx=t.MaxNumberOfDigitsInDefaultRowHeader=t.ColHeaderHeightWithDragSquaresArea=t.DefaultColHeaderHeight=t.RowHeaderWidthWithDragSquaresArea=t.DefaultRowHeaderWidth=t.MinimalCellExtent=t.GroupingLevelExtensionPx=t.GroupingFirstLevelExtensionPx=t.NSVOutlinesColor=t.OutlinesColor=t.NSVGridinesColor=t.SelectedCellsGridlinesColor=t.NSVWholeRowColSelectionAndHoverBackgroundColor=t.NSVPartialRowColSelectionAndHoverBackgroundColor=t.NSVWholeRowColSelectionBackgroundColor=t.NSVPartialRowColSelectionBackgroundColor=t.NSVHoverBackgroundColor=t.NSVHeaderBackgroundColor=t.NoHeadingsGridLineBorderBackgroundColor=t.WholeRowColSelectionAndHoverBackgroundColor=t.WholeRowColSelectionBackgroundColor=t.PartialRowColSelectionAndHoverBackgroundColor=t.PartialRowColSelectionBackgroundColor=t.HoverBackgroundColor=t.DefaultHeaderBackgroundColor=t.OldDefaultHeaderFont=t.PartialRowColSelectionHCFontColor=t.NSVHeaderFontColor=t.WholeSelectionAndHoverFontColor=t.WholeSelectionFontColor=t.PartialSelectionAndHoverFontColor=t.PartialSelectionFontColor=t.HoverFontColor=t.DefaultHeaderFontColor=t.DefaultHeaderFontSize=t.DefaultHeaderFont=void 0,t.HoverHeadersStylesSet=t.WholeSelectionHeadersStylesSet=t.PartiallySelectionHeadersStylesSet=void 0;const o=n(24);t.DefaultHeaderFont="Aptos Narrow",t.DefaultHeaderFontSize=11,t.DefaultHeaderFontColor="#616161",t.HoverFontColor="#616161",t.PartialSelectionFontColor="#0F703B",t.PartialSelectionAndHoverFontColor="#0C5F32",t.WholeSelectionFontColor="#FFFFFF",t.WholeSelectionAndHoverFontColor="#FFFFFF",t.NSVHeaderFontColor="#FFFFFF",t.PartialRowColSelectionHCFontColor="#000000",t.OldDefaultHeaderFont="Calibri",t.DefaultHeaderBackgroundColor="#F5F5F5",t.HoverBackgroundColor="#EBEBEB",t.PartialRowColSelectionBackgroundColor="#CAEAD8",t.PartialRowColSelectionAndHoverBackgroundColor="#A0D8B9",t.WholeRowColSelectionBackgroundColor="#107C41",t.WholeRowColSelectionAndHoverBackgroundColor="#0F703B",t.NoHeadingsGridLineBorderBackgroundColor="#DAD8D6",t.NSVHeaderBackgroundColor="#333333",t.NSVHoverBackgroundColor="#4D4D4D",t.NSVPartialRowColSelectionBackgroundColor="#637C6E",t.NSVWholeRowColSelectionBackgroundColor="#107C41",t.NSVPartialRowColSelectionAndHoverBackgroundColor="#596D62",t.NSVWholeRowColSelectionAndHoverBackgroundColor="#0F703B",t.SelectedCellsGridlinesColor="#BFBFBF",t.NSVGridinesColor="#DFDFDF",t.OutlinesColor="#AAAEB1",t.NSVOutlinesColor="#AAAEB1",t.GroupingFirstLevelExtensionPx=26,t.GroupingLevelExtensionPx=12,t.MinimalCellExtent=1,t.DefaultRowHeaderWidth=36.5,t.RowHeaderWidthWithDragSquaresArea=42.5,t.DefaultColHeaderHeight=19,t.ColHeaderHeightWithDragSquaresArea=30,t.MaxNumberOfDigitsInDefaultRowHeader=3,t.RowWidthExtensionPerDigitPx=10,t.DefaultHiddenRowColInnerGapPx=3,t.LetterA=65,t.AlphaRadix=26,t.HeadersFonts=[{Color:t.HoverFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.Hover,RefCount:1},{Color:t.PartialSelectionFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.PartialSelection,RefCount:1},{Color:t.PartialSelectionAndHoverFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1},{Color:t.WholeSelectionFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:o.UniqueHeadersFontID.WholeSelection,RefCount:1},{Color:t.WholeSelectionAndHoverFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1},{Color:t.DefaultHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.Default,RefCount:1}],t.OldHeadersFonts=[{Color:t.HoverFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.Hover,RefCount:1},{Color:t.PartialSelectionFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.PartialSelection,RefCount:1},{Color:t.PartialSelectionAndHoverFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1},{Color:t.WholeSelectionFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:o.UniqueHeadersFontID.WholeSelection,RefCount:1},{Color:t.WholeSelectionAndHoverFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1},{Color:t.DefaultHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.Default,RefCount:1}],t.HeadersNSVFonts=[{Color:t.NSVHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.Hover,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.PartialSelection,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:o.UniqueHeadersFontID.WholeSelection,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.Default,RefCount:1}],t.OldHeadersNSVFonts=[{Color:t.NSVHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.Hover,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.PartialSelection,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:o.UniqueHeadersFontID.WholeSelection,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:o.UniqueHeadersFontID.Default,RefCount:1}],t.RowHeadersStylesArray=[{ID:o.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.PartialSelection,RefCount:1,BackgroundColor:t.PartialRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.WholeRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.Hover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.HoverBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1,BackgroundColor:t.PartialRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.WholeRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.NoHeadings,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NoHeadingsGridLineBorderBackgroundColor},{ID:o.UniqueHeadersStyleID.Default,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1}],t.RowHeadersStylesArrayBeforeHeaderDragImprovements=[{ID:o.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.PartialSelection,RefCount:1,BackgroundColor:t.PartialRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.WholeRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.Hover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.HoverBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1,BackgroundColor:t.PartialRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.WholeRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.NoHeadings,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NoHeadingsGridLineBorderBackgroundColor},{ID:o.UniqueHeadersStyleID.Default,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1}],t.ColumnHeadersStylesArray=[{ID:o.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.PartialSelection,RefCount:1,BackgroundColor:t.PartialRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.WholeRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.Hover,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Hover,RefCount:1,BackgroundColor:t.HoverBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1,BackgroundColor:t.PartialRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.WholeRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.NoHeadings,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NoHeadingsGridLineBorderBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialRowColSelectionLeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.PartialSelection,RefCount:1,BackgroundColor:t.PartialRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialRowColSelectionRightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.PartialSelection,RefCount:1,BackgroundColor:t.PartialRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeRowColSelectionLeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.WholeRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeRowColSelectionRightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.WholeRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.HoverLeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.Hover,RefCount:1,BackgroundColor:t.HoverBackgroundColor},{ID:o.UniqueHeadersStyleID.HoverRightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Hover,RefCount:1,BackgroundColor:t.HoverBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1,BackgroundColor:t.PartialRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1,BackgroundColor:t.PartialRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.WholeRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.WholeRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.LeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.Default,RefCount:1},{ID:o.UniqueHeadersStyleID.RightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1},{ID:o.UniqueHeadersStyleID.Default,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1}],t.RowHeadersNSVStylesArray=[{ID:o.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.Hover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.NoHeadings,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NoHeadingsGridLineBorderBackgroundColor},{ID:o.UniqueHeadersStyleID.Default,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1}],t.RowHeadersNSVStylesArrayBeforeHeaderDragImprovements=[{ID:o.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.Hover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.NoHeadings,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NoHeadingsGridLineBorderBackgroundColor},{ID:o.UniqueHeadersStyleID.Default,VerticalAlignment:o.VerticalAlignment.Center,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1}],t.ColumnHeadersNSVStylesArray=[{ID:o.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.Hover,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.NoHeadings,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NoHeadingsGridLineBorderBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialRowColSelectionLeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialRowColSelectionRightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeRowColSelectionLeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeRowColSelectionRightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionBackgroundColor},{ID:o.UniqueHeadersStyleID.HoverLeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.HoverRightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionAndHoverBackgroundColor},{ID:o.UniqueHeadersStyleID.LeftAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Left,FontID:o.UniqueHeadersFontID.Default,RefCount:1},{ID:o.UniqueHeadersStyleID.RightAlignment,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Right,FontID:o.UniqueHeadersFontID.Default,RefCount:1},{ID:o.UniqueHeadersStyleID.Default,VerticalAlignment:o.VerticalAlignment.Bottom,HorizontalAlignment:o.HorizontalAlignment.Center,FontID:o.UniqueHeadersFontID.Default,RefCount:1}],t.PartiallySelectionHeadersStylesSet=new Set([o.UniqueHeadersStyleID.PartialRowColSelection,o.UniqueHeadersStyleID.PartialRowColSelectionLeftAlignment,o.UniqueHeadersStyleID.PartialRowColSelectionRightAlignment,o.UniqueHeadersStyleID.PartialSelectionAndHover,o.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment,o.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment]),t.WholeSelectionHeadersStylesSet=new Set([o.UniqueHeadersStyleID.WholeRowColSelection,o.UniqueHeadersStyleID.WholeRowColSelectionLeftAlignment,o.UniqueHeadersStyleID.WholeRowColSelectionRightAlignment,o.UniqueHeadersStyleID.WholeSelectionAndHover,o.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment,o.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment]),t.HoverHeadersStylesSet=new Set([o.UniqueHeadersStyleID.Hover,o.UniqueHeadersStyleID.HoverLeftAlignment,o.UniqueHeadersStyleID.HoverRightAlignment,o.UniqueHeadersStyleID.PartialSelectionAndHover,o.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment,o.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment,o.UniqueHeadersStyleID.WholeSelectionAndHover,o.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment,o.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.comparePartialCellsInGridBlockModel=t.comparePartialColumnsInGridBlockModel=t.comparePartialRowsInGridBlockModel=t.getRowColIndexFromNumber=t.ensureCachedFontsInTextRuns=t.compareModelCells=t.areObjectsEqual=t.areArraysEqual=t.areCellsEqual=void 0;const o=n(25),r=n(65),i=n(42),l=n(34),a=n(26),s=n(44),d=n(43),c=n(54),u=n(52),g=n(108),h=n(11),C=n(24);let f=void 0;const m=(0,h.getBooleanFeatureGate)("Microsoft.Office.Excel.HeaderCellsComparisonFromLocalStyles",!1);function p(e,t,n,o,r,l,a){const s=(0,c.isGlobalFontsAndCellStylesFlightEnabled)(n)&&(0,c.isGlobalFontsAndCellStylesFlightEnabled)(o)&&(0,u.isGlobalBorderStylesEnabled)(n)&&(0,u.isGlobalBorderStylesEnabled)(o),d=(0,i.modelType)(n)===C.ModelType.HeaderBlockModel;!s||m&&d?(e.CachedStyle=(0,i.getReferencedObjectToCache)(e.StyleID||0,n.Styles),t.CachedStyle=(0,i.getReferencedObjectToCache)(t.StyleID||0,o.Styles),e.CachedFont=(0,i.getReferencedObjectToCache)(e.CachedStyle.FontID||0,n.Fonts),t.CachedFont=(0,i.getReferencedObjectToCache)(t.CachedStyle.FontID||0,o.Fonts),e.CachedBorderStyle=(0,i.getReferencedObjectToCache)(e.BorderStyleID||0,n.BorderStyles),t.CachedBorderStyle=(0,i.getReferencedObjectToCache)(t.BorderStyleID||0,o.BorderStyles)):(x(e,n),x(t,o),D(e,n),D(t,o),v(e,n),v(t,o));const g=l(e,t);R(e.TextRuns,n.Fonts),R(t.TextRuns,o.Fonts);let p=S(e,t,g,r,a);return void 0===f&&(f=(0,h.getBooleanFeatureGate)("Microsoft.Office.Excel.ModelComparisonIsSpillBlocked",!1)),f&&p.isEqual&&e&&t&&e.Spill&&t.Spill&&!!e.Spill.IsSpillBlocked!=!!t.Spill.IsSpillBlocked&&(p={isEqual:!1,message:"areCellsEqual: simple object comparison failure. PropertyName = Spill.IsSpillCellBlocked, cell1 Value = ${cell1.Spill.IsSpillBlocked}, cell2 Value = ${cell2.Spill.IsSpillBlocked}"}),p.isEqual||(p.message+=`\nareCellsEqual: cell1.Row = ${e.Row}, cell1.Col = ${e.Col}, cell2.Row = ${t.Row}, cell2.Col = ${t.Col}`),p}function y(e,t,n,o,r,i){if(e===t)return{isEqual:!0};if(void 0===e&&void 0===t)return{isEqual:!0};if(void 0===e||void 0===t)return void 0===e?{isEqual:!1,message:"areArraysEqual: the first array is undefined."}:{isEqual:!1,message:"areArraysEqual: the second array is undefined."};if(e.length!==t.length)return{isEqual:!1,message:`areArraysEqual: arrays length are different. length1: ${e.length}, length2: ${t.length}`};for(let l=0;l<e.length;l++){const a=S(e[l],t[l],n,o,r,i);if(!a.isEqual)return a.message+="\nareArraysEqual: array objects are different. index: "+l,a}return{isEqual:!0}}function S(e,t,n,r,i,l){const{shouldContinue:a,result:s}=function(e,t,n){return e===t||(0,o.isNullOrUndefined)(e)&&(0,o.isNullOrUndefined)(t)?{shouldContinue:!1,result:{isEqual:!0}}:null==e||null==t?{shouldContinue:!1,result:{isEqual:!1,message:`areObjectsEqual: one object is null, o1 = ${!e}, o2 = ${!t}`}}:e!=e?{shouldContinue:!1,result:{isEqual:e!=e,message:"${callerMethod}: NaN comparison"}}:{shouldContinue:!0,result:{isEqual:!0}}}(e,t);if(!a)return s;const d=function(e,t){if(!e||!t)return e||t;const n=t.filter(t=>-1===e.indexOf(t));return e.push(...n),e}(r(e,n),r(t,n));if(0===d.length)return w(e)&&w(t)?{isEqual:!0}:e instanceof Date||e instanceof Number||e instanceof Boolean?{isEqual:e.valueOf()===t.valueOf(),message:"areObjectsEqual: simple object comparison"}:{isEqual:e===t,message:"areObjectsEqual: simple object comparison"};for(let n=0;n<d.length;n++){const a=d[n],s=e[a],c=t[a],u=typeof s,g=typeof c;if(!(0,o.isNullOrUndefined)(s)||!(0,o.isNullOrUndefined)(c)){if(u!==g){if(T(s)&&T(c))continue;return{isEqual:!1,message:`areObjectsEqual: object types are different. propName = ${a} type1 = ${u}, type2 = ${g}`}}switch(u){case"string":if(s!==c){if(!l||-1===l.indexOf(a))return{isEqual:!1,message:"areObjectsEqual: simple types comparison, propertyName = "+a};if(s.toUpperCase()!==c.toUpperCase())return{isEqual:!1,message:"areObjectsEqual: ignore case comparison, propertyName = "+a}}break;case"undefined":case"boolean":case"number":if(s!==c)return{isEqual:!1,message:"areObjectsEqual: simple types comparison, propertyName = "+a};break;case"object":if(s instanceof Array){if(!(c instanceof Array))return{isEqual:!1,message:"areObjectsEqual: array 2 is not an array, propertyName = "+a};const e=F(a,i),t=e.ignoreCaseProps,n=y(s,c,e.filterByProps,r,i,t);if(!n.isEqual)return n.message+="\nareObjectsEqual: arrays mismatch, propertyName = "+a,n}else{const e=F(a,i),t=e.ignoreCaseProps,n=S(s,c,e.filterByProps,r,i,t);if(!n.isEqual)return n.message+="\nareObjectsEqual: objects mismatch, propertyName = "+a,n}break;default:return{isEqual:!1,message:`areObjectsEqual: unexpected type: ${u}, propertyName = ${a}`}}}}return{isEqual:!0}}function R(e,t){if(e&&0!==e.length&&t)for(let n=0;n<e.length;n++){const o=e[n];(0,d.isGlobalFontsEnabled)()?o.CachedFont=A(o.GlobalFontID,o.FontID,t):o.CachedFont=(0,i.getReferencedObjectToCache)(o.FontID||0,t)}}function F(e,t){const n={filterByProps:void 0,ignoreCaseProps:void 0},o=r.propertyToClassMap[e];if(!o)return n;const i=[],l=new Set;for(let e=0;e<o.length;e++){var a,s;null===(a=t[o[e]])||void 0===a||a.forEach(e=>l.add(e)),i.push(...null!==(s=r.ignoreCaseLists[o[e]])&&void 0!==s?s:[])}return n.filterByProps=l,n.ignoreCaseProps=i,n}function T(e){return(0,l.isChangeGateEnabled)(l.ChangeGate.TreatZeroAndUndefinedAsEqual)?null==e||""===e||!1===e||0===e:null==e||""===e||!1===e}function w(e){if("object"==typeof e&&e.constructor===Object){for(const t in e)return!1;return!0}return!1}function I(e,t,n,o,r){const i=[];if(T(i))return[];for(let l=0;l<e.Cells.length;l++){const a=e.Cells[l];a.Row>=t&&a.Row<=n&&a.Col>=o&&a.Col<=r&&i.push(a)}return i}function b(e,t,n,o,r,i,l){let a=e,s=e,d=t,c=n;return d>=o?(s=r[c],c++):c>=i||l[d].Row<r[c].Row||l[d].Row===r[c].Row&&l[d].Col<r[c].Col?(a=l[d],d++):l[d].Row!==r[c].Row||l[d].Col!==r[c].Col?(s=r[c],c++):(a=l[d],s=r[c],d++,c++),{cell1:a,cell2:s,index1:d,index2:c}}function v(e,t){try{if(!(0,o.isNullOrUndefined)(e.GlobalBorderStyleID))return void(e.CachedBorderStyle=(0,u.getBorderStyleByGlobalID)(e.GlobalBorderStyleID||0));e.CachedBorderStyle=(0,i.getReferencedObjectToCache)(e.BorderStyleID||0,t.BorderStyles)}catch(n){e.CachedBorderStyle=(0,i.getReferencedObjectToCache)(e.BorderStyleID||0,t.BorderStyles),(0,u.disableGlobalBorderStyles)(""+n)}}function x(e,t){try{if(!(0,o.isNullOrUndefined)(e.GlobalCellStyleID))return void(e.CachedStyle=(0,s.getCellStyleByGlobalID)(e.GlobalCellStyleID));e.CachedStyle=(0,i.getReferencedObjectToCache)(e.StyleID||0,t.Styles)}catch(n){e.CachedStyle=(0,i.getReferencedObjectToCache)(e.StyleID||0,t.Styles),(0,s.disableGlobalCellStyles)(""+n)}}function D(e,t){try{var n,o;e.CachedFont=A(null===(n=e.CachedStyle)||void 0===n?void 0:n.GlobalFontID,null===(o=e.CachedStyle)||void 0===o?void 0:o.FontID,t.Fonts)}catch(n){var r;e.CachedFont=(0,i.getReferencedObjectToCache)((null===(r=e.CachedStyle)||void 0===r?void 0:r.FontID)||0,t.Fonts),(0,c.disableGlobalFonts)(""+n)}}function A(e,t,n){return(0,o.isNullOrUndefined)(e)?(0,i.getReferencedObjectToCache)(t||0,n):(0,d.getFontByGlobalID)(e)}t.areCellsEqual=p,t.areArraysEqual=y,t.areObjectsEqual=S,t.compareModelCells=function(e,t,n,o,r,a){const s=e.Cells,d=t.Cells;let c=0;if(s===d)return{isEqual:!0,canDiffRender:!0};const u=s.length,C=d.length;let f=0,m=0;const y=(0,i.getDefaultCell)(-1,-1,e.Styles,e.Fonts);let R=[],F=!0,T="";for(;f<u||m<C;){var w,I,v,x;let D,A;const P=f,M=m;({cell1:D,cell2:A,index1:f,index2:m}=b(y,f,m,u,d,C,s));const B=p(D,A,e,t,o,r,a),H=-1===(null===(w=D)||void 0===w?void 0:w.Row)?null===(I=A)||void 0===I?void 0:I.Row:D.Row,O=-1===(null===(v=D)||void 0===v?void 0:v.Col)?null===(x=A)||void 0===x?void 0:x.Col:D.Col;if(!B.isEqual){F&&(F=!1,T+=B.message+"\n"),R.push((0,i.getCellLookupKey)(H,O));const r=(0,g.getComparisonIgnoreLists)((0,h.getBooleanFeatureGate)("Microsoft.Office.Excel.IgnoreListFix",!1)).ReferencedObject;if(!S(D.CachedBorderStyle,A.CachedBorderStyle,r,o,a).isEqual||!S(D.HasError,A.HasError,void 0,o,a).isEqual){let n=[];(0,l.isChangeGateEnabled)(l.ChangeGate.AdjacentCellsMergeFix)?(-1!==D.Row&&(n=(0,i.getAdjacentCellsKeys)(e,D)),-1!==A.Row&&(n=n.concat((0,i.getAdjacentCellsKeys)(t,A)))):n=(0,i.getAdjacentCellsKeysOld)(t,H,O),R=R.concat(n),R=R.concat((0,i.getAllSpillingOverCells)(s,n)),R=R.concat((0,i.getAllSpillingOverCells)(d,n))}if(n&&(c++,c>=n))return{isEqual:F,canDiffRender:!1,changedCellsKeys:void 0,message:T+" \n maxAllowedDiffRenderCells reached"};D!==y&&(R=R.concat((0,i.getAllSpanningCellsKeys)(s,D,P))),A!==y&&(R=R.concat((0,i.getAllSpanningCellsKeys)(d,A,M)))}}return{isEqual:F,canDiffRender:!0,changedCellsKeys:R.filter(i.uniqueValuesFilter),message:T}},t.ensureCachedFontsInTextRuns=R,t.getRowColIndexFromNumber=function(e,t){if(e.length<1)return 0;if(t<e[0])return 0;const n=e.length-1;if(t>e[n])return n;for(let n=0;n<e.length;n++)if(t===e[n])return n;return-1},t.comparePartialRowsInGridBlockModel=function(e,t,n,o){!function(e,t){(0,a.verifyArgumentNotNull)(e.RowOffsets,"model1.RowOffsets","validateRowArgs"),(0,a.verifyArgumentNotNull)(t.RowOffsets,"model2.RowOffsets","validateRowArgs"),(0,a.verifyArgumentNotNull)(e.RowHeights,"model1.RowHeights","validateRowArgs"),(0,a.verifyArgumentNotNull)(t.RowHeights,"model2.RowHeights","validateRowArgs"),(0,a.verifyArgumentNotNull)(e.RowNumbers,"model1.RowNumbers","validateRowArgs"),(0,a.verifyArgumentNotNull)(t.RowNumbers,"model2.RowNumbers","validateRowArgs")}(e,t);for(let r=n;r<=o;r++){if(e.RowHeights[r]!==t.RowHeights[r])return{isEqual:!1,message:"Mismatch in RowHeights, index = "+r+" model1 value = "+e.RowHeights[r]+" model2 value = "+t.RowHeights[r],canDiffRender:!1,changedCellsKeys:void 0};if(e.RowNumbers[r]!==t.RowNumbers[r])return{isEqual:!1,message:"Mismatch in RowNumbers, index = "+r+" model1 value = "+e.RowNumbers[r]+" model2 value = "+t.RowNumbers[r],canDiffRender:!1,changedCellsKeys:void 0};if(e.RowOffsets[r]!==t.RowOffsets[r])return{isEqual:!1,message:"Mismatch in RowOffsets, index = "+r+" model1 value = "+e.RowOffsets[r]+" model2 value = "+t.RowOffsets[r],canDiffRender:!1,changedCellsKeys:void 0}}return{isEqual:!0,canDiffRender:!0,changedCellsKeys:[],message:""}},t.comparePartialColumnsInGridBlockModel=function(e,t,n,o){!function(e,t){(0,a.verifyArgumentNotNull)(e.ColumnNumbers,"model1.ColumnNumbers","validateColumnArgs"),(0,a.verifyArgumentNotNull)(t.ColumnNumbers,"model2.ColumnNumbers","validateColumnArgs"),(0,a.verifyArgumentNotNull)(e.ColumnWidths,"model1.ColumnWidths","validateColumnArgs"),(0,a.verifyArgumentNotNull)(t.ColumnWidths,"model2.ColumnWidths","validateColumnArgs"),(0,a.verifyArgumentNotNull)(e.ColumnOffsets,"model1.ColumnOffsets","validateColumnArgs"),(0,a.verifyArgumentNotNull)(t.ColumnOffsets,"model2.ColumnOffsets","validateColumnArgs")}(e,t);for(let r=n;r<=o;r++){if(e.ColumnWidths[r]!==t.ColumnWidths[r])return{isEqual:!1,message:"Mismatch in ColumnWidths, index = "+r+" model1 value = "+e.ColumnWidths[r]+" model2 value = "+t.ColumnWidths[r],canDiffRender:!1,changedCellsKeys:void 0};if(e.ColumnOffsets[r]!==t.ColumnOffsets[r])return{isEqual:!1,message:"Mismatch in ColumnOffsets, index = "+r+" model1 value = "+e.ColumnOffsets[r]+" model2 value = "+t.ColumnOffsets[r],canDiffRender:!1,changedCellsKeys:void 0};if(e.ColumnNumbers[r]!==t.ColumnNumbers[r])return{isEqual:!1,message:"Mismatch in ColumnNumbers, index = "+r+" model1 value = "+e.ColumnNumbers[r]+" model2 value = "+t.ColumnNumbers[r],canDiffRender:!1,changedCellsKeys:void 0}}return{isEqual:!0,canDiffRender:!0,changedCellsKeys:[],message:""}},t.comparePartialCellsInGridBlockModel=function(e,t,n,o,r,l,a,s,d){const c=I(e,n,o,r,l),u=I(t,n,o,r,l),g=c.length,h=u.length;let C=0,f=0;const m=(0,i.getDefaultCell)(-1,-1,e.Styles,e.Fonts);for(;C<g||f<h;){let n,o;({cell1:n,cell2:o,index1:C,index2:f}=b(m,C,f,g,u,h,c));const r=p(n,o,e,t,a,s,d);if(!r.isEqual)return{isEqual:r.isEqual,canDiffRender:!0,changedCellsKeys:[],message:r.message}}return{isEqual:!0,canDiffRender:!0,changedCellsKeys:[],message:""}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getComparisonIgnoreLists=void 0;const o=n(65);let r=!1;t.getComparisonIgnoreLists=function(e){if(!e&&!r){const e=new Set(["RowOutlinesInformation","ColumnOutlinesInformation","MaxRowOutlineLevelInSheet","MaxColOutlineLevelInSheet","ShowHeaders","AdjacentBlocksHiddensInfo","IsCanvasHeadersSupported","HasTable","HasOutline"]),t=new Set(["InsertButtons"]),n=new Set(["Start","End"]),i=new Set(["Type","Offset"]),l=o.comparisonIgnoreLists.GridBlockModel.filter(t=>!e.has(t)),a=o.comparisonIgnoreLists.HeaderCell.filter(e=>!t.has(e)),s=o.comparisonIgnoreLists.InsertButtons.filter(e=>!n.has(e)),d=o.comparisonIgnoreLists.InsertButton.filter(e=>!i.has(e));o.comparisonIgnoreLists.GridBlockModel=l,o.comparisonIgnoreLists.HeaderCell=a,o.comparisonIgnoreLists.InsertButtons=s,o.comparisonIgnoreLists.InsertButton=d,r=!0}return o.comparisonIgnoreLists}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateNumFmtFromCell=void 0;const o=n(1),r=n(6);t.updateNumFmtFromCell=function(e){if((0,o.verifyArgumentNotNull)(e.Text,"cell.Text","updateNumFmt"),(0,o.verifyArgumentNotNull)(e.NumFmt,"cell.NumFmt","updateNumFmt"),!(0,r.isNullOrUndefined)(e.NumFmt.End)&&!(0,r.isNullOrUndefined)(e.NumFmt.Separator)){var t,n,i,l;const o=function(e,t){let n=0;for(let o=0;o<e.length&&e[o]===t;o++)n++;return n}(e.NumFmt.End,e.NumFmt.Separator),r=function(e,t){let n=0;for(let o=e.length-1;o>0&&e[o]===t;o++)n++;return n}(e.NumFmt.End,e.NumFmt.Separator),a=function(e,t,n){const o=e.length-t,r=e.substring(0,o),i=r.lastIndexOf(n);return-1===i?r:r.substr(i+1)}(e.Text,r,e.NumFmt.Separator);e.NumFmt.End=function(e,t,n,o){return t.repeat(n)+e+t.repeat(o)}(a,e.NumFmt.Separator,o,r),null!=e&&null!==(t=e.Text)&&void 0!==t&&t.endsWith((null===(n=e.NumFmt)||void 0===n?void 0:n.Separator)+e.NumFmt.End)&&null!=e&&null!==(i=e.Text)&&void 0!==i&&i.startsWith((null===(l=e.NumFmt)||void 0===l?void 0:l.Start)||"")||(e.NumFmt=void 0)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RenderingCanvasElement=void 0;const o=n(0),r=n(13);t.RenderingCanvasElement=class{dispose(){this.parentElement&&(this.parentElement.removeChild(this.canvas),this.parentElement=null),this.canvas.style.width="0px",this.canvas.style.height="0px",this.setWidth(0),this.setHeight(0),this.renderingRegion&&(this.renderingRegion.isRendered=!1)}appendToParent(e){e&&(e.appendChild(this.canvas),this.parentElement=e)}getContext2d(e){return this.offscreenCanvas?this.offscreenCanvas.getContext("2d",this.ctxOptions):this.canvas.getContext("2d",this.ctxOptions)}getWidth(){return this.offscreenCanvas?this.offscreenCanvas.width:this.canvas.width}setWidth(e){this.offscreenCanvas?this.offscreenCanvas.width=e:this.canvas.width=e}getHeight(){return this.offscreenCanvas?this.offscreenCanvas.height:this.canvas.height}setHeight(e){this.offscreenCanvas?this.offscreenCanvas.height=e:this.canvas.height=e}getStyle(){return this.canvas.style}setClassName(e){this.canvas.className=null!=e?e:""}updatePosition(e,t,n,o){if(this.canvas){const r=e+"px",i=t+"px",l=this.canvas.style;if(n||(o?l.right!==r:l.left!==r)||l.top!==i)return o?l.right=r:l.left=r,l.top=i,!0}return!1}setDimensions(e,t,n){const o=Math.round(e*n),r=Math.round(t*n);this.setStyleDimensions(o,r,n),this.setWidth(o),this.setHeight(r)}setRenderingRegion(e){e&&(this.renderingRegion=e)}getRenderingRegion(){return this.renderingRegion}setStyleDimensions(e,t,n){this.canvas.style.width=e/n+"px",this.canvas.style.height=t/n+"px"}constructor(e,t){this.renderingRegion=void 0,this.canvas=document.createElement("canvas"),this.parentElement=null;const n=!!t&&(0,o.isOffscreenCanvasSupported)();if(this.ctxOptions={alpha:!e},n)try{this.offscreenCanvas=this.canvas.transferControlToOffscreen()}catch(e){(0,r.setRenderingResultInfo)("RenderingCanvasElement.ctor:: OffscreenCanvas failed."),this.offscreenCanvas=void 0}else this.offscreenCanvas=void 0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.highlightHitRegions=t.addWatermark=t.hitRegionsToHighlight=void 0;const o=n(1),r=n(0),i=n(20),l={red:{color:"Red",infoString:"Full render"},blue:{color:"Blue",infoString:"Full render from PLT cache"},green:{color:"Green",infoString:"Partial Rendering (Rendering only changed cells)"}};t.hitRegionsToHighlight={general:!1,toolTip:!1,cursor:!1,longPress:!1},t.addWatermark=function(e,t,n,a){const s=1*n.scaleFactor,d=5*n.scaleFactor,c=function(e,t){return e?l.blue:t?l.green:l.red}(n.modelFromCache,a);!function(e,t,n,o){e.beginPath(),e.lineWidth=1,e.setLineDash([]),e.strokeStyle="white",e.rect(t,t,n,n),e.strokeStyle=o.color,e.rect(t,t,n,n),e.stroke()}(t,s,d,c),function(e,t,n,a,s){var d;const c=(0,o.getRenderingRegionHitTestCache)(e,(0,r.getRenderingRegionKey)(t.renderingRegion)),u=2*a,g={isMirrored:e.IsRtl,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:{x:n,y:n,width:u,height:u},isRtl:e.IsRtl,blockWidth:e.BlockWidth};let h=null===(d=e.Cells)||void 0===d?void 0:d[0];h||(h=(0,o.getDefaultCell)(0,0)),(0,i.registerCursorHitRegion)(h,c,g,"help",o.RenderFeaturesZIndex.DebugWatermark),(0,i.registerTooltipHitRegion)(h,c,g,function(e){let t="";const n=`${e.color} - ${e.infoString}`;return Object.keys(l).forEach(e=>t+=`${l[e].color} - ${l[e].infoString}\n`),`${n}\n\n${t}`}(s),o.RenderFeaturesZIndex.DebugWatermark)}(e,n,s,d,c)},t.highlightHitRegions=function(e,n,i){const{CellHitRegions:l,CellCursorHitRegions:a,CellTooltipHitRegions:s,CellLongPressHitRegions:d}=(0,o.getRenderingRegionHitTestCache)(e,(0,r.getRenderingRegionKey)(i));[l,a,s,d].forEach(e=>{e&&Object.values(e).forEach(e=>{for(let o=0;o<e.length;o++){const r=e[o],i=r.region,{x:l,y:a,width:s,height:d}=i;r.eventType&&t.hitRegionsToHighlight.general&&(n.fillStyle="rgba(255, 255, 0, 0.2)",n.fillRect(l,a,s,d)),r.tooltipText&&t.hitRegionsToHighlight.toolTip&&(n.fillStyle="rgba(0, 255, 51, 0.2)",n.fillRect(l,a,s,d)),r.cursorType&&t.hitRegionsToHighlight.cursor&&(n.fillStyle="rgba(255, 0, 0, 0.2)",n.fillRect(l,a,s,d)),r.onStart&&t.hitRegionsToHighlight.longPress&&(n.fillStyle="rgba(236, 0, 255, 0.2)",n.fillRect(l,a,s,d))}})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawText=void 0;const o=n(1),r=n(2),i=n(113),l=n(3),a=n(118),s=n(0),d=n(4),c=n(167),u=n(9),g=n(5),h=n(171),C=n(172),f=n(12),m=n(58),p=n(17),y=n(13),S=n(173),R=n(91),F=n(73),T=n(22),w=n(174),I=n(120),b=n(6);function v(e,t,n,l,C,m,S){var I,b;const{zoom:v,devicePixelRatio:x}=n,A=(0,o.isChangeGateEnabled)(o.ChangeGate.CanvasTextMeasure);let P=-1;A?(0,y.trackDuration)(y.RenderPerformanceMetric.DrawTextTextLineHeight,()=>{P=(0,u.getTextLineHeight)(l,t)},!0,!0):P=(0,u.getTextLineHeight)(l,t);const M=(0,u.calculateVerticalAlignment)(t,l,P,S,l.DisplayFormula),B=(null===(I=l.CachedStyle)||void 0===I?void 0:I.HorizontalAlignment)===o.HorizontalAlignment.Fill,H=(0,g.getCellWidth)(t,l,!1),O=(0,u.getDistanceFromCellStartToIconEnd)(t,l,v,x);let k=0;var L,N;A?(0,y.trackDuration)(y.RenderPerformanceMetric.DrawTextTextMaxWidth,()=>{var e;k=(0,r.getTextDrawingMaxWidth)(H,(0,u.getCellTextHorizontalPaddingWithoutVisualElements)(t,l),O,(0,f.getExpandCollapseButtonWidth)(null===(e=l.PivotTable)||void 0===e?void 0:e.HasExpandCollapseIndicator),(0,p.getAutoFilterPaddingForAdvancedHorizontalAlignment)(t,l,v,x))},!0,!0):k=(0,r.getTextDrawingMaxWidth)(H,(0,u.getCellTextHorizontalPaddingWithoutVisualElements)(t,l),O,(0,f.getExpandCollapseButtonWidth)(null===(L=l.PivotTable)||void 0===L?void 0:L.HasExpandCollapseIndicator),(0,p.getAutoFilterPaddingForAdvancedHorizontalAlignment)(t,l,v,x)),D(t,l,e,k,B,C,n),l.PreviewNumFmt&&(0,h.updatePreviewTextFormatting)(e,t,l,k),l.CachedIndent!==(null===(b=l.CachedStyle)||void 0===b?void 0:b.Indentation)&&(k=(0,r.getTextDrawingMaxWidth)(H,(0,u.getCellTextHorizontalPaddingWithoutVisualElements)(t,l),O,(0,f.getExpandCollapseButtonWidth)(null===(N=l.PivotTable)||void 0===N?void 0:N.HasExpandCollapseIndicator),(0,p.getAutoFilterPaddingForAdvancedHorizontalAlignment)(t,l,v,x)));const E=l.PhonInfo?F.PhoneticTextHeightPx:0,z=(0,s.getDisplayText)(l,t),W=(0,s.getFormattedText)(z,l,t),G=(0,R.shouldDrawSpillCell)(l),V=(0,R.shouldDrawWrapText)(l),j=(0,R.getCellClipping)(t,l,e,k,W,V,G,H,S,O,m,B);(0,T.shouldDrawRotatedText)(t,l.CachedStyle,l.CachedFont)?(0,w.drawRotatedText)(e,t,l,n,z,k,S,P,E,W,j):function(e,t,n,l,s,h,C,f,m,p,y,S,F,T,w,I,b){const v=(0,u.getTextHorizontalPosition)(t,n,l),x=(0,u.getTextVerticalPosition)(n,t,f+m,s,S,void 0).absoluteY;if(T){(0,d.verifyArgumentNotNull)(b,"clipRect","drawSingleCellText");const o=(0,r.getContainerClipMaskWidth)(h),i=(0,g.isCellSpansMultipleRowsOrBlocks)(n);(0,c.drawWrapText)(e,l,t,n,y,v,C,b,o,s,i,f,I)}else n.Merge?function(e,t,n,r,l,a,s,d,c,u){var g;u?(0,i.fillTextClipped)(e,t,a,s,d,u,r,n,(null===(g=r.CachedStyle)||void 0===g?void 0:g.HorizontalAlignment)===o.HorizontalAlignment.Fill,l):(0,i.fillTextUnclipped)(e,a,s,d,c,r,n,t)}(e,l,t,n,I,y,v,x,C,b):F?(0,a.drawSpillCellText)(e,l,t,n,y,v,x,b,w,p,I):(0,R.shouldClipText)(n,I,w)?((0,d.verifyArgumentNotNull)(b,"clipRect","drawSingleCellText"),(0,i.fillTextClipped)(e,l,y,v,x,b,n,t,w,I)):(0,i.fillTextUnclipped)(e,y,v,x,C,n,t,l)}(e,t,l,n,S,H,k,P,E,O,z,M,G,V,B,W,j)}function x(e,t,n,o,r,a,s){const d=n.CachedStyle.VerticalAlignment,c=(0,u.getTextHorizontalPosition)(t,n,o),g=(0,u.getTextVerticalPosition)(n,t,l.HeaderTextLineHeight,r,d,void 0).absoluteY;D(t,n,e,a,!1,s,o),(0,i.fillTextUnclipped)(e,n.Text,c,g,a,n,t,o)}function D(e,t,n,r,i,l,a){(0,o.isChangeGateEnabled)(o.ChangeGate.CanvasTextMeasure)?(0,y.trackDuration)(y.RenderPerformanceMetric.DrawTextUpdateCellContext,()=>{(0,m.updateContextForCurrentCell)(n,l,t,e,a.highContrastScheme)},!0,!0):(0,m.updateContextForCurrentCell)(n,l,t,e,a.highContrastScheme),(0,o.shouldOverrideText)(t)&&(0,h.updateNumberFormattingInformation)(n,e,t,r,a.zoom,a.devicePixelRatio),i&&(0,C.updateCachedDisplayTextForFill)(n,e,t,a)}function A(e,t,n,o){return(0,r.restoreClipping)(n,o),(0,m.getDefaultContextState)(e,t)}function P(e,t){return!(0,b.isNullOrUndefined)(e.IsRow)&&(!!e.IsRow||!t.IsCellSnapped&&(0,s.getColumnWidth)(t.Col,e)>l.MaxColumnHeaderTextWidth)}t.drawText=function(e,t,n){!function(e,t,n){(0,d.verifyArgumentNotNull)(e,"ctx","drawCellsText"),(0,d.verifyArgumentNotNull)(t,"model","drawCellsText"),(0,d.verifyArgumentNotNull)(n,"context","drawCellsText"),(0,d.verifyArgumentNotNull)(t.RowOffsets,"model.RowOffsets","drawCellsText"),(0,d.verifyArgumentNotNull)(t.ColumnOffsets,"model.ColumnOffsets","drawCellsText"),(0,d.verifyArgumentNotNull)(t.RowHeights,"model.RowHeights","drawCellsText"),(0,d.verifyArgumentNotNull)(t.ColumnWidths,"model.ColumnWidths","drawCellsText"),(0,d.verifyArgumentNotNull)(t.Styles,"model.Styles","drawCellsText");const i=t.ClientOnlyCache.CellsToRender,a=t.BlockWidth,s=[];let c=function(e,t,n){const o=(0,m.getDefaultContextState)(t,n.IsRtl);return e.direction=o.direction,e.fillStyle=o.fontColor,e.textBaseline="bottom",e.strokeStyle="transparent",function(e){Array.isArray(e.getLineDash())&&0!==e.getLineDash().length&&e.setLineDash([])}(e),o}(e,n.highContrastScheme,t),u=void 0,h=-1;for(let d=0;d<i.length;d++){var C,f,p;const m=i[d];if(!m)continue;if((0,r.isArrayFormulaChildInFormulaView)(m,n))continue;if((0,o.isRenderFlagEnabled)(o.RenderFlagsArray.InCellControls,t)&&(0,I.shouldDrawInCellControl)(m))continue;if(!(m.Text||m.PreviewText||m.PreviewNumFmt)){if(!(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.FormulaViewCellImagesFix,t))continue;if(!n.isFormulaView||!m.FormulaInfo)continue}if(0===m.ShrunkSize||0===(null===(C=m.CachedFont)||void 0===C?void 0:C.Size))continue;if(!(0,r.cellIntersectsRenderingRegion)(m,n.renderingRegion))continue;if(m.CondFormat&&null!==(f=m.CondFormat)&&void 0!==f&&f.Icon&&null!==(p=m.CondFormat)&&void 0!==p&&null!==(p=p.Icon)&&void 0!==p&&p.IconOnly)continue;if(m.ShowSkeleton)continue;const S=t.RowHeights[m.Row]-l.GridLineWidthPx,R=t.RowOffsets[m.Row];if(m.Row!==h&&(-1!==h&&(c=A(n.highContrastScheme,t.IsRtl,e,u)),u={x:0,y:R,width:a,height:S},(0,r.applyClipping)(e,u),h=m.Row),(0,g.isCellSpansMultipleRowsOrBlocks)(m))s.push(m);else if(P(t,m)){const o=t.IsRow?l.MaxRowHeaderTextWidth:l.MaxColumnHeaderTextWidth;(0,y.trackDuration)(y.RenderPerformanceMetric.DrawHeaderCellTextDurationMs,()=>{x(e,t,m,n,S,o,c)},!0,!0)}else(0,y.trackDuration)(y.RenderPerformanceMetric.DrawSingleCellTextDurationMs,()=>{v(e,t,n,m,c,R,S)},!0,!0)}(0,r.restoreClipping)(e,u),c=(0,m.getDefaultContextState)(n.highContrastScheme,t.IsRtl);for(let o=0;o<s.length;o++){const r=s[o],i=(0,g.getCellHeight)(t,r,!1)-l.GridLineWidthPx,a=(0,g.getCellTop)(t,r);v(e,t,n,r,c,a,i)}}(e,t,n),function(e,t,n){(0,y.trackDuration)(y.RenderPerformanceMetric.HyperlinkEventRegistrationMs,()=>(0,S.registerHyperlinkEventHandlers)(e,t,n))}(e,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fillTextClipped=t.fillTextUnclipped=void 0;const o=n(32),r=n(2),i=n(40),l=n(71),a=n(14),s=n(0);t.fillTextUnclipped=function(e,t,n,o,r,l,a,s){if(r>0){e.fillText(t,n,o,r);const d={textPositionX:n,textPositionY:o};(0,i.measureAndCacheTextDecorationLayout)(e,a,l,s,d)}},t.fillTextClipped=function(e,t,n,d,c,u,g,h,C,f){if((0,r.applyClipping)(e,u),!f&&(0,a.shouldRenderVerticalText)(g))(0,l.fillVerticalText)(e,h,g,n,d,c,t,u);else if(!f||C||g.DisplayFormula||(0,s.isCellPreviewTextDefined)(g.PreviewText)){e.fillText(n,d,c);const o={textPositionX:d,textPositionY:c,clipRect:u};(0,i.measureAndCacheTextDecorationLayout)(e,h,g,t,o)}else(0,o.fillRichTextFormat)(e,t,h,g,f,d,c,u);(0,r.restoreClipping)(e,u)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cellHasBottomDoubleBorder=t.drawBorders=t.clearGridLinesForBorder=void 0;const o=n(1),r=n(2),i=n(6),l=n(3),a=n(0),s=n(115),d=n(5),c=n(0),u=n(4),g={},h={};var C;function f(e){(0,u.verifyArgumentNotNull)(e,"model","validateModel"),(0,u.verifyArgumentNotNull)(e.RowOffsets,"model.RowOffsets","validateModel"),(0,u.verifyArgumentNotNull)(e.ColumnOffsets,"model.ColumnOffsets","validateModel"),(0,u.verifyArgumentNotNull)(e.RowHeights,"model.RowHeights","validateModel"),(0,u.verifyArgumentNotNull)(e.ColumnWidths,"model.ColumnWidths","validateModel")}function m(e,t){return{BorderLineStyle:o.BorderLineType.Thin,Color:t,Weight:l.ThinBorderWeight,BorderPosition:e}}function p(e,t,n,i){var l,a;let s=null!==(l=n.CachedStyle)&&void 0!==l&&l.BackgroundColor?(0,r.hexToRgb)(null===(a=n.CachedStyle)||void 0===a?void 0:a.BackgroundColor):i;if(s===i)switch(t.BorderPosition){case o.BorderPositionType.Top:{const t=y(n,C.Top,e);s=t?(0,r.hexToRgb)(t):i;break}case o.BorderPositionType.Left:{const t=y(n,C.Left,e);s=t?(0,r.hexToRgb)(t):i;break}}if((0,o.isRenderFlagEnabled)(o.RenderFlagsArray.DoubleBorderMergeCellFix,e)&&v(e,n,t.BorderPosition)){const{BorderPosition:l}=t,a=l===o.BorderPositionType.Right||l===o.BorderPositionType.Bottom,u=l===o.BorderPositionType.Top||l===o.BorderPositionType.Left;if(a||u&&function(e,t,n){if(t.Merge)return!1;switch(n){case o.BorderPositionType.Top:{const n=(0,o.getCell)(t.Row-1,t.Col,e);return!(null==n||!n.Merge)}case o.BorderPositionType.Left:{const n=(0,o.getCell)(t.Row,t.Col-1,e);return!(null==n||!n.Merge)}}return!1}(e,n,t.BorderPosition))s=function(e,t,n,i){const l=y(e,new Map([[o.BorderPositionType.Top,C.Top],[o.BorderPositionType.Left,C.Left],[o.BorderPositionType.Right,C.Right],[o.BorderPositionType.Bottom,C.Bottom]]).get(t),n);return l?(0,r.hexToRgb)(l):i}(n,t.BorderPosition,e,i);else if(u&&n.Merge){var d,c;s=null!==(d=n.CachedStyle)&&void 0!==d&&d.BackgroundColor?(0,r.hexToRgb)(null===(c=n.CachedStyle)||void 0===c?void 0:c.BackgroundColor):i}}return s}function y(e,t,n){var r;let i=void 0;switch(t){case C.Top:e.Row>0&&(i=(0,o.getCell)(e.Row-1,e.Col,n));break;case C.Left:e.Col>0&&(i=(0,o.getCell)(e.Row,e.Col-1,n));break;case C.Bottom:e.Row<n.RowNumbers.length&&(i=(0,o.getCell)(e.Row+1,e.Col,n));break;case C.Right:e.Col<n.ColumnNumbers.length&&(i=(0,o.getCell)(e.Row,e.Col+1,n))}return null===(r=i)||void 0===r||null===(r=r.CachedStyle)||void 0===r?void 0:r.BackgroundColor}function S(e,t,n,o,r,i){const l=T(e,t,n.BorderPosition,o),a=A(n);a in i||(r.push(n),i[a]=[]),i[a].push(l)}function R(e,t,n,r,i){let a=[],s="",d=l.ThinBorderWeight;!function(e){e.strokeStyle="#000000",e.setLineDash([]),e.lineWidth=l.ThinBorderWeight}(e),e.beginPath();for(let l=0;l<t.length;l++){const c=t[l],u=i||D(c.Color),g=P(c.BorderLineStyle),h=d!==c.Weight*r,C=s!==u,f=!(0,o.areGridArraysEqual)(a,g,[]).isEqual;(h||C||f)&&(e.stroke(),e.beginPath(),h&&(d=c.Weight*r,e.lineWidth=d),C&&(s=u,e.strokeStyle=u),f&&(e.setLineDash(g),a=g));const m=n[A(c)];for(let t=0;t<m.length;t++){const n=m[t];F(e,c.Weight,n,r)}}e.stroke()}function F(e,t,n,o){!function(e){return e.Y1===e.Y2}(n)?(0,r.drawLine)(e,x(n.X1,t,o),n.Y1-o,x(n.X2,t,o),n.Y2):(0,r.drawLine)(e,n.X1-o,x(n.Y1,t,o),n.X2,x(n.Y2,t,o))}function T(e,t,n,r){if(!e.IsRtl){const i=(0,o.isChangeGateEnabled)(o.ChangeGate.BlockEdgeBorderThicknessFix)&&O(t,e)||v(e,t,n)?l.GridLineWidthPx:r;return w(n,{X:(0,d.getCellLeftAdjustedForDrawing)(e,t,!1,!1),Y:(0,d.getCellTopAdjustedForDrawing)(e,t,!1)},{X:(0,d.getCellRightAdjustedForDrawing)(e,t,!1)+i,Y:(0,d.getCellBottomAdjustedForDrawing)(e,t)})}const i=(0,o.isChangeGateEnabled)(o.ChangeGate.BlockEdgeBorderThicknessFix)&&O(t,e)||v(e,t,n)?r-l.GridLineWidthPx:0,a=w(n,{X:(0,d.getCellRightAdjustedForDrawing)(e,t,!1)+r,Y:(0,d.getCellTopAdjustedForDrawing)(e,t,!1)},{X:(0,d.getCellLeftAdjustedForDrawing)(e,t,!1,!1)+i,Y:(0,d.getCellBottomAdjustedForDrawing)(e,t)});if(n===o.BorderPositionType.Top||n===o.BorderPositionType.Bottom){const e=a.X2;a.X2=a.X1,a.X1=e}return a}function w(e,t,n){switch(e){case o.BorderPositionType.Top:return{X1:t.X,Y1:t.Y,X2:n.X,Y2:t.Y};case o.BorderPositionType.Bottom:return{X1:t.X,Y1:n.Y,X2:n.X,Y2:n.Y};case o.BorderPositionType.Right:return{X1:n.X,Y1:t.Y,X2:n.X,Y2:n.Y};case o.BorderPositionType.Left:return{X1:t.X,Y1:t.Y,X2:t.X,Y2:n.Y};default:throw Error("borders::getLineCoordinates Encountered non default BorderPositionType value="+e)}}function I(e){switch(e){case o.BorderLineType.Thin:case o.BorderLineType.Medium:case o.BorderLineType.Hair:case o.BorderLineType.Thick:return!0;default:return!1}}function b(e,t,n){return!!O(n,t)||!!v(t,n,e)||(n.HasError?B(e):e===o.BorderPositionType.Top||e===o.BorderPositionType.Left)}function v(e,t,n){return!(!t.Merge&&!(0,a.isCellAdjacentToMergedCell)(t.Row,t.Col,e))&&B(n)}function x(e,t,n){const o=(0,a.getLinePixelTranslation)(n);return t===l.MediumBorderWeight&&n%2==1?e:e-o}function D(e){const t=e.Red+"_"+e.Green+"_"+e.Blue;let n=g[t];return(0,i.isNullOrUndefined)(n)?(n=`rgb(${e.Red},${e.Green},${e.Blue})`,g[t]=n,n):n}function A(e){return`${D(e.Color)}-${e.Weight}-${e.BorderLineStyle}`}function P(e){let t=h[e];if(!(0,i.isNullOrUndefined)(t))return t;switch(e){case o.BorderLineType.Dotted:t=l.DottedLineDash;break;case o.BorderLineType.DashDot:case o.BorderLineType.MediumDashDot:t=l.DashedDotLineDash;break;case o.BorderLineType.DashDotDot:case o.BorderLineType.MediumDashDotDot:t=l.DashedDotDotLineDash;break;case o.BorderLineType.MediumDashed:t=l.MediumDashedLineDash;break;case o.BorderLineType.SlantDashDot:case o.BorderLineType.Dashed:t=l.DashedLineDash;break;default:t=[]}return h[e]=t,t}function M(e){return e.HasError?l.FormulaErrorBorderStyle:e.CachedBorderStyle}function B(e){return e<=o.BorderPositionType.Right}function H(e,t){const n=e.Col===t.endColumn+1&&e.Row>=t.startRow&&e.Row<=t.endRow,o=e.Row===t.endRow+1&&e.Col>=t.startColumn&&e.Col<=t.endColumn;return n||o}function O(e,t){return e.Row===t.RowNumbers.length-1||e.Col===t.ColumnNumbers.length-1}!function(e){e[e.Top=0]="Top",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Bottom=3]="Bottom"}(C||(C={})),t.clearGridLinesForBorder=function(e,t,n){if(!t.ShowGridLines)return;if(!(0,r.shouldRenderGridLines)((0,a.isHighContrastMode)(n),(0,a.hasWorkbookBackgroundColor)(t.BackgroundColor)))return;f(t),(0,s.setContextForClearingGridLine)(e,n,t.BackgroundColor);const i=t.ClientOnlyCache.GridlineOverridingCellsToRender;e.beginPath();for(let a=0;a<i.length;a++){const s=i[a],d=M(s);if(!(0,r.cellIntersectsRenderingRegion)(s,n.renderingRegion))continue;if(!d)continue;if(!d.Borders||0===d.Borders.length||s.CachedStyle.BackgroundColor)continue;const c=d.Borders;for(let n=0;n<c.length;n++){const r=c[n];r.BorderLineStyle!==o.BorderLineType.None&&(I(r.BorderLineStyle)||b(r.BorderPosition,t,s)&&F(e,l.ThinBorderWeight,T(t,s,r.BorderPosition,l.GridLineWidthPx),l.GridLineWidthPx))}}e.stroke()},t.drawBorders=function(e,t,n){f(t);const i=(0,r.getDefaultBorderLineWidth)(n.scaleFactor),l=(0,a.getWorkbookBackgroundColor)(n.highContrastScheme,t.BackgroundColor),s=function(e,t,n,i){const l={},a=[],s=[],d={},c=e.ClientOnlyCache.GridlineOverridingCellsToRender;for(let u=0;u<c.length;u++){const g=c[u],h=M(g);if(!(0,r.cellIntersectsRenderingRegion)(g,i.renderingRegion)&&!H(g,i.renderingRegion))continue;if(!h)continue;if(!h.Borders||0===h.Borders.length)continue;const C=h.Borders;for(let i=0;i<C.length;i++){const c=C[i];if(c.BorderLineStyle!==o.BorderLineType.None&&b(c.BorderPosition,e,g)){if(c.BorderLineStyle===o.BorderLineType.Double){let i=g.CachedStyle.BackgroundColor?(0,r.hexToRgb)(g.CachedStyle.BackgroundColor):n;(0,o.isChangeGateEnabled)(o.ChangeGate.DoubleBorderFormattingFix)&&(i=p(e,c,g,n));S(e,g,m(c.BorderPosition,i),t,s,d)}S(e,g,c,t,a,l)}}}return{distinctBorderTypes:a,borderTypeToLineMap:l,distinctClearingDoubleBorderTypes:s,clearingDoubleBordersToLineMap:d}}(t,i,(0,r.hexToRgb)(l),n);let d,u;n.highContrastScheme?(u=(0,c.rgbToColorHex)(n.highContrastScheme.TextColor),d=(0,c.rgbToColorHex)(n.highContrastScheme.BackgroundColor),R(e,s.distinctBorderTypes,s.borderTypeToLineMap,i,u),R(e,s.distinctClearingDoubleBorderTypes,s.clearingDoubleBordersToLineMap,i,d)):(R(e,s.distinctBorderTypes,s.borderTypeToLineMap,i,void 0),R(e,s.distinctClearingDoubleBorderTypes,s.clearingDoubleBordersToLineMap,i,void 0))},t.cellHasBottomDoubleBorder=function(e,t){(0,u.verifyArgumentNotNull)(e,"cell","cellHasBottomDoubleBorder");const n=(0,o.getCell)(e.Row+1,e.Col,t);if((0,i.isNullOrUndefined)(n)||(0,i.isNullOrUndefined)(n.CachedBorderStyle)||(0,i.isNullOrUndefined)(n.CachedBorderStyle.Borders))return!1;const r=n.CachedBorderStyle.Borders;for(let e=0;e<r.length;e++){const t=r[e];if(t.BorderPosition===o.BorderPositionType.Top&&t.BorderLineStyle===o.BorderLineType.Double)return!0}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearGridLinesForPivotTables=t.setContextForClearingGridLine=t.clearGridLinesForSpannedCells=void 0;const o=n(0),r=n(4),i=n(2),l=n(55),a=n(6),s=n(5),d=n(3),c=n(69);function u(e,t,n){const r=(0,o.getWorkbookBackgroundColor)(t.highContrastScheme,n);e.strokeStyle=r,e.lineWidth=d.GridLineWidthPx,e.setLineDash(d.DefaultDash)}function g(e,t,n,o,r){let a=e.Col,c=e.Col;const u=n.ClientOnlyCache.ColOffsetsAdjustedForDrawing;e.Merge?(c+=e.Merge.Columns,e.Merge.SpansNextBlockHorizontally&&(c=u.length-1)):e.Spill&&(a-=e.Spill.SpanToStart,c+=e.Spill.SpanToEnd),a=Math.max(0,a),c=Math.min(n.ColumnNumbers.length,c);const g=(0,s.getCellHeightAdjustedForDrawing)(n,e),h=(0,s.getCellTopAdjustedForDrawing)(n,e,!1),C=g-d.GridLineWidthPx;for(let e=a;e<c;e++){const n=(0,l.getAdjustedDrawingOffset)(u[e],(0,i.getColWidthFromOffsets)(e,u),o,r);(0,i.drawLine)(t,n,h,n,h+C)}}function h(e,t,n,o,r){let a=e.Row,c=e.Row+e.Merge.Rows;const u=n.ClientOnlyCache.RowOffsetsAdjustedForDrawing;a=Math.max(0,a),c=Math.min(n.RowNumbers.length,c),e.Merge.SpansNextBlockVertically&&(c=u.length-1);const g=(0,s.getCellLeftAdjustedForDrawing)(n,e,n.IsRtl,!1),h=(0,s.getCellWidthAdjustedForDrawing)(n,e)-d.GridLineWidthPx;for(let e=a;e<c;e++){const n=(0,l.getAdjustedDrawingOffset)(u[e],(0,i.getRowHeightFromOffsets)(e,u),o,r);(0,i.drawLine)(t,g,n,g+h,n)}}t.clearGridLinesForSpannedCells=function(e,t,n){if((0,r.verifyArgumentNotNull)(t,"model","clearGridLinesForText"),(0,r.verifyArgumentNotNull)(e,"ctx","clearGridLinesForText"),(0,r.verifyArgumentNotNull)(n,"context","clearGridLinesForText"),!t.ShowGridLines)return;if(!(0,i.shouldRenderGridLines)((0,o.isHighContrastMode)(n),(0,o.hasWorkbookBackgroundColor)(t.BackgroundColor)))return;const c=t.ClientOnlyCache.CellsToRender,C=(0,o.getLinePixelTranslation)(d.GridLineWidthPx),f=(0,l.getMaxLineOffset)(t.BlockWidth,n.scaleFactor,!1),m=(0,l.getMaxLineOffset)(t.BlockHeight,n.scaleFactor,!0);u(e,n,t.BackgroundColor),e.beginPath();for(let o=0;o<c.length;o++){const r=c[o],l=!(0,a.isNullOrUndefined)(r)&&!(0,a.isNullOrUndefined)(r.Spill),d=!(0,a.isNullOrUndefined)(r)&&!(0,a.isNullOrUndefined)(r.Merge)&&((0,a.isNullOrUndefined)(r.CachedStyle.BackgroundColor)||!(0,a.isNullOrUndefined)(n.highContrastScheme));(0,i.cellIntersectsRenderingRegion)(r,n.renderingRegion)&&(l||d)&&(g(r,e,t,C,f),d&&(0,s.isCellSpansMultipleRowsOrBlocks)(r)&&h(r,e,t,C,m))}e.stroke()},t.setContextForClearingGridLine=u,t.clearGridLinesForPivotTables=function(e,t,n){if((0,r.verifyArgumentNotNull)(t,"model","clearGridLinesForEmptyPivotTables"),(0,r.verifyArgumentNotNull)(e,"ctx","clearGridLinesForEmptyPivotTables"),(0,r.verifyArgumentNotNull)(n,"context","clearGridLinesForEmptyPivotTables"),!t.ShowGridLines)return;if(!(0,i.shouldRenderGridLines)((0,o.isHighContrastMode)(n),(0,o.hasWorkbookBackgroundColor)(t.BackgroundColor)))return;if(!t.PivotTables||0===t.PivotTables.length)return;let l=!1;for(let r=0;r<t.PivotTables.length;r++){const i=t.PivotTables[r];if(!i.HideGridLines)continue;if(!i.IsEmptyPivot&&(0,a.isNullOrUndefined)(i.RowHeaderRange))continue;if(!(0,c.isPivotIntersectsRenderingRegion)(t,i,n.renderingRegion,!0))continue;l||(e.fillStyle=(0,o.getWorkbookBackgroundColor)(n.highContrastScheme,t.BackgroundColor),e.beginPath(),l=!0);const s=(0,c.getPivotTableLeftAdjustedForDrawing)(t,i,t.IsRtl),u=(0,c.getPivotTableTopAdjustedForDrawing)(t,i,!0),g=i.OriginPTWidthAdjustedForDrawing-d.GridLineWidthPx,h=i.OriginPTHeightAdjustedForDrawing-d.GridLineWidthPx;e.rect(s,u,g,h)}l&&e.fill()}},function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.shouldBreak=t.CombiningClass=void 0,function(e){e[e.Other=1]="Other",e[e.CR=2]="CR",e[e.LF=4]="LF",e[e.Control=8]="Control",e[e.Extend=16]="Extend",e[e.Regional_Indicator=32]="Regional_Indicator",e[e.SpacingMark=64]="SpacingMark",e[e.L=128]="L",e[e.V=256]="V",e[e.T=512]="T",e[e.LV=1024]="LV",e[e.LVT=2048]="LVT",e[e.Prepend=4096]="Prepend",e[e.ZWJ=8192]="ZWJ"}(o||(t.CombiningClass=o={}));const r=0|o.Control|o.CR|o.LF,i=0|o.L|o.V|o.LV|o.LVT,l=0|o.V|o.LV,a=0|o.V|o.T,s=0|o.LVT|o.T;function d(e,t){return 0!=(e&t)}t.shouldBreak=function(e,t){return!(e===o.CR&&t===o.LF||!d(r,e)&&!d(r,t)&&(e===o.L&&d(i,t)||d(l,e)&&d(a,t)||d(s,e)&&t===o.T||e===o.Regional_Indicator&&t===o.Regional_Indicator||t===o.Extend||t===o.ZWJ||t===o.SpacingMark||e===o.Prepend))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVerticalTextPadding=void 0;const o=n(9);t.getVerticalTextPadding=function(e){return(0,o.getIndentationPaddingPx)(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClipMaskForSpillCell=t.drawSpillCellText=void 0;const o=n(1),r=n(2),i=n(113),l=n(4),a=n(9),s=n(5),d=n(12);t.drawSpillCellText=function(e,t,n,o,c,u,g,h,C,f,m){(0,l.verifyArgumentNotNull)(o.Spill,"cell.Spill","spillCells.drawSpillCellText");const p=(0,s.getSpillCellWidth)(o,n);if(h)(0,i.fillTextClipped)(e,t,c,u,g,h,o,n,C,m);else{const l=(0,a.getCellTextHorizontalPaddingWithoutVisualElements)(n,o),s=(0,r.getTextDrawingMaxWidth)(p,l,f,(0,d.getExpandCollapseButtonPadding)(o),0);(0,i.fillTextUnclipped)(e,c,u,g,s,o,n,t)}},t.getClipMaskForSpillCell=function(e,t,n,i,l,a,c){var u;const g=(0,s.getSpillCellWidth)(t,e);if(t.Spill.IsSpillBlocked||n||(null===(u=t.CachedStyle)||void 0===u?void 0:u.HorizontalAlignment)===o.HorizontalAlignment.CenterAcrossSelection||l){const n=(0,d.getExpandCollapseButtonPadding)(t),o=(0,r.getClipMaskWidth)(g,i,n);return{x:(0,s.getSpillCellStartOffset)(t,e,i,n),y:a,width:o,height:c}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tableIntersectsRenderingRegion=t.getIntersectionRange=t.getColumnRightOffset=t.getColumnLeftOffset=t.getRowBottomOffset=t.getRowTopOffset=void 0;const o=n(0),r=n(3);function i(e,t,n,o){return{start:Math.max(e,n),end:Math.min(t,o)}}t.getRowTopOffset=function(e,t){var n;const o=null===(n=e.ClientOnlyCache)||void 0===n?void 0:n.RowOffsetsAdjustedForDrawing;if(o)return o[t]},t.getRowBottomOffset=function(e,t){var n;const o=null===(n=e.ClientOnlyCache)||void 0===n?void 0:n.RowOffsetsAdjustedForDrawing;if(o)return o[t+1]},t.getColumnLeftOffset=function(e,t){var n;const o=null===(n=e.ClientOnlyCache)||void 0===n?void 0:n.ColOffsetsAdjustedForDrawing;if(o)return e.IsRtl?o[o.length-1]-o[t]:o[t]},t.getColumnRightOffset=function(e,t){var n;const o=null===(n=e.ClientOnlyCache)||void 0===n?void 0:n.ColOffsetsAdjustedForDrawing;if(o)return e.IsRtl?o[o.length-1]-o[t+1]:o[t+1]},t.getIntersectionRange=i,t.tableIntersectsRenderingRegion=function(e,t,n){return function(e,t,n){const{start:l,end:a}=i(t.FirstColumn,t.LastColumn,e.FirstColumn,e.LastColumn);return(0,o.intersects1D)((l-1)%r.ColumnCountInBlock,(a-1)%r.ColumnCountInBlock,n.startColumn,n.endColumn)}(e,t,n)&&function(e,t,n){const{start:l,end:a}=i(t.FirstRow,t.LastRow,e.FirstRow,e.LastRow);return(0,o.intersects1D)((l-1)%r.RowCountInBlock,(a-1)%r.RowCountInBlock,n.startRow,n.endRow)}(e,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldDrawInCellControl=t.drawInCellControls=void 0;const o=n(121),r=n(1),i=n(2);function l(e,t){return!(null==e||e.DisplayFormula||t&&!(0,i.cellIntersectsRenderingRegion)(e,t.renderingRegion)||!e.InCellControlOptions||(0,r.isChangeGateEnabled)(r.ChangeGate.HideCheckboxOnShowFormula)&&t&&(0,i.isArrayFormulaChildInFormulaView)(e,t)||(0,r.isChangeGateEnabled)(r.ChangeGate.CheckboxInCellImageCheck)&&e.InCellImage||e.InCellControlOptions.Type!==r.InCellControlType.Checkbox||!(0,o.isCellDataValidForCheckboxOrBlankCheckbox)(e))}t.drawInCellControls=function(e,t,n){(0,r.verifyArgumentNotNull)(e,"ctx","drawInCellControls"),(0,r.verifyArgumentNotNull)(t,"model","drawInCellControls"),(0,r.verifyArgumentNotNull)(n,"context","drawInCellControls");const i=t.ClientOnlyCache.CellsToRender;for(let s=0;s<i.length;s++){var a;const d=i[s];l(d,n)&&(null===(a=d.InCellControlOptions)||void 0===a?void 0:a.Type)===r.InCellControlType.Checkbox&&(0,o.drawInCellCheckboxControl)(e,t,d,n)}},t.shouldDrawInCellControl=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCellDataValidForCheckboxOrBlankCheckbox=t.drawInCellCheckboxControl=void 0;const o=n(175),r=n(1),i=n(5),l=n(3),a=n(15),s=n(12),d=n(2),c=n(41),u=n(74),g=n(0),h=n(10),C=n(20),f=n(21),m=n(23),p=n(46),y=n(59),S=n(47);function R(e){return!!e.Text&&e.ValueType===r.CellValueType.Boolean&&void 0!==e.Value}function F(e){var t;return!e.Text&&!e.CachedDisplayText&&(null===(t=e.InCellControlOptions)||void 0===t?void 0:t.Type)===r.InCellControlType.Checkbox}function T(e,t,n,R,F){var T,w;const I=null!==(T=null===(w=n.CachedFont)||void 0===w?void 0:w.Size)&&void 0!==T?T:o.CheckboxDefaultFontSize,b=function(e,t){return(0,s.pointsToPixels)(e,t)}(I,R.scaleFactor),v=function(e,t,n,o,d){const c=function(e,t,n,o,l){let d=(0,a.getEffectiveHorizontalAlignment)(e,t);const c=(0,s.getIconHorizontalPadding)(o,l);switch(t.HorizontalAlignmentSet||(d=r.HorizontalAlignment.Center),d){case r.HorizontalAlignment.Fill:case r.HorizontalAlignment.Justify:case r.HorizontalAlignment.CenterAcrossSelection:case r.HorizontalAlignment.Distributed:case r.HorizontalAlignment.JustifyDistributed:case r.HorizontalAlignment.Automatic:case r.HorizontalAlignment.Left:return Math.floor((0,i.getCellLeftAdjustedForDrawing)(e,t,!1,!1)+c);case r.HorizontalAlignment.Right:return Math.floor((0,i.getCellRightAdjustedForDrawing)(e,t,!1)-n-c);case r.HorizontalAlignment.Center:return Math.floor((0,i.getCellCenterXAdjustedForDrawing)(e,t,!1)-n/2);default:throw Error(`getCheckboxIconHorizontalPosition: Horizontal alignment ${d} is not supported for checkbox icon!`)}}(e,t,d,o,n.scaleFactor),g=(0,r.isChangeGateEnabled)(r.ChangeGate.CellIconBottomPadding)?Math.round(d*l.CellIconBottomSizeRatioPadding):0,h=(0,u.getIconVerticalPosition)(e,t,n.scaleFactor,d);let C=h-d-g;return e.RowOffsets[t.Row+1]-h>C-e.RowOffsets[t.Row]&&(C+=g),{x:c,y:C,width:d,height:d}}(t,n,R,I,b),x=(0,c.getClipRect)(t,n,v.x,v.y,b,!1);(0,d.applyClipping)(e,x),function(e,t,n,i,a,s){var d,u;const R=s?o.BlankCheckboxOpacity:o.CheckboxOpacity;!function(e,t,n,i,a){var s;const d=e.globalAlpha,c=e.textAlign,u=e.textBaseline;e.textAlign="left",e.textBaseline="alphabetic",function(e,t,n,o){var r,i;const a=n.highContrastScheme;e.fillStyle=a?(0,g.rgbToColorHex)(a.TextColor):null!==(r=null===(i=t.CachedFont)||void 0===i?void 0:i.Color)&&void 0!==r?r:l.DefaultCellFontColor,e.font=`${o.width}px ${l.CellFontUnicodeFontFamily}`}(e,t,n,i);const h="1"===t.Value||"true"===t.Value,C=String.fromCharCode(null!==(s=function(e){const t=(0,r.isChangeGateEnabled)(r.ChangeGate.XLYellowFontLoadCheckNew)&&(0,r.isFontRefactorFGV3Enabled)();return t&&!(0,p.verifyFontLoadStatus)(l.CellFontUnicodeFontFamily,p.FontLoadStatus.Loaded)||(0,r.isChangeGateEnabled)(r.ChangeGate.CheckboxFallbackFont)&&!t&&(0,p.getFontLoadStatus)(l.CellFontUnicodeFontFamily)!==p.FontLoadStatus.Loaded?e?o.CheckboxTrueFallbackFont:o.CheckboxFalseFallbackFont:e?o.CheckboxTrueYellowFont:o.CheckboxFalseYellowFont}(h))&&void 0!==s?s:o.CheckboxFalseYellowFont),{x:f,y:m,height:y}=i,S=m+y;e.globalAlpha=a,e.fillText(C,f,S),e.globalAlpha=d,e.textAlign=c,e.textBaseline=u}(e,n,i,a,R);(null===(d=n.FormulaInfo)||void 0===d?void 0:d.FormulaType)!==r.CellFormulaType.ArrayFormula&&(null===(u=n.FormulaInfo)||void 0===u?void 0:u.FormulaType)!==r.CellFormulaType.Formula&&function(e,t,n,o,i){const l=o.y+o.height;let a;if((0,c.shouldClipHorizontally)(e,t,o.x,o.width,!1)||(0,c.shouldClipVertically)(e,t,l,o.width)){const r=(0,c.getClippedDrawingContext)(e,t,n,o);a=(0,f.getUnadjustedHitRegionFromRect)(e,n,r,!1)}else a=(0,f.getUnadjustedHitRegionFromRect)(e,n,o,!1);const s=y.gridRendererStrings.inCellControlCheckboxTooltip?y.gridRendererStrings.inCellControlCheckboxTooltip:void 0;!function(e,t,n,o,i,l){let a;a=r.ChangeGate.StopCursorChangeForCheckboxWhenComponentRangePicker?e=>!(0,h.isEditingOrInComponentRangePicker)():e=>!(0,h.isEditing)(),(0,C.registerCursorHitRegion)(e,t,n,m.PointerCursorType,o,a),(0,C.registerHitRegion)(e,t,n,o,l,m.ClickEventType),(0,C.registerHitRegion)(e,t,n,o,l,m.DoubleClickEventType),i&&(0,C.registerTooltipHitRegion)(e,t,n,i,o)}(t,(0,r.getRenderingRegionHitTestCache)(e,(0,g.getRenderingRegionKey)(n.renderingRegion)),a,r.RenderFeaturesZIndex.CheckboxIcon,s,i)}(t,n,i,a,e=>{const o=(0,r.isPassRibbonCommandsToCanvasRendererEnabled)()?(0,S.getRibbonCommandsInstance)().ToggleInCellControlCheckbox:t.RibbonCommands.ToggleInCellControlCheckbox;return(0,h.handleRibbonCommand)(e,o,"",void 0,n.Row,n.Col),!0})}(e,t,n,R,v,F),(0,d.restoreClipping)(e,x)}t.drawInCellCheckboxControl=function(e,t,n,o){(0,r.verifyArgumentNotNull)(e,"ctx","drawInCellCheckboxControl"),(0,r.verifyArgumentNotNull)(t,"model","drawInCellCheckboxControl"),(0,r.verifyArgumentNotNull)(o,"context","drawInCellCheckboxControl"),(0,r.verifyArgumentNotNull)(n,"cell","drawInCellCheckboxControl"),R(n)?T(e,t,n,o,!1):F(n)&&T(e,t,n,o,!0)},t.isCellDataValidForCheckboxOrBlankCheckbox=function(e){return R(e)||F(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawHeaderCellsBackgroundFill=t.drawGridCellsBackgroundFill=void 0;const o=n(1),r=n(2),i=n(5),l=n(0),a=n(4),s=n(6),d=n(3),c=n(176);function u(e,t,n,r,l,a){const s=(0,i.getCellDimensionsAdjustedForDrawing)(t,n,!1);if(r===h.Gradient)return(0,c.fillCellWithGradientBackground)(e,n.CachedStyle.Gradient,s,l);const u=function(e,t,n){return t===h.FormulaParseError?d.FormulaErrorBackgroundColor:n&&e.CachedStyle.BackgroundColor===o.PartialRowColSelectionAndHoverBackgroundColor?o.PartialRowColSelectionBackgroundColor:e.CachedStyle.BackgroundColor}(n,r,a);return l!==u&&(e.fillStyle=u),e.fillRect(s.x,s.y,s.width,s.height),u}function g(e){return e.HasError?h.FormulaParseError:(0,s.isNullOrUndefined)(e.CachedStyle.Gradient)?(0,s.isNullOrUndefined)(e.CachedStyle.BackgroundColor)?h.None:h.Solid:h.Gradient}var h;t.drawGridCellsBackgroundFill=function(e,t,n){if((0,a.verifyArgumentNotNull)(t.RowOffsets,"model.RowOffsets","drawBackgroundFill"),(0,a.verifyArgumentNotNull)(t.ColumnOffsets,"model.ColumnOffsets","drawBackgroundFill"),(0,a.verifyArgumentNotNull)(t.RowHeights,"model.RowHeights","drawBackgroundFill"),(0,a.verifyArgumentNotNull)(t.ColumnWidths,"model.ColumnWidths","drawBackgroundFill"),(0,a.verifyArgumentNotNull)(t.Styles,"model.Styles","drawBackgroundFill"),n.highContrastScheme)return;let o;const l=[],s=t.ClientOnlyCache.GridlineOverridingCellsToRender;for(let a=0;a<s.length;a++){const d=s[a],c=g(d);c!==h.None&&(0,r.cellIntersectsRenderingRegion)(d,n.renderingRegion)&&((0,i.isCellSpansMultipleRowsOrBlocks)(d)?l.push([d,c]):o=u(e,t,d,c,o))}for(let n=0;n<l.length;n++){const[r,i]=l[n];o=u(e,t,r,i,o)}},t.drawHeaderCellsBackgroundFill=function(e,t,n){if((0,s.isNullOrUndefined)(t.Cells))return;let i;const a=(0,l.isHighContrastMode)(n),d=t.ClientOnlyCache.CellsToRender;for(let l=0;l<d.length;l++){const s=d[l];if(g(s)===h.None)continue;if(!(0,r.cellIntersectsRenderingRegion)(s,n.renderingRegion))continue;const C=s.CachedStyle.BackgroundColor;a&&(c=C)!==o.PartialRowColSelectionAndHoverBackgroundColor&&c!==o.PartialRowColSelectionBackgroundColor||(i=u(e,t,s,h.Solid,i,a))}var c},function(e){e[e.None=0]="None",e[e.Solid=1]="Solid",e[e.FormulaParseError=2]="FormulaParseError",e[e.Gradient=3]="Gradient"}(h||(h={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawSymbols=void 0;const o=n(0),r=n(4),i=n(19),l=n(27),a=n(28),s=n(45),d=n(75),c=n(18);function u(e,t,n,o,r,i,a){const s={left:t,bottom:n,outerColor:a,height:o,width:r,innerColor:i};(0,l.drawRectangle)(e,s)}t.drawSymbols=function(e,t){(0,r.verifyArgumentNotNull)(e,"ctx","drawSymbols"),(0,r.verifyArgumentNotNull)(t,"drawingContext","drawSymbols");const{image:n,highContrastScheme:g}=t,h=function(e,t){if(t)return(0,o.rgbToColorHex)(t.TextColor);switch(e){case i.CFIconImage.SymbolHigh:return a.SymbolHighInnerColor;case i.CFIconImage.SymbolMedium:return a.SymbolMediumInnerColor;case i.CFIconImage.SymbolLow:return a.SymbolLowInnerColor;case i.CFIconImage.CircleSymbolHigh:case i.CFIconImage.CircleSymbolMedium:case i.CFIconImage.CircleSymbolLow:return a.CircleSymbolInnerShapeInnerColor;default:throw Error("getSymbolInnerColor: unsupported image type = "+e)}}(n,g),C=function(e,t){if(t)return(0,o.rgbToColorHex)(t.TextColor);switch(e){case i.CFIconImage.SymbolHigh:case i.CFIconImage.CircleSymbolHigh:return a.SymbolHighOuterColor;case i.CFIconImage.SymbolMedium:case i.CFIconImage.CircleSymbolMedium:return a.SymbolMediumOuterColor;case i.CFIconImage.SymbolLow:case i.CFIconImage.CircleSymbolLow:return a.SymbolLowOuterColor;default:throw Error("getSymbolOuterColor: unsupported image type = "+e)}}(n,g);switch(n){case i.CFIconImage.SymbolHigh:case i.CFIconImage.CircleSymbolHigh:!function(e,t,n,o){let r;const{size:l,left:a,bottom:d,image:u}=t;switch(u){case i.CFIconImage.SymbolHigh:r=function(e,t,n){const o=t-n,r=e+i.CheckMarkMiddleXRatio*n,l={x:e+i.CheckMarkTopLeftXRatio*n,y:i.CheckMarkTopLeftYRatio*n+o};return[l,{x:e+i.CheckMarkTopMiddleXRatio*n,y:i.CheckMarkTopMiddleYRatio*n+o},{x:r,y:i.CheckMarkBottomYRatio*n+o},{x:e+n,y:i.CheckMarkMiddleRightYRatio*n+o},{x:e+i.CheckMarkTopRightXRatio*n,y:i.CheckMarkTopRightYRatio*n+o},{x:r,y:i.CheckMarkMiddleYRatio*n+o},l]}(a+c.ShapeLinesAdjustment,d,l);break;case i.CFIconImage.CircleSymbolHigh:r=function(e,t,n){const o=t-n,r=e+i.CircledCheckMarkMiddleXRatio*n,l={x:e+i.CircledCheckMarkTopLeftXRatio*n,y:i.CircledCheckMarkTopLeftYRatio*n+o};return[l,{x:e+i.CircledCheckMarkTopMiddleXRatio*n,y:i.CircledCheckMarkTopMiddleYRatio*n+o},{x:r,y:i.CircledCheckMarkBottomYRatio*n+o},{x:e+i.CircledCheckMarkMiddleRightXRatio*n,y:i.CircledCheckMarkMiddleRightYRatio*n+o},{x:e+i.CircledCheckMarkTopRightXRatio*n,y:i.CircledCheckMarkTopRightYRatio*n+o},{x:r,y:i.CircledCheckMarkMiddleYRatio*n+o},l]}(a,d,l);break;default:throw Error("drawCheckMark: unsupported image type = "+u)}(0,s.drawIconFromPoints)(e,n,o,r)}(e,t,h,C);break;case i.CFIconImage.SymbolMedium:case i.CFIconImage.CircleSymbolMedium:!function(e,t,n,o){const{image:r}=t;switch(r){case i.CFIconImage.SymbolMedium:!function(e,t,n,o){const{size:r,left:a,bottom:s}=t,d=Math.floor(r*i.ExclamationMarkTopRectHeightSizeRatio),c=Math.floor(r*i.ExclamationMarkBottomRectHeightSizeRatio),g=Math.floor(r*i.ExclamationMarkWidthRectSizeRatio),h=d+Math.max(i.ExclamationMarkMinSpaceBetweenRectangels,Math.floor(i.ExclamationMarkSpaceBetweenRectanglesRatio*r)),C=a+Math.floor(i.ExclamationMarkLeftRectanglePaddingRatio*r);u(e,C,s-(r-d),d,g,n,o),function(e,t,n,o,r,i,a,s,d){const c={left:t,bottom:n-(o-d-r),outerColor:s,height:r,width:i,innerColor:a};(0,l.drawRectangle)(e,c)}(e,C,s,r,c,g,n,o,h)}(e,t,n,o);break;case i.CFIconImage.CircleSymbolMedium:!function(e,t,n,o){const{size:r,left:l,bottom:a,image:s}=t,g=r-2*i.CircledExclamationMarkPaddingFromCircle,h=Math.floor(g*i.CircledExclamationMarkTopRectHeightSizeRatio),C=function(e){const t=Math.floor(e*i.CircledExclamationMarkWidthRectSizeRatio);return t%2==0?t-1:t}(h),f=l+r/2,m=Math.round(f-(C+1)/2),p=a-i.CircledExclamationMarkPaddingFromCircle,y=function(e){const t=Math.floor(e*i.CircledExclamationMarkLeftCircleSizeRatio);return t%2==0?t:t-1}(g),S={image:s,bottom:p,highContrastScheme:void 0,left:function(e,t,n){return e+c.ShapeLinesAdjustment-(t-n)/2}(m,y,C),size:y};u(e,m,Math.floor(a-i.CircledExclamationMarkPaddingFromCircle-(y+1)),h,C,n,o),(0,d.drawCircle)(e,S,o,n)}(e,t,n,o);break;default:throw Error("drawExclamationMark: unsupported image type = "+r)}}(e,t,h,C);break;case i.CFIconImage.SymbolLow:case i.CFIconImage.CircleSymbolLow:!function(e,t,n,o){let r;const{size:l,left:a,bottom:d,image:u}=t;switch(u){case i.CFIconImage.SymbolLow:r=function(e,t,n){const o=t-n,r=i.CrossMarkOuterSmallPaddingRatio*n,l=r+e,a=r+o,s=i.CrossMarkOuterBigPaddingRatio*n,d=s+e,c=s+o,u=i.CrossMarkInnerSmallPaddingRatio*n,g=u+e,h=u+o,C=i.CrossMarkInnerCenterRatio*n,f=C+e,m=C+o,p=i.CrossMarkInnerBigPaddingRatio*n,y={x:l,y:o};return[y,{x:e,y:a},{x:g,y:m},{x:e,y:c},{x:l,y:n+o},{x:f,y:p+o},{x:d,y:n+o},{x:e+n,y:c},{x:e+p,y:m},{x:e+n,y:a},{x:d,y:o},{x:f,y:h},y]}(a+c.ShapeLinesAdjustment,d,l);break;case i.CFIconImage.CircleSymbolLow:r=function(e,t,n){const o=(F=n)%2==1?F+1:F,r=t-n,l=i.CircledCrossMarkOuterSmallPaddingRatio*o,a=l+e,s=l+r,d=i.CircledCrossMarkOuterBigPaddingRatio*o,c=d+e,u=d+r,g=i.CircledCrossMarkInnerSmallPaddingRatio*o,h=g+e,C=g+r,f=i.CircledCrossMarkInnerCenterRatio*o,m=f+e,p=f+r,y=i.CircledCrossMarkInnerBigPaddingRatio*o,S=i.CircledCrossMarkPaddingFromCircleRatio*o,R={x:a,y:r+S};var F;return[R,{x:e+S,y:s},{x:h,y:p},{x:e+S,y:u},{x:a,y:o+r-S},{x:m,y:y+r},{x:c,y:o+r-S},{x:e+o-S,y:u},{x:e+y,y:p},{x:e+o-S,y:s},{x:c,y:r+S},{x:m,y:C},R]}(a,d,l);break;default:throw Error("drawCrossMark: unsupported image type = "+u)}(0,s.drawIconFromPoints)(e,n,o,r)}(e,t,h,C);break;default:throw Error("drawSymbols: unsupported image type = "+n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawCircledSymbols=void 0;const o=n(4),r=n(75),i=n(123);t.drawCircledSymbols=function(e,t){(0,o.verifyArgumentNotNull)(e,"ctx","drawCircleSymbols"),(0,o.verifyArgumentNotNull)(t,"drawingContext","drawCircleSymbols"),t.size>0&&((0,r.drawCircleIcon)(e,t),(0,i.drawSymbols)(e,function(e){const{left:t,bottom:n,image:o,highContrastScheme:r,size:i}=e,l=Math.round(t),a=Math.round(n);return{size:Math.round(i),left:l,bottom:a,image:o,highContrastScheme:r}}(t)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLineWidth=t.setPageLayoutLine=void 0;const o=n(3),r=n(6),i=n(0);function l(e){return(0,i.isHighContrastMode)(e)?o.HighContrastPageLayoutWidthPx:o.GridLineWidthPx}t.setPageLayoutLine=function(e,t){e.lineWidth=l(t),e.setLineDash(o.DefaultDash),e.strokeStyle=(0,r.isNullOrUndefined)(t.highContrastScheme)?o.PageLayoutLineColor:""+(0,i.rgbToColorHex)(t.highContrastScheme.TextColor)},t.getLineWidth=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTextWidthAdjustedForDrawing=t.drawExpandCollapseButtons=void 0;const o=n(1),r=n(3),i=n(5),l=n(15),a=n(57),s=n(2),d=n(9),c=n(18),u=n(0),g=n(8),h=n(14),C=n(69),f=n(12),m=n(20),p=n(10),y=n(23),S=n(95),R=n(31);function F(e,t,n,o){return function(e){return!!(e.CachedDrawingLayout&&e.CachedDrawingLayout.CellTextLayout&&e.CachedDrawingLayout.CellTextLayout.Width)}(n)?Math.ceil(n.CachedDrawingLayout.CellTextLayout.Width*o):Math.ceil((0,d.getTextWidthNoCaching)(e,t,n)*o)}function T(e,t,n){var o;return!(null==n||!n.PivotTable||null==n||!n.PivotTable.CanExpandCollapse||!(0,s.cellIntersectsRenderingRegion)(n,t.renderingRegion)||(0,u.isCellPreviewTextDefined)(n.PreviewText)||n.ShowSkeleton||null!==(o=n.CondFormat)&&void 0!==o&&null!==(o=o.Icon)&&void 0!==o&&o.IconOnly&&!(0,C.canCellContainExpandCollapseAndCFIcon)(n,(0,i.getCellWidthAdjustedForDrawing)(e,n),t.scaleFactor))}function w(e,t,n,o){const r=(0,i.getCellWidth)(e,t,!1);return(0,s.getTextDrawingMaxWidth)(r,(0,d.getCellTextHorizontalPaddingWithoutVisualElements)(e,t),n,(0,f.getExpandCollapseButtonPadding)(t),0)*o}function I(e,t,n,r){const l=t.PivotTable,a=!!l.ConfirmRequired,s=e.RowNumbers[t.Row]-1,d=e.ColumnNumbers[t.Col]-1,c=e=>((0,p.togglePivotDrill)(e,a,s,d,l.SourceIndex),!0),g=(0,i.getAdjustedCellArea)(e,t,!0),h=function(e,t,n){return{isMirrored:!1,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:n,isRtl:e.IsRtl,blockWidth:e.BlockWidth}}(e,n,g),C=(0,o.getRenderingRegionHitTestCache)(e,(0,u.getRenderingRegionKey)(n.renderingRegion));if(b(t,C,h,y.DoubleClickEventType,c),r&&function(e,t){return!(e.x+e.width<t.left)&&(!(e.x>t.left+t.width)&&(!(e.y>t.bottom)&&!(e.y+e.height<t.bottom-t.height)))}(g,r)){const i=function(e,t,n,o){const r=n.width,i=n.left,l=n.bottom-r,a=r,s=r,d=Math.min(a,o.x+o.width-i),c=Math.max(l,o.y),u=Math.min(l+s,o.y+o.height)-c;return{isMirrored:!1,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:{x:Math.max(i,o.x),y:c,width:d,height:u},isRtl:e.IsRtl,blockWidth:e.BlockWidth}}(e,n,r,g);b(t,C,i,y.ClickEventType,c);const a=l.ECButtonTitle;(0,m.registerTooltipHitRegion)(t,C,i,a,o.RenderFeaturesZIndex.DrillIndicator),(0,m.registerCursorHitRegion)(t,C,i,y.PointerCursorType,o.RenderFeaturesZIndex.DrillIndicator)}}function b(e,t,n,r,i){(0,m.registerHitRegion)(e,t,n,o.RenderFeaturesZIndex.DrillIndicator,i,r),(0,m.registerHitRegion)(e,t,n,o.RenderFeaturesZIndex.DrillIndicator,y.TouchCallback,"touchstart")}function v(e,t,n,s){const{scaleFactor:c}=n,g=(0,S.getAdjustedButtonSize)(c,a.ExpandCollapseButtonSizePx),C=F(e,t,s,c),f=(0,h.shouldRenderVerticalText)(s),m=function(e,t,n,r,s,c){var g;const{scaleFactor:h}=n,C=a.PaddingBetweenExpandCollapseButtonAndTextPx*h;if(c)return e.IsRtl?Math.floor((0,i.getCellRightAdjustedForDrawing)(e,t,!1)-C)-r:Math.floor((0,i.getCellLeftAdjustedForDrawing)(e,t,!1,!1)+C);let f=(0,d.getDistanceFromCellStartToIconEnd)(e,t,n.zoom,n.devicePixelRatio),m=0;if((0,o.isChangeGateEnabled)(o.ChangeGate.FixCellImageAlignmentWithRichPivotDrill)){const e=(0,u.getDynamicImageInformationFromCell)(t,R.ImageType.InCellImage);null!=e&&e.Width&&(m=(null==e?void 0:e.Width)*h)}let p=0;f>0&&t.RichValueIcon&&(null===(g=t.CondFormat)||void 0===g||!g.Icon)&&(p=f*h,f=0);const y=t.CachedIndent||a.NoIndent,S=(0,d.getCellHorizontalIndentationPaddingPx)(t,y),F=(0,l.getEffectiveHorizontalAlignment)(e,t);if(function(e,t,n,o,r){if(!t.WrapText)return!1;const i=w(e,t,n,r);return t.WrapText&&i<o}(e,t,f,s,h))return function(e,t,n,r,l,s,c,u){const g=function(e,t){return t?e===o.HorizontalAlignment.Right:e===o.HorizontalAlignment.Center||e===o.HorizontalAlignment.Left}(n,e.IsRtl)?(0,d.getCellHorizontalIndentationPaddingPx)(t,r)*u:a.NoIndent;if(e.IsRtl){const r=(0,i.getCellRightAdjustedForDrawing)(e,t,!1);return t.WrapText&&g===a.NoIndent&&n===o.HorizontalAlignment.Left&&c<=0?Math.floor(r):Math.min(Math.floor(r-l-s-g),r)}return Math.floor((0,i.getCellLeftAdjustedForDrawing)(e,t,!1,!1)+l+g)}(e,t,F,y,C,r,w(e,t,f,h),h);const T=(0,d.getTextHorizontalPosition)(e,t,n)*h;switch(F){case o.HorizontalAlignment.Left:if(e.IsRtl)return Math.min(Math.floor(T+s+m+C),t.RichValueIcon?Math.floor((0,i.getCellRightAdjustedForDrawing)(e,t,!1)-C)-r:Number.MAX_VALUE);const n=(S+f+a.PaddingBetweenExpandCollapseButtonAndTextPx)*h;return Math.floor((0,i.getCellLeftAdjustedForDrawing)(e,t,!1,!1)+n);case o.HorizontalAlignment.CenterAcrossSelection:case o.HorizontalAlignment.Center:return e.IsRtl?Math.min(Math.floor(T+s/2+m/2+C),t.RichValueIcon?Math.floor((0,i.getCellRightAdjustedForDrawing)(e,t,!1)-C)-r:Number.MAX_VALUE):Math.max(Math.floor(T-s/2-m/2-p-C)-r,(0,i.getCellLeftAdjustedForDrawing)(e,t,!1,!1));case o.HorizontalAlignment.Right:return e.IsRtl?Math.floor((0,i.getCellRightAdjustedForDrawing)(e,t,!1)-C-S*h)-r:Math.max(Math.floor(T-s-m-p-C)-r,(0,i.getCellLeftAdjustedForDrawing)(e,t,!1,!1));default:throw Error("getAdjustedButtonLeft: unsupported horizontalAlignment: "+F)}}(t,s,n,g,C,f),p=function(e,t,n,l,a){var s;if(a)return Math.floor((0,i.getCellCenterYAdjustedForDrawing)(e,t)-l/2);const c=null===(s=t.CachedStyle)||void 0===s?void 0:s.VerticalAlignment;if(c===o.VerticalAlignment.Justify)return Math.floor(Math.floor((0,i.getCellCenterYAdjustedForDrawing)(e,t)-l/2));const u=function(e,t,n,o){const l=(0,d.getTextLineHeight)(t,e),a=(0,i.getCellHeight)(e,t,!1)-r.GridLineWidthPx,s=l*o/2;return(0,d.getTextVerticalPosition)(t,e,l,a,n,void 0).absoluteY*o+r.InCellBottomAndCenterVerticalPaddingPx-s/2}(e,t,c,n);return Math.round(u-l/2)}(t,s,c,g,f),y=n.highContrastScheme;return{outerColor:y?(0,u.rgbToColorHex)(y.TextColor):a.ExpandCollapseButtonOuterColor,innerColor:y?(0,u.rgbToColorHex)(y.BackgroundColor):a.ExpandCollapseButtonInnerColor,left:m,bottom:p+g,height:g,width:g}}function x(e,t,n,o){return(0,d.getDistanceFromCellStartToIconEnd)(e,t,n.zoom,n.devicePixelRatio)*n.scaleFactor+(t.Spill?(0,i.getSpillCellLeftAdjustedForDrawing)(e,t):(0,i.getCellLeftAdjustedForDrawing)(e,t,!1,!1))>o.left}t.drawExpandCollapseButtons=function(e,t,n){if((0,o.verifyArgumentNotNull)(e,"ctx","drawExpandCollapseButtons"),(0,o.verifyArgumentNotNull)(t,"model","drawExpandCollapseButtons"),(0,o.verifyArgumentNotNull)(n,"context","drawExpandCollapseButtons"),!t.PivotTables)return;const i=t.ClientOnlyCache.CellsToRender;let l=!1;for(let o=0;o<i.length;o++){var a;const d=i[o];if(!T(t,n,d))continue;let u=void 0;if(null!==(a=d.PivotTable)&&void 0!==a&&a.HasExpandCollapseIndicator){var s;if(l||(e.lineWidth=c.ShapeOutlineWidthPx,e.setLineDash(r.DefaultDash),l=!0),e.font=(0,g.getFontCssStringFromFont)(d.CachedFont,void 0,t),u=v(e,t,n,d),null!==(s=d.CondFormat)&&void 0!==s&&s.Icon&&x(t,d,n,u))continue;const o=!!d.PivotTable.IsExpanded;(0,S.drawExpandCollapseButton)(e,t,d,u,o,!0)}I(t,d,n,u)}},t.getTextWidthAdjustedForDrawing=F},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.maskDifferentialRenderingAreas=void 0;const o=n(1),r=n(3),i=n(2);function l(e,t){const{x:n,y:o,width:r,height:i}=t;e.moveTo(n,o),e.lineTo(n+r,o),e.lineTo(n+r,o+i),e.lineTo(n,o+i),e.lineTo(n,o)}function a(e,t){const{row:n,column:l}=(0,o.getRowColFromCellKey)(t),a=(0,i.getColOffsetAdjustedForDrawing)(l,e);return{x:e.IsRtl?a:a-r.GridLineWidthPx,y:e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[n]-r.GridLineWidthPx,width:(0,i.getColWidthFromOffsets)(l,e.ClientOnlyCache.ColOffsetsAdjustedForDrawing)+r.GridLineWidthPx,height:(0,i.getRowHeightFromOffsets)(n,e.ClientOnlyCache.RowOffsetsAdjustedForDrawing)+r.GridLineWidthPx}}t.maskDifferentialRenderingAreas=function(e,t){t.save(),t.beginPath();for(let n=0;n<e.ClientOnlyCache.DirtyCellsKeys.length;n++){const o=a(e,e.ClientOnlyCache.DirtyCellsKeys[n]);o&&l(t,o)}t.strokeStyle="transparent",t.stroke(),t.clip()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommentHitRegionProportionConstant=t.CommentWithFilterPaddingPx=t.MinCommentIconSizePx=t.LegacyCommentSizePx=t.LegacyCommentColor=t.ThreadedCommentSizePx=t.ResolvedThreadedCommentColor=t.ActiveThreadedCommentColor=void 0,t.ActiveThreadedCommentColor="#bd67c9",t.ResolvedThreadedCommentColor="#808080",t.ThreadedCommentSizePx=8,t.LegacyCommentColor="#ff0000",t.LegacyCommentSizePx=8,t.MinCommentIconSizePx=4,t.CommentWithFilterPaddingPx=2,t.CommentHitRegionProportionConstant=1.5},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasRenderer=void 0;const o=n(1),r=n(13),i=n(0),l=n(6),a=n(206),s=n(130),d=n(39),c=n(11);t.CanvasRenderer=class{render(e,t,n){let s;try{if((0,r.clearPerformanceMetrics)(),!e)return(0,r.createRenderResult)(!1,"render:: canvas is undefined");if(!t)return(0,r.createRenderResult)(!1,"render:: model is undefined");if(!n)return(0,r.createRenderResult)(!1,"render:: context is undefined");if((0,a.loadPolyFills)(t),t.RowOffsets.length>o.MaxAllowedRowColCount)return(0,r.createRenderResult)(!1,`render:: block # of rows = ${t.RowOffsets.length} > MaxAllowedRowColCount`);if(t.ColumnOffsets.length>o.MaxAllowedRowColCount)return(0,r.createRenderResult)(!1,`render:: block # of columns = ${t.ColumnOffsets.length} > MaxAllowedRowColCount`);if((0,r.trackDuration)(r.RenderPerformanceMetric.GetContextDurationMs,()=>{this.ctx=e.getContext2d({alpha:!n.subPixelRenderingEnabled}),void 0===this.isDefaultFontFixEnabled&&(this.isDefaultFontFixEnabled=(0,c.isChangeGateEnabled)("OfficeVSO:8844869_defaultFontCrash")),this.isDefaultFontFixEnabled&&this.ctx?this.ctx.font=d.DefaultCanvasFontString:this.isDefaultFontFixEnabled||(this.ctx.font=`${d.DefaultFontSizePt}pt ${d.DefaultFontName}`)}),!this.ctx){const e=this.prepareOffscreenCanvasMsg(t);return(0,r.createRenderResult)(!1,"render:: ctx is undefined - "+e)}const u=(0,i.extendRenderingContext)(n);if((0,r.trackDuration)(r.RenderPerformanceMetric.ModelPreparationsMs,()=>{this.preprocessModel(t,n.renderingRegion,u,n.skeletonMode)}),(0,o.isDifferentialRenderingSupported)(t)&&!(0,i.renderingRegionContainsDirtyCells)(n.renderingRegion,t))return(0,r.createRenderResult)(!0,"skipped rendering since rendering region doesn't have dirty cells");if((0,r.trackDuration)(r.RenderPerformanceMetric.RenderInternalDurationMs,()=>{s=this.renderInternal(e,t,u)}),(0,r.trackDuration)(r.RenderPerformanceMetric.RegisterHitRegionsMs,()=>{this.shouldInitializeCanvasHitTest(t,n.skeletonMode)&&this.initializeCanvasHitTest(e,t,u.renderingRegion,u.zoom)}),u.renderingRegion.isRendered=!0,(0,l.isNullOrUndefined)(s)&&(s=(0,r.createRenderResult)(!0,"")),s.message+=this.prepareOffscreenCanvasMsg(t),s.succeeded){const e=(0,r.getRenderingMessage)();s.message=(0,l.isNullOrUndefined)(s.message)?e.message:s.message+"; "+e.message,s.messageLevel=e.level}}catch(e){return(0,r.createRenderResult)(!1,`exception caught in render: message: ${e.message} name: ${e.name} stack: ${e.stack} error: ${e}`)}return s}setTransform(e,t,n,o,r){t?this.ctx.setTransform(-e,0,0,e,r+n,o):this.ctx.setTransform(e,0,0,e,n,o)}prepareOffscreenCanvasMsg(e){const t=(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.UseOffscreenCanvas,e),n=!!t&&(0,i.isOffscreenCanvasSupported)();return"- offscreenCanvasFG: "+(t?"ON offscreenCanvasSupported: "+n:"OFF")}initializeCanvasHitTest(e,t,n,r){e.removeAllEventListeners(),(0,s.setHitMapOffsets)(e,t,n),e.setAppZoom(r);const l=(0,o.getRenderingRegionHitTestCache)(t,(0,i.getRenderingRegionKey)(n)),a=l.CellHitRegions;(0,i.registerCanvasHitRegionsFromCache)(a,t=>{e.addRegionEventListener(t)});const d=l.CellCursorHitRegions;(0,i.registerCanvasHitRegionsFromCache)(d,t=>{e.addCursorRegion(t)});const c=l.CellTooltipHitRegions;(0,i.registerCanvasHitRegionsFromCache)(c,t=>{e.addTooltipRegion(t)});const u=l.CellLongPressHitRegions;(0,i.registerCanvasHitRegionsFromCache)(u,t=>{e.addLongPressRegion(t)}),e.optimizeHitMapLookup()}constructor(){this.isDefaultFontFixEnabled=void 0,this.ctx=null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultLongPressState=t.getEventCoordinates=t.areTwoHitRegionsSame=t.hitRegionComparer=t.setHitMapOffsets=void 0;const o=n(0),r=n(13);function i(e,t,n,o,i,l){let a;if(0===o&&n===e.length-1)a=e.slice(0);else{a=e.slice(t,n+1),a[0]=0;for(let n=1;n<a.length;n++)a[n]=a[n]-o,a[n]<0&&((0,r.setRenderingResultInfo)(`getHitMapAxisOffsets: Unexpected input params: startOffsetPx: ${o}, startOffset: ${t}, offsets: ${e}`),a.splice(n,1),n--)}if(i){a=function(e,t){const n=e.slice(1).map((t,n)=>t-e[n]).concat([t-e[e.length-1]]);return e=e.map((e,o)=>t-e-n[o]).reverse()}(a,l);for(let e=0;e<a.length;e++)a[e]<0&&((0,r.setRenderingResultInfo)(`getHitMapAxisOffsets: Unexpected RTL conversion results: index: ${e}, offset: ${a[e]}`),a.splice(e,1),e--)}return a}t.setHitMapOffsets=function(e,t,n){const o=i(t.ColumnOffsets,n.startColumn,n.endColumn,n.startOffsetX,t.IsRtl,n.endOffsetX),r=i(t.RowOffsets,n.startRow,n.endRow,n.startOffsetY,!1);e.setHitMapOffsets(o,r,t.BlockWidth,t.BlockHeight,n)},t.hitRegionComparer=function(e,t){return t.zIndex-e.zIndex},t.areTwoHitRegionsSame=function(e,t){return e.zIndex===t.zIndex&&(0,o.areTwoRectsEqual)(e.region,t.region)},t.getEventCoordinates=function(e,t){const n=e,o=e;if("touchstart"===t){const{clientX:e,clientY:t}=n.touches[0];return{clientX:e,clientY:t}}if("touchend"===t){const e=n.changedTouches.length,{clientX:t,clientY:o}=n.changedTouches[e-1];return{clientX:t,clientY:o}}return{clientX:o.clientX,clientY:o.clientY}},t.getDefaultLongPressState=function(){return{callbackScheduled:!1,longPressModeEnabled:!1,callbackId:-1,eventPointerId:-1,lastHitRegion:void 0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFontMargin=t.calculateColWidthForMetadata=void 0;const o=n(1),r=n(0),i=n(8),l=n(9),a=n(3),s=n(12),d=n(68),c=n(17),u=n(48),g=n(32),h=n(22),C=n(93),f=n(7);function m(e){const t=(0,l.measureTextWidth)(e,"1234567890",!0,!0);return Math.ceil(t/10)}t.calculateColWidthForMetadata=function(e,t,n){if(n.CachedStyle||(n.CachedStyle=(0,o.getReferencedObjectById)(n.CellStyleId||0,t.Styles)),n.CachedFont||(n.CachedFont=(0,o.getReferencedObjectById)(n.CachedStyle.FontID||0,t.Fonts)),n.TextRuns){n.CachedFormattedText=(0,r.getFormattedTextForMetadata)(n.Text,n,t);const e=n.CachedFormattedText;for(let r=0;r<n.CachedFormattedText.TextRuns.length;r++){const i=e.TextRuns[r],l=i.FontID||0;try{e.TextRuns[r].CachedFont=(0,o.getReferencedObjectById)(l,t.Fonts)}catch(e){return f.ULS.sendTraceTag(520382479,f.LogCategory.msoulscat_ES_EWAJSGrid,f.TraceLevel.Warning,"calculateColWidthForMetadata: Exception in getting FontID: "+l+", ich: "+i.StartIndex+" index: "+r+", ModelFontSize: "+t.Fonts.length),n.SrvDx}}}return function(e,t,n){(0,o.verifyArgumentNotNull)(n.CachedStyle,"CachedStyle","Preproccessor::Helper"),(0,o.verifyArgumentNotNull)(n.CachedFont,"CachedFont","Preproccessor::Helper");let r=0;n.TextRuns&&(r=(0,g.measureFormattedTextWidth)(e,n.CachedFormattedText,t));const f=(0,i.getFontCssStringFromFont)(n.CachedFont,n.CachedFont.Size,t);if(e.font!==f&&(e.font=f),n.TextRuns||(r=(0,l.measureTextWidth)(e,n.Text,!0,!0)),(0,h.shouldDrawRotatedText)(t,n.CachedStyle,n.CachedFont)){const e=n.TextRuns&&(0,o.isChangeGateEnabled)(o.ChangeGate.FixRotatedTextWidth)?(0,l.getFormattedTextLineHeight)(t,n.CachedFormattedText):(0,l.getFontLineHeight)(t,n.CachedFont.Size,n.CachedFont.FontName);r=(0,C.getRotatedTextWidth)(t,r,e,n.CachedStyle)}const p=function(e,t){var n;const o=t.CachedStyle.VerticalText,r=t.CachedStyle.Indentation||0,i=o?0:(0,l.getIndentationPaddingPx)(r),g=null!==(n=t.CachedStyle)&&void 0!==n&&n.VerticalText?(0,l.getFontLineHeight)(e,t.CachedFont.Size,t.CachedFont.FontName):0,h=function(e,t){if(t.CondWidthIcon){var n;const e=null===(n=t.CachedFont)||void 0===n?void 0:n.Size;return(0,s.getIconSize)(e,1)+(0,s.getIconHorizontalPadding)(e,1)+a.GridLineWidthPx}if(t.RichValueIcon){const n=(0,c.shouldAddAutoFilterPaddingForMetadata)(e,t)?Math.round(u.AutoFilterIconRectPx+u.AutoFilterTextHorizontalPaddingPx):0;return t.IconWidth||0+d.RichValueIconRightHorizontalPadding+n}return 0}(e,t)||0,C=(0,s.getExpandCollapseButtonWidth)(t.ExpandColButton);let f=0;return t.Autofilter&&(f=u.AutoFilterIconRectPx,(0,c.shouldAddAutoFilterPaddingForMetadata)(e,t)&&(f+=u.AutoFilterTextHorizontalPaddingPx)),i+g+C+h+f}(t,n),y=m(e);return Math.min(Math.round(r+p+y),1790)}(e,t,n)},t.getFontMargin=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BlockModelAccessor=void 0;const o=n(1),r=n(7),i=n(17),l=n(2),a=n(0),s=n(5),d=n(4);class c{static throwErrorWrapper(e,t){(0,a.throwError)(e,"BlockModelAccessor."+t)}static verifyArgumentNotNull(e,t,n){(0,d.verifyArgumentNotNull)(e,t,"BlockModelAccessor."+n)}getColumnWidth(e){return(0,a.getColumnWidth)(e,this.model)}getRowHeight(e){return c.verifyArgumentNotNull(this.model.RowHeights,"RowHeights","getRowHeight"),(e>this.model.RowHeights.length-1||e<0)&&c.throwErrorWrapper("row height requested for a cell which is not in range of the model","getRowHeight"),this.model.RowHeights[e]}getColumnOffset(e){return c.verifyArgumentNotNull(this.model.ColumnOffsets,"ColumnOffsets","getColumnOffset"),(e>this.model.ColumnOffsets.length-1||e<0)&&c.throwErrorWrapper("column offset requested for a cell which is not in range of the model","getColumnOffset"),this.model.ColumnOffsets[e]}getRowOffset(e){return c.verifyArgumentNotNull(this.model.RowOffsets,"RowOffsets","getRowOffset"),(e>this.model.RowOffsets.length-1||e<0)&&c.throwErrorWrapper("row offset requested for a cell which is not in range of the model","getRowOffset"),this.model.RowOffsets[e]}getRowNumber(e){return c.verifyArgumentNotNull(this.model.RowNumbers,"RowNumbers","getRowNumber"),this.model.RowNumbers[e]}getColumnNumber(e){return c.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getColumnNumber"),this.model.ColumnNumbers[e]}getColumnOffsets(){var e;return null===(e=this.model.ColumnOffsets)||void 0===e?void 0:e.slice()}setColumnOffsets(e){c.verifyArgumentNotNull(e,"newOffsets","setColumnOffsets"),this.model.ColumnOffsets=e,this.setDirty("setColumnOffsets",o.DirtyType.ModelCoreChanges)}getColumnNumbers(){var e;return null===(e=this.model.ColumnNumbers)||void 0===e?void 0:e.slice()}setColumnNumbers(e){c.verifyArgumentNotNull(e,"newNumbers","setColumnNumbers"),this.model.ColumnNumbers=e,this.setDirty("setColumnNumbers",o.DirtyType.ModelCoreChanges)}getColumnWidths(){var e;return null===(e=this.model.ColumnWidths)||void 0===e?void 0:e.slice()}setColumnWidths(e){c.verifyArgumentNotNull(e,"newWidths","setColumnWidths"),this.model.ColumnWidths=e,this.setDirty("setColumnWidths",o.DirtyType.ModelCoreChanges)}setIsColumnWidthFixed(e,t){this.model.FixedColumns&&((e<0||e>=this.model.FixedColumns.length)&&c.throwErrorWrapper(`columnIndex ${e} is out of bounds!`,"setIsColumnWidthFixed"),this.model.FixedColumns[e]=t)}getRowOffsets(){var e;return null===(e=this.model.RowOffsets)||void 0===e?void 0:e.slice()}setRowOffsets(e){c.verifyArgumentNotNull(e,"newOffsets","setRowOffsets"),this.model.RowOffsets=e,this.setDirty("setRowOffsets",o.DirtyType.ModelCoreChanges)}getRowNumbers(){var e;return null===(e=this.model.RowNumbers)||void 0===e?void 0:e.slice()}setRowNumbers(e){c.verifyArgumentNotNull(e,"newNumbers","setRowNumbers"),this.model.RowNumbers=e,this.setDirty("setRowNumbers",o.DirtyType.ModelCoreChanges)}getRowHeights(){var e;return null===(e=this.model.RowHeights)||void 0===e?void 0:e.slice()}setRowHeights(e){c.verifyArgumentNotNull(e,"newHeights","setRowHeights"),this.model.RowHeights=e,this.setDirty("setRowHeights",o.DirtyType.ModelCoreChanges)}getBlockWidth(){return this.model.BlockWidth}setBlockWidth(e){this.model.BlockWidth=e,this.setDirty("setBlockWidth",o.DirtyType.ModelCoreChanges)}getBlockHeight(){return this.model.BlockHeight}setBlockHeight(e){this.model.BlockHeight=e,this.setDirty("setBlockHeight",o.DirtyType.ModelCoreChanges)}isDirty(){var e,t;return null!==(e=null===(t=this.model.ClientOnlyCache)||void 0===t?void 0:t.IsDirty)&&void 0!==e&&e}isDirtyDueToViewportChangeOnly(){var e;return!(null===(e=this.model.ClientOnlyCache)||void 0===e||!e.DirtyType)&&this.model.ClientOnlyCache.DirtyType===o.DirtyType.ViewportChange}setDirty(e,t){c.verifyArgumentNotNull(t,"dirtyType","setDirty"),this.setDirtyInternal(t),r.ULS.sendTraceTag(529278243,r.LogCategory.msoulscat_ES_EWAJSGrid,r.TraceLevel.Info,"BlockModelAccessor::setDirty called, caller "+e),(0,o.getModelClientCache)(this.model).DisableDiffRendering=!0}onRenderingCompleted(){const e=(0,o.getModelClientCache)(this.model);e.DirtyCellsKeys=void 0,e.DisableDiffRendering=!1,e.IsDirty=!1,e.DirtyTimestamp=void 0,e.DirtyType=o.DirtyType.None,e.delayRenderingToNextAnimationFrame=o.DelayRenderToNextAnimationFrameState.None}getColumnIndex(e){return c.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getColumnIndex"),(0,a.binarySearch)(this.model.ColumnNumbers,0,this.model.ColumnNumbers.length,e,a.numbersComparer)}getRowIndex(e){return(0,a.getModelRowIndex)(this.model,e)}getHasTable(){return!!this.model.HasTable}getHasOutline(){return!!this.model.HasOutline}getIsEmptyBlocksSupported(){return Boolean(this.model.IsEmptyBlocksSupported)}getEmptyBlocksFallbackReasons(){var e;return null!==(e=this.model.EmptyBlocksFallbackReasonBitFlag)&&void 0!==e?e:0}getDirtyTimestamp(){var e,t;return null!==(e=null===(t=this.model.ClientOnlyCache)||void 0===t?void 0:t.DirtyTimestamp)&&void 0!==e?e:-1}getMaxRowOutlineLevelInSheet(){var e;return null!==(e=this.model.MaxRowOutlineLevelInSheet)&&void 0!==e?e:0}getMaxColOutlineLevelInSheet(){var e;return null!==(e=this.model.MaxColOutlineLevelInSheet)&&void 0!==e?e:0}resetCellLookup(){(0,o.getModelClientCache)(this.model).CellLookup=(0,o.initCellLookup)(this.model)}setCellsDirty(e){if(!e)return;this.ensureDirtyCellsKeysInitialized();const t=(0,o.getModelClientCache)(this.model);t.DirtyCellsKeys=t.DirtyCellsKeys.concat(e),this.setDirtyInternal(o.DirtyType.ModelCellChanges)}getDirtyCellsCount(){var e;return null!==(e=this.model.ClientOnlyCache)&&void 0!==e&&e.DirtyCellsKeys?this.model.ClientOnlyCache.DirtyCellsKeys.filter(o.uniqueValuesFilter).length:0}getDirtyCellsKeys(){var e;return null!==(e=this.model.ClientOnlyCache)&&void 0!==e&&e.DirtyCellsKeys?this.model.ClientOnlyCache.DirtyCellsKeys:[]}isDifferentialRenderingSupported(){const e=(0,o.isDifferentialRenderingSupported)(this.model),t=(0,o.getModelClientCache)(this.model),n=this.getDirtyCellsCount();return r.ULS.sendTraceTag(512267551,r.LogCategory.msoulscat_ES_EWAJSGrid,r.TraceLevel.Info,`BlockModelAccessor::isDifferentialRenderingSupported result: ${e}, isDisabled: ${t.DisableDiffRendering}, isDirty: ${t.IsDirty}, dirtyCellsCount: ${n}, delayToNextAnimationFrame: ${t.delayRenderingToNextAnimationFrame}`),e}isRenderFlagEnabled(e){return(0,o.isRenderFlagEnabled)(e,this.model)}overrideHeaderDragImprovementsRenderFlag(e){(0,o.overrideRenderFlagForMismatch)(this.model,o.RenderFlagsArray.HeaderDragImprovements,e)}overrideInCellControlCheckboxRenderFlag(e){(0,o.overrideRenderFlagForMismatch)(this.model,o.RenderFlagsArray.InCellControls,e)}isDelayRenderingToNextFrame(){return(0,o.getModelClientCache)(this.model).delayRenderingToNextAnimationFrame===o.DelayRenderToNextAnimationFrameState.Delay}delayRenderingToNextAnimationFrame(){const e=(0,o.getModelClientCache)(this.model);e.delayRenderingToNextAnimationFrame!==o.DelayRenderToNextAnimationFrameState.DoNotDelay&&(e.delayRenderingToNextAnimationFrame=o.DelayRenderToNextAnimationFrameState.Delay)}doNotDelayRenderingToNextAnimationFrame(){(0,o.getModelClientCache)(this.model).delayRenderingToNextAnimationFrame=o.DelayRenderToNextAnimationFrameState.DoNotDelay}overrideGlobalStylesRenderFlag(e){(0,o.overrideRenderFlagForMismatch)(this.model,o.RenderFlagsArray.GlobalStylesSlice1,e),(0,o.overrideRenderFlagForMismatch)(this.model,o.RenderFlagsArray.GlobalStylesSlice2,e),(0,o.overrideRenderFlagForMismatch)(this.model,o.RenderFlagsArray.GlobalStylesSlice3,e)}setDirtyInternal(e,t=!1){const n=(0,o.getModelClientCache)(this.model);n.IsDirty||(n.DirtyTimestamp=Date.now()),n.IsDirty=!0,n.DirtyType|=e,(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.DelayRenderToNextAnimationFrame,this.model)&&!t&&this.doNotDelayRenderingToNextAnimationFrame()}getOrCreateCanvasContext(){this.canvasInstance||(this.canvasInstance=document.createElement("canvas"));const e=this.canvasInstance.getContext("2d");if(!e)throw Error("GetOrCreateCanvasContext: ctx is undefined");return e}getAutoFilterMenuOffsetsFromCellStartInternal(e,t,n){const o=t*n;this.ensureCachedObjectsInitialized(this.model,e,o),(0,l.isAdjustedForDrawingOffsetsInitialized)(this.model)||(0,l.initializeOffsetsForDrawing)(this.model,o);const r=!this.model.IsRtl,a=(0,s.getCellLeftAdjustedForDrawing)(this.model,e,!1,r),d=(0,s.getCellTopAdjustedForDrawing)(this.model,e,!0),c=(0,i.getFilterSizeAdjustedForDrawing)(this.model,e,n,t),u=(0,i.getFilterLeftAdjustedForDrawing)(this.model,e,c,n,t)-a,g=(0,i.getFilterBottomAdjustedForDrawing)(this.model,e,c,n,t)-d;return{x:Math.round(u/o),y:Math.round(g/o)}}getAutoFilterButtonTotalSizeInternal(e,t,n){const o=t*n;this.ensureCachedObjectsInitialized(this.model,e,o),(0,l.isAdjustedForDrawingOffsetsInitialized)(this.model)||(0,l.initializeOffsetsForDrawing)(this.model,o);const r=(0,i.getFilterSizeAdjustedForDrawing)(this.model,e,n,t),a=(0,l.getDefaultBorderLineWidth)(o);return Math.round((r+a)/o)}ensureCachedObjectsInitialized(e,t,n){var o,r,i;c.verifyArgumentNotNull(e,"model","ensureCachedObjectsInitialized"),c.verifyArgumentNotNull(t,"cell","ensureCachedObjectsInitialized"),(0,l.isAdjustedForDrawingOffsetsInitialized)(this.model)||(0,l.initializeOffsetsForDrawing)(this.model,n),t.CachedStyle&&t.CachedBorderStyle&&t.CachedFont&&t.CachedIndent&&null!==(o=t.CachedDrawingLayout)&&void 0!==o&&o.UnderlineRuns&&null!==(r=t.CachedDrawingLayout)&&void 0!==r&&r.StrikethroughRuns&&null!==(i=t.CachedDrawingLayout)&&void 0!==i&&i.CellTextLayout||(0,a.initializeCellCachedObjects)(e,t,!0);const s=t.Merge;!s||s.HeightAdjustedForDrawing&&s.OriginDeltaXAdjustedForDrawing&&s.WidthAdjustedForDrawing&&s.OriginDeltaYAdjustedForDrawing||(0,a.updateCellMergeInformation)(e,t,n)}ensureDirtyCellsKeysInitialized(){const e=(0,o.getModelClientCache)(this.model);return e.DirtyCellsKeys||(e.DirtyCellsKeys=[]),e.DirtyCellsKeys}constructor(e){this.canvasInstance=null,c.verifyArgumentNotNull(e,"model","constructor"),this.model=e}}t.BlockModelAccessor=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInsertButtonSize=t.setCellsDirtyForInsertButtonSpill=t.getHeaderInsertButtonHitRegions=void 0;const o=n(1),r=n(99);function i(e,t){if(!e)return 0;const n=e.Offset*(t?1:-1);return e.Type===o.InsertButtonType.InsertButton?r.InsertButtonRadius+r.InsertButtonStrokeWidth+n:e.Type===o.InsertButtonType.InsertDot?r.InsertDotRadius+r.InsertButtonStrokeWidth+n:0}t.getHeaderInsertButtonHitRegions=function(e,t,n,o,r,i){let l,a;const{startHitRegionSize:s,endHitRegionSize:d}=function(e,t,n,o){const r=e?t.height:t.width;if(r<n+o){const e=r/2;return{startHitRegionSize:e,endHitRegionSize:e}}return{startHitRegionSize:n,endHitRegionSize:o}}(t,e,r,i);if(t){const t=n?e.x+e.width-o:e.x;l={x:t,y:e.y,width:o,height:s},a={x:t,y:e.y+e.height-d,width:o,height:d}}else n?(l={x:e.x+e.width-s,y:e.y,width:s,height:o},a={x:e.x,y:e.y,width:d,height:o}):(l={x:e.x,y:e.y,width:s,height:o},a={x:e.x+e.width-d,y:e.y,width:d,height:o});return{cellStartHitRegion:l,cellEndHitRegion:a}},t.setCellsDirtyForInsertButtonSpill=function(e,t,n,o,l,a){let s=l-t.getCellExtent(n),d=0;const c=r.InsertButtonRadius+r.InsertButtonStrokeWidth,u=e.IsRow?e.RowNumbers.length:e.ColumnNumbers.length;let g=n;for(;s>0||d<c;){var h,C;if(o?++g:--g,g<0||g>=u)break;const n=e.Cells[g],r=t.getCellExtent(g);s>0&&(a(g),s-=r),d+=r,(o?i(null===(h=n.InsertButtons)||void 0===h?void 0:h.End,!1):i(null===(C=n.InsertButtons)||void 0===C?void 0:C.Start,!0))>d&&a(g)}},t.getInsertButtonSize=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MinRowHeightToAccomadateResizePillAnd1pxSelectionArea=t.MinRowHeightToAccomadateResizePillAndMinSelectionArea=t.MinRowHeightToAllocateMaxResizeArea=t.MinColWidthToAccomadateResizePillAnd1pxSelectionArea=t.MinColWidthToAccomadateResizePillAndMinSelectionArea=t.MinColWidthToAllocateMaxResizeArea=t.CellPercentageAllocatedToResize=t.MinCellPixelsAllocatedForCellSelection=t.MaxCellPixelsAllocatedToRowResizeZone=t.MaxCellPixelsAllocatedToColumnResizeZone=t.DefaultSpaceFromRowHeaderRightBorderPx=t.ResizePillBorderRadius=t.DefaultColResizePillHeightPx=t.DefaultColResizePillWidthPx=t.DefaultRowResizePillHeightPx=t.DefaultRowResizePillWidthPx=void 0,t.DefaultRowResizePillWidthPx=20,t.DefaultRowResizePillHeightPx=3,t.DefaultColResizePillWidthPx=5,t.DefaultColResizePillHeightPx=16,t.ResizePillBorderRadius=90,t.DefaultSpaceFromRowHeaderRightBorderPx=2,t.MaxCellPixelsAllocatedToColumnResizeZone=5.5,t.MaxCellPixelsAllocatedToRowResizeZone=3.5,t.MinCellPixelsAllocatedForCellSelection=5,t.CellPercentageAllocatedToResize=.25,t.MinColWidthToAllocateMaxResizeArea=2*t.MaxCellPixelsAllocatedToColumnResizeZone+t.MinCellPixelsAllocatedForCellSelection,t.MinColWidthToAccomadateResizePillAndMinSelectionArea=t.DefaultColResizePillWidthPx+t.MinCellPixelsAllocatedForCellSelection,t.MinColWidthToAccomadateResizePillAnd1pxSelectionArea=t.DefaultColResizePillWidthPx+1,t.MinRowHeightToAllocateMaxResizeArea=2*t.MaxCellPixelsAllocatedToRowResizeZone+t.MinCellPixelsAllocatedForCellSelection,t.MinRowHeightToAccomadateResizePillAndMinSelectionArea=t.DefaultRowResizePillHeightPx+t.MinCellPixelsAllocatedForCellSelection,t.MinRowHeightToAccomadateResizePillAnd1pxSelectionArea=t.DefaultRowResizePillHeightPx+1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OutlinesStartSizePx=t.OutlinesPaddingPx=t.OutlinesLevelHeightWidthPx=t.ExpandCollapseButtonSizePx=void 0,t.ExpandCollapseButtonSizePx=10,t.OutlinesLevelHeightWidthPx=12,t.OutlinesPaddingPx=6,t.OutlinesStartSizePx=4},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHeaderDragSquareHitRegionRectInfo=t.getHeaderDragSquareRegionRectInfo=void 0;const o=n(137),r=n(5),i=n(38),l=n(78);function a(e,t,n,o){const i=e.IsRow?(0,r.getCellCenterYAdjustedForDrawing)(e,t):(0,r.getCellCenterXAdjustedForDrawing)(e,t,e.IsRtl);return Math.round(i-n/2-o-n)}function s(e,t,n){return e*t+(e-1)*n}t.getHeaderDragSquareRegionRectInfo=function(e,t,n,l,d){const c=a(e,t,l,d),u=Math.round((e.IsRow?(0,r.getCellLeftAdjustedForDrawing)(e,t,e.IsRtl,!1):(0,r.getCellTopAdjustedForDrawing)(e,t,!1))+(0,i.getDimensionAdjustedForDrawing)(e.IsRow?o.RowHeaderDragSquarePadding:o.ColumnHeaderDragSquarePadding,n)),g=s(o.DragSquareNumberOfDotsInLongEdge,l,d),h=s(o.DragSquareNumberOfDotsInShortEdge,l,d);return e.IsRow?{x:u,y:c,width:h,height:g}:{x:c,y:u,width:g,height:h}},t.getHeaderDragSquareHitRegionRectInfo=function(e,t,n){const d=(0,i.getDimensionAdjustedForDrawing)(o.DragSquareDimension,n),c=(0,i.getDimensionAdjustedForDrawing)(o.DragSquareGap,n),u=s(o.DragSquareNumberOfDotsInLongEdge,d,c),g=e.IsRow?(0,r.getCellHeightAdjustedForDrawing)(e,t):(0,r.getCellWidthAdjustedForDrawing)(e,t);if(g<=u)return;const h=a(e,t,d,c);if(e.IsRow){const a=(0,r.getCellLeftAdjustedForDrawing)(e,t,e.IsRtl,!1),s=(0,i.getDimensionAdjustedForDrawing)(l.RowHeaderDragAndInsertHitRegionWidth,n),d=(0,i.getDimensionAdjustedForDrawing)(o.RowHeaderDragHitRegionVerticalPadding,n),c=u+2*d;return c<g?{x:a,y:h-d,width:s,height:c}:{x:a,y:(0,r.getCellTopAdjustedForDrawing)(e,t,!1),width:s,height:g}}{const l=(0,r.getCellTopAdjustedForDrawing)(e,t,!1),a=(0,i.getDimensionAdjustedForDrawing)(o.ColumnHeaderDragHitRegionHeight,n),s=(0,i.getDimensionAdjustedForDrawing)(o.ColumnHeaderDragHitRegionHorizontalPadding,n),d=u+2*s;return d<g?{x:h-s,y:l,width:d,height:a}:{x:(0,r.getCellLeftAdjustedForDrawing)(e,t,e.IsRtl,!1),y:l,width:g,height:a}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColumnHeaderDragHitRegionHeight=t.ColumnHeaderDragHitRegionHorizontalPadding=t.RowHeaderDragHitRegionVerticalPadding=t.ColumnHeaderDragSquarePadding=t.RowHeaderDragSquarePadding=t.DragSquareNumberOfDotsInShortEdge=t.DragSquareNumberOfDotsInLongEdge=t.DragSquareGap=t.DragSquareDimension=void 0,t.DragSquareDimension=2,t.DragSquareGap=2,t.DragSquareNumberOfDotsInLongEdge=3,t.DragSquareNumberOfDotsInShortEdge=2,t.RowHeaderDragSquarePadding=6,t.ColumnHeaderDragSquarePadding=1,t.RowHeaderDragHitRegionVerticalPadding=2,t.ColumnHeaderDragHitRegionHorizontalPadding=5,t.ColumnHeaderDragHitRegionHeight=11},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerCollector=t.initPassiveTelemetryManager=void 0;const o=n(10),r=n(79),i=n(236),l=n(7),a=[];let s,d,c,u={},g=(0,r.getCurrentTimeInMs)(),h=!1;function C(){const e=(0,r.getCurrentTimeInMs)();for(;(0,r.getCurrentTimeInMs)()-e<s&&a.length>0&&!(navigator.scheduling&&navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending());){const e=Math.floor(Math.random()*a.length),t=a[e],n=(0,r.getCurrentTimeInMs)();if(t.canCollectorExecute())try{const e=t.collect();e.isValid&&u[t.getCollectorName()].push(e.value);const o=(0,r.getCurrentTimeInMs)()-n;o>s&&(l.ULS.sendTraceTag(572602177,l.LogCategory.msoulscat_ES_EWAJSGrid,l.TraceLevel.Info,`Name: ${t.getCollectorName()} is disabled because it exceeded execution threshold.\n            Threshold: ${s}, TimeTaken: ${o}`),t.disable())}catch(e){l.ULS.sendTraceTag(572602178,l.LogCategory.msoulscat_ES_EWAJSGrid,l.TraceLevel.Info,`Name: ${t.getCollectorName()}, Exception encountered in collector, Collector will be disabled. Exception - ${e}`),t.disable()}a.splice(e,1)}a.length<1&&c.stopTracking(),(0,r.getCurrentTimeInMs)()-g>d&&setTimeout(f,0)}function f(){if(u){const e=Object.keys(u);for(let t=0;t<e.length;t++){const n=e[t],o=u[n];o&&o.length>0&&l.ULS.sendTraceTag(572602179,l.LogCategory.msoulscat_ES_EWAJSGrid,l.TraceLevel.Info,JSON.stringify({Name:n,Results:o}))}}u={},g=(0,r.getCurrentTimeInMs)()}t.initPassiveTelemetryManager=function(){if(!h){s=(0,o.getServiceSetting)(3,25),d=(0,o.getServiceSetting)(5,6e4);const e=(0,o.getServiceSetting)(4,1e4),t=()=>{window.requestIdleCallback?window.requestIdleCallback(C):setTimeout(C,0)};c=new i.IdleTracker({onReportUserIsIdle:t},e),a.length>0&&c.startTrackingIfApplicable(),h=!0}},t.registerCollector=function(e){a.length<100&&a.push(e);const t=e.getCollectorName();u[t]||(u[t]=[]),h&&c.startTrackingIfApplicable()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.doesMergedCellOverlapMultipleRowCol=t.updatePrintAreasOfBlockPair=t.updatePageBreaksOfBlockPair=t.isCellInLastCascadedCol=t.getAdjacentCell=t.getBottomBorder=t.getRightBorder=t.removeExtraModelRowsColumns=t.cellHasBorderAtPosition=t.canCellsOfMultipleRowColHideOrCascade=t.canCellsOfRowColHideOrCascade=t.addRightBorderToNewBlockEdgeCell=t.addBottomBorderToNewBlockEdgeCell=t.modelReverseCascadeRowCols=t.modelCascadeMultipleRowCols=t.modelCascadeRowCols=t.modelCascadeRowColsOperations=t.modelCascade=t.hideMultipleRowsColumns=t.hideDeleteRowsColumns=t.modelRowColOperations=t.hideRowsColumns=t.GridInstantaneousOperation=t.isHideColumnMergedCellFlightEnabled=t.maxColumnCount=t.maxRowCount=void 0;const o=n(1),r=n(0),i=n(6),l=n(7),a=n(100),s=n(77),d=n(140),c=n(249);t.maxRowCount=28,t.maxColumnCount=30;let u=0,g=!1;const h=(0,o.isChangeGateEnabled)(o.ChangeGate.MergeCellBorderScenarios),C=(0,o.isChangeGateEnabled)(o.ChangeGate.MungedBorderBugFixes),f=(0,o.isChangeGateEnabled)(o.ChangeGate.HideDeleteCSEBlockEdgeBorderFix);let m=new Map,p=new Map;function y(e){return(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.HideColumnMergedCellSlice1,e)&&(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.HideColumnSlice1,e)}var S;function R(e,t,n,o,r,i=!1){const l=r===S.Hide||r===S.FreezePane,a=o?e.RowNumbers:e.ColumnNumbers,s=k(a,t),u=te(a,n,s);if(-1===u[0])return!1;if(_(e.Cells))return q(e,u,o,l),!0;const g=[],C=u[u.length-1],f=Te(e,o),m=Ie(e,o);for(let t=0;t<e.Cells.length;t++){const i=e.Cells[t];var p,y;pe(e,i,s,n,o,r,f,m),ee(i,u,o)||P(i,s,n,o)?i.Merge&&(ne(i,s,n,o)?!h||s!==i.Col&&s!==i.Row||(0,d.removeBorderFromMergeCellAdjacentCells)(i,e,o):(!l&&le(i,s,n,o,e)&&(i.Text=void 0),oe(i,s,n,o,l,e),o?i.Row>s&&(i.Row=s):i.Col>s&&(i.Col=s),g.push(i))):(i.Merge&&!l&&(o?null!==(p=i.Merge)&&void 0!==p&&p.OriginRow&&0!==i.Merge.OriginRow&&(i.Merge.OriginRow-=n+1):null!==(y=i.Merge)&&void 0!==y&&y.OriginColumn&&0!==i.Merge.OriginColumn&&(i.Merge.OriginColumn-=n+1)),o?i.Row>C&&(i.Row-=n+1):i.Col>C&&(i.Col-=n+1),g.push(i))}return(0,c.isFreezePaneCseSlice1Enabled)()&&r===S.FreezePane&&s>0&&(0,c.addEdgeBordersToFreezePaneBlocks)(e,o,s),q(e,u,o,l),e.Cells=[],de(e,g),i&&ye(e,o),!0}function F(e,t,n,l,s,u,g){const C={};try{const m=(0,o.isGlobalBorderStylesEnabled)(e),p=(0,o.isGlobalFontsAndCellStylesFlightEnabled)(e),y=performance.now(),S=s?e.RowNumbers:e.ColumnNumbers,R=k(S,n),F=te(S,l,R),T=(0,c.isFreezePaneCseSlice1Enabled)()&&!!g;if(-1===F[0])return{isSuccess:!1,exception:"Incorrect rowColIndex found"};if(T){if(_(e.Cells)&&(null==g||!g.performDiagonalCascading))return C.timeTaken=performance.now()-y,N(e,t,F,u,s),{isSuccess:!0,metric:C}}else if(_(e.Cells))return C.timeTaken=performance.now()-y,N(e,t,F,u,s),me(t,s),ye(t,s),{isSuccess:!0,metric:C};const w=[],I=[],b=[],P=new Map,M=[],H=new Map,O=[],L=new Map,E=new Map,z=t.Styles.length,W=t.Fonts.length,G=t.BorderStyles.length,V=l+1,j=s?t.RowOffsets.length:t.ColumnOffsets.length;e.ClientOnlyCache=void 0,t.ClientOnlyCache=void 0;let U=!1,q=!1,$=!1,Y=!1,X=!1,K=!1;(0,o.preprocessModelStyles)(e),(0,o.preprocessModelStyles)(t);for(let n=0;n<e.Cells.length;n++){const C=e.Cells[n];let f=!1;const y=s?C.Row:C.Col,S=s?C.Col:C.Row;if(T&&Ce(C,s,g)){I.push(C);continue}if(!ee(C,F,s)){s?C.Row-=V:C.Col-=V,I.push(C);continue}if(C.Merge)if(ne(C,R,l,s))C.Merge.SpansBlocks?(0,d.cascadeMergeCellSpanningBlocksFully)(e,t,C,l,I,O,m,s):K=!0;else{const n=(0,a.duplicateCell)(C);if(n.Merge.SpansBlocks&&d.isHideColMergedCellAcrossBlocksEnabled?((0,d.updateSrcModelMergeCellSpanningBlocks)(n,e,t,R,l,s),h||0!==n.Merge.Columns&&0!==n.Merge.Rows||(Y=!0)):ie(n,e,R,l,f,s,u),!h||0!==n.Merge.Columns&&0!==n.Merge.Rows||(Y=!0),C.Merge.SpansBlocks||(f=!0),s?n.Row=0:n.Col=0,h&&n.Merge){const t=s?o.BorderPositionType.Top:o.BorderPositionType.Left;(0,r.removeBorderFromCell)(n,e,t)}I.push(n)}if(C.Merge)if(f)ie(C,e,R,l,f,s,u),!h||0!==C.Merge.Columns&&0!==C.Merge.Rows||(X=!0);else if(C.Merge.SpansBlocks&&!f)continue;const B=s?C.Row:C.Col;s?C.Row=j+B:C.Col=j+B,T&&fe(C,t,l,s,g),w.push(C);const k=C.StyleID||0;let N=!1,_=!1;if(N=!p||(0,i.isNullOrUndefined)(C.GlobalCellStyleID),!P.has(k)&&k!==o.UniqueStyleID.Default&&k!==o.UniqueStyleID.Hyperlink){const t=(0,o.getReferencedObjectById)(k,e.Styles);_=!p||(0,i.isNullOrUndefined)(t.GlobalFontID);const n=t.FontID||0;if(_&&!H.has(n)){const t=W+H.size;H.set(n,t);const i=(0,o.getReferencedObjectById)(n,e.Fonts),l=(0,r.duplicateFont)(i,t,1);M.push(l),$=!0}if(N){const e=z-r.NumberOfUniqueStyleIDs+b.length;P.set(k,e);const o=(0,r.duplicateOnlyStyleWithoutFont)(t,e,1);o.FontID=H.get(n),b.push(o),q=!0}}const J=C.BorderStyleID||0,Z=!m||(0,i.isNullOrUndefined)(C.GlobalBorderStyleID);if(Z&&!L.has(J)&&J!==o.UniqueStyleID.DefaultBorder){const t=G+O.length;L.set(J,t);const n=(0,r.duplicateBorderStyle)((0,o.getReferencedObjectById)(J,e.BorderStyles),t,1);O.push(n),U=!0}const Q=C.BorderStyleID||0;if(N&&(C.StyleID=k===o.UniqueStyleID.Default?o.UniqueStyleID.Default:P.get(k)),Z&&(C.BorderStyleID=J===o.UniqueStyleID.DefaultBorder?o.UniqueStyleID.DefaultBorder:L.get(J)),T){const t=(0,c.addEdgeCellsBordersForCascadedCells)(C,e,G,O,Z,L,E,F,B,s,g,S,y);U=U||t}else if(!C.Merge&&A(B,F[F.length-1])){let t=!1,n={},i={};if(s?(n=x(C,e,B,s),t=0!==Object.keys(n).length):(i=v(C,e,B,s),t=0!==Object.keys(i).length),t){const t=C.BorderStyleID||0,l=G+O.length,a=D(C,e.Cells,B,s).BorderStyleID||0;if(Z&&L.get(t)&&E.get(a))C.BorderStyleID=L.get(t),m&&(C.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID((0,o.getReferencedObjectById)(Q,e.BorderStyles)));else{Z&&(L.set(t,l),E.set(a,G+E.size));const d=(0,r.duplicateBorderStyle)((0,o.getReferencedObjectById)(Q,e.BorderStyles),l,1);if(s){const e=d.Borders;let t=e.length;for(let o=0;o<e.length;o++)e[o].BorderPosition<n.BorderPosition&&(t=o+1);d.Borders.splice(t,0,n)}else d.Borders.push(i);O.push(d),C.BorderStyleID=l,m&&(C.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID(d)),U=!0}}}}U&&t.BorderStyles.push(...O),T&&(!T||null!=g&&g.performDiagonalCascading)||(B(t,j,s),N(e,t,F,u,s));for(const n of w){const i=(0,r.getCellPositionInArray)(n,t.Cells);if(f&&(s?n.Row+l===t.RowNumbers.length-1:n.Col+l===t.ColumnNumbers.length-1)&&_e(t,n,s),t.Cells.splice(i,0,n),n.Merge){if((0,d.addRightOrBottomBorderToAdjacentCells)(n,t,s),!K){(0,r.removeBorderFromCell)(n,t,o.BorderPositionType.Right);continue}if(s?n.Merge.Rows===l:n.Merge.Columns===l){const o=(0,d.getAdjacentEdgeCellsWithNewLeftOrTopBorder)(n,e,t,s);for(const e of o)I.push(e)}}}if(q)for(const e of b)t.Styles.splice(e.ID||0,0,e);if($&&t.Fonts.push(...M),T&&null!=g&&g.performDiagonalCascading||me(t,s),d.isHideColMergedCellAcrossBlocksEnabled){const t=[];for(const e of I){const n=(0,r.getCellPositionInArray)(e,t);t.splice(n,0,e)}e.Cells=t}else e.Cells=I;Y&&(0,d.changeBorderForMergedCellSpanningBlocks)(e,I,s),h&&X&&(0,d.changeBorderForMergedCellSpanningBlocks)(t,w,s,X),ye(t,s),C.countOfStylesMoved=P.size,C.countOfFontsMoved=H.size,C.countOfBorderStylesMoved=L.size,C.timeTaken=performance.now()-y}catch(e){return{isSuccess:!1,exception:e,metric:C}}return{isSuccess:!0,metric:C}}function T(e,t,n,i,l){const s={};try{const c=performance.now(),u=l?e.RowNumbers:e.ColumnNumbers,g=k(u,n),h=te(u,i,g);if(-1===h[0])return{isSuccess:!1,exception:"Incorrect rowColIndex found"};if(_(e.Cells)&&_(t.Cells))return s.timeTaken=performance.now()-c,l?z(e,t,h):E(e,t,h),me(t,l),ye(e,l),{isSuccess:!0,metric:s};const C=[],f=[],m=[],p=e.ColumnNumbers.length,y=e.RowNumbers.length,S=i+1;e.ClientOnlyCache=void 0,t.ClientOnlyCache=void 0,(0,o.preprocessModelStyles)(e),(0,o.preprocessModelStyles)(t);for(let e=0;e<t.Cells.length;e++){const n=t.Cells[e];l?n.Row+=S:n.Col+=S}for(let t=0;t<e.Cells.length;t++){const n=e.Cells[t];let o=!1,r={};if(!ee(n,h,l)&&!P(n,g,i,l))continue;n.Merge&&(ne(n,g,i,l)||(r=(0,a.duplicateCell)(n),he(n,e,i,o,l),o=!0)),n.Merge&&o&&0!==Object.keys(r).length&&he(r,e,i,o,l),o||C.push(n);const s=l?n.Row:n.Col;let d;d=o?r:(0,a.duplicateCell)(n),l?d.Merge&&o?d.Row=0:d.Row=s+S-y:d.Merge&&o?d.Col=0:d.Col=s+S-p,m.push(d)}l?z(e,t,h):E(e,t,h),ce(e,C),de(e,f),de(t,m),me(t,l),function(e,t,n,i){(function(e,t,n){const i=e.Cells.filter(e=>n?e.Row===t:e.Col===t);for(let t=0;t<i.length;t++){const l=i[t];if(n){if((0,d.getBorderAtPosition)(l,e,o.BorderPositionType.Bottom)){const t=(0,r.duplicateBorderStyle)((0,o.getBorderStyleByID)(l,e),e.BorderStyles.length,1),n=t.Borders.findIndex(e=>e.BorderPosition===o.BorderPositionType.Bottom);-1!==n&&t.Borders.splice(n,1),l.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID(t),e.BorderStyles.push(t),l.BorderStyleID=t.ID}}else if((0,d.getBorderAtPosition)(l,e,o.BorderPositionType.Right)){const t=(0,r.duplicateBorderStyle)((0,o.getBorderStyleByID)(l,e),e.BorderStyles.length,1),n=t.Borders.findIndex(e=>e.BorderPosition===o.BorderPositionType.Right);-1!==n&&t.Borders.splice(n,1),l.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID(t),e.BorderStyles.push(t),l.BorderStyleID=t.ID}}})(t,n,i),function(e,t,n){const o=n?e.RowNumbers.length-1:e.ColumnNumbers.length-1,r=e.Cells.filter(e=>n?e.Row===o:e.Col===o),i=t.Cells.filter(e=>n?0===e.Row:0===e.Col);let l=0,a=0;for(;a<i.length;){const o=l<r.length?r[l]:null,s=i[a];n?o?o.Col===s.Col?(w(o,s,e,t),l++,a++):o.Col<s.Col?l++:(w(o,s,e,t),a++):(w(o,s,e,t),a++):o?o.Row===s.Row?(I(o,s,e,t),l++,a++):o.Row<s.Row?l++:(I(o,s,e,t),a++):(I(o,s,e,t),a++)}}(e,t,i)}(e,t,i,l),ye(e,l),s.countOfStylesMoved=0,s.countOfFontsMoved=0,s.countOfBorderStylesMoved=0,s.timeTaken=performance.now()-c}catch(e){return{isSuccess:!1,exception:e,metric:s}}return{isSuccess:!0,metric:s}}function w(e,t,n,i,l){const a=(0,d.getBorderAtPosition)(t,i,o.BorderPositionType.Top);if(a){e||de(n,[e=(0,o.getOrCreateCell)(n,l||n.RowNumbers.length-1,t.Col)]);const i=(0,r.duplicateBorderStyle)((0,o.getBorderStyleByID)(e,n),n.BorderStyles.length,1),s=(0,d.duplicateBorder)(a);s.BorderPosition=o.BorderPositionType.Bottom;let c=0;for(let e=0;e<i.Borders.length;e++)if(i.Borders[e].BorderPosition>o.BorderPositionType.Bottom){c=1,i.Borders.splice(e,0,s);break}c||i.Borders.push(s),e.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID(i),n.BorderStyles.push(i),e.BorderStyleID=i.ID}}function I(e,t,n,i,l){const a=(0,d.getBorderAtPosition)(t,i,o.BorderPositionType.Left);if(a){e||de(n,[e=(0,o.getOrCreateCell)(n,t.Row,l||n.ColumnNumbers.length-1)]);const i=(0,r.duplicateBorderStyle)((0,o.getBorderStyleByID)(e,n),n.BorderStyles.length,1),s=(0,d.duplicateBorder)(a);s.BorderPosition=o.BorderPositionType.Right,i.Borders.push(s),e.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID(i),n.BorderStyles.push(i),e.BorderStyleID=i.ID}}function b(e,t){for(const n of e.Borders)if(n.BorderPosition===t)return!0;return!1}function v(e,t,n,r,i,l){const a={},s=D(e,t.Cells,n,r,i,l);if(!s)return a;const d=(0,o.getBorderStyleByID)(s,t);for(const e of d.Borders)if(e.BorderPosition===o.BorderPositionType.Left)return a.BorderLineStyle=e.BorderLineStyle,a.BorderPosition=o.BorderPositionType.Right,a.Weight=e.Weight,a.Color=e.Color,a;return a}function x(e,t,n,r,i,l){const a={},s=D(e,t.Cells,n,r,i,l);if(!s)return a;const d=(0,o.getBorderStyleByID)(s,t);for(const e of d.Borders)if(e.BorderPosition===o.BorderPositionType.Top)return a.BorderLineStyle=e.BorderLineStyle,a.BorderPosition=o.BorderPositionType.Bottom,a.Weight=e.Weight,a.Color=e.Color,a;return a}function D(e,t,n,o,r,i){for(const l of t)if(o){if(l.Col===(r?i:e.Col)&&l.Row===n+1)return l}else if(l.Row===(r?i:e.Row)&&l.Col===n+1)return l;return null}function A(e,t){return e===t}function P(e,t,n,o){return!!e.Merge&&(o?V(t,n,e.Row,e.Row+e.Merge.Rows):V(t,n,e.Col,e.Col+e.Merge.Columns))}function M(e,t){return b((0,o.getBorderStyleByID)(e,t),o.BorderPositionType.Left)}function B(e,t,n,i){const l=e.Cells.filter(e=>n?e.Row===t-1:e.Col===t-1);for(const t of l){if(h&&t.Merge)continue;const l=(0,o.isGlobalBorderStylesEnabled)(e),a=e.BorderStyles.length,s=(0,r.duplicateBorderStyle)((0,o.getBorderStyleByID)(t,e),a,1),d=s.Borders.findIndex(e=>i?n?e.BorderPosition===o.BorderPositionType.Right:e.BorderPosition===o.BorderPositionType.Bottom:n?e.BorderPosition===o.BorderPositionType.Bottom:e.BorderPosition===o.BorderPositionType.Right);-1!==d&&(s.Borders.splice(d,1),t.BorderStyleID=a,e.BorderStyles.push(s),l&&(t.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID(s)))}}function H(e,t,n){return!!e.Merge&&(n?O(t,e.Row,e.Row+e.Merge.Rows):O(t,e.Col,e.Col+e.Merge.Columns))}function O(e,t,n){return t<=e&&n>=e}function k(e,t){for(let n=0;n<e.length;n++)if(t===e[n])return n;return-1}function L(e,t,n){var o,r,i,l,a,s,d,c,u,g;Be(t),Be(e),null===(o=t.ColumnNumbers)||void 0===o||o.push(e.ColumnNumbers[n]),null===(r=t.ColMetadata)||void 0===r||r.push(e.ColMetadata[n]),null===(i=t.ColumnWidths)||void 0===i||i.push(e.ColumnWidths[n]),null===(l=t.FixedColumns)||void 0===l||l.push(e.FixedColumns[n]),null===(a=t.ColumnOffsets)||void 0===a||a.push(e.ColumnOffsets[n]),null===(s=e.ColumnNumbers)||void 0===s||s.splice(n,1),null===(d=e.ColMetadata)||void 0===d||d.splice(n,1),null===(c=e.ColumnWidths)||void 0===c||c.splice(n,1),null===(u=e.FixedColumns)||void 0===u||u.splice(n,1),null===(g=e.ColumnOffsets)||void 0===g||g.splice(n,1);let h=0;for(let t=0;t<e.ColumnWidths.length;t++)e.ColumnOffsets[t]=h,h+=e.ColumnWidths[t];e.BlockWidth=h;let C=0;for(let e=0;e<t.ColumnWidths.length;e++)t.ColumnOffsets[e]=C,C+=t.ColumnWidths[e];t.BlockWidth=C}function N(e,t,n,o,r){Be(t),Be(e);const i=n.length;for(const o of n){var l,a,s,d,c,g,h,C,f;r?(null===(l=t.RowNumbers)||void 0===l||l.push(e.RowNumbers[o]),null===(a=t.RowHeights)||void 0===a||a.push(e.RowHeights[o]),null===(s=t.RowOutlinesInformation)||void 0===s||s.push(e.RowOutlinesInformation[o]),null===(d=t.RowOffsets)||void 0===d||d.push(e.RowOffsets[o])):(null===(c=t.ColumnNumbers)||void 0===c||c.push(e.ColumnNumbers[o]),null===(g=t.ColMetadata)||void 0===g||g.push(e.ColMetadata[o]),null===(h=t.ColumnWidths)||void 0===h||h.push(e.ColumnWidths[o]),null===(C=t.FixedColumns)||void 0===C||C.push(e.FixedColumns[o]),null===(f=t.ColumnOffsets)||void 0===f||f.push(e.ColumnOffsets[o]))}const m=n[0];if(r){var p,y,S,R;null===(p=e.RowNumbers)||void 0===p||p.splice(m,i),null===(y=e.RowHeights)||void 0===y||y.splice(m,i),null===(S=e.RowOutlinesInformation)||void 0===S||S.splice(m,i),null===(R=e.RowOffsets)||void 0===R||R.splice(m,i);let n=0;for(let t=0;t<e.RowHeights.length;t++)e.RowOffsets[t]=n,n+=e.RowHeights[t];e.BlockHeight=n;let o=0;for(let e=0;e<t.RowHeights.length;e++)t.RowOffsets[e]=o,o+=t.RowHeights[e];t.BlockHeight=o}else{var F,T,w,I,b;null===(F=e.ColumnNumbers)||void 0===F||F.splice(m,i),null===(T=e.ColMetadata)||void 0===T||T.splice(m,i),null===(w=e.ColumnWidths)||void 0===w||w.splice(m,i),null===(I=e.FixedColumns)||void 0===I||I.splice(m,i),null===(b=e.ColumnOffsets)||void 0===b||b.splice(m,i);let n=0;for(let t=0;t<e.ColumnWidths.length;t++)e.ColumnOffsets[t]=n,n+=e.ColumnWidths[t];e.BlockWidth=n;let o=0;for(let e=0;e<t.ColumnWidths.length;e++)t.ColumnOffsets[e]=o,o+=t.ColumnWidths[e];t.BlockWidth=o}o||(r?(Y(t.RowNumbers,t.RowNumbers.length-i,u),Y(e.RowNumbers,0,u)):(Y(t.ColumnNumbers,t.ColumnNumbers.length-i,u),Y(e.ColumnNumbers,0,u)))}function E(e,t,n){var o,r,i,l,a;Be(t),Be(e);const s=n.length,d=e.ColumnNumbers.length;for(const o of n){var c,u,g,h;const n=o+s-d;null===(c=t.ColumnNumbers)||void 0===c||c.splice(n,0,e.ColumnNumbers[o]),null===(u=t.ColumnWidths)||void 0===u||u.splice(n,0,e.ColumnWidths[o]),null===(g=t.ColMetadata)||void 0===g||g.splice(n,0,e.ColMetadata[o]),null===(h=t.FixedColumns)||void 0===h||h.splice(n,0,e.FixedColumns[o])}const C=n[s-1]+s-d;J(t.ColumnNumbers,C,s),Q(t);const f=n[0];null===(o=e.ColumnNumbers)||void 0===o||o.splice(f,s),null===(r=e.ColMetadata)||void 0===r||r.splice(f,s),null===(i=e.ColumnWidths)||void 0===i||i.splice(f,s),null===(l=e.FixedColumns)||void 0===l||l.splice(f,s),null===(a=e.ColumnOffsets)||void 0===a||a.splice(f,s),Q(e)}function z(e,t,n){var o,r,i,l;const a=n.length,s=e.RowNumbers.length;for(const o of n){var d,c,u;const n=o+a-s;null===(d=t.RowNumbers)||void 0===d||d.splice(n,0,e.RowNumbers[o]),null===(c=t.RowHeights)||void 0===c||c.splice(n,0,e.RowHeights[o]),null===(u=t.RowOutlinesInformation)||void 0===u||u.splice(n,0,e.RowOutlinesInformation[o])}const g=n[a-1]+a-s;J(t.RowNumbers,g,a),Z(t);const h=n[0];null===(o=e.RowNumbers)||void 0===o||o.splice(h,a),null===(r=e.RowHeights)||void 0===r||r.splice(h,a),null===(i=e.RowOffsets)||void 0===i||i.splice(h,a),null===(l=e.RowOutlinesInformation)||void 0===l||l.splice(h,a),Z(e)}function W(e,t,n){return n?e.Row===t:e.Col===t}function G(e,t,n,o){return o?e.Row<=t+n&&e.Row>=t:e.Col<=t+n&&e.Col>=t}function V(e,t,n,o){return n<=e+t&&o>=e}function j(e,t,n,r){let i=!!(t.RichValueFieldsIndexes||t.PivotFilter||t.PivotTable||t.InCellImage||t.Sparkline);const a=(0,c.isFreezePaneCseSlice1Enabled)()?n!==S.Hide&&n!==S.FreezePane:n!==S.Hide;return i=i||a&&!!t.CondFormat,y(e)&&t.Merge?d.isHideColMergedCellAcrossBlocksEnabled?n!==S.Hide&&(i=i||!!t.Merge.SpansBlocks):i=i||!!t.Merge.SpansBlocks:i=i||!!t.Merge,ue(e)||(i=i||!!t.AutoFilter),ge(e)||(i=i||!!t.FormulaInfo),(0,o.isGlobalFontsAndCellStylesFlightEnabled)(e)||(i=i||!!t.TextRuns),i&&function(e,t,n,r){var i;let a="";const s=[];if(t.RichValueFieldsIndexes&&s.push("RichValueFieldsIndexes"),t.PivotFilter&&s.push("PivotFilter"),t.PivotTable&&s.push("PivotTable"),t.InCellImage&&s.push("InCellImage"),t.Sparkline&&s.push("Sparkline"),null!==(i=t.Merge)&&void 0!==i&&i.SpansBlocks&&s.push("MergeCellSpansBlocks"),t.CondFormat&&n!==S.Hide&&s.push("CondFormat"),t.FormulaInfo&&!ge(e)&&s.push("FormulaInfo"),t.Merge&&!y(e)&&s.push("MergeCell"),t.AutoFilter&&!ue(e)&&s.push("AutoFilter"),t.TextRuns&&!(0,o.isGlobalFontsAndCellStylesFlightEnabled)(e)&&s.push("TextRuns"),s.length>0&&(a=s.join(",")),""!==a){let e="";switch(n){case S.Hide:e="Hide";break;case S.Unhide:e="Unhide";break;case S.Insert:e="Insert";break;case S.Delete:e="Delete";break;case S.FreezePane:e="FreezePane"}e=e.concat(r?"Row":"Column"),l.ULS.sendTraceTag(507353300,l.LogCategory.msoulscat_ES_EWAJSGrid,l.TraceLevel.Info,`CSE unattempted due to complex cell  for commandName= ${e},reason= ${a}`)}}(e,t,n,r),i}function _(e){return!e||0===e.length}function U(e,t){var n,o,r,i,l;null===(n=e.ColumnNumbers)||void 0===n||n.splice(t,1),null===(o=e.ColMetadata)||void 0===o||o.splice(t,1),null===(r=e.ColumnWidths)||void 0===r||r.splice(t,1),null===(i=e.FixedColumns)||void 0===i||i.splice(t,1),null===(l=e.ColumnOffsets)||void 0===l||l.splice(t,1);let a=0;for(let t=0;t<e.ColumnWidths.length;t++)e.ColumnOffsets[t]=a,a+=e.ColumnWidths[t];e.BlockWidth=a}function q(e,t,n,o){const r=t[0],i=t.length;if(n){var l,a,s,d;u=$(e,t,n),null===(l=e.RowNumbers)||void 0===l||l.splice(r,i),null===(a=e.RowHeights)||void 0===a||a.splice(r,i),null===(s=e.RowOffsets)||void 0===s||s.splice(r,i),null===(d=e.RowOutlinesInformation)||void 0===d||d.splice(r,i);let c=0;for(let t=0;t<e.RowHeights.length;t++)e.RowOffsets[t]=c,c+=e.RowHeights[t];e.BlockHeight=c,o||Y(e.RowNumbers,r,u)}else{var c,g,h,C,f;u=$(e,t,n),null===(c=e.ColumnNumbers)||void 0===c||c.splice(r,i),null===(g=e.ColMetadata)||void 0===g||g.splice(r,i),null===(h=e.ColumnWidths)||void 0===h||h.splice(r,i),null===(C=e.FixedColumns)||void 0===C||C.splice(r,i),null===(f=e.ColumnOffsets)||void 0===f||f.splice(r,i);let l=0;for(let t=0;t<e.ColumnWidths.length;t++)e.ColumnOffsets[t]=l,l+=e.ColumnWidths[t];e.BlockWidth=l,o||Y(e.ColumnNumbers,r,u)}}function $(e,t,n){const o=t.length;return n?e.RowNumbers[t[o-1]]-e.RowNumbers[t[0]]+1:e.ColumnNumbers[t[o-1]]-e.ColumnNumbers[t[0]]+1}function Y(e,t,n){for(let o=t;o<e.length;o++)e[o]=e[o]-n}function X(e,t){const n=t.length,o=0===t[0],i=t[0]-1;let l,a;var s,d;o||!(0,r.isFixedRows)(e.IsBitwiseFixedRows||0,i)?(l=20,a={}):(l=null===(s=e.RowHeights)||void 0===s?void 0:s[i],a=null===(d=e.RowOutlinesInformation)||void 0===d?void 0:d[i]);for(let n=0;n<t.length;n++){var c,u,g;const o=t[n],r=0===o?1:e.RowNumbers[o-1]+1;null===(c=e.RowNumbers)||void 0===c||c.splice(o,0,r),null===(u=e.RowHeights)||void 0===u||u.splice(o,0,l),null===(g=e.RowOutlinesInformation)||void 0===g||g.splice(o,0,a)}const h=t[n-1];J(e.RowNumbers,h,n),Z(e)}function K(e,t){const n=t.length,o=0===t[0],r=t[0]-1;let i,l,a;var s,d,c;o?(i=64,l={},a=!1):(i=null===(s=e.ColumnWidths)||void 0===s?void 0:s[r],l=null===(d=e.ColMetadata)||void 0===d?void 0:d[r],a=null===(c=e.FixedColumns)||void 0===c?void 0:c[r]);for(let n=0;n<t.length;n++){var u,g,h,C;const o=t[n],r=0===o?1:e.ColumnNumbers[o-1]+1;null===(u=e.ColumnNumbers)||void 0===u||u.splice(o,0,r),null===(g=e.ColumnWidths)||void 0===g||g.splice(o,0,i),null===(h=e.ColMetadata)||void 0===h||h.splice(o,0,l),null===(C=e.FixedColumns)||void 0===C||C.splice(o,0,a)}const f=t[t.length-1];J(e.ColumnNumbers,f,n),Q(e)}function J(e,t,n){for(let o=t+1;o<e.length;o++)e[o]=e[o]+n}function Z(e){let t=0;for(let n=0;n<e.RowHeights.length;n++)e.RowOffsets[n]=t,t+=e.RowHeights[n];e.BlockHeight=t}function Q(e){let t=0;for(let n=0;n<e.ColumnWidths.length;n++)e.ColumnOffsets[n]=t,t+=e.ColumnWidths[n];e.BlockWidth=t}function ee(e,t,n){if(n){for(const n of t)if(e.Row===n)return!0;return!1}for(const n of t)if(e.Col===n)return!0;return!1}function te(e,t,n){if(-1===n)return[-1];const o=[n];for(let r=1;r<=t;r++){const t=k(e,e[n+r]);if(-1===t)return[-1];o.push(t)}return o}function ne(e,t,n,o){var r,i;return o?e.Row>=t&&e.Row+(null===(i=e.Merge)||void 0===i?void 0:i.Rows)<=t+n:e.Col>=t&&e.Col+(null===(r=e.Merge)||void 0===r?void 0:r.Columns)<=t+n}function oe(e,t,n,o,r,i){const l=e.Merge;let a=-1,s=-1;if(function(e,t,n,o,r){const[i,l]=ae(r,t,n,o),[a,s]=se(e,r,o);return i>a&&l<s}(e,t,n,o,i))o?l.Rows-=n+1:l.Columns-=n+1,a=t,s=t+n+1;else if(le(e,t,n,o,i)){if(h&&(0,d.processMergedCellBorders)(e,i,o,t,!0),r&&(re(e,i,l),l.IsOrigin=void 0),o){const o=t-e.Row+n+1;l.Rows-=o,!r&&l.OriginRow&&(l.OriginRow-=n-o+1),a=e.Row}else{const o=t-e.Col+n+1;l.Columns-=o,!r&&l.OriginColumn&&(l.OriginColumn-=n-o+1),a=e.Col}s=t+n+1}else if(function(e,t,n,o,r){const[i,l]=ae(r,t,n,o),[a,s]=se(e,r,o);return i>a&&l>=s}(e,t,n,o,i)){let n;h&&(0,d.processMergedCellBorders)(e,i,o,t,!1),r&&re(e,i,l),o?(n=e.Row+e.Merge.Rows-t+1,l.Rows-=n):(n=e.Col+e.Merge.Columns-t+1,l.Columns-=n),a=t,s=t+n}l.SpansBlocks&&(o?(0,d.updateMergedCellHeight)(a,s,l,i):(0,d.updateMergedCellWidth)(a,s,l,i))}function re(e,t,n){0!==(null==n?void 0:n.OriginRow)&&void 0!==(null==n?void 0:n.OriginRow)||(n.OriginRow=t.RowNumbers[e.Row]-1||0),0!==(null==n?void 0:n.OriginColumn)&&void 0!==(null==n?void 0:n.OriginColumn)||(n.OriginColumn=t.ColumnNumbers[e.Col]-1||0)}function ie(e,t,n,o,r,i,l){const a=e.Merge;a.OriginColumn=t.ColumnNumbers[e.Col]-1,a.OriginRow=t.RowNumbers[e.Row]-1,a.SpansBlocks=!0,a.Width=(0,d.getMergedCellUpdatedWidthOrHeight)(t.ColumnWidths,e.Col,e.Col+a.Columns),a.Height=(0,d.getMergedCellUpdatedWidthOrHeight)(t.RowHeights,e.Row,e.Row+a.Rows),r?(i?(l||(a.OriginRow-=o+1),a.Rows=n+o-e.Row):(l||(a.OriginColumn-=o+1),a.Columns=n+o-e.Col),a.IsOrigin=!0):(i?(l||(a.OriginRow-=o+1),a.Rows-=n+o-e.Row+1,a.OriginDeltaY=(0,d.getMergedCellUpdatedWidthOrHeight)(t.RowHeights,e.Row,n+o)):(l||(a.OriginColumn-=o+1),a.Columns-=n+o-e.Col+1,a.OriginDeltaX=(0,d.getMergedCellUpdatedWidthOrHeight)(t.ColumnWidths,e.Col,n+o)),a.IsOrigin=!1)}function le(e,t,n,o,r){const[i,l]=ae(r,t,n,o),[a,s]=se(e,r,o);return i<=a&&l<s}function ae(e,t,n,o){return o?[e.RowNumbers[t],e.RowNumbers[t+n]]:[e.ColumnNumbers[t],e.ColumnNumbers[t+n]]}function se(e,t,n){var o,r,i,l;return n?[0===((null===(i=e.Merge)||void 0===i?void 0:i.OriginRow)||0)?t.RowNumbers[e.Row]:((null===(l=e.Merge)||void 0===l?void 0:l.OriginRow)||0)+1,t.RowNumbers[e.Row+e.Merge.Rows]]:[0===((null===(o=e.Merge)||void 0===o?void 0:o.OriginColumn)||0)?t.ColumnNumbers[e.Col]:((null===(r=e.Merge)||void 0===r?void 0:r.OriginColumn)||0)+1,t.ColumnNumbers[e.Col+e.Merge.Columns]]}function de(e,t){for(const n of t){const t=(0,r.getCellPositionInArray)(n,e.Cells);e.Cells.splice(t,0,n)}}function ce(e,t){for(const n of t){const t=(0,r.getCellPositionInArray)(n,e.Cells);e.Cells.splice(t,1)}}function ue(e){return(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.HideColumnAutoFilterSlice1,e)&&(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.HideColumnSlice1,e)}function ge(e){return(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.HideColumnFormulaSlice1,e)&&(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.HideColumnSlice1,e)}function he(e,n,o,r,i){const l=e.Merge;if(l.OriginColumn=n.ColumnNumbers[e.Col]-1,l.OriginRow=n.RowNumbers[e.Row]-1,l.SpansBlocks=!0,l.Width=(0,d.getMergedCellUpdatedWidthOrHeight)(n.ColumnWidths,e.Col,e.Col+l.Columns),l.Height=(0,d.getMergedCellUpdatedWidthOrHeight)(n.RowHeights,e.Row,e.Row+l.Rows),r)i?(l.OriginDeltaY=(0,d.getMergedCellUpdatedWidthOrHeight)(n.RowHeights,e.Row,e.Row+l.Rows-(o+1)+(t.maxRowCount+o-(e.Row+e.Merge.Rows))),l.Rows=o-(t.maxRowCount+o+1-(e.Row+e.Merge.Rows+1))):(l.OriginDeltaX=(0,d.getMergedCellUpdatedWidthOrHeight)(n.ColumnWidths,e.Col,e.Col+l.Columns-(o+1)+(t.maxColumnCount+o-(e.Col+e.Merge.Columns))),l.Columns=o-(t.maxColumnCount+o+1-(e.Col+e.Merge.Columns+1)));else if(i){const n=t.maxRowCount+o+1-(e.Row+e.Merge.Rows+1);l.Rows=l.Rows+n-(o+1),l.IsOrigin=!0}else{const n=t.maxColumnCount+o+1-(e.Col+e.Merge.Columns+1);l.Columns=l.Columns+n-(o+1)}}function Ce(e,t,n){const o=t?e.Col:e.Row;return n.skipCascadingBeforeRowColIndex?o<n.rowColIndexToEndRangeCascade:o>=n.rowColIndexToEndRangeCascade}function fe(e,t,n,o,r){return!!r&&(null!=r&&r.skipCascadingBeforeRowColIndex&&!o?e.Row-=null==r?void 0:r.rowColIndexToEndRangeCascade:null!=r&&r.performDiagonalCascading&&!o&&(e.Col-=n+1,e.Row=t.RowNumbers.length-(null==r?void 0:r.rowColIndexToEndRangeCascade)+e.Row),!0)}function me(e,t){C||(function(e,t){const n=Te(e,t);(function(e,t,n){const i=t?o.BorderPositionType.Top:o.BorderPositionType.Left,l=t?o.BorderPositionType.Bottom:o.BorderPositionType.Right;for(let c=0;c<e.Cells.length;c++){var a,s,d;const u=e.Cells[c];if(u.Merge||u[t?"Row":"Col"]===(t?((null===(a=e.RowNumbers)||void 0===a?void 0:a.length)||0)-1:((null===(s=e.ColumnNumbers)||void 0===s?void 0:s.length)||0)-1))continue;u.CachedBorderStyle||(u.CachedBorderStyle=(0,o.getBorderStyleByID)(u,e));const g=null===(d=u.CachedBorderStyle)||void 0===d?void 0:d.Borders.find(e=>e.BorderPosition===i);if(g&&(0,r.isActualBorderPresent)(u,l)){const l=t?(0,o.getCell)(u.Row+1,u.Col,e):(0,o.getCell)(u.Row,u.Col+1,e);if(!l||!(0,r.isSerializedBorderPresent)(l,i)){if(l&&l.Merge)continue;const e=t?(0,o.getCellLookupKey)(u.Row+1,u.Col):(0,o.getCellLookupKey)(u.Row,u.Col+1);n.set(e,g)}}}})(e,t,n),we(e,t,n);const i=Ie(e,t);(function(e,t,n,i){const l=t?o.BorderPositionType.Bottom:o.BorderPositionType.Right,a=t?o.BorderPositionType.Top:o.BorderPositionType.Left;for(let c=0;c<e.Cells.length;c++){var s,d;const u=e.Cells[c];if(!u.Merge&&u[t?"Row":"Col"]!==(t?((null===(s=e.RowNumbers)||void 0===s?void 0:s.length)||0)-1:((null===(d=e.ColumnNumbers)||void 0===d?void 0:d.length)||0)-1)&&(u.CachedBorderStyle||(u.CachedBorderStyle=(0,o.getBorderStyleByID)(u,e)),u.CachedBorderStyle&&u.CachedBorderStyle.Borders&&u.CachedBorderStyle.Borders.length>0&&(0,r.isActualBorderPresent)(u,l))){const l=t?(0,o.getCell)(u.Row+1,u.Col,e):(0,o.getCell)(u.Row,u.Col+1,e);if(l&&(0,r.isSerializedBorderPresent)(l,a)&&!(0,r.isActualBorderPresent)(l,a)){if(l&&l.Merge)continue;const e=t?(0,o.getCellLookupKey)(u.Row+1,u.Col):(0,o.getCellLookupKey)(u.Row,u.Col+1);if(i.has(e)){const t=i.get(e);if(t&&t.BorderPosition===a)continue}n.set(e,a)}}}})(e,t,i,n),be(e,t,i)}(e,t),Se(e,t),Re(e,t))}function pe(e,t,n,i,l,a,s,c){C&&(a!==S.Hide&&a!==S.Delete?function(e,t,n,i,l,a,s){if((l?t.Row:t.Col)===n){const n=l?(0,o.getCell)(t.Row-1,t.Col,e):(0,o.getCell)(t.Row,t.Col-1,e);if(!n)return;if(t.CachedBorderStyle=(0,o.getBorderStyleByID)(t,e),n.CachedBorderStyle=(0,o.getBorderStyleByID)(n,e),(0,r.isActualBorderPresent)(n,o.BorderPositionType.Right)&&(0,r.isSerializedBorderPresent)(t,o.BorderPositionType.Left)){if(!(0,r.isActualBorderPresent)(t,o.BorderPositionType.Left)){const e=(0,o.getCellLookupKey)(l?t.Row+i+1:t.Row,l?t.Col:t.Col+i+1);s.set(e,o.BorderPositionType.Left)}const n=(0,o.getCellLookupKey)(t.Row,t.Col),c=(0,d.getBorderAtPosition)(t,e,o.BorderPositionType.Left);c&&a.set(n,c),we(e,l,a),be(e,l,s)}}}(e,t,n,i,l,s,c):function(e,t,n,i,l,a,s){const c=l?t.Row:t.Col;if(c===n){const n=l?(0,o.getCell)(t.Row-1,t.Col,e):(0,o.getCell)(t.Row,t.Col-1,e);if(n&&(t.CachedBorderStyle=(0,o.getBorderStyleByID)(t,e),n.CachedBorderStyle=(0,o.getBorderStyleByID)(n,e),l?(0,r.isActualBorderPresent)(n,o.BorderPositionType.Bottom)&&(0,r.isSerializedBorderPresent)(t,o.BorderPositionType.Top):(0,r.isActualBorderPresent)(n,o.BorderPositionType.Right)&&(0,r.isSerializedBorderPresent)(t,o.BorderPositionType.Left))){const n=(0,d.getBorderAtPosition)(t,e,l?o.BorderPositionType.Top:o.BorderPositionType.Left);if(n){const r=(0,o.getCellLookupKey)(t.Row,t.Col);a.set(r,n),we(e,l,a)}}}if(c===n+i){const n=l?(0,o.getCell)(t.Row+1,t.Col,e):(0,o.getCell)(t.Row,t.Col+1,e);if(!n)return;if(t.CachedBorderStyle=(0,o.getBorderStyleByID)(t,e),n.CachedBorderStyle=(0,o.getBorderStyleByID)(n,e),l?!(0,r.isActualBorderPresent)(n,o.BorderPositionType.Top)&&(0,r.isSerializedBorderPresent)(n,o.BorderPositionType.Top)&&(0,r.isActualBorderPresent)(t,o.BorderPositionType.Bottom):!(0,r.isActualBorderPresent)(n,o.BorderPositionType.Left)&&(0,r.isSerializedBorderPresent)(n,o.BorderPositionType.Left)&&(0,r.isActualBorderPresent)(t,o.BorderPositionType.Right)){const t=(0,o.getCellLookupKey)(l?n.Row-i-1:n.Row,l?n.Col:n.Col-i-1);s.set(t,l?o.BorderPositionType.Top:o.BorderPositionType.Left),be(e,l,s)}}}(e,t,n,i,l,s,c))}function ye(e,t){C&&(Re(e,t),Se(e,t))}function Se(e,t){const n=Te(e,t);for(let t=0;t<e.Cells.length;t++){const i=e.Cells[t],l=(0,o.getCellLookupKey)(i.Row,i.Col);if(n.has(l)){i.CachedBorderStyle=(0,o.getBorderStyleByID)(i,e);const t=n.get(l);t&&(0,r.addBorderToCellIfNotPresent)(i,e,t,t.BorderPosition),n.delete(l)}}for(const t of Array.from(n.keys())){const{row:i,column:l}=(0,o.getRowColFromCellKey)(t),a=(0,o.getDefaultCell)(i,l);a.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID({Borders:[],ID:0}),a.CachedBorderStyle=(0,o.getBorderStyleByID)(a,e);const s=n.get(t);s&&(0,r.addBorderToCellIfNotPresent)(a,e,s,s.BorderPosition);const d=(0,r.getCellPositionInArray)(a,e.Cells);e.Cells.splice(d,0,a),n.delete(t)}we(e,t,n)}function Re(e,t){const n=Ie(e,t);if(0!==n.size){for(let t=0;t<e.Cells.length;t++){const i=e.Cells[t],l=(0,o.getCellLookupKey)(i.Row,i.Col);if(n.has(l)){i.CachedBorderStyle=(0,o.getBorderStyleByID)(i,e);const t=n.get(l);(t&&!C||void 0!==t)&&(0,r.removeBorderFromCell)(i,e,t),n.delete(l)}}be(e,t,n)}}function Fe(e,t){return t?e.ColumnNumbers[0]:e.RowNumbers[0]}function Te(e,t){const n=Fe(e,t);let o=m.get(n);return o||(o=new Map),o}function we(e,t,n){const o=Fe(e,t);m.set(o,n)}function Ie(e,t){const n=Fe(e,t);let o=p.get(n);return o||(o=new Map),o}function be(e,t,n){const o=Fe(e,t);p.set(o,n)}function ve(e,t,n){return n?t.Index>=e.RowNumbers.length||t.Index<0:t.Index>=e.ColumnNumbers.length||t.Index<0}function xe(e,t,n,o,r){const i=r?e.RowNumbers[t.Index]:e.ColumnNumbers[t.Index],l=r?n.FirstRow:n.FirstColumn,a=r?n.LastRow:n.LastColumn;return i+1>=l&&i<a&&o===S.Delete}function De(e,t,n,o,r,i){const l=r?e.RowNumbers[t.Index]:e.ColumnNumbers[t.Index],a=r?n.FirstRow:n.FirstColumn,s=r?n.LastRow:n.LastColumn;l>=s?t.Index+=i:l+1>=a&&l<s&&(o===S.Insert||o===S.Unhide?t.Index+=i:o===S.Hide&&(t.Index-=t.Index-k(r?e.RowNumbers:e.ColumnNumbers,a)+1))}function Ae(e,t,n){e&&e.PageBreaks&&(0!==t.length?n?e.PageBreaks.Row=t:e.PageBreaks.Col=t:n?e.PageBreaks.Row=void 0:e.PageBreaks.Col=void 0)}function Pe(e){e&&e.PageBreaks&&(e.PageBreaks.Row&&0===e.PageBreaks.Row.length&&(e.PageBreaks.Row=void 0),e.PageBreaks.Col&&0===e.PageBreaks.Col.length&&(e.PageBreaks.Col=void 0),e.PageBreaks.Row||e.PageBreaks.Col||(e.PageBreaks=void 0))}function Me(e){return e===S.Hide||e===S.Delete}function Be(e){if(!(0,o.isChangeGateEnabled)(o.ChangeGate.AutofitWidthGlobalStyle))return;(0,s.resetCache)();const t=[];for(let n=0;n<e.ColumnNumbers.length;n++)t.push(null);e.ColMetadata=t}function He(e,t,n){const r=n?(0,o.getCell)(t.Row+1,t.Col,e):(0,o.getCell)(t.Row,t.Col+1,e);if(!r)return;const i=ke(e,t,n),l=ke(e,r,n);if(0===i.length||0===l.length)return;let a=0,s=0;const d=[];for(;a<i.length&&s<l.length;){const e=i[a].BorderPosition,n=l[s].BorderPosition;if(e===n){if(Oe(t,r,i[a],l[s])){const e=_object_spread({},i[a]);e.BorderPosition===o.BorderPositionType.Bottom?e.BorderPosition=o.BorderPositionType.Top:e.BorderPosition===o.BorderPositionType.Right&&(e.BorderPosition=o.BorderPositionType.Left),d.push(e)}a++,s++}else e<n?a++:s++}return{ID:e.BorderStyles.length,Borders:d,RefCount:0}}function Oe(e,t,n,o){const i=(0,r.isActualBorderPresent)(e,n.BorderPosition),l=(0,r.isActualBorderPresent)(t,o.BorderPosition);return(i&&l||!i&&!l)&&(s=o,d=(a=n).Color,c=s.Color,d.Blue===c.Blue&&d.Green===c.Green&&d.Red===c.Red&&a.Weight===s.Weight&&a.BorderLineStyle===s.BorderLineStyle);var a,s,d,c}function ke(e,t,n){var i;const l=null===(i=(0,o.getBorderStyleByID)(t,e))||void 0===i?void 0:i.Borders,a=[];for(const e of l)((0,r.isActualBorderPresent)(t,e.BorderPosition)||n&&o.BorderPositionType.Left===e.BorderPosition||!n&&o.BorderPositionType.Top===e.BorderPosition)&&a.push(e);return function(e,t,n,i){if(!(i&&(0,r.isActualBorderPresent)(t,o.BorderPositionType.Bottom)||!i&&(0,r.isActualBorderPresent)(t,o.BorderPositionType.Right)))return;const l=i?(0,o.getCell)(t.Row+1,t.Col,e):(0,o.getCell)(t.Row,t.Col+1,e);if(!l||i&&(0,r.isActualBorderPresent)(t,o.BorderPositionType.Bottom)&&(0,r.isActualBorderPresent)(l,o.BorderPositionType.Top)||!i&&(0,r.isActualBorderPresent)(t,o.BorderPositionType.Right)&&(0,r.isActualBorderPresent)(l,o.BorderPositionType.Left))return;const a=(0,o.getBorderStyleByID)(l,e),s=null==a?void 0:a.Borders;if(0!==s.length)for(const e of s)if(i&&e.BorderPosition===o.BorderPositionType.Top||!i&&e.BorderPosition===o.BorderPositionType.Left){const t=_object_spread({},e);t.BorderPosition=i?o.BorderPositionType.Bottom:o.BorderPositionType.Right,Le(n,t)}}(e,t,a,n),a}function Le(e,t){let n=0;for(;n<e.length&&e[n].BorderPosition<t.BorderPosition;)n++;e.splice(n,0,t)}function Ne(e,t,n,o,r,i){if(!(e&&e.PrintAreas&&t&&t.FirstRow&&t.FirstColumn&&t.LastRow&&t.LastColumn))return void(e&&i.length>0&&(e.PrintAreas=i));const l=e.PrintAreas.length,a=i.length,s=[];for(let a=0;a<l;a++){const l=e.PrintAreas[a],d=r?t.FirstRow:t.FirstColumn,c=r?t.LastRow:t.LastColumn,u=r?l.FirstRow>e.RowNumbers.length-1?e.RowNumbers[e.RowNumbers.length-1]+1:e.RowNumbers[l.FirstRow]:l.FirstColumn>e.ColumnNumbers.length-1?e.ColumnNumbers[e.ColumnNumbers.length-1]+1:e.ColumnNumbers[l.FirstColumn],h=r?l.LastRow>e.RowNumbers.length-1?e.RowNumbers[e.RowNumbers.length-1]+1:e.RowNumbers[l.LastRow]:l.LastColumn>e.ColumnNumbers.length-1?e.ColumnNumbers[e.ColumnNumbers.length-1]+1:e.ColumnNumbers[l.LastColumn],C=o===S.Hide||o===S.Delete?-n:n;if(d<=u&&c<=u)r?(l.FirstRow+=C,l.LastRow+=C):(l.FirstColumn+=C,l.LastColumn+=C);else if(d<u&&c>u&&c<=h){const e=o===S.Hide||o===S.Delete?-1*(u-d):n;r?(l.FirstRow+=e,l.LastRow+=C):(l.FirstColumn+=e,l.LastColumn+=C)}else if(d>=u&&c<=h)r?l.LastRow+=C:l.LastColumn+=C;else if(d>u&&d<=h&&c>=h){const e=o===S.Hide||o===S.Delete?-1*(h-d+1):n;r?l.LastRow+=e:l.LastColumn+=e}else if(d>h);else if(o===S.Delete)g=!0;else{if(o===S.Hide)continue;o===S.Insert&&(r?(l.FirstRow+=n,l.LastRow+=n):(l.FirstColumn+=n,l.LastColumn+=n))}if(We(e,l,r))s.push(l);else{const t=_object_spread({},l);je(e,l,o,r)&&s.push(l),i.push(t)}}e.PrintAreas=s;for(let t=0;t<a;t++){const n=i[t];Ge(e,n,o,r)||e.PrintAreas.push(n)}return!1}function Ee(e,t,n){return n?t.LastRow>e.RowNumbers.length-1||t.FirstRow<0:t.LastColumn>e.ColumnNumbers.length-1||t.FirstColumn<0}function ze(e,t,n,o,r){const i=_object_spread({},n);switch(o){case S.Hide:case S.Delete:r?(i.FirstRow=n.FirstRow+t.RowNumbers.length,n.FirstRow=0,i.LastRow=t.RowNumbers.length):(i.FirstColumn=n.FirstColumn+t.ColumnNumbers.length,n.FirstColumn=0,i.LastColumn=t.ColumnNumbers.length);break;case S.Insert:case S.Unhide:r?(n.LastRow=e.RowNumbers.length,i.FirstRow=0,i.LastRow-=n.LastRow):(n.LastColumn=e.ColumnNumbers.length,i.FirstColumn=0,i.LastColumn-=n.LastColumn)}return i}function We(e,t,n){return n?!(t.FirstRow<0&&t.LastRow<0||t.FirstRow>e.RowNumbers.length-1&&t.LastRow>e.RowNumbers.length-1):!(t.FirstColumn<0&&t.LastColumn<0||t.FirstColumn>e.ColumnNumbers.length-1&&t.LastColumn>e.ColumnNumbers.length-1)}function Ge(e,t,n,o){if(!e.PrintAreas||0===e.PrintAreas.length)return!1;for(const r of e.PrintAreas)if(Ve(r,t,n,o))return o?n===S.Hide||n===S.Delete?r.LastRow=t.LastRow:r.FirstRow=t.FirstRow:n===S.Hide||n===S.Delete?r.LastColumn=t.LastColumn:r.FirstColumn=t.FirstColumn,!0;return!1}function Ve(e,t,n,o){return o?e.FirstColumn===t.FirstColumn&&e.LastColumn===t.LastColumn&&(n===S.Hide||n===S.Delete?e.LastRow===t.FirstRow:e.FirstRow===t.LastRow):e.FirstRow===t.FirstRow&&e.LastRow===t.LastRow&&(n===S.Hide||n===S.Delete?e.LastColumn===t.FirstColumn:e.FirstColumn===t.LastColumn)}function je(e,t,n,o){let r=!1;return o?n===S.Insert||n===S.Unhide?t.FirstRow===e.RowNumbers.length&&(t.LastRow=e.RowNumbers.length,r=!0):t.LastRow===e.RowNumbers.length&&(t.FirstRow=e.RowNumbers.length,r=!0):n===S.Insert||n===S.Unhide?t.FirstColumn===e.ColumnNumbers.length&&(t.LastColumn=e.ColumnNumbers.length,r=!0):t.LastColumn===e.ColumnNumbers.length&&(t.FirstColumn=e.ColumnNumbers.length,r=!0),r}function _e(e,t,n){t.CachedBorderStyle=(0,o.getBorderStyleByID)(t,e);const i=n?(0,o.getCell)(t.Row-1,t.Col,e):(0,o.getCell)(t.Row,t.Col-1,e);(n?!(0,r.isActualBorderPresent)(t,o.BorderPositionType.Top)&&(0,r.isSerializedBorderPresent)(t,o.BorderPositionType.Top):!(0,r.isActualBorderPresent)(t,o.BorderPositionType.Left)&&(0,r.isSerializedBorderPresent)(t,o.BorderPositionType.Left))&&(i?(n?(0,r.isActualBorderPresent)(i,o.BorderPositionType.Bottom):(0,r.isActualBorderPresent)(i,o.BorderPositionType.Right))||(0,r.removeBorderFromCell)(t,e,n?o.BorderPositionType.Top:o.BorderPositionType.Left):(0,r.removeBorderFromCell)(t,e,o.BorderPositionType.Left))}t.isHideColumnMergedCellFlightEnabled=y,function(e){e.Hide="Hide",e.Unhide="Unhide",e.Insert="Insert",e.Delete="Delete",e.FreezePane="FreezePane"}(S||(t.GridInstantaneousOperation=S={})),t.hideRowsColumns=function(e,t,n){if(n)return!1;const o=k(n?e.RowNumbers:e.ColumnNumbers,t);if(-1===o)return!1;if(_(e.Cells))return U(e,o),!0;const r=[];for(let t=0;t<e.Cells.length;t++){const i=e.Cells[t];i.Col===o||H(i,o,!1)?i.Merge&&(ne(i,o,0,n)||(oe(i,o,0,!1,!0,e),r.push(i))):(i.Col>o&&(i.Col-=1),r.push(i))}return U(e,o),e.Cells=r,!0},t.modelRowColOperations=function(e,t,n,i,l,a=!1){return m=new Map,p=new Map,i===S.Hide||i===S.FreezePane||i===S.Delete?R(e,t,n,l,i,a):function(e,t,n,i,l,a=!1){const s=i?e.RowNumbers:e.ColumnNumbers,d=k(s,t),c=te(s,n,d);if(-1===c[0])return!1;if(_(e.Cells))return i?X(e,c):K(e,c),!0;const u=[],g=Te(e,i),h=Ie(e,i);for(let t=0;t<e.Cells.length;t++){const a=e.Cells[t];pe(e,a,d,n,i,l,g,h);const s=c[0]-1;let y=0,R=0;if(i){if(a.Row>=d){var C;l===S.Insert&&a.Merge&&null!==(C=a.Merge)&&void 0!==C&&C.OriginRow&&0!==a.Merge.OriginRow&&(a.Merge.OriginRow+=n+1),a.Row+=n+1,u.push(a);continue}if(a.Merge&&a.Row<d&&a.Row+a.Merge.Rows>=d){a.Merge.Rows+=n+1,u.push(a);continue}}else{if(a.Col>=d){var f;l===S.Insert&&a.Merge&&null!==(f=a.Merge)&&void 0!==f&&f.OriginColumn&&0!==a.Merge.OriginColumn&&(a.Merge.OriginColumn+=n+1),a.Col+=n+1,u.push(a);continue}if(a.Merge&&a.Col<d&&a.Col+a.Merge.Columns>=d){a.Merge.Columns+=n+1,u.push(a);continue}}if(-1===s){u.push(a);continue}i?a.Merge?a.Row+a.Merge.Rows===s&&(y=a.Merge.Columns+1,R=c.length):a.Row===s&&(y=1,R=c.length):a.Merge?a.Col+a.Merge.Columns===s&&(y=c.length,R=a.Merge.Rows+1):a.Col===s&&(y=c.length,R=1);const F=(0,o.getCellStyleByID)(a,e);let T,w,I;if(a.HorizontalAlignmentSet)T=(0,o.getGlobalCellStylesMap)().getOrCreateID(F),w=F;else{var m;const t=(0,r.getLastNonUniqueStyleID)(e)+1,n=(0,r.duplicateStyle)(e,(0,o.getCellStyleByID)(a,e),t,1);n.HorizontalAlignment=o.HorizontalAlignment.Automatic,null===(m=e.Styles)||void 0===m||m.splice(t,0,n),T=(0,o.getGlobalCellStylesMap)().getOrCreateID(n),w=n}let b=0,v=0;var p;if(R>0&&y>0)I=He(e,a,i),I&&(I.RefCount=Math.max(y,R),b=I.ID||0,null===(p=e.BorderStyles)||void 0===p||p.push(I)),v=void 0===I?0:(0,o.getGlobalBorderStyleMap)().getOrCreateID(I);for(let e=0;e<R;e++)for(let t=0;t<y;t++){const n=i?c[0]+e:a.Row+e,r=i?a.Col+t:c[0]+t,l=(0,o.getDefaultCell)(n,r);l.GlobalCellStyleID=T,l.CachedStyle=w,l.StyleID=w.ID||0,l.WrapText=a.WrapText,l.BorderStyleID=b,l.GlobalBorderStyleID=v,u.push(l)}u.push(a)}return e.Cells=[],de(e,u),i?X(e,c):K(e,c),a&&ye(e,i),!0}(e,t,n,l,i,a)},t.hideDeleteRowsColumns=R,t.hideMultipleRowsColumns=function(e,t,n,o){const r=o?e.RowNumbers:e.ColumnNumbers,i=k(r,t),l=te(r,n,i);if(-1===l[0])return!1;if(_(e.Cells))return q(e,l,o,!0),!0;const a=[],s=l[l.length-1];for(let t=0;t<e.Cells.length;t++){const r=e.Cells[t];ee(r,l,o)||P(r,i,n,o)?r.Merge&&(ne(r,i,n,o)||(oe(r,i,n,o,!0,e),r.Col>l[0]&&(r.Col-=n),a.push(r))):(o?r.Row>s&&(r.Row-=n+1):r.Col>s&&(r.Col-=n+1),a.push(r))}return q(e,l,o,!0),e.Cells=a,!0},t.modelCascade=function(e,t,n,l){if(l)return{isSuccess:!1,exception:"Rows are not supported"};const s={};try{const d=(0,o.isGlobalBorderStylesEnabled)(e),c=(0,o.isGlobalFontsAndCellStylesFlightEnabled)(e),u=performance.now(),g=k(l?e.RowNumbers:e.ColumnNumbers,n);if(-1===g)return{isSuccess:!1,exception:"Incorrect rowColIndex found"};if(_(e.Cells))return s.timeTaken=performance.now()-u,L(e,t,g),{isSuccess:!0,metric:s};const h=[],C=[],f=[],m=new Map,p=[],y=new Map,S=[],R=new Map,F=t.Styles.length,T=t.Fonts.length,w=t.BorderStyles.length,I=t.ColumnNumbers.length;let b=!1;e.ClientOnlyCache=void 0,t.ClientOnlyCache=void 0;let x=!1,D=!1,A=!1;(0,o.preprocessModelStyles)(e),(0,o.preprocessModelStyles)(t);for(let n=0;n<e.Cells.length;n++){const s=e.Cells[n];let u=!1;if(s.Col!==g){s.Col-=1,C.push(s);continue}if(s.Merge&&!ne(s,g,0,l)){const t=(0,a.duplicateCell)(s);ie(t,e,g,0,u,!1,!0),u=!0,t.Col=0,C.push(t)}s.Merge&&u&&ie(s,e,g,0,u,!1,!0);const P=s.Col;s.Col=I,h.push(s);const B=s.StyleID||0;let H=!1,O=!1;if(!m.has(B)&&B!==o.UniqueStyleID.Default&&B!==o.UniqueStyleID.Hyperlink){const t=(0,o.getReferencedObjectById)(B,e.Styles),n=t.FontID||0;if(H=!c||(0,i.isNullOrUndefined)(s.GlobalCellStyleID),O=!c||(0,i.isNullOrUndefined)(t.GlobalFontID),O&&!y.has(n)){const t=T+y.size;y.set(n,t);const i=(0,o.getReferencedObjectById)(n,e.Fonts),l=(0,r.duplicateFont)(i,t,1);p.push(l),A=!0}if(H){let e=o.UniqueStyleID.Default;e=F-r.NumberOfUniqueStyleIDs+f.length,m.set(B,e);const i=(0,r.duplicateOnlyStyleWithoutFont)(t,e,1);i.FontID=y.get(n),f.push(i),D=!0}}const k=s.BorderStyleID||0,L=!d||(0,i.isNullOrUndefined)(s.GlobalBorderStyleID);if(L){if(!R.has(k)&&k!==o.UniqueStyleID.DefaultBorder){const t=w+R.size;R.set(k,t);const n=(0,r.duplicateBorderStyle)((0,o.getReferencedObjectById)(k,e.BorderStyles),t,1),i=v(s,e,P,l);0!==Object.keys(i).length&&n.Borders.push(i),M(s,e)&&(b=!0),S.push(n),x=!0}}else if(d){const n=v(s,e,P,l),i=0!==Object.keys(n).length,a=M(s,e);if(i||a){const l=t.BorderStyles.length,d=(0,r.duplicateBorderStyle)((0,o.getBorderStyleByID)(s,e),l,1);i&&(d.Borders.push(n),s.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID(d)),s.BorderStyleID=l,t.BorderStyles.push(d),b=a}}H&&(s.StyleID=B===o.UniqueStyleID.Default?o.UniqueStyleID.Default:m.get(B)),L&&(s.BorderStyleID=k===o.UniqueStyleID.DefaultBorder?o.UniqueStyleID.DefaultBorder:R.get(k))}x&&t.BorderStyles.push(...S),b&&B(t,I,l),L(e,t,g);for(const e of h){const n=(0,r.getCellPositionInArray)(e,t.Cells);t.Cells.splice(n,0,e)}if(D)for(const e of f)t.Styles.splice(e.ID||0,0,e);A&&t.Fonts.push(...p),e.Cells=C,s.countOfStylesMoved=m.size,s.countOfFontsMoved=y.size,s.countOfBorderStylesMoved=R.size,s.timeTaken=performance.now()-u}catch(e){return{isSuccess:!1,exception:e,metric:s}}return{isSuccess:!0,metric:s}},t.modelCascadeRowColsOperations=function(e,t,n,o,r,i,l){const a=r===S.Hide||r===S.FreezePane;return a||r===S.Delete?F(e,t,n,o,i,a,l):T(e,t,n,o,i)},t.modelCascadeRowCols=F,t.modelCascadeMultipleRowCols=function(e,t,n,l,s){if(s)return{isSuccess:!1,exception:"Rows are not supported"};const d={};try{const c=(0,o.isGlobalBorderStylesEnabled)(e),u=(0,o.isGlobalFontsAndCellStylesFlightEnabled)(e),g=performance.now(),h=s?e.RowNumbers:e.ColumnNumbers,C=!0,f=k(h,n),m=te(h,l,f);if(-1===m[0])return{isSuccess:!1,exception:"Incorrect rowColIndex found"};if(_(e.Cells))return d.timeTaken=performance.now()-g,N(e,t,m,C,s),{isSuccess:!0,metric:d};const p=[],y=[],S=[],R=new Map,F=[],T=new Map,w=[],I=new Map,b=new Map,x=t.Styles.length,P=t.Fonts.length,M=t.BorderStyles.length,H=t.ColumnNumbers.length,O=l+1;e.ClientOnlyCache=void 0,t.ClientOnlyCache=void 0;let L=!1,E=!1,z=!1;(0,o.preprocessModelStyles)(e),(0,o.preprocessModelStyles)(t);for(let t=0;t<e.Cells.length;t++){const n=e.Cells[t];let d=!1;if(!ee(n,m,s)){n.Col-=O,y.push(n);continue}if(n.Merge&&!ne(n,f,l,s)){const t=(0,a.duplicateCell)(n);ie(t,e,f,l,d,!1,!0),d=!0,t.Col=0,y.push(t)}n.Merge&&d&&ie(n,e,f,l,d,!1,!0);const g=n.Col;n.Col=H+g,p.push(n);const h=n.StyleID||0;let C=!1,B=!1;if(!R.has(h)&&h!==o.UniqueStyleID.Default&&h!==o.UniqueStyleID.Hyperlink){const t=(0,o.getReferencedObjectById)(h,e.Styles),l=t.FontID||0;if(C=!u||(0,i.isNullOrUndefined)(n.GlobalCellStyleID),B=!u||(0,i.isNullOrUndefined)(t.GlobalFontID),B&&!T.has(l)){const t=P+T.size;T.set(l,t);const n=(0,o.getReferencedObjectById)(l,e.Fonts),i=(0,r.duplicateFont)(n,t,1);F.push(i),z=!0}if(C){const e=x-r.NumberOfUniqueStyleIDs+S.length;R.set(h,e);const n=(0,r.duplicateOnlyStyleWithoutFont)(t,e,1);n.FontID=T.get(l),S.push(n),E=!0}}const k=n.BorderStyleID||0,N=!c||(0,i.isNullOrUndefined)(n.GlobalBorderStyleID);if(N&&!I.has(k)&&k!==o.UniqueStyleID.DefaultBorder){const t=M+w.length;I.set(k,t);const n=(0,r.duplicateBorderStyle)((0,o.getReferencedObjectById)(k,e.BorderStyles),t,1);w.push(n),L=!0}const W=n.BorderStyleID||0;if(C&&(n.StyleID=h===o.UniqueStyleID.Default?o.UniqueStyleID.Default:R.get(h)),N&&(n.BorderStyleID=k===o.UniqueStyleID.DefaultBorder?o.UniqueStyleID.DefaultBorder:I.get(k)),A(g,m[m.length-1])){const t=v(n,e,g,s);if(0!==Object.keys(t).length){const i=n.BorderStyleID||0,l=M+w.length,a=D(n,e.Cells,g,s).BorderStyleID||0;if(N&&I.get(i)&&b.get(a))n.BorderStyleID=I.get(i),c&&(n.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID((0,o.getReferencedObjectById)(W,e.BorderStyles)));else{N&&(I.set(i,l),b.set(a,M+b.size));const s=(0,r.duplicateBorderStyle)((0,o.getReferencedObjectById)(W,e.BorderStyles),l,1);s.Borders.push(t),w.push(s),n.BorderStyleID=l,c&&(n.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID(s)),L=!0}}}}L&&t.BorderStyles.push(...w),B(t,H,s),N(e,t,m,C,s);for(const e of p){const n=(0,r.getCellPositionInArray)(e,t.Cells);t.Cells.splice(n,0,e)}if(E)for(const e of S)t.Styles.splice(e.ID||0,0,e);z&&t.Fonts.push(...F),e.Cells=y,d.countOfStylesMoved=R.size,d.countOfFontsMoved=T.size,d.countOfBorderStylesMoved=I.size,d.timeTaken=performance.now()-g}catch(e){return{isSuccess:!1,exception:e,metric:d}}return{isSuccess:!0,metric:d}},t.modelReverseCascadeRowCols=T,t.addBottomBorderToNewBlockEdgeCell=w,t.addRightBorderToNewBlockEdgeCell=I,t.canCellsOfRowColHideOrCascade=function(e,t,n,o){if(_(e.Cells))return!0;const r=k(n?e.RowNumbers:e.ColumnNumbers,t);if(-1===r)return!1;const i=e.Cells;for(let t=0;t<i.length;t++){const a=i[t];let s=!1;if(a.Merge&&(s=H(a,r,n),l.ULS.sendTraceTag(507353301,l.LogCategory.msoulscat_ES_EWAJSGrid,l.TraceLevel.Info,`ModelCascadeHelper::canCellsOfRowColHideOrCascade called, MergedCellAcrossBlocks: ${!!a.Merge.SpansBlocks}, rowColIndex: ${r}, cell.Col: ${a.Col}, cell.Row: ${a.Row}, isMergedCellIntersectRowCol: ${s}`)),(W(a,r,n)||s)&&j(e,a,o,n))return!1}return!0},t.canCellsOfMultipleRowColHideOrCascade=function(e,t,n,o,r){if(_(e.Cells))return!0;const i=k(o?e.RowNumbers:e.ColumnNumbers,t);if(-1===i)return!1;const l=e.Cells;for(let t=0;t<l.length;t++){const a=l[t];if((0,c.isMergeCellsToBeValidatedForFreezePaneCse)(r)&&(0,c.doesMergedCellOverlapMultipleRowColExcludingCellAtEdge)(a,i,n,o))return!1;if((G(a,i,n,o)||P(a,i,n,o))&&j(e,a,r,o))return!1}return!0},t.cellHasBorderAtPosition=b,t.removeExtraModelRowsColumns=function(e){const n=e.ColumnNumbers.length,o=e.RowNumbers.length,r=t.maxRowCount,i=t.maxColumnCount,l=[];if(n>i){var a,s,d,c,u;const t=n-i;if(null===(a=e.ColumnNumbers)||void 0===a||a.splice(i,t),null===(s=e.ColMetadata)||void 0===s||s.splice(i,t),null===(d=e.ColumnWidths)||void 0===d||d.splice(i,t),null===(c=e.FixedColumns)||void 0===c||c.splice(i,t),null===(u=e.ColumnOffsets)||void 0===u||u.splice(i,t),Q(e),!_(e.Cells))for(const t of e.Cells)(t.Col>=i||t.Col>i)&&l.push(t)}if(o>r){var g,h,C,f;const t=o-r;if(null===(g=e.RowNumbers)||void 0===g||g.splice(r,t),null===(h=e.RowHeights)||void 0===h||h.splice(r,t),null===(C=e.RowOutlinesInformation)||void 0===C||C.splice(r,t),null===(f=e.RowOffsets)||void 0===f||f.splice(r,t),Z(e),!_(e.Cells))for(const t of e.Cells)(t.Row>=r||t.Row>r)&&l.push(t)}ce(e,l)},t.getRightBorder=v,t.getBottomBorder=x,t.getAdjacentCell=D,t.isCellInLastCascadedCol=A,t.updatePageBreaksOfBlockPair=function(e,t,n,o,r,i){var l,a,s,d;const c=r===S.Hide||r===S.Delete?-1*n:n,u=i?null==e||null===(l=e.PageBreaks)||void 0===l?void 0:l.Row:null==e||null===(a=e.PageBreaks)||void 0===a?void 0:a.Col,g=i?null==t||null===(s=t.PageBreaks)||void 0===s?void 0:s.Row:null==t||null===(d=t.PageBreaks)||void 0===d?void 0:d.Col,h=[],C=[],f=[];if(u){for(let t=0;t<u.length;t++)if(!xe(e,u[t],o,r,i))if(De(e,u[t],o,r,i,c),ve(e,u[t],i)){const n=i?e.RowNumbers.length:e.ColumnNumbers.length;u[t].Index+=r===S.Hide||r===S.Delete?n:-1*n,f.push(u[t])}else h.push(u[t]);Ae(e,h,i)}if(g){for(let e=0;e<g.length;e++)xe(t,g[e],o,r,i)||(De(t,g[e],o,r,i,c),C.push(g[e]));Ae(t,C,i)}!function(e,t,n,o){if(!e||0===t.length)return;if(e.PageBreaks||(e.PageBreaks={}),o&&!e.PageBreaks.Row)return void(e.PageBreaks.Row=t);if(!o&&!e.PageBreaks.Col)return void(e.PageBreaks.Col=t);const r=o?e.PageBreaks.Row:e.PageBreaks.Col;Me(n)?r.push(...t):r.unshift(...t)}(t,f,r,i),Pe(e),Pe(t)},t.updatePrintAreasOfBlockPair=function(e,t,n,o,r,i){const l=[];if(Ne(e,o,n,r,i,l),g)return g=!1,!0;if(function(e,t,n,o){if(e&&0!==t.length)for(const r of t)o?Me(n)?(r.LastRow+=e.RowNumbers.length,r.FirstRow+=e.RowNumbers.length):(r.LastRow-=e.RowNumbers.length,r.FirstRow-=e.RowNumbers.length):Me(n)?(r.LastColumn+=e.ColumnNumbers.length,r.FirstColumn+=e.ColumnNumbers.length):(r.LastColumn-=e.ColumnNumbers.length,r.FirstColumn-=e.ColumnNumbers.length)}(t,l,r,i),e&&e.PrintAreas)for(const n of null==e?void 0:e.PrintAreas)Ee(e,n,i)&&!je(e,n,r,i)&&l.push(ze(e,t,n,r,i));return Ne(t,o,n,r,i,l),g?(g=!1,!0):(e&&e.PrintAreas&&0===e.PrintAreas.length&&(e.PrintAreas=void 0),t&&t.PrintAreas&&0===t.PrintAreas.length&&(t.PrintAreas=void 0),!1)},t.doesMergedCellOverlapMultipleRowCol=P},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeBorderFromMergeCellAdjacentCells=t.getAdjacentEdgeCellsWithNewLeftOrTopBorder=t.getOrCreateAdjacentCells=t.addRightOrBottomBorderToAdjacentCells=t.getAdjacentCellsOfMergedCell=t.processMergedCellBorders=t.removeBordersFromAdjacentCells=t.updateMergedCellHeight=t.updateMergedCellWidth=t.getMergedCellUpdatedWidthOrHeight=t.isMergedCellSpanningAcrossBlocksVerticallyAndHorizontally=t.doesMergedCellSpansPrevBlockHorizontally=t.doesMergedCellSpansPrevBlockVertically=t.doesMergedCellSpansNextBlockVertically=t.doesMergedCellSpansNextBlockHorizontally=t.getBorderAtPosition=t.duplicateBorder=t.cascadeMergeCellSpanningBlocksFully=t.updateMergeCellInfoForColumn=t.updateMergeInfoForRow=t.updateMergeInfoForSrcModelCell=t.updateSrcModelMergeCellSpanningBlocks=t.resetMergeCellInfo=t.isCellAdjacentToMergedCell=t.changeBorderForMergedCellSpanningBlocks=t.isHideColMergedCellAcrossBlocksEnabled=void 0;const o=n(1),r=n(0),i=n(100);function l(e,t,n,o){return e===n&&(t===o+1||t===o-1)||t===o&&(e===n+1||e===n-1)}function a(e){return _object_spread_props(_object_spread({},e),{SpansBlocks:!1,Width:0,Height:0,OriginDeltaX:0,OriginDeltaY:0,OriginRow:void 0,OriginColumn:void 0,WidthAdjustedForDrawing:void 0,HeightAdjustedForDrawing:void 0,OriginDeltaXAdjustedForDrawing:void 0,OriginDeltaYAdjustedForDrawing:void 0,SpansNextBlockHorizontally:void 0,SpansNextBlockVertically:void 0})}function s(e,t,n,o,r,i,l,a){a?d(e,t,n,o,r,i,l):c(e,t,n,o,r,i,l)}function d(e,t,n,o,r,i,l){e.Rows-=i+l-t.Row+1,e.OriginDeltaY=p(o.RowHeights,t.Row,i+l)+p(r.RowHeights,n.Row,n.Row+n.Merge.Rows),n.Merge.Rows+=l+1,e.Height=n.Merge.Height}function c(e,t,n,o,r,i,l){e.Columns-=i+l-t.Col+1,e.OriginDeltaX=p(o.ColumnWidths,t.Col,i+l)+p(r.ColumnWidths,n.Col,n.Col+n.Merge.Columns),n.Merge.Columns+=l+1,e.Width=n.Merge.Width}function u(e){return{BorderLineStyle:e.BorderLineStyle,BorderPosition:e.BorderPosition,Color:e.Color,Weight:e.Weight}}function g(e,t,n){const r=(0,o.getBorderStyleByID)(e,t);for(const e of r.Borders)if(e.BorderPosition===n)return e;return null}function h(e,t){const n=e.Merge;return t.ColumnOffsets[e.Col]-n.OriginDeltaX+n.Width>t.BlockWidth}function C(e,t){const n=e.Merge;return t.RowOffsets[e.Row]-n.OriginDeltaY+n.Height>t.BlockHeight}function f(e){if(!e)return!1;const t=e.Merge;return!(0!==e.Row||!t||!t.SpansBlocks)&&e.Row!==t.OriginRow&&t.Height>t.OriginDeltaY}function m(e){if(!e)return!1;const t=e.Merge;return!(0!==e.Col||!t||!t.SpansBlocks)&&e.Col!==t.OriginColumn&&t.Width>t.OriginDeltaX}function p(e,t,n){let o=0;for(let r=t;r<=n;r++)o+=e[r];return o}function y(e,t,n){const i=n?o.BorderPositionType.Bottom:o.BorderPositionType.Right;for(const n of e)(0,r.removeBorderFromCell)(n,t,i)}function S(e,t,n){const r=[];switch(n){case o.BorderPositionType.Top:for(const n of t)n.Row===e.Row-1&&r.push(n);break;case o.BorderPositionType.Bottom:for(const n of t)n.Row===e.Row+1&&r.push(n);break;case o.BorderPositionType.Left:for(const n of t)n.Col===e.Col-1&&r.push(n);break;case o.BorderPositionType.Right:for(const n of t)n.Col===e.Col+1&&r.push(n)}return r}function R(e,t,n){const r=[];if(n)for(let n=e.Col;n<=e.Col+e.Merge.Columns;n++)r.push((0,o.getOrCreateCell)(t,e.Row+e.Merge.Rows+1,n));else for(let n=e.Row;n<=e.Row+e.Merge.Rows;n++)r.push((0,o.getOrCreateCell)(t,n,e.Col+e.Merge.Columns+1));return r}function F(e,t,n){const r=n?o.BorderPositionType.Top:o.BorderPositionType.Left,i=S(e,t.Cells,r);i.length>0&&y(i,t,n)}function T(e,t,n,r,i,l){let a={};const s=l?r.Borders.findIndex(e=>e.BorderPosition===o.BorderPositionType.Bottom):r.Borders.findIndex(e=>e.BorderPosition===o.BorderPositionType.Right);return-1!==s&&(a=u(r.Borders[s]),r.Borders.splice(s,1),e.BorderStyleID=n,t.BorderStyles.push(r),i&&(e.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID(r))),a}function w(e,t,n){const r=g(e,t,n?o.BorderPositionType.Right:o.BorderPositionType.Bottom);return r?u(r):{}}function I(e){return e.filter(e=>e.Merge&&e.Merge.SpansBlocks)}t.isHideColMergedCellAcrossBlocksEnabled=(0,o.isChangeGateEnabled)(o.ChangeGate.HideColMergedCellAcrossBlocks),t.changeBorderForMergedCellSpanningBlocks=function(e,t,n,i=!1){const a=(0,o.isGlobalBorderStylesEnabled)(e),s=I(t);if(0!==s.length)for(const d of s){const s=(0,r.getLastBorderStyleID)(e)+1,c=(0,r.duplicateBorderStyle)((0,o.getBorderStyleByID)(d,e),s,1),u=T(d,e,s,c,a,n);for(const i of t)if(l(i.Row,i.Col,d.Row,d.Col)&&(i.Row===d.Row-1||i.Col===d.Col-1)){const t=w(i,e,n);if(Object.keys(t).length>0){t.BorderPosition=n?o.BorderPositionType.Left:o.BorderPositionType.Top,c.Borders.splice(0,0,t);const l=(0,r.getLastBorderStyleID)(e)+1;c.ID=l,d.BorderStyleID=l,e.BorderStyles.push(c),a&&(d.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID(c));const s=n?o.BorderPositionType.Right:o.BorderPositionType.Bottom;(0,r.removeBorderFromCell)(i,e,s)}}const g=i?[]:R(d,e,n);if(Object.keys(u).length>0){const t=n?o.BorderPositionType.Top:o.BorderPositionType.Left;u.BorderPosition=t;for(const n of g)(0,r.attachCellToModel)(n,e),(0,r.addBorderToCellIfNotPresent)(n,e,u,t)}}},t.isCellAdjacentToMergedCell=l,t.resetMergeCellInfo=a,t.updateSrcModelMergeCellSpanningBlocks=function(e,t,n,o,r,i){const l=e.Merge,a=n.Cells.find(t=>(i?t.Col===e.Col:t.Row===e.Row)&&t.Merge&&t.Merge.SpansBlocks&&(i?t.Row>0:t.Col>0));a&&s(l,e,a,t,n,o,r,i)},t.updateMergeInfoForSrcModelCell=s,t.updateMergeInfoForRow=d,t.updateMergeCellInfoForColumn=c,t.cascadeMergeCellSpanningBlocksFully=function(e,n,i,l,s,d,c,p){if(!t.isHideColMergedCellAcrossBlocksEnabled)return;const y=n.Cells.find(e=>(p?e.Col===i.Col:e.Row===i.Row)&&e.Merge&&e.Merge.SpansBlocks&&(p?e.Row>0:e.Col>0));p?y.Merge.Rows+=i.Merge.Rows+1:y.Merge.Columns+=i.Merge.Columns+1;const S=p?!(y.Row+y.Merge.Rows===n.RowNumbers[n.RowNumbers.length-1]):!(y.Col+y.Merge.Columns===n.ColumnNumbers[n.ColumnNumbers.length-1]),R=h(y,n)||m(y),F=C(y,n)||f(y);!S||R&&F||(y.Merge=a(y.Merge));const T=g(i,e,p?o.BorderPositionType.Bottom:o.BorderPositionType.Right);if(T){const t=e.BorderStyles.length,a=n.BorderStyles.length+d.length,g=(0,r.duplicateBorderStyle)((0,o.getBorderStyleByID)(y,n),a,1);p?g.Borders.splice(0,0,T):g.Borders.push(T),n.BorderStyles.push(g),y.BorderStyleID=a,c&&(y.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID(g));const h=u(T);h.BorderPosition=p?o.BorderPositionType.Top:o.BorderPositionType.Left;const C=[],f=i.Col+i.Merge.Columns,m=i.Row+i.Merge.Rows;if(p)for(let t=i.Col;t<=f;t+=1)C.push((0,o.getDefaultCell)(m+1,t,e.Styles,e.Fonts));else for(let t=i.Row;t<=m;t+=1)C.push((0,o.getDefaultCell)(t,f+1,e.Styles,e.Fonts));const S=(0,r.duplicateBorderStyle)((0,o.getBorderStyleByID)(C[0],e),t,1);S.Borders.push(h),e.BorderStyles.push(S);for(const e of C)p?e.Row-=l+1:e.Col-=l+1,s.push(e),e.BorderStyleID=t,c&&(e.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID(S))}},t.duplicateBorder=u,t.getBorderAtPosition=g,t.doesMergedCellSpansNextBlockHorizontally=h,t.doesMergedCellSpansNextBlockVertically=C,t.doesMergedCellSpansPrevBlockVertically=f,t.doesMergedCellSpansPrevBlockHorizontally=m,t.isMergedCellSpanningAcrossBlocksVerticallyAndHorizontally=function(e){const t=I(e.Cells);if(0===t.length)return!1;for(const n of t)if(h(n,e)&&C(n,e))return!0;return!1},t.getMergedCellUpdatedWidthOrHeight=p,t.updateMergedCellWidth=function(e,t,n,o){for(let r=e;r<t;r++)n.Width-=o.ColumnWidths[r]},t.updateMergedCellHeight=function(e,t,n,o){for(let r=e;r<t;r++)n.Height-=o.RowHeights[r]},t.removeBordersFromAdjacentCells=y,t.processMergedCellBorders=function(e,t,n,i,l){0!==(0,o.getBorderStyleByID)(e,t).Borders.length&&(!l||i!==e.Col&&i!==e.Row?l||(0,r.removeBorderFromCell)(e,t,n?o.BorderPositionType.Bottom:o.BorderPositionType.Right):F(e,t,n))},t.getAdjacentCellsOfMergedCell=S,t.addRightOrBottomBorderToAdjacentCells=function(e,t,n){const i=n?o.BorderPositionType.Top:o.BorderPositionType.Left,l=g(e,t,i);if(!l||0===Object.keys(l).length)return;const a=S(e,t.Cells,i),s=u(l);(0,r.removeBorderFromCell)(e,t,i),s.BorderPosition=n?o.BorderPositionType.Bottom:o.BorderPositionType.Right;for(const e of a)(0,r.addBorderToCellIfNotPresent)(e,t,s,s.BorderPosition)},t.getOrCreateAdjacentCells=R,t.getAdjacentEdgeCellsWithNewLeftOrTopBorder=function(e,t,n,l){const a=g(e,n,l?o.BorderPositionType.Bottom:o.BorderPositionType.Right);if(!a)return[];const s=u(a);s.BorderPosition=l?o.BorderPositionType.Top:o.BorderPositionType.Left;const d=(0,i.duplicateCell)(e);l?d.Row=0:d.Col=0;const c=R(d,t,l);for(const e of c)l?e.Row=0:e.Col=0,(0,r.attachCellToModel)(e,t),(0,r.addBorderToCellIfNotPresent)(e,t,s,s.BorderPosition);return c},t.removeBorderFromMergeCellAdjacentCells=F},function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return p}));const o="UnavailabilityToast";class r{setVisibility(e){this.toastElement.style.visibility=e?"visible":"hidden"}dispose(){var e;null===(e=this.toastElement.parentNode)||void 0===e||e.removeChild(this.toastElement)}setTitle(e){e?this.toastTitleElement?this.toastTitleElement.innerText=e:(this.toastTitleElement=this.createToastTitle(e),this.toastElement.appendChild(this.toastTitleElement)):this.toastTitleElement&&(this.toastElement.removeChild(this.toastTitleElement),this.toastTitleElement=void 0)}setMessage(e){e?this.toastMessageElement?this.toastMessageElement.innerText=e:(this.toastMessageElement=this.createToastMessage(e),this.toastElement.appendChild(this.toastMessageElement)):this.toastMessageElement&&(this.toastElement.removeChild(this.toastMessageElement),this.toastMessageElement=void 0)}setIcon(e,t){this.hasSpinner=!!t,this.toastElement.removeChild(this.toastIconElement),this.toastIconElement=this.createToastIcon(e),this.toastElement.insertBefore(this.toastIconElement,this.toastElement.firstChild)}createToastContainer(){const e=document.createElement("div");return e.id=o,e.setAttribute("role","alert"),e.setAttribute("style",'display: flex;\n      visibility: hidden;\n      padding: 12px 16px;\n      background-color: #FFF4CE;\n      color: #484644;\n      font-size: 14px;\n      line-height: 20px;\n      box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.19);\n      border-radius: 4px;\n      font-family: "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif;\n      -webkit-touch-callout: none;\n      -webkit-user-select: none;\n      -moz-user-select: none;\n      -ms-user-select: none;\n      user-select: none;\n      pointer-events: auto;\n      border: 2px solid transparent;'),e.appendChild(this.toastIconElement),e}createToastIcon(e){const t=document.createElement("span");if(t.id="UnavailabilityToastIcon",this.hasSpinner)!function(e,t){const n=document.createElement("div");n.id="UnavailbilitySpinner",n.setAttribute("style","border: 1.5px solid black;\n    border-top: 1.5px solid gray;\n    border-radius: 100%;\n    font-size: 12px;\n    width: 20px;\n    height: 20px;\n    -webkit-animation: spin 1.2s linear infinite; /* Safari */\n    animation: spin 1.2s linear infinite;"),t?n.style.marginLeft="7px":n.style.marginRight="7px";const o=document.createElement("style");o.type="text/css";const r=document.createTextNode("  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    20% { transform: rotate(50deg); }\n    70% { transform: rotate(270deg); }\n    100% { transform: rotate(360deg); }\n  }\n  \n  @-webkit-keyframes spin {\n    0% { -webkit-transform: rotate(0deg); }\n    20% { -webkit-transform: rotate(50deg); }\n    70% { -webkit-transform: rotate(270deg); }\n    100% { -webkit-transform: rotate(360deg); }\n  }\n  ");o.appendChild(r),n.appendChild(o),e.appendChild(n)}(t,this.isRTL);else{const n=null!=e?e:this.OpenWorkbookIcon;t.setAttribute("style",`display: inline-block;\n        height: 20px;\n        width: 20px;\n        background-repeat: no-repeat;\n        background-image: url("data:image/svg+xml;charset=utf8,${n}");`+this.elementsMargin)}return t}createToastTitle(e){const t=document.createElement("span");return t.id="UnavailabilityToastTitle",t.innerText=e,t.setAttribute("style","font-weight: 600;"+this.elementsMargin),t}createToastMessage(e){const t=document.createElement("span");return t.id="UnavailabilityToastText",t.innerText=e,t}constructor(e,t,n,o,r,i){this.OpenWorkbookIcon="%3Csvg%20width%3D%2220%22%20height%3D%2218%22%20viewBox%3D%220%200%2020%2018%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0D%0A%3Cpath%20d%3D%22M8.17383%207.24219C8.02409%207.48307%207.84831%207.70443%207.64648%207.90625C7.45117%208.10156%207.23307%208.27409%206.99219%208.42383L7.49023%209.63477L6.33789%2010.1035L5.83984%208.90234C5.57943%208.96745%205.29948%209%205%209C4.70052%209%204.42057%208.96745%204.16016%208.90234L3.66211%2010.1035L2.50977%209.63477L3.00781%208.42383C2.76693%208.27409%202.54557%208.10156%202.34375%207.90625C2.14844%207.70443%201.97591%207.48307%201.82617%207.24219L0.615234%207.74023L0.146484%206.58789L1.34766%206.08984C1.28255%205.82943%201.25%205.54948%201.25%205.25C1.25%204.95052%201.28255%204.67057%201.34766%204.41016L0.146484%203.91211L0.615234%202.75977L1.82617%203.25781C2.12565%202.76953%202.51953%202.37565%203.00781%202.07617L2.50977%200.865234L3.66211%200.396484L4.16016%201.59766C4.42057%201.53255%204.70052%201.5%205%201.5C5.29948%201.5%205.57943%201.53255%205.83984%201.59766L6.33789%200.396484L7.49023%200.865234L6.99219%202.07617C7.48047%202.37565%207.87435%202.76953%208.17383%203.25781L9.38477%202.75977L9.85352%203.91211L8.65234%204.41016C8.71745%204.67057%208.75%204.95052%208.75%205.25C8.75%205.54948%208.71745%205.82943%208.65234%206.08984L9.85352%206.58789L9.38477%207.74023L8.17383%207.24219ZM5%207.75C5.34505%207.75%205.66732%207.6849%205.9668%207.55469C6.27279%207.42448%206.53971%207.24544%206.76758%207.01758C6.99544%206.78971%207.17448%206.52604%207.30469%206.22656C7.4349%205.92057%207.5%205.59505%207.5%205.25C7.5%204.90495%207.4349%204.58268%207.30469%204.2832C7.17448%203.97721%206.99544%203.71029%206.76758%203.48242C6.53971%203.25456%206.27279%203.07552%205.9668%202.94531C5.66732%202.8151%205.34505%202.75%205%202.75C4.65495%202.75%204.32943%202.8151%204.02344%202.94531C3.72396%203.07552%203.46029%203.25456%203.23242%203.48242C3.00456%203.71029%202.82552%203.97721%202.69531%204.2832C2.5651%204.58268%202.5%204.90495%202.5%205.25C2.5%205.59505%202.5651%205.92057%202.69531%206.22656C2.82552%206.52604%203.00456%206.78971%203.23242%207.01758C3.46029%207.24544%203.72396%207.42448%204.02344%207.55469C4.32943%207.6849%204.65495%207.75%205%207.75ZM18.75%2012.125C18.75%2012.4831%2018.7044%2012.8444%2018.6133%2013.209L19.9512%2013.7559L19.4824%2014.918L18.1348%2014.3613C17.7507%2014.9993%2017.2428%2015.5072%2016.6113%2015.8848L17.168%2017.2227L16.0059%2017.7012L15.459%2016.3633C15.0944%2016.4544%2014.7331%2016.5%2014.375%2016.5C14.0169%2016.5%2013.6556%2016.4544%2013.291%2016.3633L12.7441%2017.7012L11.582%2017.2227L12.1387%2015.8848C11.5007%2015.5072%2010.9928%2014.9993%2010.6152%2014.3613L9.26758%2014.918L8.79883%2013.7559L10.1367%2013.209C10.0456%2012.8444%2010%2012.4831%2010%2012.125C10%2011.7669%2010.0456%2011.4056%2010.1367%2011.041L8.79883%2010.4941L9.26758%209.33203L10.6152%209.88867C10.9928%209.25716%2011.5007%208.74935%2012.1387%208.36523L11.582%207.01758L12.7441%206.54883L13.291%207.88672C13.6556%207.79557%2014.0169%207.75%2014.375%207.75C14.7331%207.75%2015.0944%207.79557%2015.459%207.88672L16.0059%206.54883L17.168%207.01758L16.6113%208.36523C17.2428%208.74935%2017.7507%209.25716%2018.1348%209.88867L19.4824%209.33203L19.9512%2010.4941L18.6133%2011.041C18.7044%2011.4056%2018.75%2011.7669%2018.75%2012.125ZM14.375%2015.25C14.8047%2015.25%2015.2083%2015.1686%2015.5859%2015.0059C15.9635%2014.8431%2016.2923%2014.6217%2016.5723%2014.3418C16.8587%2014.0553%2017.0833%2013.7233%2017.2461%2013.3457C17.4154%2012.9616%2017.5%2012.5547%2017.5%2012.125C17.5%2011.6953%2017.4154%2011.2917%2017.2461%2010.9141C17.0833%2010.5365%2016.8587%2010.2077%2016.5723%209.92773C16.2923%209.64128%2015.9635%209.41667%2015.5859%209.25391C15.2083%209.08464%2014.8047%209%2014.375%209C13.9453%209%2013.5384%209.08464%2013.1543%209.25391C12.7767%209.41667%2012.4447%209.64128%2012.1582%209.92773C11.8783%2010.2077%2011.6569%2010.5365%2011.4941%2010.9141C11.3314%2011.2917%2011.25%2011.6953%2011.25%2012.125C11.25%2012.5547%2011.3314%2012.9616%2011.4941%2013.3457C11.6569%2013.7233%2011.8783%2014.0553%2012.1582%2014.3418C12.4447%2014.6217%2012.7767%2014.8431%2013.1543%2015.0059C13.5384%2015.1686%2013.9453%2015.25%2014.375%2015.25Z%22%20fill%3D%22%23797775%22%2F%3E%0D%0A%3C%2Fsvg%3E",this.hasSpinner=null!=i&&i,this.isRTL=o,this.elementsMargin=o?"margin-left: 8px;":"margin-right: 8px;",this.toastIconElement=this.createToastIcon(r),this.toastElement=this.createToastContainer(),this.setTitle(t),this.setMessage(n),e.appendChild(this.toastElement)}}class i{static createInstance(e,t,n,o,i,l){return new r(e,t,n,o,i,l)}}var l=n(51),a=n(80),s=n(16);const d=(e,t)=>t;var c=n(142);const u={},g=e=>{return n=()=>new Set("".toLowerCase().trim().split(",").map(e=>e.trim()).filter(e=>Boolean(e))),u[t=e]&&u[t].size||(u[t]=n()),u[t];var t,n},h=(e,t)=>"string"==typeof t?((e,t)=>e.indexOf(t)>-1)(e,t):((e,t)=>t.filter(t=>h(e,t)).length>0)(e,t),C=["SharedOnline.","WordOnline.","ExcelOnline.","PowerPointOnline.","OneNoteOnline.","VisioOnline."],f=e=>{(e=>{if(!(e=>(e=>C.filter(t=>0===e.indexOf(t)&&e.length>t.length).length>0)(e)&&h(e,".ChangeGate."))(e)){const t=`Change Gate Name validation failed: ${e} should follow change gate naming convention.`;throw l.a.shipAssertTag(538972812,a.a.msoulscat_Wac_Ribbon,!1,t),Error(t)}})(e);const t=e.toLowerCase();return!!d(0,"").toLowerCase().includes(t)||!d(0,"").toLowerCase().includes(t)&&!g("SharedUxSafeVelocityStoppedGates").has(t)&&Object(c.isChangeGateEnabled)(e)};let m;class p{static getInstance(){return m||(m=new p),m}showToast(e,t,n,o,r,l,a,s){if(!this.isToastVisible()||s){if(this.toast)this.toast.setIcon(o,r),this.toast.setTitle(e),this.toast.setMessage(t);else{const a=document.createElement("div");a.setAttribute("style",(e=>`position: absolute;\n        display: flex;\n        z-index: 2000;\n        left: 0px;\n        right: 0px;\n        top: ${e?"40px":"8px"};\n        margin: auto;\n        align-items: center;\n        justify-content: center;\n        pointer-events: none;\n        opacity : 0;\n        transition: opacity 0.35s;\n        transition-timing-function: ease-in;`)(l)),document.body.appendChild(a),this.toast=i.createInstance(a,e,t,n,o,r),requestAnimationFrame(()=>{a.style.opacity="1"})}this.isToastVisible()||(this.toast.setVisibility(!0),this.isVisible=!0),this.logToastVisibilityChange(!0,a),this.displayTime=window.performance.now()}}dismissToast(e){var t;this.isToastVisible()&&(null===(t=this.toast)||void 0===t||t.setVisibility(!1),this.isVisible=!1,this.logToastVisibilityChange(!1,e),this.displayTime=void 0)}isToastVisible(){var e,t;return f("SharedOnline.ChangeGate.IsToastVisibleModified")?this.isVisible||"visible"===(null===(t=document.getElementById(o))||void 0===t?void 0:t.style.visibility)&&!function e(t,n){return t?n(t)?t:e(t.parentElement,n):null}(document.getElementById(o),e=>"none"===getComputedStyle(e).display):this.isVisible||"visible"===(null===(e=document.getElementById(o))||void 0===e?void 0:e.style.visibility)}logToastVisibilityChange(e,t){let n="Unavailability Toast Visibility Changed: "+(e?"Shown":"Dismissed");!e&&this.displayTime&&(n+=", Duration Visible: "+Math.trunc(window.performance.now()-this.displayTime)),t&&(n+=", Kind: "+t),l.a.sendTraceTag(537249949,a.a.msoulscat_Wac_Telemetry,s.a.Info,n)}constructor(){this.toast=void 0,this.isVisible=!1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(61);o.__exportStar(n(251),t),o.__exportStar(n(252),t)},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;const o=n(82);t.makeGetTypedFeatureGate=function(e){return function(t){const n=e[t];switch(typeof n){case"boolean":return(0,o.getBooleanFeatureGate)(t,n);case"number":return(0,o.getNumberFeatureGate)(t,n);case"string":return(0,o.getStringFeatureGate)(t,n);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;const o=n(83);t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,o.isChangeGateEnabled)(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;const o=n(83);function r(e){const t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)(()=>_object_spread({},void 0!==t?t():{},e)),t}t.overrideChangeGates=r,t.overrideTypedChangeGates=function(e,t){return r(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;const o=n(82);function r(e){var t;const n={};for(const t of Object.keys(e)){var r;n[t]=null===(r=e[t])||void 0===r?void 0:r.toString()}const i=null!==(t=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==t?t:()=>({});return(0,o.setFeatureGateDictionaryGetter)(()=>_object_spread({},i(),n)),i}t.overrideFeatureGates=r,t.overrideTypedFeatureGates=function(e,t){return r(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.duplicateOnlyStyleWithoutFont=void 0;const o=n(24);t.duplicateOnlyStyleWithoutFont=function(e,t,n){return{BackgroundColor:e.BackgroundColor,HorizontalAlignment:e.HorizontalAlignment||o.HorizontalAlignment.Automatic,ID:t||0,GlobalId:e.GlobalId,NamedStyleId:e.NamedStyleId||0,RefCount:n||0,VerticalAlignment:e.VerticalAlignment,Indentation:e.Indentation||0,IsUnlocked:e.IsUnlocked,IsHidden:e.IsHidden,ReadingOrder:e.ReadingOrder||o.ReadingOrderType.Context,FontID:e.FontID||0,GlobalFontID:e.GlobalFontID||0,ShrinkToFit:e.ShrinkToFit,Gradient:e.Gradient,Orientation:e.Orientation||0,VerticalText:e.VerticalText||!1,PatternStyle:e.PatternStyle||0,PatternColor:e.PatternColor}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trackDuration=t.verifyPerformanceNowSupported=t.perf=void 0;let o=void 0;function r(){if(o)return o;o=!1,window.performance&&"function"==typeof window.performance.now&&(o=!0);try{window.performance.now()}catch(e){o=!1}return o}t.perf=r()?window.performance:void 0,t.verifyPerformanceNowSupported=r,t.trackDuration=function(e){const n=t.perf?t.perf.now():-1;return e(),t.perf?t.perf.now()-n:-1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CalcBlockModel=void 0;const o=n(42),r=n(25),i=n(24),l=n(11);let a=void 0;t.CalcBlockModel=class{createCell(e){let t=void 0,n=i.CellValueType.None,o=void 0,r=void 0,s=i.CellFormulaType.Value,d=i.RichValueCellType.None;var c,u,g;return e.Merge&&!e.Merge.IsOrigin||(t=e.Value,n=e.ValueType,o=e.Text,r=null===(c=e.FormulaInfo)||void 0===c?void 0:c.Formula,s=e.FormulaInfo?e.FormulaInfo.FormulaType:i.CellFormulaType.Value,d=null!==(u=e.RichValueType)&&void 0!==u?u:i.RichValueCellType.None),void 0===a&&(a=(0,l.getBooleanFeatureGate)("Microsoft.Office.Excel.CalcCellRichValueType",!1)),a||(o=e.Text,r=null===(g=e.FormulaInfo)||void 0===g?void 0:g.Formula),{col:e.Col,row:e.Row,text:o,formula:r,valueType:n,value:t,ifmt:e.Ifmt||0,formulaType:s,richValueType:d}}addCell(e){if(-1!==this.index)throw"cannot add cell after iterating cells";this.Cells[(0,o.getCellLookupKey)(e.row,e.col)]=e,this.keys=null}addHeaders(e,t){this.RowNumbers=e,this.ColumnNumbers=t}getRowNumbers(){return this.RowNumbers}getColumnNumbers(){return this.ColumnNumbers}getCell(e,t){return(0,r.isNullOrUndefined)(this.Cells)?null:this.Cells[(0,o.getCellLookupKey)(e,t)]}reset(){this.index=0,(0,r.isNullOrUndefined)(this.keys)&&(this.keys=Object.keys(this.Cells))}getNextCell(){if((0,r.isNullOrUndefined)(this.Cells)||(0,r.isNullOrUndefined)(this.keys))return null;if(-1===this.index)return null;if(this.index>=this.keys.length)return null;const e=this.Cells[this.keys[this.index]];return this.index++,e}constructor(){this.RowNumbers=[],this.ColumnNumbers=[],this.Cells={},this.index=-1,this.keys=null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRowHeaderStylesArray=t.createHeaderCell=t.calculateRowHeaderWidth=t.columnNumberToTitle=t.createHeaderBlockModel=void 0;const o=n(24),r=n(42),i=n(25),l=n(106),a=n(7),s=n(26),d=n(34);function c(e){if(e)for(const t of e)t&&(t.GlobalId=void 0)}function u(e){let t=e-1;const n=[];for(;t>=0;)n.unshift(String.fromCharCode(l.LetterA+t%l.AlphaRadix)),t=Math.floor(t/l.AlphaRadix)-1;return n.join("")}function g(e,t){return(Math.max(l.MaxNumberOfDigitsInDefaultRowHeader,e)-l.MaxNumberOfDigitsInDefaultRowHeader)*l.RowWidthExtensionPerDigitPx+(t?l.RowHeaderWidthWithDragSquaresArea:l.DefaultRowHeaderWidth)}function h(e,t,n,r,i){const l=!r||i?0:1,a=i?"":function(e,t){return t?e.toString():u(e)}(t,n);return{Row:n?e:l,Col:n?l:e,StyleID:o.UniqueHeadersStyleID.Default,BorderStyleID:o.UniqueHeadersStyleID.Default,HorizontalAlignmentSet:!1,ValueType:o.CellValueType.String,Text:a}}function C(e,t){let n;switch(e){case o.ViewMode.Default:n=l.RowHeadersStylesArray;break;case o.ViewMode.NamedSheetView:n=l.RowHeadersNSVStylesArray;break;case o.ViewMode.PresentMode:default:throw Error("headerBlockModelCreator.getModelStyles: unsupported ViewMode")}return n.map(e=>_object_spread_props(_object_spread({},e),{HorizontalAlignment:t&&e.HorizontalAlignment===o.HorizontalAlignment.Left?o.HorizontalAlignment.Right:t&&e.HorizontalAlignment===o.HorizontalAlignment.Right?o.HorizontalAlignment.Left:e.HorizontalAlignment}))}function f(e,t,n){const o=t?e.RowNumbers:e.ColumnNumbers;e.Cells=[];const r=n>0,i=[];for(let n=0;n<o.length;n++){const l=h(n,o[n],t,r,!1);if(e.Cells.push(l),r){const e=h(n,o[n],t,r,!0);i.push(e)}}r&&e.Cells.push(...i)}function m(e,t,n){const i=(0,r.isIncreasedHeaderSizeEnabled)(e);let a;switch(t){case o.ViewMode.Default:return a=i?C(o.ViewMode.Default,e.IsRtl):l.RowHeadersStylesArrayBeforeHeaderDragImprovements,n?a:l.ColumnHeadersStylesArray;case o.ViewMode.NamedSheetView:return a=i?C(o.ViewMode.NamedSheetView,e.IsRtl):l.RowHeadersNSVStylesArrayBeforeHeaderDragImprovements,n?a:l.ColumnHeadersNSVStylesArray;case o.ViewMode.PresentMode:default:throw Error("headerBlockModelCreator.getModelStyles: unsupported ViewMode")}}function p(e,t){const n=(0,s.isRenderFlagEnabled)(o.RenderFlagsArray.NewDefaultTemplate,e)&&(0,s.isRenderFlagEnabled)(o.RenderFlagsArray.NewThemeFontForHeaderFBarNBox,e)&&document.fonts.check("11pt "+l.DefaultHeaderFont);switch(t){case o.ViewMode.Default:return n?l.HeadersFonts:l.OldHeadersFonts;case o.ViewMode.NamedSheetView:return n?l.HeadersNSVFonts:l.OldHeadersNSVFonts;case o.ViewMode.PresentMode:default:throw Error("headerBlockModelCreator.getModelFonts: unsupported ViewMode")}}function y(e){return(0,s.verifyArgumentNotNull)(e,"array","headerBlockModel.duplicateArray"),[...e]}function S(e,t,n){return t?e.BlockHeight:(0,r.isIncreasedHeaderSizeEnabled)(e)?l.ColHeaderHeightWithDragSquaresArea+n:l.DefaultColHeaderHeight+n}function R(e,t,n){return t?function(e,t,n){const o=e.length-1;return e[o]?g(e[o].toString().length,n)+t:(a.ULS.sendTraceTag(508966366,a.LogCategory.msoulscat_ES_EWAJSGrid,a.TraceLevel.Warning,`HeaderBlockModelCreator.getRowHeaderWidth: rowNumbers[lastRowIndex] is undefined, rowNumbers.length: ${e.length}, lastRowIndex: ${o}, rowNumbers: ${e}`),0)}(e.RowNumbers,n,(0,r.isIncreasedHeaderSizeEnabled)(e)):e.BlockWidth}t.createHeaderBlockModel=function(e,t,n){(0,s.verifyArgumentNotNull)(e,"gridModel","headerBlockModel.createHeaderBlockModel");const o=function(e,t){const n=t?e.MaxRowOutlineLevelInSheet:e.MaxColOutlineLevelInSheet;return(0,i.isNullOrUndefined)(n)||0===n?0:l.GroupingFirstLevelExtensionPx+(n-1)*l.GroupingLevelExtensionPx}(e,t),a={RenderFlagsArray:y(e.RenderFlagsArray),BlockHeight:S(e,t,o),BlockWidth:R(e,t,o),IsRtl:e.IsRtl,ShowGridLines:!0,Fonts:p(e,n),Styles:m(e,n,t),ShowHeaders:e.ShowHeaders,AdjacentBlocksHiddensInfo:(u=e.AdjacentBlocksHiddensInfo,u?_object_spread({},u):u),IsRow:t,PermissionSet:e.PermissionSet,RibbonCommands:e.RibbonCommands};var u;return(0,r.isIncreasedHeaderSizeEnabled)(a)&&(c(a.Fonts),c(a.Styles)),(0,d.isChangeGateEnabled)(d.ChangeGate.RestrictStylesPreProcess)&&(a.AreStylesProcessed=!1),t?function(e,t,n){return function(e,t,n){var o;t.RowNumbers=y(e.RowNumbers),t.RowOffsets=y(e.RowOffsets),t.RowHeights=y(e.RowHeights),n>0&&(t.RowOutlinesInformation=(0,r.cloneOutlines)(e.RowOutlinesInformation)),t.MaxRowOutlineLevelInSheet=null!==(o=e.MaxRowOutlineLevelInSheet)&&void 0!==o?o:0}(e,t,n),f(t,!0,n),function(e,t){if(0===t)e.ColumnNumbers=[0],e.ColumnOffsets=[0],e.ColumnWidths=[e.BlockWidth];else{e.ColumnNumbers=[0,1],e.ColumnOffsets=[0,t];const n=e.BlockWidth-t;e.ColumnWidths=[t,n]}}(t,n),t}(e,a,o):function(e,t,n){return function(e,t,n){var o;t.ColumnNumbers=y(e.ColumnNumbers),t.ColumnOffsets=y(e.ColumnOffsets),t.ColumnWidths=y(e.ColumnWidths),n>0&&(t.ColumnOutlinesInformation=(0,r.cloneOutlines)(e.ColumnOutlinesInformation)),t.MaxColOutlineLevelInSheet=null!==(o=e.MaxColOutlineLevelInSheet)&&void 0!==o?o:0}(e,t,n),f(t,!1,n),function(e,t){0===t?(e.RowNumbers=[0],e.RowOffsets=[0],e.RowHeights=(0,r.isIncreasedHeaderSizeEnabled)(e)?[l.ColHeaderHeightWithDragSquaresArea]:[l.DefaultColHeaderHeight]):(e.RowNumbers=[0,1],e.RowOffsets=[0,t],e.RowHeights=(0,r.isIncreasedHeaderSizeEnabled)(e)?[t,l.ColHeaderHeightWithDragSquaresArea]:[t,l.DefaultColHeaderHeight])}(t,n),t}(e,a,o)},t.columnNumberToTitle=u,t.calculateRowHeaderWidth=g,t.createHeaderCell=h,t.getRowHeaderStylesArray=C},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.annonymize=t.serializeModel=t.serializeCell=void 0;const o=n(65),r=n(157),i=n(42),l=n(34);let a=!1,s=[];function d(e){return e.toLowerCase().replace(r.DigitReplaceValue,r.CharacterReplaceValue).replace(r.Digit,r.DigitReplaceValue).replace(r.ValueAnnonymizerRegex,r.CharacterReplaceValue)}function c(e){return(t,n)=>n&&e&&e.indexOf(t)>-1?d(n):n}s=o.UserContentList.Cell.concat(o.UserContentList.GridBlockModel).concat(o.UserContentList.CellStyle).concat(o.UserContentList.Font).concat(o.UserContentList.BorderStyle).concat(o.UserContentList.AutoFilter).concat(o.UserContentList.PivotFilter).concat(o.UserContentList.MenuItem).concat(o.UserContentList.FormulaInformation).concat(o.UserContentList.NumberFormatInformation).concat(o.UserContentList.InCellControlType).concat(o.UserContentList.InCellControlOptions),t.serializeCell=function(e,t){if((0,l.isChangeGateEnabled)(l.ChangeGate.FixUserContentList)&&!a){s=[];for(const e in o.UserContentList)s=s.concat(o.UserContentList[e]);a=!0}return e&&t?(e.CachedStyle=(0,i.getReferencedObjectToCache)(e.StyleID||0,t.Styles),e.CachedBorderStyle=(0,i.getReferencedObjectToCache)(e.BorderStyleID||0,t.BorderStyles),e.CachedFont=(0,i.getReferencedObjectToCache)(e.CachedStyle.FontID||0,t.Fonts),s?JSON.stringify(e,c(s)):JSON.stringify(e)):""},t.serializeModel=function(e){if((0,l.isChangeGateEnabled)(l.ChangeGate.FixUserContentList)&&!a){s=[];for(const e in o.UserContentList)s=s.concat(o.UserContentList[e]);a=!0}return e?s?JSON.stringify(e,c(s)):JSON.stringify(e):""},t.annonymize=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Digit=t.ValueAnnonymizerRegex=t.CharacterReplaceValue=t.DigitPattern=t.DigitReplaceValue=t.AllowedCharactersToLog=t.SetCellOfInterestSymbols=t.CurrencySymbols=void 0,t.CurrencySymbols="$",t.SetCellOfInterestSymbols='=\\[\\]\\./%#\\-\\+,;\\(\\):?""&<>\'!{}~\\^\\*'+t.CurrencySymbols,t.AllowedCharactersToLog=t.SetCellOfInterestSymbols+"\\s",t.DigitReplaceValue="d",t.DigitPattern="[0-9]",t.CharacterReplaceValue="w",t.ValueAnnonymizerRegex=new RegExp("[^"+t.AllowedCharactersToLog+t.DigitReplaceValue+"]","gm"),t.Digit=new RegExp(t.DigitPattern,"gm")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.areGridObjectsEqual=t.areGridArraysEqual=t.areGridCellsEqual=t.getCellIgnoreList=t.getNonIgnoredPropertyNames=t.areMergeInformationEqual=t.areNumberFormatInformationEqual=t.areInCellControlOptionsEqual=t.areFormattedTextsEqual=t.areStylesEqual=t.comparePartialGridBlockModels=t.compareGridBlockModels=void 0;const o=n(42),r=n(107),i=n(26),l=n(108),a=n(11);let s,d,c,u,g,h,C,f,m,p,y,S,R,F,T,w,I,b,v,x,D=!1;function A(e,t){if(M(),"object"!=typeof e)return[];const n=Object.getOwnPropertyNames(e);return t?t instanceof Set?n.filter(e=>!t.has(e)):n.filter(e=>-1===t.indexOf(e)):n}function P(e,t){M();const n=(0,o.isAccAndCustomNumFmtApplicable)(e)&&(0,o.isAccAndCustomNumFmtApplicable)(t),r=t.DisplayFormula;let i;return i=n?r?I:b:r?v:x,i}function M(){D||(s=(0,l.getComparisonIgnoreLists)((0,a.getBooleanFeatureGate)("Microsoft.Office.Excel.IgnoreListFix",!1)),d=s.GridBlockModel.concat(["Cells"]).concat(s.RangeInformation).concat(s.PivotTableRangeInformation).concat(s.DynamicImageInformation).concat(s.Sparklines),c=s.Cell.concat(["Row","Col"]),u=c.concat(["Text"]),g=c.concat(["FormulaInfo"]),h=u.concat(["FormulaInfo"]),C=s.ReferencedObject,f=s.CellStyle.concat(C),m=f.concat(s.AutoFilter).concat(s.FormulaInformation).concat(s.MergeInformation).concat(s.TextRun).concat(s.Hyperlink).concat(s.LinkedEntityInformation).concat(s.PivotTableCellInformation),p=s.TextRun,y=[],S=[],R=[],F=p.concat(["Fonts"]),T=new Set(d),w=new Set([...d,"BlockWidth","BlockHeight","RowOffsets","ColumnOffsets","RowHeights","ColumnWidths","RowNumbers","ColumnNumbers"]),I=new Set([...u,...m]),b=new Set([...h,...m]),v=new Set([...c,...m]),x=new Set([...g,...m]),D=!0)}t.compareGridBlockModels=function(e,t,n){M();const o=T,i=(0,r.areObjectsEqual)(e,t,o,A,s);return i.isEqual?(0,r.compareModelCells)(e,t,n,A,P,s):{isEqual:i.isEqual,message:i.message,canDiffRender:!1,changedCellsKeys:void 0}},t.comparePartialGridBlockModels=function(e,t,n,o,l,a){M();const d=(0,r.areObjectsEqual)(e,t,w,A,s);if(!d.isEqual)return{isEqual:d.isEqual,message:d.message,canDiffRender:!1,changedCellsKeys:void 0};(0,i.verifyArgumentNotNull)(e.RowNumbers,"model1.RowNumbers","comparePartialGridBlockModels"),(0,i.verifyArgumentNotNull)(t.RowNumbers,"model2.RowNumbers","comparePartialGridBlockModels");const c=(0,r.getRowColIndexFromNumber)(e.RowNumbers,n),u=(0,r.getRowColIndexFromNumber)(e.RowNumbers,o),g=(0,r.comparePartialRowsInGridBlockModel)(e,t,c,u);if(!g.isEqual)return g;(0,i.verifyArgumentNotNull)(e.ColumnNumbers,"model1.ColumnNumbers","comparePartialGridBlockModels"),(0,i.verifyArgumentNotNull)(t.ColumnNumbers,"model2.ColumnNumbers","comparePartialGridBlockModels");const h=(0,r.getRowColIndexFromNumber)(e.ColumnNumbers,l),C=(0,r.getRowColIndexFromNumber)(e.ColumnNumbers,a),f=(0,r.comparePartialColumnsInGridBlockModel)(e,t,h,C);return f.isEqual?(0,r.comparePartialCellsInGridBlockModel)(e,t,c,u,h,C,A,P,s):f},t.areStylesEqual=function(e,t,n,o){return M(),(0,r.areObjectsEqual)(e,t,f,n,o)},t.areFormattedTextsEqual=function(e,t){if(M(),e&&t){if(e.TextRuns&&!e.Fonts)return{isEqual:!1,message:"couldn't compare formattedTexts, formattedText1 has Textruns without Fonts."};if(t.TextRuns&&!t.Fonts)return{isEqual:!1,message:"couldn't compare formattedTexts, formattedText2 has Textruns without Fonts."};(0,r.ensureCachedFontsInTextRuns)(e.TextRuns,e.Fonts),(0,r.ensureCachedFontsInTextRuns)(t.TextRuns,t.Fonts)}return(0,r.areObjectsEqual)(e,t,F,A,s)},t.areInCellControlOptionsEqual=function(e,t){return M(),(0,r.areObjectsEqual)(e,t,y,A,s)},t.areNumberFormatInformationEqual=function(e,t){return M(),(0,r.areObjectsEqual)(e,t,S,A,s)},t.areMergeInformationEqual=function(e,t){return M(),(0,r.areObjectsEqual)(e,t,R,A,s)},t.getNonIgnoredPropertyNames=A,t.getCellIgnoreList=P,t.areGridCellsEqual=function(e,t,n,o){return M(),(0,r.areCellsEqual)(e,t,n,o,A,P,s)},t.areGridArraysEqual=function(e,t,n){return M(),(0,r.areArraysEqual)(e,t,n,A,s)},t.areGridObjectsEqual=function(e,t,n,o){return M(),(0,r.areObjectsEqual)(e,t,n,A,s,o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compareHeaderBlockModels=void 0;const o=n(107),r=n(65),i=n(25),l=r.HeaderIncludeLists.GridBlockModel;function a(e,t){return(0,i.isNullOrUndefined)(t)?[]:t instanceof Array?t:Array.from(t)}function s(e,t){return r.HeaderIncludeLists.Cell.concat(r.HeaderIncludeLists.HeaderCell)}t.compareHeaderBlockModels=function(e,t){const n=(0,o.areObjectsEqual)(e,t,l,a,r.HeaderIncludeLists);return n.isEqual?(0,o.compareModelCells)(e,t,void 0,a,s,r.HeaderIncludeLists):{isEqual:!1,message:n.message,canDiffRender:!1,changedCellsKeys:void 0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCellLog=t.getRangeLog=t.getRangeTopLeftCell=t.isModelCellContainedInRange=t.isCellContainedInRange=void 0,t.isCellContainedInRange=function(e,t){return(!e.NamedObjectName&&!t.NamedObjectName||e.NamedObjectName===t.NamedObjectName)&&(!e.SheetName&&!t.SheetName||e.SheetName===t.SheetName)&&e.FirstColumn<=t.FirstColumn&&e.LastColumn>=t.FirstColumn&&e.FirstRow<=t.FirstRow&&e.LastRow>=t.FirstRow},t.isModelCellContainedInRange=function(e,t,n){const o=e.ColumnNumbers[n.Col],r=e.RowNumbers[n.Row];return t.FirstColumn<=o&&t.LastColumn>=o&&t.FirstRow<=r&&t.LastRow>=r},t.getRangeTopLeftCell=function(e){return{SheetName:e.SheetName,NamedObjectName:e.NamedObjectName,FirstRow:e.FirstRow,FirstColumn:e.FirstColumn}},t.getRangeLog=function(e){return`(${e.FirstRow}-${e.LastRow}, ${e.FirstColumn}-${e.LastColumn})`},t.getCellLog=function(e){return`(${e.FirstRow},${e.FirstColumn})`}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawSkeletonCells=t.drawSkeleton=void 0;const o=n(1),r=n(3),i=n(2),l=n(4),a=n(5),s=n(11);let d=void 0;function c(){return void 0===d&&(d=(0,s.getBooleanFeatureGate)("Microsoft.Office.Excel.SkeletonRectFillOnce",!1)),d}function u(e,t,n,o,r,i){const l=Math.min(o/4,16),a=Math.min(r/4,8),s=t+o/2-l/2,d=n+r/2-a/2;i?e.rect(s,d,l,a):e.fillRect(s,d,l,a)}t.drawSkeleton=function(e,t,n){(0,l.verifyArgumentNotNull)(e,"ctx","drawSkeleton"),(0,l.verifyArgumentNotNull)(t,"model","drawSkeleton"),(0,l.verifyArgumentNotNull)(n,"context","drawSkeleton");const a=t.ClientOnlyCache;if((0,l.verifyArgumentNotNull)(a,"ClientOnlyCache","drawSkeleton"),(0,l.verifyArgumentNotNull)(a.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","drawSkeleton"),(0,l.verifyArgumentNotNull)(a.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","drawSkeleton"),(0,l.verifyArgumentNotNull)(t.RowHeights,"RowHeights","drawSkeleton"),(0,l.verifyArgumentNotNull)(t.ColumnWidths,"ColumnWidths","drawSkeleton"),n.scaleFactor<r.MinimalScaleFactorForGridlinesRendering||!(0,o.isChangeGateEnabled)(o.ChangeGate.SkeletonWithoutGridLines)&&!t.ShowGridLines)return;e.fillStyle=r.SkeletonColor;const s=c();s&&e.beginPath();for(let n=0;n<a.RowOffsetsAdjustedForDrawing.length-1;n++){const o=a.RowOffsetsAdjustedForDrawing[n],r=(0,i.getRowHeightFromOffsets)(n,a.RowOffsetsAdjustedForDrawing);for(let n=0;n<a.ColOffsetsAdjustedForDrawing.length-1;n++)u(e,(0,i.getColOffsetAdjustedForDrawing)(n,t),o,(0,i.getColWidthFromOffsets)(n,a.ColOffsetsAdjustedForDrawing),r,s)}s&&e.fill()},t.drawSkeletonCells=function(e,t,n){if((0,l.verifyArgumentNotNull)(e,"ctx","drawSkeletonCells"),(0,l.verifyArgumentNotNull)(t,"model","drawSkeletonCells"),(0,l.verifyArgumentNotNull)(n,"context","drawSkeletonCells"),n.scaleFactor<r.MinimalScaleFactorForGridlinesRendering)return;const o=t.ClientOnlyCache.CellsToRender;e.fillStyle=r.SkeletonCellsColor;const s=c();s&&e.beginPath();for(let r=0;r<o.length;r++){const l=o[r];if(null==l||!l.ShowSkeleton)continue;if(!(0,i.cellIntersectsRenderingRegion)(l,n.renderingRegion))continue;const d=(0,a.getCellTopAdjustedForDrawing)(t,l,!0),c=(0,a.getCellHeightAdjustedForDrawing)(t,l);u(e,(0,a.getCellLeftAdjustedForDrawing)(t,l,!1,!0),d,(0,a.getCellWidthAdjustedForDrawing)(t,l),c,s)}s&&e.fill()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVerticalAlignmentFontSizeAdjusted=void 0,t.getVerticalAlignmentFontSizeAdjusted=function(e){return 2*e/3}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cssFontToCanvasFont=void 0;const o=n(0),r=n(110);let i=void 0,l=void 0,a=!1;const s={};t.cssFontToCanvasFont=function(e,t){if(t&&(0,o.isSafari)())return e;if(a||(i=new r.RenderingCanvasElement(!1,!0),i.setWidth(1),i.setHeight(1),l=i.getContext2d(),a=!0),!l)return e;let n=s[e];return n||(l.font=e,n=l.font,s[e]=n,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldAddRichValueIconPadding=void 0;const o=n(17);t.shouldAddRichValueIconPadding=function(e,t){if(t.PivotTable)return!1;const n=!!t.RichValueIcon&&!!t.AutoFilter;return e.IsRtl&&n&&!(0,o.isTextAlignedOnButton)(e,t.CachedStyle)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.classifyChar=void 0;const o=n(116);t.classifyChar=function(e){return 8205===e?o.CombiningClass.ZWJ:13===e?o.CombiningClass.CR:10===e?o.CombiningClass.LF:function(e){return 0<=e&&e<=9||11<=e&&e<=12||14<=e&&e<=31||127<=e&&e<=159||173===e||1564===e||6158===e||8203===e||8206<=e&&e<=8207||8232===e||8233===e||8234<=e&&e<=8238||8288<=e&&e<=8292||8293===e||8294<=e&&e<=8303||55296<=e&&e<=57343||65279===e||65520<=e&&e<=65528||65529<=e&&e<=65531||113824<=e&&e<=113827||119155<=e&&e<=119162||917504===e||917505===e||917506<=e&&e<=917535||917632<=e&&e<=917759||918e3<=e&&e<=921599}(e)?o.CombiningClass.Control:function(e){return 768<=e&&e<=879||1155<=e&&e<=1159||1160<=e&&e<=1161||1425<=e&&e<=1469||1471===e||1473<=e&&e<=1474||1476<=e&&e<=1477||1479===e||1552<=e&&e<=1562||1611<=e&&e<=1631||1648===e||1750<=e&&e<=1756||1759<=e&&e<=1764||1767<=e&&e<=1768||1770<=e&&e<=1773||1809===e||1840<=e&&e<=1866||1958<=e&&e<=1968||2027<=e&&e<=2035||2070<=e&&e<=2073||2075<=e&&e<=2083||2085<=e&&e<=2087||2089<=e&&e<=2093||2137<=e&&e<=2139||2260<=e&&e<=2273||2275<=e&&e<=2306||2362===e||2364===e||2369<=e&&e<=2376||2381===e||2385<=e&&e<=2391||2402<=e&&e<=2403||2433===e||2492===e||2494===e||2497<=e&&e<=2500||2509===e||2519===e||2530<=e&&e<=2531||2561<=e&&e<=2562||2620===e||2625<=e&&e<=2626||2631<=e&&e<=2632||2635<=e&&e<=2637||2641===e||2672<=e&&e<=2673||2677===e||2689<=e&&e<=2690||2748===e||2753<=e&&e<=2757||2759<=e&&e<=2760||2765===e||2786<=e&&e<=2787||2810<=e&&e<=2815||2817===e||2876===e||2878===e||2879===e||2881<=e&&e<=2884||2893===e||2902===e||2903===e||2914<=e&&e<=2915||2946===e||3006===e||3008===e||3021===e||3031===e||3072===e||3134<=e&&e<=3136||3142<=e&&e<=3144||3146<=e&&e<=3149||3157<=e&&e<=3158||3170<=e&&e<=3171||3201===e||3260===e||3263===e||3266===e||3270===e||3276<=e&&e<=3277||3285<=e&&e<=3286||3298<=e&&e<=3299||3328<=e&&e<=3329||3387<=e&&e<=3388||3390===e||3393<=e&&e<=3396||3405===e||3415===e||3426<=e&&e<=3427||3530===e||3535===e||3538<=e&&e<=3540||3542===e||3551===e||3633===e||3636<=e&&e<=3642||3655<=e&&e<=3662||3761===e||3764<=e&&e<=3769||3771<=e&&e<=3772||3784<=e&&e<=3789||3864<=e&&e<=3865||3893===e||3895===e||3897===e||3953<=e&&e<=3966||3968<=e&&e<=3972||3974<=e&&e<=3975||3981<=e&&e<=3991||3993<=e&&e<=4028||4038===e||4141<=e&&e<=4144||4146<=e&&e<=4151||4153<=e&&e<=4154||4157<=e&&e<=4158||4184<=e&&e<=4185||4190<=e&&e<=4192||4209<=e&&e<=4212||4226===e||4229<=e&&e<=4230||4237===e||4253===e||4957<=e&&e<=4959||5906<=e&&e<=5908||5938<=e&&e<=5940||5970<=e&&e<=5971||6002<=e&&e<=6003||6068<=e&&e<=6069||6071<=e&&e<=6077||6086===e||6089<=e&&e<=6099||6109===e||6155<=e&&e<=6157||6277<=e&&e<=6278||6313===e||6432<=e&&e<=6434||6439<=e&&e<=6440||6450===e||6457<=e&&e<=6459||6679<=e&&e<=6680||6683===e||6742===e||6744<=e&&e<=6750||6752===e||6754===e||6757<=e&&e<=6764||6771<=e&&e<=6780||6783===e||6832<=e&&e<=6845||6846===e||6912<=e&&e<=6915||6964===e||6966<=e&&e<=6970||6972===e||6978===e||7019<=e&&e<=7027||7040<=e&&e<=7041||7074<=e&&e<=7077||7080<=e&&e<=7081||7083<=e&&e<=7085||7142===e||7144<=e&&e<=7145||7149===e||7151<=e&&e<=7153||7212<=e&&e<=7219||7222<=e&&e<=7223||7376<=e&&e<=7378||7380<=e&&e<=7392||7394<=e&&e<=7400||7405===e||7412===e||7416<=e&&e<=7417||7616<=e&&e<=7673||7675<=e&&e<=7679||8204===e||8400<=e&&e<=8412||8413<=e&&e<=8416||8417===e||8418<=e&&e<=8420||8421<=e&&e<=8432||11503<=e&&e<=11505||11647===e||11744<=e&&e<=11775||12330<=e&&e<=12333||12334<=e&&e<=12335||12441<=e&&e<=12442||42607===e||42608<=e&&e<=42610||42612<=e&&e<=42621||42654<=e&&e<=42655||42736<=e&&e<=42737||43010===e||43014===e||43019===e||43045<=e&&e<=43046||43204<=e&&e<=43205||43232<=e&&e<=43249||43302<=e&&e<=43309||43335<=e&&e<=43345||43392<=e&&e<=43394||43443===e||43446<=e&&e<=43449||43452===e||43493===e||43561<=e&&e<=43566||43569<=e&&e<=43570||43573<=e&&e<=43574||43587===e||43596===e||43644===e||43696===e||43698<=e&&e<=43700||43703<=e&&e<=43704||43710<=e&&e<=43711||43713===e||43756<=e&&e<=43757||43766===e||44005===e||44008===e||44013===e||64286===e||65024<=e&&e<=65039||65056<=e&&e<=65071||65438<=e&&e<=65439||66045===e||66272===e||66422<=e&&e<=66426||68097<=e&&e<=68099||68101<=e&&e<=68102||68108<=e&&e<=68111||68152<=e&&e<=68154||68159===e||68325<=e&&e<=68326||69633===e||69688<=e&&e<=69702||69759<=e&&e<=69761||69811<=e&&e<=69814||69817<=e&&e<=69818||69888<=e&&e<=69890||69927<=e&&e<=69931||69933<=e&&e<=69940||70003===e||70016<=e&&e<=70017||70070<=e&&e<=70078||70090<=e&&e<=70092||70191<=e&&e<=70193||70196===e||70198<=e&&e<=70199||70206===e||70367===e||70371<=e&&e<=70378||70400<=e&&e<=70401||70460===e||70462===e||70464===e||70487===e||70502<=e&&e<=70508||70512<=e&&e<=70516||70712<=e&&e<=70719||70722<=e&&e<=70724||70726===e||70832===e||70835<=e&&e<=70840||70842===e||70845===e||70847<=e&&e<=70848||70850<=e&&e<=70851||71087===e||71090<=e&&e<=71093||71100<=e&&e<=71101||71103<=e&&e<=71104||71132<=e&&e<=71133||71219<=e&&e<=71226||71229===e||71231<=e&&e<=71232||71339===e||71341===e||71344<=e&&e<=71349||71351===e||71453<=e&&e<=71455||71458<=e&&e<=71461||71463<=e&&e<=71467||72193<=e&&e<=72198||72201<=e&&e<=72202||72243<=e&&e<=72248||72251<=e&&e<=72254||72263===e||72273<=e&&e<=72278||72281<=e&&e<=72283||72330<=e&&e<=72342||72344<=e&&e<=72345||72752<=e&&e<=72758||72760<=e&&e<=72765||72767===e||72850<=e&&e<=72871||72874<=e&&e<=72880||72882<=e&&e<=72883||72885<=e&&e<=72886||73009<=e&&e<=73014||73018===e||73020<=e&&e<=73021||73023<=e&&e<=73029||73031===e||92912<=e&&e<=92916||92976<=e&&e<=92982||94095<=e&&e<=94098||113821<=e&&e<=113822||119141===e||119143<=e&&e<=119145||119150<=e&&e<=119154||119163<=e&&e<=119170||119173<=e&&e<=119179||119210<=e&&e<=119213||119362<=e&&e<=119364||121344<=e&&e<=121398||121403<=e&&e<=121452||121461===e||121476===e||121499<=e&&e<=121503||121505<=e&&e<=121519||122880<=e&&e<=122886||122888<=e&&e<=122904||122907<=e&&e<=122913||122915<=e&&e<=122916||122918<=e&&e<=122922||125136<=e&&e<=125142||125252<=e&&e<=125258||917536<=e&&e<=917631||917760<=e&&e<=917999}(e)?o.CombiningClass.Extend:function(e){return 127462<=e&&e<=127487}(e)?o.CombiningClass.Regional_Indicator:function(e){return 2307===e||2363===e||2366<=e&&e<=2368||2377<=e&&e<=2380||2382<=e&&e<=2383||2434<=e&&e<=2435||2495<=e&&e<=2496||2503<=e&&e<=2504||2507<=e&&e<=2508||2563===e||2622<=e&&e<=2624||2691===e||2750<=e&&e<=2752||2761===e||2763<=e&&e<=2764||2818<=e&&e<=2819||2880===e||2887<=e&&e<=2888||2891<=e&&e<=2892||3007===e||3009<=e&&e<=3010||3014<=e&&e<=3016||3018<=e&&e<=3020||3073<=e&&e<=3075||3137<=e&&e<=3140||3202<=e&&e<=3203||3262===e||3264<=e&&e<=3265||3267<=e&&e<=3268||3271<=e&&e<=3272||3274<=e&&e<=3275||3330<=e&&e<=3331||3391<=e&&e<=3392||3398<=e&&e<=3400||3402<=e&&e<=3404||3458<=e&&e<=3459||3536<=e&&e<=3537||3544<=e&&e<=3550||3570<=e&&e<=3571||3635===e||3763===e||3902<=e&&e<=3903||3967===e||4145===e||4155<=e&&e<=4156||4182<=e&&e<=4183||4228===e||6070===e||6078<=e&&e<=6085||6087<=e&&e<=6088||6435<=e&&e<=6438||6441<=e&&e<=6443||6448<=e&&e<=6449||6451<=e&&e<=6456||6681<=e&&e<=6682||6741===e||6743===e||6765<=e&&e<=6770||6916===e||6965===e||6971===e||6973<=e&&e<=6977||6979<=e&&e<=6980||7042===e||7073===e||7078<=e&&e<=7079||7082===e||7143===e||7146<=e&&e<=7148||7150===e||7154<=e&&e<=7155||7204<=e&&e<=7211||7220<=e&&e<=7221||7393===e||7410<=e&&e<=7411||7415===e||43043<=e&&e<=43044||43047===e||43136<=e&&e<=43137||43188<=e&&e<=43203||43346<=e&&e<=43347||43395===e||43444<=e&&e<=43445||43450<=e&&e<=43451||43453<=e&&e<=43456||43567<=e&&e<=43568||43571<=e&&e<=43572||43597===e||43755===e||43758<=e&&e<=43759||43765===e||44003<=e&&e<=44004||44006<=e&&e<=44007||44009<=e&&e<=44010||44012===e||69632===e||69634===e||69762===e||69808<=e&&e<=69810||69815<=e&&e<=69816||69932===e||70018===e||70067<=e&&e<=70069||70079<=e&&e<=70080||70188<=e&&e<=70190||70194<=e&&e<=70195||70197===e||70368<=e&&e<=70370||70402<=e&&e<=70403||70463===e||70465<=e&&e<=70468||70471<=e&&e<=70472||70475<=e&&e<=70477||70498<=e&&e<=70499||70709<=e&&e<=70711||70720<=e&&e<=70721||70725===e||70833<=e&&e<=70834||70841===e||70843<=e&&e<=70844||70846===e||70849===e||71088<=e&&e<=71089||71096<=e&&e<=71099||71102===e||71216<=e&&e<=71218||71227<=e&&e<=71228||71230===e||71340===e||71342<=e&&e<=71343||71350===e||71456<=e&&e<=71457||71462===e||72199<=e&&e<=72200||72249===e||72279<=e&&e<=72280||72343===e||72751===e||72766===e||72873===e||72881===e||72884===e||94033<=e&&e<=94078||119142===e||119149===e}(e)?o.CombiningClass.SpacingMark:function(e){return 4352<=e&&e<=4447||43360<=e&&e<=43388}(e)?o.CombiningClass.L:function(e){return 44033<=e&&e<=44059||44061<=e&&e<=44087||44089<=e&&e<=44115||44117<=e&&e<=44143||44145<=e&&e<=44171||44173<=e&&e<=44199||44201<=e&&e<=44227||44229<=e&&e<=44255||44257<=e&&e<=44283||44285<=e&&e<=44311||44313<=e&&e<=44339||44341<=e&&e<=44367||44369<=e&&e<=44395||44397<=e&&e<=44423||44425<=e&&e<=44451||44453<=e&&e<=44479||44481<=e&&e<=44507||44509<=e&&e<=44535||44537<=e&&e<=44563||44565<=e&&e<=44591||44593<=e&&e<=44619||44621<=e&&e<=44647||44649<=e&&e<=44675||44677<=e&&e<=44703||44705<=e&&e<=44731||44733<=e&&e<=44759||44761<=e&&e<=44787||44789<=e&&e<=44815||44817<=e&&e<=44843||44845<=e&&e<=44871||44873<=e&&e<=44899||44901<=e&&e<=44927||44929<=e&&e<=44955||44957<=e&&e<=44983||44985<=e&&e<=45011||45013<=e&&e<=45039||45041<=e&&e<=45067||45069<=e&&e<=45095||45097<=e&&e<=45123||45125<=e&&e<=45151||45153<=e&&e<=45179||45181<=e&&e<=45207||45209<=e&&e<=45235||45237<=e&&e<=45263||45265<=e&&e<=45291||45293<=e&&e<=45319||45321<=e&&e<=45347||45349<=e&&e<=45375||45377<=e&&e<=45403||45405<=e&&e<=45431||45433<=e&&e<=45459||45461<=e&&e<=45487||45489<=e&&e<=45515||45517<=e&&e<=45543||45545<=e&&e<=45571||45573<=e&&e<=45599||45601<=e&&e<=45627||45629<=e&&e<=45655||45657<=e&&e<=45683||45685<=e&&e<=45711||45713<=e&&e<=45739||45741<=e&&e<=45767||45769<=e&&e<=45795||45797<=e&&e<=45823||45825<=e&&e<=45851||45853<=e&&e<=45879||45881<=e&&e<=45907||45909<=e&&e<=45935||45937<=e&&e<=45963||45965<=e&&e<=45991||45993<=e&&e<=46019||46021<=e&&e<=46047||46049<=e&&e<=46075||46077<=e&&e<=46103||46105<=e&&e<=46131||46133<=e&&e<=46159||46161<=e&&e<=46187||46189<=e&&e<=46215||46217<=e&&e<=46243||46245<=e&&e<=46271||46273<=e&&e<=46299||46301<=e&&e<=46327||46329<=e&&e<=46355||46357<=e&&e<=46383||46385<=e&&e<=46411||46413<=e&&e<=46439||46441<=e&&e<=46467||46469<=e&&e<=46495||46497<=e&&e<=46523||46525<=e&&e<=46551||46553<=e&&e<=46579||46581<=e&&e<=46607||46609<=e&&e<=46635||46637<=e&&e<=46663||46665<=e&&e<=46691||46693<=e&&e<=46719||46721<=e&&e<=46747||46749<=e&&e<=46775||46777<=e&&e<=46803||46805<=e&&e<=46831||46833<=e&&e<=46859||46861<=e&&e<=46887||46889<=e&&e<=46915||46917<=e&&e<=46943||46945<=e&&e<=46971||46973<=e&&e<=46999||47001<=e&&e<=47027||47029<=e&&e<=47055||47057<=e&&e<=47083||47085<=e&&e<=47111||47113<=e&&e<=47139||47141<=e&&e<=47167||47169<=e&&e<=47195||47197<=e&&e<=47223||47225<=e&&e<=47251||47253<=e&&e<=47279||47281<=e&&e<=47307||47309<=e&&e<=47335||47337<=e&&e<=47363||47365<=e&&e<=47391||47393<=e&&e<=47419||47421<=e&&e<=47447||47449<=e&&e<=47475||47477<=e&&e<=47503||47505<=e&&e<=47531||47533<=e&&e<=47559||47561<=e&&e<=47587||47589<=e&&e<=47615||47617<=e&&e<=47643||47645<=e&&e<=47671||47673<=e&&e<=47699||47701<=e&&e<=47727||47729<=e&&e<=47755||47757<=e&&e<=47783||47785<=e&&e<=47811||47813<=e&&e<=47839||47841<=e&&e<=47867||47869<=e&&e<=47895||47897<=e&&e<=47923||47925<=e&&e<=47951||47953<=e&&e<=47979||47981<=e&&e<=48007||48009<=e&&e<=48035||48037<=e&&e<=48063||48065<=e&&e<=48091||48093<=e&&e<=48119||48121<=e&&e<=48147||48149<=e&&e<=48175||48177<=e&&e<=48203||48205<=e&&e<=48231||48233<=e&&e<=48259||48261<=e&&e<=48287||48289<=e&&e<=48315||48317<=e&&e<=48343||48345<=e&&e<=48371||48373<=e&&e<=48399||48401<=e&&e<=48427||48429<=e&&e<=48455||48457<=e&&e<=48483||48485<=e&&e<=48511||48513<=e&&e<=48539||48541<=e&&e<=48567||48569<=e&&e<=48595||48597<=e&&e<=48623||48625<=e&&e<=48651||48653<=e&&e<=48679||48681<=e&&e<=48707||48709<=e&&e<=48735||48737<=e&&e<=48763||48765<=e&&e<=48791||48793<=e&&e<=48819||48821<=e&&e<=48847||48849<=e&&e<=48875||48877<=e&&e<=48903||48905<=e&&e<=48931||48933<=e&&e<=48959||48961<=e&&e<=48987||48989<=e&&e<=49015||49017<=e&&e<=49043||49045<=e&&e<=49071||49073<=e&&e<=49099||49101<=e&&e<=49127||49129<=e&&e<=49155||49157<=e&&e<=49183||49185<=e&&e<=49211||49213<=e&&e<=49239||49241<=e&&e<=49267||49269<=e&&e<=49295||49297<=e&&e<=49323||49325<=e&&e<=49351||49353<=e&&e<=49379||49381<=e&&e<=49407||49409<=e&&e<=49435||49437<=e&&e<=49463||49465<=e&&e<=49491||49493<=e&&e<=49519||49521<=e&&e<=49547||49549<=e&&e<=49575||49577<=e&&e<=49603||49605<=e&&e<=49631||49633<=e&&e<=49659||49661<=e&&e<=49687||49689<=e&&e<=49715||49717<=e&&e<=49743||49745<=e&&e<=49771||49773<=e&&e<=49799||49801<=e&&e<=49827||49829<=e&&e<=49855||49857<=e&&e<=49883||49885<=e&&e<=49911||49913<=e&&e<=49939||49941<=e&&e<=49967||49969<=e&&e<=49995||49997<=e&&e<=50023||50025<=e&&e<=50051||50053<=e&&e<=50079||50081<=e&&e<=50107||50109<=e&&e<=50135||50137<=e&&e<=50163||50165<=e&&e<=50191||50193<=e&&e<=50219||50221<=e&&e<=50247||50249<=e&&e<=50275||50277<=e&&e<=50303||50305<=e&&e<=50331||50333<=e&&e<=50359||50361<=e&&e<=50387||50389<=e&&e<=50415||50417<=e&&e<=50443||50445<=e&&e<=50471||50473<=e&&e<=50499||50501<=e&&e<=50527||50529<=e&&e<=50555||50557<=e&&e<=50583||50585<=e&&e<=50611||50613<=e&&e<=50639||50641<=e&&e<=50667||50669<=e&&e<=50695||50697<=e&&e<=50723||50725<=e&&e<=50751||50753<=e&&e<=50779||50781<=e&&e<=50807||50809<=e&&e<=50835||50837<=e&&e<=50863||50865<=e&&e<=50891||50893<=e&&e<=50919||50921<=e&&e<=50947||50949<=e&&e<=50975||50977<=e&&e<=51003||51005<=e&&e<=51031||51033<=e&&e<=51059||51061<=e&&e<=51087||51089<=e&&e<=51115||51117<=e&&e<=51143||51145<=e&&e<=51171||51173<=e&&e<=51199||51201<=e&&e<=51227||51229<=e&&e<=51255||51257<=e&&e<=51283||51285<=e&&e<=51311||51313<=e&&e<=51339||51341<=e&&e<=51367||51369<=e&&e<=51395||51397<=e&&e<=51423||51425<=e&&e<=51451||51453<=e&&e<=51479||51481<=e&&e<=51507||51509<=e&&e<=51535||51537<=e&&e<=51563||51565<=e&&e<=51591||51593<=e&&e<=51619||51621<=e&&e<=51647||51649<=e&&e<=51675||51677<=e&&e<=51703||51705<=e&&e<=51731||51733<=e&&e<=51759||51761<=e&&e<=51787||51789<=e&&e<=51815||51817<=e&&e<=51843||51845<=e&&e<=51871||51873<=e&&e<=51899||51901<=e&&e<=51927||51929<=e&&e<=51955||51957<=e&&e<=51983||51985<=e&&e<=52011||52013<=e&&e<=52039||52041<=e&&e<=52067||52069<=e&&e<=52095||52097<=e&&e<=52123||52125<=e&&e<=52151||52153<=e&&e<=52179||52181<=e&&e<=52207||52209<=e&&e<=52235||52237<=e&&e<=52263||52265<=e&&e<=52291||52293<=e&&e<=52319||52321<=e&&e<=52347||52349<=e&&e<=52375||52377<=e&&e<=52403||52405<=e&&e<=52431||52433<=e&&e<=52459||52461<=e&&e<=52487||52489<=e&&e<=52515||52517<=e&&e<=52543||52545<=e&&e<=52571||52573<=e&&e<=52599||52601<=e&&e<=52627||52629<=e&&e<=52655||52657<=e&&e<=52683||52685<=e&&e<=52711||52713<=e&&e<=52739||52741<=e&&e<=52767||52769<=e&&e<=52795||52797<=e&&e<=52823||52825<=e&&e<=52851||52853<=e&&e<=52879||52881<=e&&e<=52907||52909<=e&&e<=52935||52937<=e&&e<=52963||52965<=e&&e<=52991||52993<=e&&e<=53019||53021<=e&&e<=53047||53049<=e&&e<=53075||53077<=e&&e<=53103||53105<=e&&e<=53131||53133<=e&&e<=53159||53161<=e&&e<=53187||53189<=e&&e<=53215||53217<=e&&e<=53243||53245<=e&&e<=53271||53273<=e&&e<=53299||53301<=e&&e<=53327||53329<=e&&e<=53355||53357<=e&&e<=53383||53385<=e&&e<=53411||53413<=e&&e<=53439||53441<=e&&e<=53467||53469<=e&&e<=53495||53497<=e&&e<=53523||53525<=e&&e<=53551||53553<=e&&e<=53579||53581<=e&&e<=53607||53609<=e&&e<=53635||53637<=e&&e<=53663||53665<=e&&e<=53691||53693<=e&&e<=53719||53721<=e&&e<=53747||53749<=e&&e<=53775||53777<=e&&e<=53803||53805<=e&&e<=53831||53833<=e&&e<=53859||53861<=e&&e<=53887||53889<=e&&e<=53915||53917<=e&&e<=53943||53945<=e&&e<=53971||53973<=e&&e<=53999||54001<=e&&e<=54027||54029<=e&&e<=54055||54057<=e&&e<=54083||54085<=e&&e<=54111||54113<=e&&e<=54139||54141<=e&&e<=54167||54169<=e&&e<=54195||54197<=e&&e<=54223||54225<=e&&e<=54251||54253<=e&&e<=54279||54281<=e&&e<=54307||54309<=e&&e<=54335||54337<=e&&e<=54363||54365<=e&&e<=54391||54393<=e&&e<=54419||54421<=e&&e<=54447||54449<=e&&e<=54475||54477<=e&&e<=54503||54505<=e&&e<=54531||54533<=e&&e<=54559||54561<=e&&e<=54587||54589<=e&&e<=54615||54617<=e&&e<=54643||54645<=e&&e<=54671||54673<=e&&e<=54699||54701<=e&&e<=54727||54729<=e&&e<=54755||54757<=e&&e<=54783||54785<=e&&e<=54811||54813<=e&&e<=54839||54841<=e&&e<=54867||54869<=e&&e<=54895||54897<=e&&e<=54923||54925<=e&&e<=54951||54953<=e&&e<=54979||54981<=e&&e<=55007||55009<=e&&e<=55035||55037<=e&&e<=55063||55065<=e&&e<=55091||55093<=e&&e<=55119||55121<=e&&e<=55147||55149<=e&&e<=55175||55177<=e&&e<=55203}(e)?o.CombiningClass.LVT:function(e){return 4448<=e&&e<=4519||55216<=e&&e<=55238}(e)?o.CombiningClass.V:function(e){return 4520<=e&&e<=4607||55243<=e&&e<=55291}(e)?o.CombiningClass.T:function(e){return 44032===e||44060===e||44088===e||44116===e||44144===e||44172===e||44200===e||44228===e||44256===e||44284===e||44312===e||44340===e||44368===e||44396===e||44424===e||44452===e||44480===e||44508===e||44536===e||44564===e||44592===e||44620===e||44648===e||44676===e||44704===e||44732===e||44760===e||44788===e||44816===e||44844===e||44872===e||44900===e||44928===e||44956===e||44984===e||45012===e||45040===e||45068===e||45096===e||45124===e||45152===e||45180===e||45208===e||45236===e||45264===e||45292===e||45320===e||45348===e||45376===e||45404===e||45432===e||45460===e||45488===e||45516===e||45544===e||45572===e||45600===e||45628===e||45656===e||45684===e||45712===e||45740===e||45768===e||45796===e||45824===e||45852===e||45880===e||45908===e||45936===e||45964===e||45992===e||46020===e||46048===e||46076===e||46104===e||46132===e||46160===e||46188===e||46216===e||46244===e||46272===e||46300===e||46328===e||46356===e||46384===e||46412===e||46440===e||46468===e||46496===e||46524===e||46552===e||46580===e||46608===e||46636===e||46664===e||46692===e||46720===e||46748===e||46776===e||46804===e||46832===e||46860===e||46888===e||46916===e||46944===e||46972===e||47e3===e||47028===e||47056===e||47084===e||47112===e||47140===e||47168===e||47196===e||47224===e||47252===e||47280===e||47308===e||47336===e||47364===e||47392===e||47420===e||47448===e||47476===e||47504===e||47532===e||47560===e||47588===e||47616===e||47644===e||47672===e||47700===e||47728===e||47756===e||47784===e||47812===e||47840===e||47868===e||47896===e||47924===e||47952===e||47980===e||48008===e||48036===e||48064===e||48092===e||48120===e||48148===e||48176===e||48204===e||48232===e||48260===e||48288===e||48316===e||48344===e||48372===e||48400===e||48428===e||48456===e||48484===e||48512===e||48540===e||48568===e||48596===e||48624===e||48652===e||48680===e||48708===e||48736===e||48764===e||48792===e||48820===e||48848===e||48876===e||48904===e||48932===e||48960===e||48988===e||49016===e||49044===e||49072===e||49100===e||49128===e||49156===e||49184===e||49212===e||49240===e||49268===e||49296===e||49324===e||49352===e||49380===e||49408===e||49436===e||49464===e||49492===e||49520===e||49548===e||49576===e||49604===e||49632===e||49660===e||49688===e||49716===e||49744===e||49772===e||49800===e||49828===e||49856===e||49884===e||49912===e||49940===e||49968===e||49996===e||50024===e||50052===e||50080===e||50108===e||50136===e||50164===e||50192===e||50220===e||50248===e||50276===e||50304===e||50332===e||50360===e||50388===e||50416===e||50444===e||50472===e||50500===e||50528===e||50556===e||50584===e||50612===e||50640===e||50668===e||50696===e||50724===e||50752===e||50780===e||50808===e||50836===e||50864===e||50892===e||50920===e||50948===e||50976===e||51004===e||51032===e||51060===e||51088===e||51116===e||51144===e||51172===e||51200===e||51228===e||51256===e||51284===e||51312===e||51340===e||51368===e||51396===e||51424===e||51452===e||51480===e||51508===e||51536===e||51564===e||51592===e||51620===e||51648===e||51676===e||51704===e||51732===e||51760===e||51788===e||51816===e||51844===e||51872===e||51900===e||51928===e||51956===e||51984===e||52012===e||52040===e||52068===e||52096===e||52124===e||52152===e||52180===e||52208===e||52236===e||52264===e||52292===e||52320===e||52348===e||52376===e||52404===e||52432===e||52460===e||52488===e||52516===e||52544===e||52572===e||52600===e||52628===e||52656===e||52684===e||52712===e||52740===e||52768===e||52796===e||52824===e||52852===e||52880===e||52908===e||52936===e||52964===e||52992===e||53020===e||53048===e||53076===e||53104===e||53132===e||53160===e||53188===e||53216===e||53244===e||53272===e||53300===e||53328===e||53356===e||53384===e||53412===e||53440===e||53468===e||53496===e||53524===e||53552===e||53580===e||53608===e||53636===e||53664===e||53692===e||53720===e||53748===e||53776===e||53804===e||53832===e||53860===e||53888===e||53916===e||53944===e||53972===e||54e3===e||54028===e||54056===e||54084===e||54112===e||54140===e||54168===e||54196===e||54224===e||54252===e||54280===e||54308===e||54336===e||54364===e||54392===e||54420===e||54448===e||54476===e||54504===e||54532===e||54560===e||54588===e||54616===e||54644===e||54672===e||54700===e||54728===e||54756===e||54784===e||54812===e||54840===e||54868===e||54896===e||54924===e||54952===e||54980===e||55008===e||55036===e||55064===e||55092===e||55120===e||55148===e||55176===e}(e)?o.CombiningClass.LV:o.CombiningClass.Other}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reorderTextTokensUsingDom=void 0;const o=n(67),r=n(2);t.reorderTextTokensUsingDom=function(e,t,n,i){const l=(0,r.getReOrderDiv)(n,i);for(let r=0;r<e.textLines.length;r++){const i=e.textLines[r],a=e.tokensPerLine[r],s=(0,o.analyzeBidiText)(i.text,t);if(n.HasBidi)if(s.HasRtl&&!s.HasLtr)a.tokens.reverse();else{const e=document.createElement("div");e.setAttribute("textLineId",r.toString());for(let t=0;t<a.tokens.length;t++){const n=a.tokens[t].text,o=document.createElement("span");o.innerText=n,o.setAttribute("textTokenId",t.toString()),e.appendChild(o)}l.appendChild(e)}}document.body.appendChild(l);for(let t=0;t<l.children.length;t++){const n=l.children[t],o=n.getAttribute("textLineId");if(!o)throw Error("reorderTextTokensUsingDom: textLineIndexAttr is undefined");const r=parseInt(o,10),i=e.tokensPerLine[r].tokens;for(let e=0;e<n.children.length;e++){const t=n.children[e],o=t.getAttribute("textTokenId");if(!o)throw Error("reorderTextTokensUsingDom: tokenIndexAttr is undefined");const r=t.getBoundingClientRect().left;i[parseInt(o,10)].OffsetX=r}i.sort((e,t)=>e.OffsetX-t.OffsetX)}document.body.removeChild(l)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawWrapText=void 0;const o=n(2),r=n(35),i=n(1),l=n(9),a=n(40),s=n(32),d=n(89),c=n(170),u=n(88),g=n(3),h=n(6),C=n(72),f=n(15),m=n(49),p=n(14),y=n(73),S=n(90),R=n(92),F=n(13),T=n(117);function w(e,t,n,o,r,i,l,a){let s=a?e+t-n-o:e-n;return l&&(s=(0,m.getAdvancedVerticalAlignmentOffsetYForWrapText)(s,r,i)),s}function I(e,t,n,o){return e&&!t.HasRtl?0===n:n===o-1}t.drawWrapText=function(e,t,n,b,v,x,D,A,P,M,B,H,O){var k;const L=(0,p.shouldRenderVerticalText)(b),N=(0,C.getBreakType)(b),E=L?(0,o.getTextDrawingMaxHeight)(M,(0,T.getVerticalTextPadding)((null===(k=b.CachedStyle)||void 0===k?void 0:k.Indentation)||0)):M;if(E<=0||D<=0)return;const z=L?E:D,W=(0,C.computeMaxTextWidthForWrapText)(b,N,z,n,t),G=L?H:e.measureText(g.Whitespace).width,V=b.WrapText,j=(0,d.breakTextToLines)(e,v,W,N,G,n,b,O,V),_=(0,l.getBidiContext)(b);L&&(0,C.adjustOrderingOfLinesForVerticalText)(b,j,_);const U=j.textLines,{rowsBottomY:q,rowsAlphabeticY:$,textHeight:Y,formattedLines:X}=function(e,t,n,o){const r=[];let i=[],a=[];i=[0],a=[0];let d=0;if(n)for(let o=0;o<t.length;o++){const c=t[t.length-1-o],u=(0,s.substringFormattedText)(n,c.startIndex,c.endIndex);r[o]=u;const g=(0,l.getFormattedTextLineFontMetrics)(e,u);a[o]=g.baseline;const h=(0,l.getFormattedTextLineHeight)(e,u);i[o+1]=i[o]+h,d+=h}else i=function(e,t){const n=[];for(let o=0;o<e;o++)n.push(o*t);return n}(t.length,o),d=o*t.length;return{rowsBottomY:i,rowsAlphabeticY:a,textHeight:d,formattedLines:r}}(n,U,O,H),K=!(0,h.isNullOrUndefined)(b.PhonInfo),J=j.requireClipping||B||K||function(e,t,n,o){return e&&t<n*o}(L,P,H,U.length);let Z=void 0;J&&(Z=A);const Q=e.textAlign,ee=e.textBaseline;let te=!1;var ne;(0,f.isHorizontalAlignmentJustifiedAndDistributed)(b)&&!L&&(e.textAlign="left",e.textBaseline="alphabetic",te=!0,_.HasRtl&&(0,u.reorderTextTokens)(j,(null===(ne=b.CachedStyle)||void 0===ne?void 0:ne.ReadingOrder)||i.ReadingOrderType.Context,_,W));const oe=K?y.PhoneticTextHeightPx:0,re=L?b.CachedStyle.VerticalAlignment:(0,m.getEffectiveVerticalAlignment)(b.CachedStyle.VerticalAlignment,m.AdvVerticalAlignmentFormat.WrapText,M,Y,H,U.length,b.DisplayFormula),ie=L?(0,p.isVerticalAlignmentJustifiedOrDistributedForVerticalText)(b):(0,m.isVerticalAlignmentJustifyOrDistributed)(re),le=ie&&U.length>1&&!L?(0,m.getAdvancedVerticalAlignmentLineGapHeightForWraptext)(M,Y,U.length):0;!function(e,t){t&&(0,o.applyClipping)(e,t)}(e,Z);const ae=$[0],se=(0,l.getTextVerticalPosition)(b,n,Y+oe,M,re,ae),de=se.absoluteY;let ce=L?(0,C.getOffsetXForVerticalText)(n,b,t,x,H,U.length):x,ue=0;(0,p.isHorizontalAlignmentJustifiedOrDistributedForVerticalText)(b)&&(ue=(0,C.getSpaceWidthBetweenLines)(n,b,ce,U.length,H));const ge=function(e,t,n,o,r){return e?(0,l.getTextVerticalPosition)(t,n,o,r,t.CachedStyle.VerticalAlignment,void 0).absoluteY:0}(L,b,n,H,M);for(let o=0;o<U.length;o++){const i=U.length-1-o,l=U[i],s=l.text;L&&o>0&&(ce+=H+ue);const d=L?ge:w(de,ae,q[o],$[o],le,o,ie,!(0,h.isNullOrUndefined)(O));if(N===r.BreakType.Wrap)(0,C.drawTextLine)(e,t,n,b,J,s,ce,d,D,X[o],A),O||L||(0,a.cacheTextDecorationLayout)(n,b,t,{textPositionX:ce,textPositionY:d,textWidth:l.underlineWidth,clipRect:A},b.CachedFont);else{const l={breakType:N,singleSpaceWidth:G,maxWidth:W,isProcessingLastLine:I(L,_,i,U.length),isCompleteTextVisible:Y<M,lineDirection:L?r.LineDirection.Vertical:r.LineDirection.Horizontal};(0,c.drawJustifyOrDistributedTextLine)(e,t,n,b,j,i,ce,l,J,d,W,X[o],A,s,d,!(0,h.isNullOrUndefined)(O))}}try{if(K){var he;(0,S.updateContextForPhonetic)(e,n,t.highContrastScheme);const o=(0,R.getPhoneticVerticalPosition)(n,b,de,se.lastTextLineAlphabeticBaselineOffset,Y);(0,S.drawPhoneticText)(e,n,b,o,t),(null===(he=b.PhonInfo)||void 0===he?void 0:he.Text)!==g.EmptyString&&(0,F.setRenderingResultMonitorable)("drawWrapText: PhoneticRendered")}}catch(e){throw(0,F.setRenderingResultMonitorable)("drawWrapText: Error in drawing phonetic: "+e),e}te&&(e.textAlign=Q,e.textBaseline=ee),function(e,t){(0,o.restoreClipping)(e,t)}(e,Z)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tokenizeTextToWrap=t.BreakOpTokenType=void 0;const o=n(3),r=n(1),i=n(32),l=n(9);var a;!function(e){e[e.Space=0]="Space",e[e.Word=1]="Word",e[e.HardBreak=2]="HardBreak",e[e.HardBreakCRLF=3]="HardBreakCRLF"}(a||(t.BreakOpTokenType=a={}));const s="1".charCodeAt(0);function d(e,t,n,o,a,s,d,c){return d?o?(0,l.measureTextRunsHeightForVerticalText)(e,o.TextRuns,o.Text,t,s,a).totalSize:(0,l.measureTextHeightForVerticalText)(c,n):o?(0,i.measureFormattedTextWidth)(e,o,t):function(e,t,n,o,i){return i?o*n.length:(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.TextWidthClientPhase1,t)?(0,l.measureTextWidth)(e,n,!1,!0):e.measureText(n).width}(e,t,n,a,s)}function c(e){switch(e){case o.FullWidthSpace:case o.Whitespace:return a.Space;case o.HardBreak:return a.HardBreak;case o.HardBreakCRLF:return a.HardBreakCRLF}return a.Word}function u(e,t){return"\r"===e[t]&&t<e.length-1&&"\n"===e[t+1]?o.HardBreakCRLF:e[t]}function g(e,t){return t===a.HardBreakCRLF?e+2:e+1}function h(e,t,n){return!(!t||n!==a.Word||e>t.length-1)&&t.charCodeAt(e)===s}t.tokenizeTextToWrap=function(e,t,n,o,r,l,s,C){const f=[];let m=0;const p=n,y=null==C?void 0:C.BreakOp;for(;m<t.length;){const n=c(u(t,m));let C=g(m,n),S=u(t,C),R=c(S);for(;C<t.length&&n===R&&!h(C,y,n);)C=g(C,n),S=u(t,C),R=c(S);const F=C-m,T=t.substring(m,C),w=s?(0,i.substringFormattedText)(s,m,C):void 0;let I=0;switch(n){case a.Word:case a.Space:I=d(e,o,T,w,p,n===a.Space,r,l);break;case a.HardBreak:case a.HardBreakCRLF:break;default:throw"breakToTextLines - textTokenizer - unexpected run type"}f.push({start:m,len:F,value:T,type:n,width:I}),m=C}return f}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.breakWideWordVerticalText=t.breakWideWord=void 0;const o=n(0),r=n(32),i=n(70);class l{get width(){if(-1===this.cachedWidth)if(this.wordFormattedText){if(!this.formattedValue)throw Error("expected formattedValue to be set");this.cachedWidth=(0,r.measureFormattedTextWidth)(this.ctx,this.formattedValue,this.model)}else this.cachedWidth=this.ctx.measureText(this.value).width;return this.cachedWidth}get value(){return this.cachedValue||(this.cachedValue=this.word.substring(0,this.prefixLength)),this.cachedValue}get formattedValue(){return this.wordFormattedText&&(this.cachedFormattedValue=(0,r.substringFormattedText)(this.wordFormattedText,0,this.prefixLength)),this.cachedFormattedValue}constructor(e,t,n,o,r){this.cachedWidth=-1,this.ctx=e,this.word=t,this.prefixLength=n,this.wordFormattedText=r,this.model=o}}class a{item(e){let t=this.cachedItems[e];return t||(t=new l(this.ctx,this.word,e+1,this.model,this.formattedText),this.cachedItems[e]=t),t}constructor(e,t,n,o){this.cachedItems=[],this.ctx=e,this.word=t,this.formattedText=o,this.model=n}}function s(e,t,n,i,l){if(0===t.length)return;const s=new a(e,t,i,l),d={width:n,value:"IGNORED"};let c=(0,o.binarySearch)(s,0,t.length,d,(e,t)=>e.width-t.width);c<0&&(c=~c,0!==c&&(c-=1));const u=s.item(c);return{width:u.width,value:u.value,remaining:t.substring(u.value.length),formattedRemaining:l?(0,r.substringFormattedText)(l,u.value.length):void 0}}t.breakWideWord=function(e,t,n,o,r){const i=[];let l=s(e,t,n,o,r);for(;l;)i.push({value:l.value,size:l.width}),l=s(e,l.remaining,n,o,l.formattedRemaining);return i},t.breakWideWordVerticalText=function(e,t,n){const o=[],r=(0,i.breakToGraphemes)(e);let l=n,a=r[0];for(let e=1;e<r.length;e++)l+n>t?(o.push({value:a,size:l}),l=n,a=r[e]):(l+=n,a+=r[e]);return a&&l>0&&o.push({value:a,size:l}),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawJustifyOrDistributedTextLine=void 0;const o=n(35),r=n(15),i=n(72),l=n(88),a=n(40);function s(e,t,n,r,i){let l=n,a=r;return e.lineDirection===o.LineDirection.Horizontal?l=i+t.Offset:e.lineDirection===o.LineDirection.Vertical&&(a=i-t.Offset),{textPortionOffsetX:l,textPortionOffsetY:a}}t.drawJustifyOrDistributedTextLine=function(e,t,n,d,c,u,g,h,C,f,m,p,y,S,R,F){const T=c.tokensPerLine[u].tokens,w=h.lineDirection===o.LineDirection.Horizontal?(0,r.adjustXForHorizontalAlignment)(n,d,g,m):f;if(p)return void(0,i.drawTextLine)(e,t,n,d,C,S,g,f,m,p,y,T,h);const I=(0,l.getStartOffset)(h,T),b=(0,l.getJustifyDistributedLine)(h,T,(0,l.getSpaceWidthBetweenWords)(T,h),I);if(!b)return;const{textPortionOffsetX:v,textPortionOffsetY:x}=s(h,b.Start,g,f,w);if((0,i.drawTextLine)(e,t,n,d,C,b.Start.Text,v,x,m,p,y),b.Middle){const{textPortionOffsetX:o,textPortionOffsetY:r}=s(h,b.Middle,g,f,w);(0,i.drawTextLine)(e,t,n,d,C,b.Middle.Text,o,r,m,p,y)}if(b.End){const{textPortionOffsetX:o,textPortionOffsetY:r}=s(h,b.End,g,f,w);(0,i.drawTextLine)(e,t,n,d,C,b.End.Text,o,r,m,p,y)}if(!F&&h.lineDirection!==o.LineDirection.Vertical){const e=c.textLines[u],r=function(e,t,n,r,i){switch(e){case o.BreakType.Justify:return r?t.underlineWidth:n;case o.BreakType.Distributed:return r&&1===i?t.underlineWidth:n;case o.BreakType.Wrap:default:return t.underlineWidth}}(h.breakType,e,h.maxWidth,h.isProcessingLastLine,T.length);(0,a.cacheTextDecorationLayout)(n,d,t,{textPositionX:h.lineDirection===o.LineDirection.Horizontal?w+I:g,textPositionY:R,textWidth:r,clipRect:y},d.CachedFont)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updatePreviewTextFormatting=t.updateNumberFormattingInformation=void 0;const o=n(1),r=n(0),i=n(4),l=n(9),a=n(6),s=n(8),d=n(46),c=n(56),u=n(14),g=n(13),h=n(87),C=n(12),f=n(17),m=n(2),p=n(5),y=n(22),S=n(93);function R(e,t,n,o){const r=(0,l.getNumFmtHashWidth)(e,o,t);r<0&&(0,g.setRenderingResultInfo)("buildNumFmtHashesString:: Invalid hashWidth. hashWidth: "+r+" MeasuredWidth: "+(0,s.getFontNameForLogging)(t.CachedFont.FontName)+", FontSize:"+t.CachedFont.Size);const i=w(e,o,t,n,r,!0);let a="";return a+="#".repeat(i),a}function F(e,t,n,o,r,i){let l=o.Start||"";try{l+=o.Separator.repeat(r),l+=o.End||""}catch(r){return(0,g.setRenderingResultInfo)("buildNumFmtText:: Invalid separatorCount."+T(e,t,n,o,i)),o.Start||""+o.End||""}return l}function T(e,t,n,r,i){var l;const a=(0,d.isFontValid)(null===(l=n.CachedFont)||void 0===l?void 0:l.FontName),u=!!a&&(0,c.documentFontsCheck)((0,s.getFontCssStringFromCell)(n,t));return(0,o.annonymize)(r.Separator)+" CachedWidth: "+i+" MeasuredWidth: "+e.measureText(r.Separator).width+", IsSpace: "+(" "===r.Separator)+", FontName:"+(0,s.getFontNameForLogging)(n.CachedFont.FontName)+", FontSize:"+n.CachedFont.Size+", Length: "+r.Separator.length+", MLetterWidth: "+e.measureText("M").width+", IsDocumentAttached: "+function(e){try{return e instanceof CanvasRenderingContext2D?document.contains(e.canvas):"Offscreen"}catch(e){return!1}}(e)+", isFontValid: "+a+", FontLoadCheck: "+u}function w(e,t,n,o,r,i){let s=0;if(n.CachedFont.Italic&&i){const i=(0,l.getOverhangHashWidth)(e,t,n);s=Math.max(Math.floor((o-i)/r),0)}else s=Math.max(Math.floor(o/r),0);return((0,a.isNullOrUndefined)(s)||isNaN(s)||s===1/0)&&((0,g.setRenderingResultInfo)(`calculateSeparatorCountInMaxWidth: Invalid count variable. hashCount: ${s}, cellWidth: ${o}, hashWidth: ${r} `),s=0),s}t.updateNumberFormattingInformation=function(e,t,n,c,I,b){(0,i.verifyArgumentNotNull)(n,"cell","updateNumberFormattingInformation"),(0,i.verifyArgumentNotNull)(n.CachedFont,"cell.CachedFont","updateNumberFormattingInformation"),(0,i.verifyArgumentNotNull)(t,"model","updateNumberFormattingInformation");const v=(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.TextWidthClientPhase1,t);if((0,o.isRenderFlagEnabled)(o.RenderFlagsArray.TextWidthClientPhase1,t)&&n.TolType!==o.TolType.Autofit&&n.ValueType!==o.CellValueType.Error&&n.ValueType!==o.CellValueType.Boolean)return;if((0,u.shouldRenderVerticalText)(n))return;const x=!(0,h.isTestRun)();if(!(0,a.isNullOrUndefined)(n.NumFmt)&&!(0,a.isNullOrUndefined)(n.NumFmt.Separator)&&""!==n.NumFmt.Separator){var D,A;const o=(0,l.measureTextWidth)(e,null===(D=n.NumFmt)||void 0===D?void 0:D.Start,x,v),i=(0,l.measureTextWidth)(e,null===(A=n.NumFmt)||void 0===A?void 0:A.End,x,v);if(o+i>c&&!(0,s.cellHasShrinkToFit)(n)){const o=R(e,n,c,t);(0,r.setCellCachedDisplayText)(n,o),(0,l.cacheLegacyTextWidthOnCell)(e,t,n)}else{var P;const a=(0,l.getNumFmtSeparatorWidth)(e,t,n,n.NumFmt);if(!(0,d.fontFaceSetSupported)())return;const s=(0,d.isValidCellFontLoaded)(t,n);if(0===a&&!s)return;if(0===a)return void(0,g.setRenderingResultInfo)("updateNumberFormattingInformation:: Invalid SeparatorWidth."+T(e,t,n,n.NumFmt,a));const u=w(e,t,n,c-o-i,a,"#"===(null===(P=n.NumFmt)||void 0===P?void 0:P.Separator)),h=F(e,t,n,n.NumFmt,u,a);(0,r.setCellCachedDisplayText)(n,h)}return}let M=Math.round((0,l.getTextWidth)(e,t,n));if((0,y.shouldDrawRotatedText)(t,n.CachedStyle,n.CachedFont)&&(0,o.isChangeGateEnabled)(o.ChangeGate.FixRotatedTextWidth)){const e=(0,l.getTextLineHeight)(n,t);M=(0,S.getRotatedTextWidth)(t,M,e,n.CachedStyle)}if(M>c&&!(0,s.cellHasShrinkToFit)(n)){var B;n.CachedIndent=0;const o=R(e,n,null!==(B=n.CachedStyle)&&void 0!==B&&B.Indentation?function(e,t,n,o){var r;const i=(0,p.getCellWidth)(e,t,!1),a=(0,l.getDistanceFromCellStartToIconEnd)(e,t,n,o);return(0,m.getTextDrawingMaxWidth)(i,(0,l.getCellTextHorizontalPaddingWithoutVisualElements)(e,t),a,(0,C.getExpandCollapseButtonWidth)(null===(r=t.PivotTable)||void 0===r?void 0:r.HasExpandCollapseIndicator),(0,f.getAutoFilterPaddingForAdvancedHorizontalAlignment)(e,t,n,o))}(t,n,I,b):c,t);o!==n.CachedDisplayText&&(n.CachedIsTextWidthExceedsCellWidth=!0,(0,r.setCellCachedDisplayText)(n,o),(0,l.cacheLegacyTextWidthOnCell)(e,t,n))}},t.updatePreviewTextFormatting=function(e,t,n,r){var s;if((0,i.verifyArgumentNotNull)(n,"cell","updatePreviewTextFormatting"),(0,i.verifyArgumentNotNull)(n.CachedFont,"cell.CachedFont","updatePreviewTextFormatting"),(0,i.verifyArgumentNotNull)(t,"model","updatePreviewTextFormatting"),(0,a.isNullOrUndefined)(n.PreviewNumFmt)||(0,a.isNullOrUndefined)(n.PreviewNumFmt.Separator)||""===n.PreviewNumFmt.Separator)return;const c=!(0,h.isTestRun)(),u=(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.TextWidthClientPhase1,t),C=(0,l.measureTextWidth)(e,n.PreviewNumFmt.Start,c,u),f=(0,l.measureTextWidth)(e,n.PreviewNumFmt.End,c,u),m=(0,l.getNumFmtSeparatorWidth)(e,t,n,n.PreviewNumFmt);if(0===m){if(!(0,d.isValidCellFontLoaded)(t,n))return;return void(0,g.setRenderingResultInfo)("updatePreviewTextFormatting:: Invalid SeparatorWidth."+T(e,t,n,n.PreviewNumFmt,m))}const p=w(e,t,n,r-C-f,m,"#"===(null===(s=n.PreviewNumFmt)||void 0===s?void 0:s.Separator));n.PreviewText=F(e,t,n,n.PreviewNumFmt,p,m)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateCachedDisplayTextForFill=void 0;const o=n(1),r=n(2),i=n(0),l=n(9),a=n(5),s=n(13),d=n(12),c=n(17);t.updateCachedDisplayTextForFill=function(e,t,n,u){const g=n.Text;if(g){const h=function(e,t,n){const{zoom:o,devicePixelRatio:i}=n,s=t.Spill?(0,a.getSpillCellWidth)(t,e):(0,a.getCellWidth)(e,t,!1);return(0,r.getTextDrawingMaxWidth)(s,(0,l.getCellTextHorizontalPadding)(t,e,o,i),(0,l.getDistanceFromCellStartToIconEnd)(e,t,o,i),(0,d.getExpandCollapseButtonPadding)(t),(0,c.getAutoFilterPaddingForAdvancedHorizontalAlignment)(e,t,o,i))}(t,n,u),C=(0,l.measureTextWidth)(e,g,!1,(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.TextWidthClientPhase1,t));let f=Math.floor(h/C);f<1&&(f=1),(void 0===f||isNaN(f)||f===1/0)&&((0,s.setRenderingResultInfo)(`updateCachedDisplayTextForFill: Invalid count variable. repeatCount: ${f}, maxTextWidth: ${h}, textWidth: ${C} `),f=1);const m=g.repeat(f);(0,i.setCellCachedDisplayText)(n,m)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerHyperlinkEventHandlers=void 0;const o=n(1),r=n(11),i=n(0),l=n(8),a=n(10),s=n(20),d=n(5),c=n(9),u=n(6),g=n(49),h=n(15),C=n(3),f=n(2),m=n(21),p=n(59),y=n(23),S=n(119);let R=!1,F=!1,T=void 0;function w(e,t){return!(0,u.isNullOrUndefined)(e.Hyperlink)&&!!(0,f.cellIntersectsRenderingRegion)(e,t.renderingRegion)}function I(e,t,n,r){!function(e,t,n,r){const l=(0,m.getUnadjustedHitRegionFromRect)(e,n,r,!1),d=(0,o.getRenderingRegionHitTestCache)(e,(0,i.getRenderingRegionKey)(n.renderingRegion)),c=()=>!(0,a.inRangePicker)(),g=e=>{const t=!!e.metaKey&&e.metaKey,n=!!e.ctrlKey&&e.ctrlKey;return(0,i.isMac)()?t:n};v()?((0,s.registerMouseEnterHitRegion)(t,d,l,o.RenderFeaturesZIndex.Hyperlink,n=>(c()&&v()&&a.showOrHideHyperlinkFloatie&&(0,a.showOrHideHyperlinkFloatie)(e.RowNumbers[t.Row],e.ColumnNumbers[t.Col],!0,n.clientX),!1)),(0,s.registerMouseLeaveHitRegion)(t,d,l,o.RenderFeaturesZIndex.Hyperlink,n=>(v()&&a.showOrHideHyperlinkFloatie&&(0,a.showOrHideHyperlinkFloatie)(e.RowNumbers[t.Row],e.ColumnNumbers[t.Col],!1,n.clientX),!1)),(0,s.registerCursorHitRegion)(t,d,l,"pointer",o.RenderFeaturesZIndex.Hyperlink,g)):((0,s.registerCursorHitRegion)(t,d,l,"pointer",o.RenderFeaturesZIndex.Hyperlink,c),(0,s.registerTooltipHitRegion)(t,d,l,function(e){var t,n,o;return null!==(t=e.Hyperlink)&&void 0!==t&&t.Tooltip?null===(n=e.Hyperlink)||void 0===n?void 0:n.Tooltip:p.gridRendererStrings.hyperlinkToolTip?(0,u.stringFormat)(p.gridRendererStrings.hyperlinkToolTip,null===(o=e.Hyperlink)||void 0===o?void 0:o.Text):C.EmptyString}(t),o.RenderFeaturesZIndex.Hyperlink)),(0,s.registerHitRegion)(t,d,l,o.RenderFeaturesZIndex.Hyperlink,n=>{var o,r,i;if(c()&&!R)if(v()&&g(n)||!v())if(null!==(o=t.Hyperlink)&&void 0!==o&&o.IsValidHyperlink){if(null!==(r=t.Hyperlink)&&void 0!==r&&r.IsHyperlinkExternal)(0,a.followHyperlink)(n,null===(i=t.Hyperlink)||void 0===i?void 0:i.Text);else if(t.Hyperlink.InternalLink){const e=t.Hyperlink.InternalLink;(0,a.handleGoTo)(n,e.ObjectName,e.SheetName,e.FirstRow,e.FirstColumn,e.LastRow,e.LastColumn)}}else(0,a.invalidHyperlinkCallback)();else v()&&(0,a.showCtrlClickHyperlinkCallout)(e.RowNumbers[t.Row],e.ColumnNumbers[t.Col]);return v()?(R=!0,setTimeout(()=>{R=!1},500)):R=!1,!1},"click"),(0,s.registerLongPressHitRegion)(t,d,l,o.RenderFeaturesZIndex.Hyperlink,()=>{F=!0},()=>{F&&(R=!0),F=!1}),(0,s.registerHitRegion)(t,d,l,o.RenderFeaturesZIndex.Hyperlink,y.EmptyFalseCallback,"touchend")}(t,n,r,function(e,t,n,r){const{leftX:i,width:l}=function(e,t,n,r){var i;if(b(n)||!v()&&n.Spill)return{leftX:(0,d.getCellLeftAdjustedForDrawing)(t,n,!1,!1),width:(0,d.getCellWidthAdjustedForDrawing)(t,n)};const l=(0,c.getTextWidth)(e,t,n),a=function(e,t,n,r){var i;const l=(0,c.getTextHorizontalPosition)(e,t,n),a=(null===(i=t.CachedStyle)||void 0===i?void 0:i.HorizontalAlignment)||o.HorizontalAlignment.Automatic;switch(a){case o.HorizontalAlignment.Right:return l-r;case o.HorizontalAlignment.Center:return l-r/2;case o.HorizontalAlignment.Automatic:case o.HorizontalAlignment.Left:return l;default:throw Error("getHyperlinkBoundsOnTextRectLeftX: unsupported horizontalAlignment for hyperlinks on text rect: "+a)}}(t,n,r,l),s=l*r.scaleFactor,u=a*r.scaleFactor;if(!v()&&!n.Spill)return{leftX:Math.max((0,d.getCellLeftAdjustedForDrawing)(t,n,!1,!1),u),width:Math.min((0,d.getCellWidthAdjustedForDrawing)(t,n),s)};if(null!==(i=n.Spill)&&void 0!==i&&i.IsSpillBlocked){const e=t.IsRtl?(0,d.getSpillCellEndCol)(n,t):(0,d.getSpillCellStartCol)(n),o=t.IsRtl?(0,d.getSpillCellStartCol)(n):(0,d.getSpillCellEndCol)(n,t),r=t.IsRtl?(0,S.getColumnRightOffset)(t,e):(0,S.getColumnLeftOffset)(t,e),i=t.IsRtl?(0,S.getColumnLeftOffset)(t,o):(0,S.getColumnRightOffset)(t,o);if(r&&i){const e=Math.max(r,u);return{leftX:e,width:Math.min(i,u+s)-e}}}return{leftX:u,width:s}}(e,t,n,r),{topY:a,height:s}=function(e,t,n){var r;if(b(t)){const n=(0,d.getCellHeightAdjustedForDrawing)(e,t);return{topY:(0,d.getCellTopAdjustedForDrawing)(e,t,!1),height:n}}const i=(0,c.getTextLineHeight)(t,e)*n.scaleFactor,l=function(e,t,n){var r;const i=null===(r=t.CachedStyle)||void 0===r?void 0:r.VerticalAlignment;switch(i){case o.VerticalAlignment.Bottom:return(0,d.getCellBottomAdjustedForDrawing)(e,t)-n-C.GridLineWidthPx;case o.VerticalAlignment.Center:return(0,d.getCellCenterYAdjustedForDrawing)(e,t)-n/2;case o.VerticalAlignment.Top:return(0,d.getCellTopAdjustedForDrawing)(e,t,!1);default:throw Error("getHyperlinkBoundsOnTextRectTopY: unsupported verticalAlignment: "+i)}}(e,t,i);let a=i;const s=null===(r=t.CachedDrawingLayout)||void 0===r?void 0:r.UnderlineRuns;return s&&s.length>0&&(a=s[0].Y+s[0].LineWidth-l),{topY:Math.max(l,(0,d.getCellTopAdjustedForDrawing)(e,t,!1)),height:Math.min(a,(0,d.getCellHeightAdjustedForDrawing)(e,t))}}(t,n,r);return{x:i,y:a,width:l,height:s}}(e,t,n,r))}function b(e){var t;const n=e.CachedStyle;if((0,u.isNullOrUndefined)(n))throw Error("shouldHyperlinkEventsBeRegisteredOnFullCell: cell.CachedStyle is null");return!!(e.WrapText||n.ShrinkToFit||n.Indentation||n.VerticalText||(0,g.isVerticalAlignmentJustifyOrDistributed)(n.VerticalAlignment)||(0,h.isHorizontalAlignmentAdvance)(n.HorizontalAlignment)||e.ValueType===o.CellValueType.Number||e.TextRuns||null!==(t=e.LinkedEntity)&&void 0!==t&&t.IconWidth||e.RichValueIcon||e.HasIgnorableError||(0,u.isNullOrUndefined)(e.Text))}function v(){return void 0===T&&(T=(0,r.getBooleanFeatureGate)("Microsoft.Office.Excel.HyperlinkImprovementSlice1",!1)),T}t.registerHyperlinkEventHandlers=function(e,t,n){(0,o.verifyArgumentNotNull)(e,"ctx","registerHyperlinkEventHandlers"),(0,o.verifyArgumentNotNull)(t,"model","registerHyperlinkEventHandlers"),(0,o.verifyArgumentNotNull)(n,"context","registerHyperlinkEventHandlers");const r=t.ClientOnlyCache.CellsToRender;let i="";for(let o=0;o<r.length;o++){const a=r[o];if(!w(a,n))continue;const s=(0,l.getFontCssStringFromCell)(a,t);i!==s&&(i=s,e.font=s),I(e,t,a,n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawRotatedText=void 0;const o=n(8),r=n(4),i=n(9),l=n(2),a=n(66),s=n(22),d=n(5),c=n(32),u=n(91),g=n(89),h=n(35),C=n(3),f=n(72),m=n(40),p=n(6),y=n(13),S=n(90);function R(e,t,n,o,r,l,a,c){var u;const g=(0,s.getEffectiveHorizontalAlignmentForRotatedText)(null===(u=t.CachedStyle)||void 0===u?void 0:u.HorizontalAlignment,e.IsRtl),h=(0,i.getCellAdornmentPadding)(e,t,a,c),C=(0,s.getUnderlinePadding)(t.CachedFont,l),f=(0,d.getCellLeft)(e,t,e.BlockWidth),m=(0,d.getCellRight)(e,t,e.BlockWidth);return(0,s.getRotatedTextHorizontalPosition)(g,f,m,r,h,C,o,l,n)}function F(e,t,n,o,i){(0,r.verifyArgumentNotNull)(e.CachedDrawingLayout,"CachedDrawingLayout","cacheOrientationLayout");const l={TranslateX:t,TranslateY:n,Angle:o,clipRect:i};e.CachedDrawingLayout.TextOrientationLayout=l}t.drawRotatedText=function(e,t,n,r,T,w,I,b,v,x,D){var A;const P=(0,s.degreeToRadians)((0,s.getOrientationInCanvas)(t.IsRtl,null===(A=n.CachedStyle)||void 0===A?void 0:A.Orientation)),M=x?(0,i.getLargestFont)(t,x.TextRuns):n.CachedFont,B=(0,o.getActualFontSizeFromFont)(n,M,!0);(0,u.shouldDrawWrapText)(n)?function(e,t,n,r,u,T,w,I,b,v,x,D,A){const{zoom:P,devicePixelRatio:M}=r,B=(0,s.getRotatedTextVerticalPadding)(n,T),H=b-C.GridLineWidthPx-C.RotatedTextPaddingMultiplier*B,O=H/I,k=Math.atan(O);let L=0;if(L=Math.abs(w)>=k?Math.round(H/Math.abs(Math.sin(w))):Math.round(I/Math.abs(Math.cos(w))),L<=0)return;const N=(0,i.measureTextWidth)(e,C.Whitespace,!1,!0),E=n.WrapText,z=(0,g.breakTextToLines)(e,u,L,h.BreakType.Wrap,N,t,n,D,E).textLines,{textLinesHeight:W,linesAlphabeticOffset:G,formattedLines:V}=function(e,t,n,r,l,s){const d=[],u=[],g=[];let h=0;if(s){for(let t=0;t<n.length;t++){const o=n[t],r=(0,c.substringFormattedText)(s,o.startIndex,o.endIndex);d[t]=r;const a=(0,i.getFormattedTextLineFontMetrics)(e,r);g[t]=a.baseline,h=(0,i.getFormattedTextLineHeight)(e,r),u[t]=h+l}return{textLinesHeight:u,linesAlphabeticOffset:g,formattedLines:d}}const C=t.CachedFont,f=(0,o.getActualFontSize)(t),m=(0,a.getCachedFontMetrics)(C.FontName,f,e).baseline;for(let e=0;e<n.length;e++)u.push(r+l),g.push(m);return{textLinesHeight:u,linesAlphabeticOffset:g,formattedLines:d}}(t,n,z,v,x,D),j=function(e,t,n,o,r,i,l,a,d){return R(e,t,i,(0,s.getRotatedWrapTextWidth)(n,o,l),o[0]-r[0],l,a,d)}(t,n,z,W,G,I,w,P,M),_=function(e,t,n,o,r,i,l,a,c){const u=(0,s.getIndexOfMaxLineWidth)(n),g=(0,s.getRotatedTextBoxHeight)(n[u].width,o[u],l),h=(0,d.getCellTop)(e,t),C=(0,d.getCellBottom)(e,t);return(0,s.getRotatedTextVerticalPosition)(t.CachedStyle.VerticalAlignment,a,c,g,i,h,C)-r[u]*Math.abs(Math.cos(l))}(t,n,z,W,G,b,w,B,(0,i.isCellBottomPaddingRequired)(t,n)),U=e.textAlign,q=e.textBaseline;(0,l.applyClipping)(e,A),(0,s.applyRotation)(e,j,_,w),F(n,j,_,w,A);let $=0,Y=0;const X=Math.abs(Math.cos(w))/Math.abs(Math.sin(w));for(let o=0;o<z.length;o++)o>0&&(Y=Y+G[o-1]+W[o]-G[o],$=Y*X*(w<0?1:-1)),(0,f.drawTextLine)(e,r,t,n,!0,z[o].text,$,Y,I,V[o],A),D||(0,m.cacheTextDecorationLayout)(t,n,r,{textPositionX:$,textPositionY:Y,textWidth:z[o].underlineWidth,clipRect:A},n.CachedFont);const K=!(0,p.isNullOrUndefined)(n.PhonInfo);try{if(K&&z.length>0){var J;(0,S.updateContextForPhonetic)(e,t,r.highContrastScheme);const o=-(W[0]-x-G[0]);e.textAlign="left",(0,S.drawPhoneticText)(e,t,n,o,r,z[0].width),(null===(J=n.PhonInfo)||void 0===J?void 0:J.Text)!==C.EmptyString&&(0,y.setRenderingResultMonitorable)("drawWrapText: RotatedPhoneticRendered")}}catch(e){throw(0,y.setRenderingResultMonitorable)("drawWrapText: Error in drawing rotated phonetic: "+e),e}e.restore(),e.textAlign=U,e.textBaseline=q,(0,l.restoreClipping)(e,A)}(e,t,n,r,T,B,P,w,I,b,v,x,D):function(e,t,n,o,r,u,g,h,C,f,p,y){var S;const{zoom:T,devicePixelRatio:w}=o,I=(0,i.getTextWidth)(e,t,n),b=(0,a.getCachedFontMetrics)(null===(S=n.CachedFont)||void 0===S?void 0:S.FontName,u,t).baseline,v=function(e,t,n,o,r,i,l,a,d){return R(e,t,o,(0,s.getRotatedTextBoxWidth)(n,r,l),r-i,l,a,d)}(t,n,I,h,f,b,g,T,w),x=function(e,t,n,o,r,i,l,a,c){var u;const g=(0,s.getRotatedTextVerticalPadding)(t,o),h=(0,s.getRotatedTextBoxHeight)(r,i,a),C=(0,d.getCellTop)(e,t),f=(0,d.getCellBottom)(e,t);return(0,s.getRotatedTextVerticalPosition)(null===(u=t.CachedStyle)||void 0===u?void 0:u.VerticalAlignment,g,c,h,n,C,f)-l*Math.abs(Math.cos(a))}(t,n,C,u,I,f,b,g,(0,i.isCellBottomPaddingRequired)(t,n));(0,l.applyClipping)(e,y),(0,s.applyRotation)(e,v,x,g),F(n,v,x,g,y),p&&!n.DisplayFormula?(0,c.fillRichTextFormat)(e,o,t,n,p,0,0,y):(e.fillText(r,0,0),(0,m.cacheTextDecorationLayout)(t,n,o,{textPositionX:0,textPositionY:0,textWidth:I,clipRect:y},n.CachedFont)),e.restore(),(0,l.restoreClipping)(e,y)}(e,t,n,r,T,B,P,w,I,b+v,x,D)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CheckboxDefaultFontSize=t.CheckboxTrueFallbackFont=t.CheckboxFalseFallbackFont=t.CheckboxTrueYellowFont=t.CheckboxFalseYellowFont=t.BlankCheckboxOpacity=t.CheckboxOpacity=t.AdjustedCheckboxIconTopOffset=void 0,t.AdjustedCheckboxIconTopOffset=2,t.CheckboxOpacity=1,t.BlankCheckboxOpacity=.6,t.CheckboxFalseYellowFont=57944,t.CheckboxTrueYellowFont=57945,t.CheckboxFalseFallbackFont=9744,t.CheckboxTrueFallbackFont=9745,t.CheckboxDefaultFontSize=16},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fillCellWithGradientBackground=void 0;const o=n(1),r=n(4);function i(e,t,n,i){(0,r.verifyArgumentNotNull)(n,"cell.CachedStyle.Gradient.Stops","createGradientFill");const l=function(e,t){const{x:n,y:r,width:i,height:l}=t;switch(e){case o.GradientShadingStyle.Vertical:case o.GradientShadingStyle.Center:case o.GradientShadingStyle.TopRightCorner:return{x0:n,y0:0,x1:n+i,y1:0};case o.GradientShadingStyle.ReversedVertical:case o.GradientShadingStyle.TopLeftCorner:return{x0:n+i,y0:0,x1:n,y1:0};case o.GradientShadingStyle.Horizontal:case o.GradientShadingStyle.BottomRightCorner:case o.GradientShadingStyle.BottomLeftCorner:return{x0:0,y0:r,x1:0,y1:r+l};case o.GradientShadingStyle.ReversedHorizontal:return{x0:0,y0:r+l,x1:0,y1:r};case o.GradientShadingStyle.DiagonalUp:case o.GradientShadingStyle.DiagonalDown:case o.GradientShadingStyle.ReversedDiagonalUp:case o.GradientShadingStyle.ReversedDiagonalDown:return function(e,t){const n=t.width*t.width,r=t.height*t.height,i=n+r,l=t.x+t.width/2,a=t.y+t.height/2;let s=t.width*r/i,d=n*t.height/i;switch(e){case o.GradientShadingStyle.DiagonalUp:break;case o.GradientShadingStyle.DiagonalDown:s=-s;break;case o.GradientShadingStyle.ReversedDiagonalUp:d=-d;break;case o.GradientShadingStyle.ReversedDiagonalDown:s=-s,d=-d;break;default:throw Error("getDiagonalGradientLine:: Gradient shading style is not diagonal.")}return{x0:l-s,y0:a-d,x1:l+s,y1:a+d}}(e,t);default:throw Error("getGradientLine:: Gradient not supported")}}(t,i),a=e.createLinearGradient(l.x0,l.y0,l.x1,l.y1);for(let e=0;e<n.length;e++)a.addColorStop(n[e].Position,n[e].Color);return a}t.fillCellWithGradientBackground=function(e,t,n,r){let l=i(e,t.ShadingStyle,t.Stops,n);return l!==r&&(e.fillStyle=l),e.fillRect(n.x,n.y,n.width,n.height),function(e){switch(e){case o.GradientShadingStyle.TopLeftCorner:case o.GradientShadingStyle.TopRightCorner:case o.GradientShadingStyle.BottomLeftCorner:case o.GradientShadingStyle.BottomRightCorner:case o.GradientShadingStyle.Center:return!0;default:return!1}}(t.ShadingStyle)&&(l=e.fillStyle=i(e,function(e){switch(e){case o.GradientShadingStyle.TopLeftCorner:case o.GradientShadingStyle.TopRightCorner:return o.GradientShadingStyle.ReversedHorizontal;case o.GradientShadingStyle.BottomLeftCorner:return o.GradientShadingStyle.ReversedVertical;case o.GradientShadingStyle.BottomRightCorner:return o.GradientShadingStyle.Vertical;case o.GradientShadingStyle.Center:return o.GradientShadingStyle.Horizontal;default:throw Error("getSecondPassShadingStyle:: Gradient shading style does not have a second pass.")}}(t.ShadingStyle),t.Stops,n),function(e,t,n){const{x:r,y:i,width:l,height:a}=n;switch(e.beginPath(),e.moveTo(r,i),e.lineTo(r+l,i),t){case o.GradientShadingStyle.TopLeftCorner:case o.GradientShadingStyle.BottomRightCorner:e.lineTo(r+l,i+a);break;case o.GradientShadingStyle.TopRightCorner:case o.GradientShadingStyle.BottomLeftCorner:e.lineTo(r,i+a);break;case o.GradientShadingStyle.Center:e.lineTo(r,i+a),e.lineTo(r+l,i+a);break;default:throw Error("setSecondPassStencil:: Gradient shading style does not have a second pass.")}e.lineTo(r,i)}(e,t.ShadingStyle,n),e.fill()),l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawGridCellsPattern=void 0;const o=n(1),r=n(2),i=n(5),l=n(3);function a(e,t,n){if(e===n.RowNumbers.length-1)return!0;const r=(0,o.getCell)(e+1,t,n);if(!r)return!0;const i=r.CachedStyle;return!(null!=i&&i.BackgroundColor||null!=i&&i.Gradient||null!=i&&i.PatternStyle)}function s(e,t,n){if(t===n.ColumnNumbers.length-1)return!0;const r=(0,o.getCell)(e,t+1,n);if(!r)return!0;const i=r.CachedStyle;return!(null!=i&&i.BackgroundColor||null!=i&&i.Gradient||null!=i&&i.PatternStyle)}t.drawGridCellsPattern=function(e,t,n){if(n.highContrastScheme)return;const d=new Map,c=t.ClientOnlyCache.GridlineOverridingCellsToRender;for(let e=0;e<c.length;e++){const t=c[e];if(!(0,r.cellIntersectsRenderingRegion)(t,n.renderingRegion))continue;const i={styleType:(g=t).CachedStyle.PatternStyle,color:g.CachedStyle.PatternColor},l=i.styleType;if(!l||l===o.PatternStyleType.Solid)continue;const a=`${(u=i).styleType}_${u.color}`;d.has(a)?d.get(a).push(t):d.set(a,[t])}var u,g;d.forEach((r,d)=>{const c=function(e,t){const n=document.createElement("canvas"),r=t<=1?1:Math.trunc(t);n.width=l.PatternTileSize*r,n.height=l.PatternTileSize*r;const i=n.getContext("2d");switch(i.scale(r,r),i.fillStyle=e.color,i.strokeStyle=e.color,e.styleType){case o.PatternStyleType.Gray75:i.beginPath(),i.lineWidth=1,i.moveTo(1+l.pixelTranslation,0),i.lineTo(1+l.pixelTranslation,n.height),i.moveTo(3+l.pixelTranslation,0),i.lineTo(3+l.pixelTranslation,n.height),i.moveTo(5+l.pixelTranslation,0),i.lineTo(5+l.pixelTranslation,n.height),i.moveTo(7+l.pixelTranslation,0),i.lineTo(7+l.pixelTranslation,n.height),i.stroke(),i.beginPath(),i.setLineDash([1,1]),i.moveTo(l.pixelTranslation,0),i.lineTo(l.pixelTranslation,n.height),i.moveTo(2+l.pixelTranslation,1),i.lineTo(2+l.pixelTranslation,n.height),i.moveTo(4+l.pixelTranslation,0),i.lineTo(4+l.pixelTranslation,n.height),i.moveTo(6+l.pixelTranslation,1),i.lineTo(6+l.pixelTranslation,n.height),i.stroke();break;case o.PatternStyleType.Gray50:i.beginPath(),i.setLineDash([1,1]),i.lineWidth=1,i.moveTo(l.pixelTranslation,1),i.lineTo(l.pixelTranslation,n.height),i.moveTo(1+l.pixelTranslation,0),i.lineTo(1+l.pixelTranslation,n.height),i.moveTo(2+l.pixelTranslation,1),i.lineTo(2+l.pixelTranslation,n.height),i.moveTo(3+l.pixelTranslation,0),i.lineTo(3+l.pixelTranslation,n.height),i.moveTo(4+l.pixelTranslation,1),i.lineTo(4+l.pixelTranslation,n.height),i.moveTo(5+l.pixelTranslation,0),i.lineTo(5+l.pixelTranslation,n.height),i.moveTo(6+l.pixelTranslation,1),i.lineTo(6+l.pixelTranslation,n.height),i.moveTo(7+l.pixelTranslation,0),i.lineTo(7+l.pixelTranslation,n.height),i.stroke();break;case o.PatternStyleType.Gray25:i.beginPath(),i.setLineDash([1,1]),i.lineWidth=1,i.moveTo(1+l.pixelTranslation,0),i.lineTo(1+l.pixelTranslation,n.height),i.moveTo(3+l.pixelTranslation,1),i.lineTo(3+l.pixelTranslation,n.height),i.moveTo(5+l.pixelTranslation,0),i.lineTo(5+l.pixelTranslation,n.height),i.moveTo(7+l.pixelTranslation,1),i.lineTo(7+l.pixelTranslation,n.height),i.stroke();break;case o.PatternStyleType.Gray125:i.beginPath(),i.setLineDash([1,3]),i.lineWidth=1,i.moveTo(1+l.pixelTranslation,3),i.lineTo(1+l.pixelTranslation,n.height),i.moveTo(3+l.pixelTranslation,1),i.lineTo(3+l.pixelTranslation,n.height),i.moveTo(5+l.pixelTranslation,3),i.lineTo(5+l.pixelTranslation,n.height),i.moveTo(7+l.pixelTranslation,1),i.lineTo(7+l.pixelTranslation,n.height),i.stroke();break;case o.PatternStyleType.Gray0625:i.beginPath(),i.setLineDash([1,3]),i.lineWidth=1,i.moveTo(3+l.pixelTranslation,1),i.lineTo(3+l.pixelTranslation,n.height),i.moveTo(7+l.pixelTranslation,3),i.lineTo(7+l.pixelTranslation,n.height),i.stroke();break;case o.PatternStyleType.DiagStripe:i.beginPath(),i.setLineDash([2,2]),i.lineWidth=1,i.moveTo(2,l.pixelTranslation),i.lineTo(n.width,l.pixelTranslation),i.moveTo(1,1+l.pixelTranslation),i.lineTo(n.width,1+l.pixelTranslation),i.moveTo(0,2+l.pixelTranslation),i.lineTo(n.width,2+l.pixelTranslation),i.moveTo(3,3+l.pixelTranslation),i.lineTo(n.width,3+l.pixelTranslation),i.moveTo(2,4+l.pixelTranslation),i.lineTo(n.width,4+l.pixelTranslation),i.moveTo(1,5+l.pixelTranslation),i.lineTo(n.width,5+l.pixelTranslation),i.moveTo(0,6+l.pixelTranslation),i.lineTo(n.width,6+l.pixelTranslation),i.moveTo(3,7+l.pixelTranslation),i.lineTo(n.width,7+l.pixelTranslation),i.stroke(),i.fillRect(0,3,1,1),i.fillRect(0,7,1,1);break;case o.PatternStyleType.ThinDiagStripe:i.beginPath(),i.setLineDash([1,3]),i.lineWidth=1,i.moveTo(3,l.pixelTranslation),i.lineTo(n.width,l.pixelTranslation),i.moveTo(2,1+l.pixelTranslation),i.lineTo(n.width,1+l.pixelTranslation),i.moveTo(1,2+l.pixelTranslation),i.lineTo(n.width,2+l.pixelTranslation),i.moveTo(0,3+l.pixelTranslation),i.lineTo(n.width,3+l.pixelTranslation),i.moveTo(3,4+l.pixelTranslation),i.lineTo(n.width,4+l.pixelTranslation),i.moveTo(2,5+l.pixelTranslation),i.lineTo(n.width,5+l.pixelTranslation),i.moveTo(1,6+l.pixelTranslation),i.lineTo(n.width,6+l.pixelTranslation),i.moveTo(0,7+l.pixelTranslation),i.lineTo(n.width,7+l.pixelTranslation),i.stroke();break;case o.PatternStyleType.ReverseDiagStripe:i.beginPath(),i.setLineDash([2,2]),i.lineWidth=1,i.moveTo(1,l.pixelTranslation),i.lineTo(n.width,l.pixelTranslation),i.moveTo(2,1+l.pixelTranslation),i.lineTo(n.width,1+l.pixelTranslation),i.moveTo(3,2+l.pixelTranslation),i.lineTo(n.width,2+l.pixelTranslation),i.moveTo(0,3+l.pixelTranslation),i.lineTo(n.width,3+l.pixelTranslation),i.moveTo(1,4+l.pixelTranslation),i.lineTo(n.width,4+l.pixelTranslation),i.moveTo(2,5+l.pixelTranslation),i.lineTo(n.width,5+l.pixelTranslation),i.moveTo(3,6+l.pixelTranslation),i.lineTo(n.width,6+l.pixelTranslation),i.moveTo(0,7+l.pixelTranslation),i.lineTo(n.width,7+l.pixelTranslation),i.stroke(),i.fillRect(0,2,1,1),i.fillRect(0,6,1,1);break;case o.PatternStyleType.ThinReverseDiagStripe:i.beginPath(),i.setLineDash([1,3]),i.lineWidth=1,i.moveTo(1,l.pixelTranslation),i.lineTo(n.width,l.pixelTranslation),i.moveTo(2,1+l.pixelTranslation),i.lineTo(n.width,1+l.pixelTranslation),i.moveTo(3,2+l.pixelTranslation),i.lineTo(n.width,2+l.pixelTranslation),i.moveTo(0,3+l.pixelTranslation),i.lineTo(n.width,3+l.pixelTranslation),i.moveTo(1,4+l.pixelTranslation),i.lineTo(n.width,4+l.pixelTranslation),i.moveTo(2,5+l.pixelTranslation),i.lineTo(n.width,5+l.pixelTranslation),i.moveTo(3,6+l.pixelTranslation),i.lineTo(n.width,6+l.pixelTranslation),i.moveTo(0,7+l.pixelTranslation),i.lineTo(n.width,7+l.pixelTranslation),i.stroke();break;case o.PatternStyleType.HorzStripe:i.beginPath(),i.lineWidth=2,i.moveTo(0,1),i.lineTo(n.width,1),i.moveTo(0,5),i.lineTo(n.width,5),i.stroke();break;case o.PatternStyleType.ThinHorzStripe:i.beginPath(),i.lineWidth=1,i.moveTo(0,1+l.pixelTranslation),i.lineTo(n.width,1+l.pixelTranslation),i.moveTo(0,5+l.pixelTranslation),i.lineTo(n.width,5+l.pixelTranslation),i.stroke();break;case o.PatternStyleType.VertStripe:i.beginPath(),i.lineWidth=2,i.moveTo(1,0),i.lineTo(1,n.height),i.moveTo(5,0),i.lineTo(5,n.height),i.stroke();break;case o.PatternStyleType.ThinVertStripe:i.beginPath(),i.lineWidth=1,i.moveTo(1+l.pixelTranslation,0),i.lineTo(1+l.pixelTranslation,n.height),i.moveTo(5+l.pixelTranslation,0),i.lineTo(5+l.pixelTranslation,n.height),i.stroke();break;case o.PatternStyleType.ThinHorzCross:i.beginPath(),i.lineWidth=1,i.moveTo(0,1+l.pixelTranslation),i.lineTo(n.width,1+l.pixelTranslation),i.moveTo(0,5+l.pixelTranslation),i.lineTo(n.width,5+l.pixelTranslation),i.moveTo(3+l.pixelTranslation,0),i.lineTo(3+l.pixelTranslation,n.height),i.moveTo(7+l.pixelTranslation,0),i.lineTo(7+l.pixelTranslation,n.height),i.stroke();break;case o.PatternStyleType.ThinDiagCross:i.beginPath(),i.setLineDash([1,1]),i.lineWidth=1,i.moveTo(0+l.pixelTranslation,0),i.lineTo(0+l.pixelTranslation,n.height),i.moveTo(2+l.pixelTranslation,0),i.lineTo(2+l.pixelTranslation,n.height),i.moveTo(4+l.pixelTranslation,0),i.lineTo(4+l.pixelTranslation,n.height),i.moveTo(6+l.pixelTranslation,0),i.lineTo(6+l.pixelTranslation,n.height),i.stroke(),i.beginPath(),i.setLineDash([1,3]),i.moveTo(1+l.pixelTranslation,3),i.lineTo(1+l.pixelTranslation,n.height),i.moveTo(3+l.pixelTranslation,1),i.lineTo(3+l.pixelTranslation,n.height),i.moveTo(5+l.pixelTranslation,3),i.lineTo(5+l.pixelTranslation,n.height),i.moveTo(7+l.pixelTranslation,1),i.lineTo(7+l.pixelTranslation,n.height),i.stroke();break;case o.PatternStyleType.DiagCross:i.beginPath(),i.setLineDash([2,2]),i.lineWidth=1,i.moveTo(2,l.pixelTranslation),i.lineTo(n.width,l.pixelTranslation),i.moveTo(2,1+l.pixelTranslation),i.lineTo(n.width,1+l.pixelTranslation),i.moveTo(0,2+l.pixelTranslation),i.lineTo(n.width,2+l.pixelTranslation),i.moveTo(0,3+l.pixelTranslation),i.lineTo(n.width,3+l.pixelTranslation),i.moveTo(2,4+l.pixelTranslation),i.lineTo(n.width,4+l.pixelTranslation),i.moveTo(2,5+l.pixelTranslation),i.lineTo(n.width,5+l.pixelTranslation),i.moveTo(0,6+l.pixelTranslation),i.lineTo(n.width,6+l.pixelTranslation),i.moveTo(0,7+l.pixelTranslation),i.lineTo(n.width,7+l.pixelTranslation),i.stroke();break;case o.PatternStyleType.ThickDiagCross:i.beginPath(),i.lineWidth=1,i.moveTo(0,1+l.pixelTranslation),i.lineTo(n.width,1+l.pixelTranslation),i.moveTo(0,3+l.pixelTranslation),i.lineTo(n.width,3+l.pixelTranslation),i.moveTo(0,5+l.pixelTranslation),i.lineTo(n.width,5+l.pixelTranslation),i.moveTo(0,7+l.pixelTranslation),i.lineTo(n.width,7+l.pixelTranslation),i.stroke(),i.beginPath(),i.setLineDash([2,2]),i.moveTo(2,0+l.pixelTranslation),i.lineTo(n.width,0+l.pixelTranslation),i.moveTo(0,2+l.pixelTranslation),i.lineTo(n.width,2+l.pixelTranslation),i.moveTo(2,4+l.pixelTranslation),i.lineTo(n.width,4+l.pixelTranslation),i.moveTo(0,6+l.pixelTranslation),i.lineTo(n.width,6+l.pixelTranslation),i.stroke();break;default:throw Error("getPatternStyleTile:: Pattern not supported: "+e.styleType)}return n}(function(e){const t={styleType:o.PatternStyleType.None,color:""};if(!e)return t;const n=e.split("_");return 2!==n.length||(t.styleType=o.PatternStyleType[o.PatternStyleType[parseInt(n[0],10)]],t.color=n[1]),t}(d),n.devicePixelRatio),u=e.createPattern(c,"repeat");if(!u)throw Error("CanvasPattern from patternTile is null for "+d);e.fillStyle=u;for(let n=0;n<r.length;n++){const o=r[n],d=(0,i.getCellDimensionsAdjustedForDrawing)(t,o,!1),c=a(o.Row,o.Col,t)?d.height:d.height-l.GridLineWidthPx;let u=d.width,g=d.x;s(o.Row,o.Col,t)||(t.IsRtl?g+=l.GridLineWidthPx:u-=l.GridLineWidthPx),e.fillRect(g,d.y,u,c)}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawConditionalFormattingIcons=void 0;const o=n(0),r=n(8),i=n(4),l=n(2),a=n(19),s=n(75),d=n(3),c=n(180),u=n(74),g=n(12),h=n(181),C=n(182),f=n(183),m=n(184),p=n(185),y=n(186),S=n(123),R=n(187),F=n(124),T=n(41),w=n(18);function I(e,t,n,o,i){const d=function(e,t,n,o){const i=t.CondFormat.Icon.IconOnly?t.CachedFont.Size:(0,r.getActualFontSize)(t),l=(0,g.getIconSize)(i,n),s=t.CondFormat.Icon;return{size:l,image:a.IconImageLookup[s.Set][s.Index],left:(0,u.getIconLeftPosition)(e,t,l,i,n),bottom:(0,u.getIconVerticalPosition)(e,t,n,l),highContrastScheme:o}}(t,n,o,i),w=(0,T.getClipRect)(t,n,d.left,d.bottom,d.size,!1);if(!(d.size<=a.MinimalIconSize)){switch((0,l.applyClipping)(e,w),d.image){case a.CFIconImage.CircleLow:case a.CFIconImage.CircleMedium:case a.CFIconImage.CircleHigh:case a.CFIconImage.CircleEmpty:case a.CFIconImage.CircleFilled:case a.CFIconImage.FourCircleHigh:case a.CFIconImage.FourCircleLow:case a.CFIconImage.FourCircleMedium1:case a.CFIconImage.FourCircleMedium2:case a.CFIconImage.Circle25:case a.CFIconImage.CircleHalf:case a.CFIconImage.Circle75:(0,s.drawCircleIcon)(e,d);break;case a.CFIconImage.CircleSymbolHigh:case a.CFIconImage.CircleSymbolMedium:case a.CFIconImage.CircleSymbolLow:(0,F.drawCircledSymbols)(e,d);break;case a.CFIconImage.TrafficHigh:case a.CFIconImage.TrafficMedium:case a.CFIconImage.TrafficLow:(0,c.drawTrafficLightRimmed)(e,d);break;case a.CFIconImage.SignalBarEmpty:case a.CFIconImage.SignalBarLow:case a.CFIconImage.SignalBarMedium1:case a.CFIconImage.SignalBarMedium2:case a.CFIconImage.SignalBarHigh:(0,h.drawSignalBar)(e,d);break;case a.CFIconImage.QuadrantEmpty:case a.CFIconImage.Quadrant25:case a.CFIconImage.QuadrantHalf:case a.CFIconImage.Quadrant75:case a.CFIconImage.QuadrantFull:(0,C.drawQuadrantBoxes)(e,d);break;case a.CFIconImage.FlagHigh:case a.CFIconImage.FlagMedium:case a.CFIconImage.FlagLow:(0,f.drawFlag)(e,d);break;case a.CFIconImage.TriangleHigh:case a.CFIconImage.TriangleMedium:case a.CFIconImage.TriangleLow:(0,m.drawTriangleSet)(e,d);break;case a.CFIconImage.StarHigh:case a.CFIconImage.StarMedium:case a.CFIconImage.StarLow:(0,p.drawStarIcon)(e,d);break;case a.CFIconImage.SignLow:case a.CFIconImage.SignMedium:(0,y.drawSigns)(e,d);break;case a.CFIconImage.SymbolHigh:case a.CFIconImage.SymbolMedium:case a.CFIconImage.SymbolLow:(0,S.drawSymbols)(e,d);break;case a.CFIconImage.ColoredArrowDown:case a.CFIconImage.ColoredArrowDownRight:case a.CFIconImage.ColoredArrowRight:case a.CFIconImage.ColoredArrowUp:case a.CFIconImage.ColoredArrowUpRight:case a.CFIconImage.GrayArrowDown:case a.CFIconImage.GrayArrowDownRight:case a.CFIconImage.GrayArrowRight:case a.CFIconImage.GrayArrowUp:case a.CFIconImage.GrayArrowUpRight:(0,R.drawArrows)(e,d);break;default:throw Error(`drawConditionalFormattingIcon: imageType: ${d.image} not supported`)}(0,l.restoreClipping)(e,w)}}t.drawConditionalFormattingIcons=function(e,t,n){(0,i.verifyArgumentNotNull)(e,"ctx","drawConditionalFormattingIcons"),(0,i.verifyArgumentNotNull)(t,"model","drawConditionalFormattingIcons"),(0,i.verifyArgumentNotNull)(n,"context","drawConditionalFormattingIcons");const r=t.ClientOnlyCache.CellsToRender;r.length>0&&(e.lineWidth=w.ShapeOutlineWidthPx,e.setLineDash(d.DefaultDash));const a=null!==n.highContrastScheme?n.highContrastScheme:void 0;for(let i=0;i<r.length;i++){var s;const d=r[i];null!=d&&null!==(s=d.CondFormat)&&void 0!==s&&s.Icon&&((0,o.isCellPreviewTextDefined)(d.PreviewText)||d.ShowSkeleton||(0,l.cellIntersectsRenderingRegion)(d,n.renderingRegion)&&I(e,t,d,n.scaleFactor,a))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawStripes=t.getInnerCircleRadius=t.getHighContrastFillingType=t.FillType=void 0;const o=n(19),r=n(2),i=n(18);var l;!function(e){e[e.Empty=0]="Empty",e[e.Stripes=1]="Stripes",e[e.InnerCircle=2]="InnerCircle",e[e.FillPortion=3]="FillPortion",e[e.Full=4]="Full"}(l||(t.FillType=l={})),t.getHighContrastFillingType=function(e){switch(e){case o.CFIconImage.Circle25:case o.CFIconImage.CircleHalf:case o.CFIconImage.Circle75:return l.FillPortion;case o.CFIconImage.CircleLow:case o.CFIconImage.CircleEmpty:case o.CFIconImage.FourCircleHigh:case o.CFIconImage.TrafficLow:case o.CFIconImage.CircleSymbolLow:case o.CFIconImage.CircleSymbolMedium:case o.CFIconImage.CircleSymbolHigh:return l.Empty;case o.CFIconImage.CircleHigh:case o.CFIconImage.TrafficHigh:case o.CFIconImage.CircleFilled:return l.Full;case o.CFIconImage.CircleMedium:case o.CFIconImage.TrafficMedium:return l.Stripes;case o.CFIconImage.FourCircleLow:case o.CFIconImage.FourCircleMedium1:case o.CFIconImage.FourCircleMedium2:return l.InnerCircle;default:throw Error(`getHighContrastFillingType: image: ${e} not supported`)}},t.getInnerCircleRadius=function(e,t){switch(e){case o.CFIconImage.FourCircleMedium2:return t*o.CircleHighContrastSmallRadiusPortion;case o.CFIconImage.FourCircleMedium1:return t*o.CircleHighContrastMediumRadiusPortion;case o.CFIconImage.FourCircleLow:return t*o.CircleHighContrastLargeRadiusPortion;default:throw Error("highContrastCircles::getInnerRadius: unsupported image for drawing inner circle")}},t.drawStripes=function(e,t,n,l,a){e.strokeStyle=a,e.beginPath();const s={p1:{x:t+l*Math.cos(o.StripedCircleUpperLineAngle)-i.ShapeLinesAdjustment,y:n+l*Math.sin(o.StripedCircleUpperLineAngle)-i.ShapeLinesAdjustment},p2:{x:t+l*Math.cos(o.Circle270Deg-o.StripedCircleUpperLineAngle)+i.ShapeLinesAdjustment,y:n+l*Math.sin(o.Circle270Deg-o.StripedCircleUpperLineAngle)+i.ShapeLinesAdjustment}},d={p1:{x:t+l*Math.cos(o.StripedCircleMiddleLineAngle)-i.ShapeLinesAdjustment,y:n+l*Math.sin(o.StripedCircleMiddleLineAngle)-i.ShapeLinesAdjustment},p2:{x:t+l*Math.cos(o.Circle270Deg-o.StripedCircleMiddleLineAngle)+i.ShapeLinesAdjustment,y:n+l*Math.sin(o.Circle270Deg-o.StripedCircleMiddleLineAngle)+i.ShapeLinesAdjustment}},c={p1:{x:t+l*Math.cos(o.StripedCircleLowerLineAngle)-i.ShapeLinesAdjustment,y:n+l*Math.sin(o.StripedCircleLowerLineAngle)-i.ShapeLinesAdjustment},p2:{x:t+l*Math.cos(o.Circle270Deg-o.StripedCircleLowerLineAngle)+i.ShapeLinesAdjustment,y:n+l*Math.sin(o.Circle270Deg-o.StripedCircleLowerLineAngle)+i.ShapeLinesAdjustment}};(0,r.drawLine)(e,s.p1.x,s.p1.y,s.p2.x,s.p2.y),(0,r.drawLine)(e,d.p1.x,d.p1.y,d.p2.x,d.p2.y),(0,r.drawLine)(e,c.p1.x,c.p1.y,c.p2.x,c.p2.y),e.stroke()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawTrafficLightRimmed=void 0;const o=n(0),r=n(4),i=n(19),l=n(27),a=n(75),s=n(28);t.drawTrafficLightRimmed=function(e,t){(0,r.verifyArgumentNotNull)(e,"ctx","drawTrafficLightRimmed"),(0,r.verifyArgumentNotNull)(t,"drawingContext","drawTrafficLightRimmed");const{size:n,left:d,bottom:c,highContrastScheme:u}=t;let g=n;n%2==0&&(g=n-1);const h={left:d,bottom:c,outerColor:function(e){return e?(0,o.rgbToColorHex)(e.TextColor):s.TrafficHighRimmedRectColor}(u),height:g,width:g,innerColor:void 0};(0,l.drawRectangle)(e,h),t.size=g;const C=function(e){const{image:t,left:n,bottom:o,highContrastScheme:r,size:l}=e;return{size:l-2*i.CirclePaddingFromBoundariesPx,left:n+i.CirclePaddingFromBoundariesPx+.5,bottom:o-i.CirclePaddingFromBoundariesPx-.5,image:t,highContrastScheme:r}}(t);(0,a.drawCircleIcon)(e,C)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawSignalBar=void 0;const o=n(0),r=n(4),i=n(27),l=n(19),a=n(28),s=n(2),d=n(18);function c(e,t,n,r){const{left:i,bottom:l,highContrastScheme:s}=r;return{innerColor:t,outerColor:function(e){return e?(0,o.rgbToColorHex)(e.TextColor):a.SignalBarOutlineColor}(s),bottom:l,left:i+n*(e+1),height:n*(e+2),width:n}}t.drawSignalBar=function(e,t){(0,r.verifyArgumentNotNull)(e,"ctx","drawSignalBar"),(0,r.verifyArgumentNotNull)(t,"drawingContext","drawSignalBar");const{image:n,size:u,highContrastScheme:g}=t,h=Math.floor(u/5),C=function(e,t){const n=function(e){return e?(0,o.rgbToColorHex)(e.BackgroundColor):a.SignalBarEmptyColor}(t),r=function(e){return e?(0,o.rgbToColorHex)(e.TextColor):a.SignalBarFilledColor}(t);switch(e){case l.CFIconImage.SignalBarEmpty:return[n,n,n,n];case l.CFIconImage.SignalBarLow:return[r,n,n,n];case l.CFIconImage.SignalBarMedium1:return[r,r,n,n];case l.CFIconImage.SignalBarMedium2:return[r,r,r,n];case l.CFIconImage.SignalBarHigh:return[r,r,r,r];default:throw Error(`getBarsColors: image: ${e} not supported`)}}(n,g);for(let n=0;n<C.length;n++){const o=c(n,C[n],h,t);(0,i.drawRectangle)(e,o)}g&&function(e,t,n,r){const{left:i,bottom:a,highContrastScheme:c}=n,u=function(e,t,n,o){const r=function(e){switch(e){case l.CFIconImage.SignalBarEmpty:case l.CFIconImage.SignalBarLow:return 0;case l.CFIconImage.SignalBarMedium1:return 1;case l.CFIconImage.SignalBarMedium2:return 2;case l.CFIconImage.SignalBarHigh:return 3;default:throw Error(`getSeperators: image: ${e} not supported`)}}(e),i=[];let a=n-2*o+d.ShapeLinesAdjustment,s=t+2*o+d.ShapeLinesAdjustment;for(let e=0;e<r;e++)i.push({X:s,startY:a,endY:n-1.5}),a-=o,s+=o;return i}(e,i,a,r);t.strokeStyle=(0,o.rgbToColorHex)(c.BackgroundColor),t.beginPath();for(let e=0;e<u.length;e++)(0,s.drawLine)(t,u[e].X,u[e].startY,u[e].X,u[e].endY);t.stroke()}(n,e,t,h)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawQuadrantBoxes=void 0;const o=n(0),r=n(4),i=n(27),l=n(19),a=n(28),s=n(2),d=n(18);function c(e,t,n,r,i){const{left:l,bottom:s,highContrastScheme:d}=i;return{innerColor:n,outerColor:function(e){return e?(0,o.rgbToColorHex)(e.TextColor):a.SignalBarOutlineColor}(d),bottom:s-e*r,left:l+t*r,height:r,width:r}}t.drawQuadrantBoxes=function(e,t){(0,r.verifyArgumentNotNull)(e,"ctx","drawQuadrantBoxes"),(0,r.verifyArgumentNotNull)(t,"drawingContext","drawQuadrantBoxes");const{image:n,size:u,highContrastScheme:g}=t,h=Math.floor(u/2),C=function(e,t){const n=function(e){return e?(0,o.rgbToColorHex)(e.TextColor):a.SignalBarFilledColor}(t),r=function(e){return e?(0,o.rgbToColorHex)(e.BackgroundColor):a.SignalBarEmptyColor}(t);switch(e){case l.CFIconImage.QuadrantEmpty:return[[r,r],[r,r]];case l.CFIconImage.Quadrant25:return[[n,r],[r,r]];case l.CFIconImage.QuadrantHalf:return[[n,n],[r,r]];case l.CFIconImage.Quadrant75:return[[n,n],[n,r]];case l.CFIconImage.QuadrantFull:return[[n,n],[n,n]];default:throw Error(`getBoxesColors: image: ${e} not supported`)}}(n,g);for(let n=0;n<C.length;n++)for(let o=0;o<C.length;o++){const r=c(n,o,C[n][o],h,t);(0,i.drawRectangle)(e,r)}g&&function(e,t,n,r){const{left:i,bottom:a,highContrastScheme:c}=t,u=i+n+d.ShapeLinesAdjustment,g=a-n-d.ShapeLinesAdjustment,h=function(e,t,n,o){switch(e){case l.CFIconImage.QuadrantEmpty:return[];case l.CFIconImage.Quadrant25:return[{x:t,y:n+o-d.ShapeLinesAdjustment},{x:t-o+d.ShapeLinesAdjustment,y:n}];case l.CFIconImage.QuadrantHalf:return[{x:t+o,y:n},{x:t,y:n+o-d.ShapeLinesAdjustment},{x:t-o+d.ShapeLinesAdjustment,y:n}];case l.CFIconImage.Quadrant75:case l.CFIconImage.QuadrantFull:return[{x:t,y:n-o+d.ShapeLinesAdjustment},{x:t+o-d.ShapeLinesAdjustment,y:n},{x:t,y:n+o-d.ShapeLinesAdjustment},{x:t-o+d.ShapeLinesAdjustment,y:n}];default:throw Error(`getSeparatorsCoordinates: image: ${e} not supported`)}}(r,u,g,n);e.strokeStyle=(0,o.rgbToColorHex)(c.BackgroundColor),e.beginPath();for(let t=0;t<h.length;t++)(0,s.drawLine)(e,u,g,h[t].x,h[t].y);e.stroke()}(e,t,h,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawFlag=void 0;const o=n(0),r=n(4),i=n(19),l=n(27),a=n(28),s=n(2),d=n(3),c=n(18);function u(e,t){(0,r.verifyArgumentNotNull)(t.outerColor,"outerColor","drawFlags");const{outerColor:n}=t,o=function(e){const{left:t,bottom:n,width:o,height:r}=e,l=r/2;return{p1:{x:t+o+c.ShapeLinesAdjustment,y:n-l-c.ShapeLinesAdjustment},p2:{x:t+o-l/i.QuarterPiTan+c.ShapeLinesAdjustment,y:n-r-c.ShapeLinesAdjustment}}}(t),l=function(e){const{left:t,bottom:n,width:o}=e,r=o/2,l={x:t+r+c.ShapeLinesAdjustment,y:n-c.ShapeLinesAdjustment},a=n-r*i.QuarterPiTan-c.ShapeLinesAdjustment;return{p1:l,p2:{x:t+c.ShapeLinesAdjustment,y:a}}}(t);e.strokeStyle=n,e.beginPath(),(0,s.drawLine)(e,o.p1.x,o.p1.y,o.p2.x,o.p2.y),(0,s.drawLine)(e,l.p1.x,l.p1.y,l.p2.x,l.p2.y),e.stroke()}t.drawFlag=function(e,t){(0,r.verifyArgumentNotNull)(e,"ctx","drawFlags"),(0,r.verifyArgumentNotNull)(t,"drawingContext","drawFlags");const{image:n,size:g,left:h,bottom:C,highContrastScheme:f}=t,m=Math.floor(g/2),p=Math.floor(g/3),y=function(e,t){if(t)return function(e,t){if(e===i.CFIconImage.FlagHigh)return(0,o.rgbToColorHex)(t.TextColor)}(e,t);switch(e){case i.CFIconImage.FlagHigh:return a.FlagHighInnerColor;case i.CFIconImage.FlagMedium:return a.FlagMediumInnerColor;case i.CFIconImage.FlagLow:return a.FlagLowInnerColor;default:throw Error("getFlagInnerColor: unsupported image type = "+e)}}(n,f),S=function(e,t){if(t)return(0,o.rgbToColorHex)(t.TextColor);switch(e){case i.CFIconImage.FlagHigh:return a.FlagHighOuterColor;case i.CFIconImage.FlagMedium:return a.FlagMediumOuterColor;case i.CFIconImage.FlagLow:return a.FlagLowOuterColor;default:throw Error("getFlagOuterColor: unsupported image type = "+e)}}(n,f);!function(e,t,n,o,r,a){const{left:s,bottom:d,image:c,highContrastScheme:g}=a,h={left:s,bottom:d-t,outerColor:r,height:t,width:n,innerColor:o};(0,l.drawRectangle)(e,h),c===i.CFIconImage.FlagMedium&&g&&u(e,h)}(e,m,p,y,S,t),function(e,t,n,o,r,a){const{left:s,bottom:d,size:c,image:g,highContrastScheme:h}=a,C={left:s+n,bottom:d-t+Math.floor(c/8),outerColor:r,height:t,width:n,innerColor:o};(0,l.drawRectangle)(e,C),g===i.CFIconImage.FlagMedium&&h&&u(e,C)}(e,m,p,y,S,t),function(e,t,n,r,l){const u=r-c.ShapeLinesAdjustment,g=u-n,h=t+c.ShapeLinesAdjustment;e.lineWidth=i.FlagPoleWidth,e.setLineDash(d.DefaultDash),e.strokeStyle=function(e){return e?(0,o.rgbToColorHex)(e.TextColor):a.FlagPoleColor}(l),e.beginPath(),(0,s.drawLine)(e,h,u,h,g),e.stroke()}(e,h,2*m,C,f)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawTriangleSet=void 0;const o=n(0),r=n(4),i=n(19),l=n(28),a=n(60),s=n(27),d=n(18);function c(e,t){if(t)return(0,o.rgbToColorHex)(t.TextColor);switch(e){case i.CFIconImage.TriangleLow:return l.TriangleLowOuterColor;case i.CFIconImage.TriangleMedium:return l.TriangleMediumOuterColor;case i.CFIconImage.TriangleHigh:return l.TriangleHighOuterColor;default:throw Error("getTriangleOuterColor: unsupported image type = "+e)}}function u(e,t){if(t)return(0,o.rgbToColorHex)(t.BackgroundColor);switch(e){case i.CFIconImage.TriangleLow:return l.TriangleLowInnerColor;case i.CFIconImage.TriangleMedium:return l.TriangleMediumInnerColor;case i.CFIconImage.TriangleHigh:return l.TriangleHighInnerColor;default:throw Error("getTriangleInnerColor: unsupported image type = "+e)}}t.drawTriangleSet=function(e,t){(0,r.verifyArgumentNotNull)(e,"ctx","drawTriangleSet"),(0,r.verifyArgumentNotNull)(t,"drawingContext","drawTriangleSet");const{image:n,size:o,left:l,bottom:g,highContrastScheme:h}=t;switch(n){case i.CFIconImage.TriangleHigh:case i.CFIconImage.TriangleLow:const r=function(e){const{image:t,left:n,bottom:o,size:r,highContrastScheme:l}=e,a=Math.floor(r/2),s=Math.floor(r/4),g=o-s-d.ShapeLinesAdjustment,h=n+d.ShapeLinesAdjustment;switch(t){case i.CFIconImage.TriangleHigh:return{outerColor:c(t,l),innerColor:u(t,l),left:h,bottom:g,height:a,width:r};case i.CFIconImage.TriangleLow:return{outerColor:c(t,l),innerColor:u(t,l),left:n+d.ShapeLinesAdjustment,bottom:o-s-a-d.ShapeLinesAdjustment,height:a,width:r};default:throw Error("getTriangleDrawingContext: unsupported image type = "+t)}}(t);(0,a.drawTriangle)(e,r,n===i.CFIconImage.TriangleLow);break;case i.CFIconImage.TriangleMedium:{const t=Math.floor(o/3),r={left:l,outerColor:c(n,h),innerColor:u(n,h),bottom:g-t,height:t,width:o};(0,s.drawRectangle)(e,r);break}default:throw Error("drawTriangleSet: unsupported image type = "+n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawStarIcon=void 0;const o=n(0),r=n(4),i=n(19),l=n(28),a=n(45),s=n(18);t.drawStarIcon=function(e,t){(0,r.verifyArgumentNotNull)(e,"ctx","drawStarIcon"),(0,r.verifyArgumentNotNull)(t,"drawingContext","drawStarIcon");const{image:n,size:d,left:c,bottom:u,highContrastScheme:g}=t,h=Math.floor(d/2);if(h<=1)return;const C=function(e,t,n){const o=n*i.StarInset,r=e+n+.5,l=t-n,a=o*i.StarRotationSin,d=o*i.StarRotationCos,c=n*i.StarRotation2Sin,u=o*i.StarRotation2Sin,g=o*i.StarRotation2Cos,h=n*i.StarRotationSin,C=n*i.StarRotationCos,f=l+(d-(Math.floor(d)+s.ShapeLinesAdjustment)),m=f-d,p=f+g,y=f+C;return{topOuter:{x:r,y:f-n},topRightInner:{x:r+a,y:m},topRightOuter:{x:r+c,y:m},middleRightInner:{x:r+u,y:p},bottomRightOuter:{x:r+h,y:y},bottomInner:{x:r,y:f+o},bottomLeftOuter:{x:r-h,y:y},middleLeftInner:{x:r-u,y:p},topLeftOuter:{x:r-c,y:m},topLeftInner:{x:r-a,y:m}}}(c,u,h),f=function(e,t){if(t)return function(e,t){switch(e){case i.CFIconImage.StarHigh:case i.CFIconImage.StarMedium:return(0,o.rgbToColorHex)(t.TextColor);case i.CFIconImage.StarLow:return;default:throw Error("getStarLeftInnerColorHighContrast: unsupported image type = "+e)}}(e,t);switch(e){case i.CFIconImage.StarHigh:case i.CFIconImage.StarMedium:return l.StarFilledInnerColor;case i.CFIconImage.StarLow:return l.StarEmptyInnerColor;default:throw Error("getStarLeftInnerColor: unsupported image type = "+e)}}(n,g),m=function(e,t){if(t)return(0,o.rgbToColorHex)(t.TextColor);switch(e){case i.CFIconImage.StarHigh:case i.CFIconImage.StarMedium:return l.StarFilledOuterColor;case i.CFIconImage.StarLow:return l.StarEmptyOuterColor;default:throw Error("getStarLeftOuterColor: unsupported image type = "+e)}}(n,g),p=function(e,t){if(t)return function(e,t){switch(e){case i.CFIconImage.StarHigh:return(0,o.rgbToColorHex)(t.TextColor);case i.CFIconImage.StarLow:case i.CFIconImage.StarMedium:return;default:throw Error("getStarRightInnerColorHighContrast: unsupported image type = "+e)}}(e,t);switch(e){case i.CFIconImage.StarHigh:return l.StarFilledInnerColor;case i.CFIconImage.StarMedium:case i.CFIconImage.StarLow:return l.StarEmptyInnerColor;default:throw Error("getStarRightInnerColor: unsupported image type = "+e)}}(n,g),y=function(e,t){if(t)return(0,o.rgbToColorHex)(t.TextColor);switch(e){case i.CFIconImage.StarHigh:return l.StarFilledOuterColor;case i.CFIconImage.StarMedium:case i.CFIconImage.StarLow:return l.StarEmptyOuterColor;default:throw Error("getStarRightOuterColor: unsupported image type = "+e)}}(n,g),S=n===i.CFIconImage.StarMedium;e.beginPath(),function(e,t){e.moveTo(t.topOuter.x,t.topOuter.y),e.lineTo(t.topRightInner.x,t.topRightInner.y),e.lineTo(t.topRightOuter.x,t.topRightOuter.y),e.lineTo(t.middleRightInner.x,t.middleRightInner.y),e.lineTo(t.bottomRightOuter.x,t.bottomRightOuter.y),e.lineTo(t.bottomInner.x,t.bottomInner.y)}(e,C),S&&((0,a.fillAndStroke)(e,p,y),e.beginPath()),function(e,t){e.moveTo(t.bottomInner.x,t.bottomInner.y),e.lineTo(t.bottomLeftOuter.x,t.bottomLeftOuter.y),e.lineTo(t.middleLeftInner.x,t.middleLeftInner.y),e.lineTo(t.topLeftOuter.x,t.topLeftOuter.y),e.lineTo(t.topLeftInner.x,t.topLeftInner.y),e.lineTo(t.topOuter.x,t.topOuter.y)}(e,C),(0,a.fillAndStroke)(e,f,m)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawSigns=void 0;const o=n(0),r=n(4),i=n(19),l=n(28),a=n(60),s=n(45),d=n(18);function c(e,t){if(!t)switch(e){case i.CFIconImage.SignLow:return l.SignLowInnerColor;case i.CFIconImage.SignMedium:return l.SignMediumInnerColor;default:throw Error("getInnerColor: unsupported image type = "+e)}}function u(e,t){if(t)return(0,o.rgbToColorHex)(t.TextColor);switch(e){case i.CFIconImage.SignLow:return l.SignLowOuterColor;case i.CFIconImage.SignMedium:return l.SignMediumOuterColor;default:throw Error("getOuterColor: unsupported image type = "+e)}}t.drawSigns=function(e,t){(0,r.verifyArgumentNotNull)(e,"ctx","drawSigns"),(0,r.verifyArgumentNotNull)(t,"drawingContext","drawSigns");const{image:n}=t;switch(n){case i.CFIconImage.SignLow:!function(e,t){const{image:n,highContrastScheme:o}=t,r=c(n,o),i=u(n,o),l=function(e){const{size:t,left:n,bottom:o}=e,r=Math.floor(t/2),i=n+r+d.ShapeLinesAdjustment,l=o-r-d.ShapeLinesAdjustment;return{top:{x:i,y:l-r},right:{x:i+r,y:l},bottom:{x:i,y:l+r},left:{x:i-r,y:l}}}(t);e.beginPath(),e.moveTo(l.top.x,l.top.y),e.lineTo(l.right.x,l.right.y),e.lineTo(l.bottom.x,l.bottom.y),e.lineTo(l.left.x,l.left.y),e.lineTo(l.top.x,l.top.y),(0,s.fillAndStroke)(e,r,i)}(e,t);break;case i.CFIconImage.SignMedium:{const n=function(e){const{left:t,bottom:n,size:o,highContrastScheme:r,image:i}=e,l=t+d.ShapeLinesAdjustment,a=n-d.ShapeLinesAdjustment,s=c(i,r);return{outerColor:u(i,r),innerColor:s,left:l,bottom:a,height:o,width:o}}(t);(0,a.drawTriangle)(e,n,!1);break}default:throw Error("drawSigns: unsupported image type = "+n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawArrows=void 0;const o=n(0),r=n(4),i=n(28),l=n(19),a=n(45),s=n(18);function d(e){let t=Math.round(l.ArrowWidthRatio*e);return t=t%2!=0?t+1:t,t}function c(e){let t=Math.round(l.ArrowHeightRatio*e);return t=t%2!=0?t+1:t,t}t.drawArrows=function(e,t){(0,r.verifyArgumentNotNull)(e,"ctx","drawArrows"),(0,r.verifyArgumentNotNull)(t,"drawingContext","drawArrows");const{image:n,size:u,left:g,bottom:h,highContrastScheme:C}=t,f=function(e,t){if(t)return(0,o.rgbToColorHex)(t.TextColor);switch(e){case l.CFIconImage.GrayArrowDown:case l.CFIconImage.GrayArrowDownRight:case l.CFIconImage.GrayArrowRight:case l.CFIconImage.GrayArrowUp:case l.CFIconImage.GrayArrowUpRight:return i.ArrowGrayOuterColor;case l.CFIconImage.ColoredArrowUp:return i.ArrowUpOuterColor;case l.CFIconImage.ColoredArrowDown:return i.ArrowDownOuterColor;case l.CFIconImage.ColoredArrowUpRight:case l.CFIconImage.ColoredArrowRight:case l.CFIconImage.ColoredArrowDownRight:return i.ArrowRightOuterColor;default:throw Error("getArrowOuterColor: unsupported image type = "+e)}}(n,C),m=function(e,t){if(t)return function(e,t){switch(e){case l.CFIconImage.GrayArrowDown:case l.CFIconImage.GrayArrowDownRight:case l.CFIconImage.GrayArrowRight:case l.CFIconImage.GrayArrowUp:case l.CFIconImage.GrayArrowUpRight:return(0,o.rgbToColorHex)(t.TextColor);case l.CFIconImage.ColoredArrowUp:case l.CFIconImage.ColoredArrowDown:case l.CFIconImage.ColoredArrowUpRight:case l.CFIconImage.ColoredArrowRight:case l.CFIconImage.ColoredArrowDownRight:return(0,o.rgbToColorHex)(t.BackgroundColor);default:throw Error("getArrowHighContrastInnerColor: unsupported image type = "+e)}}(e,t);switch(e){case l.CFIconImage.GrayArrowDown:case l.CFIconImage.GrayArrowDownRight:case l.CFIconImage.GrayArrowRight:case l.CFIconImage.GrayArrowUp:case l.CFIconImage.GrayArrowUpRight:return i.ArrowGrayInnerColor;case l.CFIconImage.ColoredArrowUp:return i.ArrowUpInnerColor;case l.CFIconImage.ColoredArrowDown:return i.ArrowDownInnerColor;case l.CFIconImage.ColoredArrowUpRight:case l.CFIconImage.ColoredArrowRight:case l.CFIconImage.ColoredArrowDownRight:return i.ArrowRightInnerColor;default:throw Error("getArrowInnerColor: unsupported image type = "+e)}}(n,C);let p=[];switch(n){case l.CFIconImage.GrayArrowDown:case l.CFIconImage.ColoredArrowDown:p=function(e,t,n){const o=l.ArrowHeightRatio*n,r=d(n),i=Math.floor(n/2+e)+s.ShapeLinesAdjustment,a=Math.round(t),c=i+o*Math.cos(-3*l.ArrowAngle),u=a+o*Math.sin(-3*l.ArrowAngle),g=c+r*Math.cos(-l.ArrowAngle),h=u+r*Math.sin(-l.ArrowAngle),C=i-r/2,f=h+o/2*Math.sin(l.ArrowAngle),m=f-o,p=C+r,y=m,S=p,R=f,F=i+(i-g),T=h,w=i+(i-c),I=u,b={x:i,y:a};return[b,{x:c,y:u},{x:g,y:h},{x:C,y:f},{x:C,y:Math.round(m)-s.ShapeLinesAdjustment},{x:p,y:Math.round(y)-s.ShapeLinesAdjustment},{x:S,y:R},{x:F,y:T},{x:w,y:I},b]}(g,h,u);break;case l.CFIconImage.GrayArrowUp:case l.CFIconImage.ColoredArrowUp:p=function(e,t,n){const o=t-n,r=l.ArrowHeightRatio*n,i=d(n),a=Math.floor(n/2+e)+s.ShapeLinesAdjustment,c=Math.round(o),u=a+r*Math.cos(3*l.ArrowAngle),g=c+r*Math.sin(3*l.ArrowAngle),h=u+i*Math.cos(l.ArrowAngle),C=g+i*Math.sin(l.ArrowAngle),f=a-i/2,m=C+r/2*Math.sin(-l.ArrowAngle),p=m+r,y=f+i,S=p,R=y,F=m,T=a+(a-h),w=C,I=a+(a-u),b=g,v={x:a,y:c};return[v,{x:u,y:g},{x:h,y:C},{x:f,y:m},{x:f,y:Math.round(p)-s.ShapeLinesAdjustment},{x:y,y:Math.round(S)-s.ShapeLinesAdjustment},{x:R,y:F},{x:T,y:w},{x:I,y:b},v]}(g,h,u);break;case l.CFIconImage.GrayArrowRight:case l.CFIconImage.ColoredArrowRight:p=function(e,t,n){const o=t-n,r=l.ArrowHeightRatio*n,i=d(n),a=Math.round(e+n),c=Math.floor(n/2+o)+s.ShapeLinesAdjustment,u=a+r*Math.cos(-3*l.ArrowAngle),g=c+r*Math.sin(-3*l.ArrowAngle),h=u+i*Math.cos(3*l.ArrowAngle),C=g+i*Math.sin(3*l.ArrowAngle),f=h+r/2*Math.cos(l.ArrowAngle),m=c-i/2,p=f-r,y=m,S=p,R=y+i,F=f,T=c+(c-m),w=h,I=c+(c-C),b=u,v=c+(c-g),x={x:a,y:c};return[x,{x:u,y:g},{x:h,y:C},{x:f,y:m},{x:Math.round(p)+s.ShapeLinesAdjustment,y:y},{x:Math.round(S)+s.ShapeLinesAdjustment,y:R},{x:F,y:T},{x:w,y:I},{x:b,y:v},x]}(g,h,u);break;case l.CFIconImage.GrayArrowDownRight:case l.CFIconImage.ColoredArrowDownRight:p=function(e,t,n){const o=t-n,r=Math.round(l.ArrowWidthRatio*n),i=c(n),a=Math.floor(l.ArrowDownRightTipXRatio*n+e)+s.ShapeLinesAdjustment,d=Math.floor(l.ArrowDownRightTipYRatio*n+o)+s.ShapeLinesAdjustment,u=a,g=d-i,h=u-r,C=g,f=h,m=d-r-r/Math.sqrt(2),p=f+i*Math.cos(-3*l.ArrowAngle),y=m+i*Math.sin(-3*l.ArrowAngle),S=a-i,R=d,F=S,T=R-r,w={x:a,y:d};return[w,{x:u,y:g},{x:h,y:C},{x:f,y:m},{x:p,y:y},{x:p+r*Math.cos(3*l.ArrowAngle),y:y+r*Math.sin(3*l.ArrowAngle)},{x:a-r-r/Math.sqrt(2),y:T},{x:F,y:T},{x:S,y:R},w]}(g,h,u);break;case l.CFIconImage.GrayArrowUpRight:case l.CFIconImage.ColoredArrowUpRight:p=function(e,t,n){const o=t-n,r=Math.round(l.ArrowWidthRatio*n),i=c(n),a=Math.floor(l.ArrowUpRightTipXRatio*n+e)+s.ShapeLinesAdjustment,d=Math.floor(l.ArrowUpRightTipYRatio*n+o)+s.ShapeLinesAdjustment,u=a-i,g=d,h=u,C=g+r,f=a-r-r/Math.sqrt(2),m=C,p=f+i*Math.cos(3*l.ArrowAngle),y=m+i*Math.sin(3*l.ArrowAngle),S=a,R=d+i,F=S-r,T=R,w={x:a,y:d};return[w,{x:u,y:g},{x:h,y:C},{x:f,y:m},{x:p,y:y},{x:p+r*Math.cos(l.ArrowAngle),y:y+r*Math.sin(l.ArrowAngle)},{x:F,y:d+r+r/Math.sqrt(2)},{x:F,y:T},{x:S,y:R},w]}(g,h,u);break;default:throw Error("drawArrows: unsupported image type = "+n)}(0,a.drawIconFromPoints)(e,m,f,p)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawPageBreaks=void 0;const o=n(2),r=n(55),i=n(0),l=n(125);function a(e,t,n,r,i,l,a){const s=r.Index,g=r.Min,h=r.Max;if(!d(s,g,h,n.renderingRegion,!0))return;const C=t.ClientOnlyCache,f=u(C.RowOffsetsAdjustedForDrawing,s,i,a),m=-1===r.Min?0:c(C.ColOffsetsAdjustedForDrawing,g,i,l),p=-1===r.Max?t.BlockWidth*n.scaleFactor:c(C.ColOffsetsAdjustedForDrawing,h,i,l);(0,o.drawLine)(e,m,f,p,f)}function s(e,t,n,r,i,l,a){const s=r.Index,g=r.Min,h=r.Max;if(!d(s,g,h,n.renderingRegion,!1))return;const C=t.ClientOnlyCache,f=c(C.ColOffsetsAdjustedForDrawing,s,i,l),m=-1===r.Min?0:u(C.RowOffsetsAdjustedForDrawing,g,i,a),p=-1===r.Max?t.BlockHeight*n.scaleFactor:u(C.RowOffsetsAdjustedForDrawing,h,i,a);(0,o.drawLine)(e,f,m,f,p)}function d(e,t,n,o,r){let i=r?o.startRow:o.startColumn,l=r?o.endRow:o.endColumn;return i<=(a=e)&&a<=l&&(l=r?o.endColumn:o.endRow,!(-1!==t&&t>l||(i=r?o.startColumn:o.startRow,-1!==n&&n<i)));var a}function c(e,t,n,i){return t>=0?(0,r.getAdjustedDrawingOffset)(e[t],(0,o.getColWidthFromOffsets)(t,e),n,i):0}function u(e,t,n,i){return t>=0?(0,r.getAdjustedDrawingOffset)(e[t],(0,o.getRowHeightFromOffsets)(t,e),n,i):0}t.drawPageBreaks=function(e,t,n){if(null==t.PageBreaks)return;(0,l.setPageLayoutLine)(e,n);const o=(0,i.getLinePixelTranslation)((0,l.getLineWidth)(n)),d=(0,r.getMaxLineOffset)(t.BlockWidth,n.scaleFactor,!1),c=(0,r.getMaxLineOffset)(t.BlockHeight,n.scaleFactor,!0);e.beginPath(),function(e,t,n,o,r,i){var l;const s=null===(l=t.PageBreaks)||void 0===l?void 0:l.Row;if(null!=s)for(let l=0;l<s.length;++l)a(e,t,n,s[l],o,r,i)}(e,t,n,o,d,c),function(e,t,n,o,r,i){var l;const a=null===(l=t.PageBreaks)||void 0===l?void 0:l.Col;if(null!=a)for(let l=0;l<a.length;++l)s(e,t,n,a[l],o,r,i)}(e,t,n,o,d,c),e.stroke()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawPrintAreas=void 0;const o=n(55),r=n(0),i=n(4),l=n(125),a=n(2);function s(e,t,n,r,i,l,s){const d=t.ClientOnlyCache,c=s.FirstColumn<=0?-1:(0,o.getAdjustedDrawingOffset)(d.ColOffsetsAdjustedForDrawing[s.FirstColumn],0,r,l),u=s.FirstRow<=0?-1:(0,o.getAdjustedDrawingOffset)(d.RowOffsetsAdjustedForDrawing[s.FirstRow],0,r,i),g=s.LastColumn>=t.ColumnNumbers.length?t.BlockWidth*n.scaleFactor+1:(0,o.getAdjustedDrawingOffset)(d.ColOffsetsAdjustedForDrawing[s.LastColumn],(0,a.getColWidthFromOffsets)(s.LastColumn,d.ColOffsetsAdjustedForDrawing),r,l),h=s.LastRow>=t.RowNumbers.length?t.BlockHeight*n.scaleFactor+1:(0,o.getAdjustedDrawingOffset)(d.RowOffsetsAdjustedForDrawing[s.LastRow],(0,a.getRowHeightFromOffsets)(s.LastRow,d.RowOffsetsAdjustedForDrawing),r,i);e.rect(c,u,g-c,h-u)}t.drawPrintAreas=function(e,t,n){if(function(e){(0,i.verifyArgumentNotNull)(e.BlockWidth,"model.BlockWidth","drawPrintAreas"),(0,i.verifyArgumentNotNull)(e.BlockHeight,"model.BlockHeight","drawPrintAreas"),(0,i.verifyArgumentNotNull)(e.RowNumbers,"model.RowNumbers","drawPrintAreas"),(0,i.verifyArgumentNotNull)(e.ColumnNumbers,"model.ColumnNumbers","drawPrintAreas"),(0,i.verifyArgumentNotNull)(e.ClientOnlyCache,"ClientOnlyCache","drawPrintAreas"),(0,i.verifyArgumentNotNull)(e.ClientOnlyCache.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","drawPrintAreas"),(0,i.verifyArgumentNotNull)(e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","drawPrintAreas")}(t),!t.PrintAreas)return;(0,l.setPageLayoutLine)(e,n);const a=(0,r.getLinePixelTranslation)((0,l.getLineWidth)(n)),d=(0,o.getMaxLineOffset)(t.BlockWidth,n.scaleFactor,!1),c=(0,o.getMaxLineOffset)(t.BlockHeight,n.scaleFactor,!0);e.beginPath();for(let o=0;o<(null===(u=t.PrintAreas)||void 0===u?void 0:u.length);o++){var u;g=n.renderingRegion,h=t.PrintAreas[o],!(g.startRow>h.LastRow||g.startColumn>h.LastColumn||g.endRow+1<h.FirstRow||g.endColumn+1<h.FirstColumn||g.startRow>h.FirstRow&&g.startColumn>h.FirstColumn&&g.endRow<h.LastRow&&g.endColumn<h.LastColumn)&&s(e,t,n,a,c,d,t.PrintAreas[o])}var g,h;e.stroke()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawEmptyPivotTableTitleText=t.drawEmptyPivotTableImages=t.drawEmptyPivotTableTitleContainers=void 0;const o=n(1),r=n(2),i=n(3),l=n(57),a=n(69),s=n(0),d=n(8),c=n(31),u=n(9),g=n(37);function h(e,t,n){const o=l.EmptyPivotTableImagePlaceholderThicknessPx,r=(0,s.getLinePixelTranslation)(o);e.lineWidth=o,e.fillStyle=e.strokeStyle=n?(0,s.rgbToColorHex)(n.TextColor):l.EmptyPivotTableTitleContainerBorderColor,e.strokeRect(t.x+r,t.y+r,t.width,t.height)}function C(e,t,n,o){const r=n?(0,s.rgbToColorHex)(n.TextColor):l.EmptyPivotTableTitleTextColor;e.font=(0,d.getFontCssStringFromFont)(t,void 0,o),e.fillStyle=r,e.textBaseline=g.DefaultTextBaseline,e.textAlign="center"}function f(e,t,n){const o=m(e,t,n),r=(0,a.getPivotTableLeftAdjustedForDrawing)(e,t,!1),i=(0,a.getPivotTableTopAdjustedForDrawing)(e,t,!1),s=t.OriginPTWidthAdjustedForDrawing,d=t.OriginPTHeightAdjustedForDrawing,c=o.y+o.height,u=i+d,g=o.width,h=u-c-2*l.EmptyPivotTableImageMinimalPaddingYPx*n,C=Math.min(g,l.EmptyPivotTableImageWidthHeightRatio*h),f=Math.min(h,g/l.EmptyPivotTableImageWidthHeightRatio),p=(c+u)/2;return{x:r+Math.round((s-C)/2),y:Math.round(p-f/2),width:C,height:f}}function m(e,t,n){const o=Math.round(t.OriginPTWidthAdjustedForDrawing*l.EmptyPivotTableTitleContainerWidthRatio);return{x:R(e,t,o),y:y(e,t,n),width:o,height:Math.round(l.EmptyPivotTableTitleContainerHeightPx*n)}}function p(e,t){const n=Math.round(t.OriginPTWidth*l.EmptyPivotTableTitleContainerWidthRatio);return{x:F(e,t,n),y:S(e,t),width:n-l.EmptyPivotTableTitleContainerBorderThicknessPx,height:l.EmptyPivotTableTitleContainerHeightPx-l.EmptyPivotTableTitleContainerBorderThicknessPx}}function y(e,t,n){return(0,a.getPivotTableTopAdjustedForDrawing)(e,t,!1)+Math.round(l.EmptyPivotTableTitleContainerTopPaddingPx*n)}function S(e,t){return e.RowOffsets[t.FirstRowIndex]+t.DeltaYFromOriginPT+l.EmptyPivotTableTitleContainerTopPaddingPx+l.EmptyPivotTableTitleContainerBorderThicknessPx}function R(e,t,n){const o=Math.floor((t.OriginPTWidthAdjustedForDrawing-n)/2);return(0,a.getPivotTableLeftAdjustedForDrawing)(e,t,!1)+o}function F(e,t,n){const o=(t.OriginPTWidth-n)/2+l.EmptyPivotTableTitleContainerBorderThicknessPx;return function(e,t){const n=e.ColumnOffsets;return e.IsRtl?e.BlockWidth-t.DeltaXFromOriginPT-n[t.FirstColIndex]-t.OriginPTWidth:n[t.FirstColIndex]+t.DeltaXFromOriginPT}(e,t)+o}t.drawEmptyPivotTableTitleContainers=function(e,t,n){if((0,o.verifyArgumentNotNull)(t,"model","drawEmptyPivotTableTitleContainers"),(0,o.verifyArgumentNotNull)(e,"ctx","drawEmptyPivotTableTitleContainers"),(0,o.verifyArgumentNotNull)(n,"context","drawEmptyPivotTableTitleContainers"),!t.PivotTables||0===t.PivotTables.length)return;const r=Math.max(Math.round(l.EmptyPivotTableTitleContainerBorderThicknessPx*n.scaleFactor),1),d=(0,s.getLinePixelTranslation)(r);let c=!1;for(let o=0;o<t.PivotTables.length;o++){const u=t.PivotTables[o];if(!u.IsEmptyPivot)continue;if(u.OriginPTHeight<l.EmptyPivotTableMinimalHeightForDrawingTitle)continue;if(!(0,a.isPivotIntersectsRenderingRegion)(t,u,n.renderingRegion,!1))continue;c||(e.strokeStyle=n.highContrastScheme?(0,s.rgbToColorHex)(n.highContrastScheme.TextColor):l.EmptyPivotTableTitleContainerBorderColor,e.lineWidth=r,e.setLineDash(i.DefaultDash),e.beginPath(),c=!0);const g=m(t,u,n.scaleFactor);e.rect(d+g.x,d+g.y,g.width,g.height)}c&&e.stroke()},t.drawEmptyPivotTableImages=function(e,t,n){if((0,o.verifyArgumentNotNull)(t,"model","drawEmptyPivotTableImages"),(0,o.verifyArgumentNotNull)(e,"ctx","drawEmptyPivotTableImages"),(0,o.verifyArgumentNotNull)(n,"context","drawEmptyPivotTableImages"),t.PivotTables&&0!==t.PivotTables.length)for(let o=0;o<t.PivotTables.length;o++){const r=t.PivotTables[o];if(!r.IsEmptyPivot)continue;if(r.OriginPTHeight<l.EmptyPivotTableMinimalHeightForDrawingImage)continue;if(!(0,a.isPivotIntersectsRenderingRegion)(t,r,n.renderingRegion,!1))continue;const i=f(t,r,n.scaleFactor);if(i.width<l.EmptyPivotTableMinimalImageWidthPx)continue;const s=(0,c.getOrLoadStaticImage)(0,n.blockIdentifier);s?e.drawImage(s,i.x,i.y,i.width,i.height):h(e,i,n.highContrastScheme)}},t.drawEmptyPivotTableTitleText=function(e,t,n){if((0,o.verifyArgumentNotNull)(t,"model","drawEmptyPivotTableTitleText"),(0,o.verifyArgumentNotNull)(e,"ctx","drawEmptyPivotTableTitleText"),(0,o.verifyArgumentNotNull)(n,"context","drawEmptyPivotTableTitleText"),!t.PivotTables||0===t.PivotTables.length)return;let i=!1,s=void 0;for(let d=0;d<t.PivotTables.length;d++){const c=t.PivotTables[d];if(!c.IsEmptyPivot)continue;if(c.OriginPTHeight<l.EmptyPivotTableMinimalHeightForDrawingTitle)continue;if(!(0,a.isPivotIntersectsRenderingRegion)(t,c,n.renderingRegion,!1))continue;if(!c.PivotTableName)continue;if(!i){const r=(0,o.getReferencedObjectById)(o.UniqueStyleID.Default,t.Styles);s=(0,o.getReferencedObjectById)(r.FontID||0,t.Fonts),C(e,s,n.highContrastScheme,t),i=!0}const g=p(t,c),h=g.x+g.width/2,f=(0,u.getTextOffsetYAlphabeticBaseline)(t,g.y+g.height,g.height,s.Size,s.FontName,o.VerticalAlignment.Center);(0,r.applyClipping)(e,g),e.fillText(c.PivotTableName,h,f),(0,r.restoreClipping)(e,g)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawDataBars=void 0;const o=n(1),r=n(5),i=n(2),l=n(192),a=n(3),s=n(0),d=n(6);function c(e,t,n,o){if(function(e){return e>0&&e<100}(e))return{X:t+n-(0,s.getLinePixelTranslation)(a.GridLineWidthPx),startY:o.y+a.GridLineWidthPx,endY:o.y+o.height-a.GridLineWidthPx}}function u(e,t,n,o,r){let i=Math.round(t.width*e/100);o&&(i=-i);const a=r&&i<0?l.DataBarAxisWidth:0,s=Math.min(n,n+i),d=t.x+s,c=Math.max(Math.abs(i)-a,0);return{x:d,y:t.y,width:c,height:t.height}}function g(e,t){return t.information.GradientColor?function(e,t){const n=function(e){var t;const n=e.bar,o=n.x,r=o+n.width,i=null===(t=e.axis)||void 0===t?void 0:t.X;return((0,d.isNullOrUndefined)(i)?e.isRtl:o<i)?{startX:r,endX:o,Y:n.y}:{startX:o,endX:r,Y:n.y}}(t),o=e.createLinearGradient(n.startX,n.Y,n.endX,n.Y);return o.addColorStop(l.GradientStartingPositing,t.information.Color),o.addColorStop(l.GradientEndingPositing,t.information.GradientColor),o}(e,t):t.information.Color}function h(e,t,n,o){e.lineWidth=t,e.setLineDash(n),e.strokeStyle=o}function C(e,t,n){n!==t&&(e.stroke(),e.beginPath(),e.strokeStyle=t)}function f(e,t){const n=m(l.DataBarHorizontalPadding,t),o=m(l.DataBarTopPadding,t),r=m(l.DataBarBottomPadding,t);return{x:e.x+n+a.GridLineWidthPx,y:e.y+n+a.GridLineWidthPx,width:Math.max(0,e.width-2*n-2*a.GridLineWidthPx),height:Math.max(0,e.height-o-r-2*a.GridLineWidthPx)}}function m(e,t){return Math.max(e,Math.round(e*t))}t.drawDataBars=function(e,t,n){(0,o.verifyArgumentNotNull)(t,"model","drawDataBars"),(0,o.verifyArgumentNotNull)(e,"ctx","drawDataBars"),(0,o.verifyArgumentNotNull)(n,"context","drawDataBars");const a=function(e,t){const n=e.ClientOnlyCache.CellsToRender,l=[];for(let m=0;m<n.length;m++){var a;const p=n[m];if(!(0,i.cellIntersectsRenderingRegion)(p,t.renderingRegion))continue;const y=null===(a=p.CondFormat)||void 0===a?void 0:a.DataBar;if(!y)continue;if((0,s.isCellPreviewTextDefined)(p.PreviewText))continue;if(p.ShowSkeleton)continue;const S=y.Direction===o.ReadingOrderType.RightToLeft||e.IsRtl&&y.Direction===o.ReadingOrderType.Context,R=(0,r.getCellDimensionsAdjustedForDrawing)(e,p,!1),F=f(R,t.scaleFactor),T=(g=y.AxisPostion,h=F.width,C=S,function(e,t,n){if(e<0||e>t)throw Error("adjustCellCoordinateIfRtl: coordinate is outside of the data bar bounds.");return n?t-e:e}(Math.round(h*g/100),h,C)),w=c(y.AxisPostion,F.x,T,R),I=!(0,d.isNullOrUndefined)(w),b=u(y.Length,F,T,S,I);l.push({information:y,axis:w,bar:b,isRtl:S})}var g,h,C;return l}(t,n),m=function(e){if(!(0,d.isNullOrUndefined)(e))return""+(0,s.rgbToColorHex)(e.TextColor)}(n.highContrastScheme);!function(e,t,n){let o,r=!1;const a=!(0,d.isNullOrUndefined)(n);for(let s=0;s<t.length;s++){const c=t[s].axis;if(!(0,d.isNullOrUndefined)(c)){if(r||(o=a?n:t[s].information.AxisColor,h(e,l.DataBarAxisWidth,l.DataBarAxisLineDash,o),e.beginPath(),r=!0),!a){const n=t[s].information.AxisColor;C(e,n,o),o=n}(0,i.drawLine)(e,c.X,c.startY,c.X,c.endY)}}r&&e.stroke()}(e,a,m),(0,d.isNullOrUndefined)(m)&&function(e,t){let n;for(let o=0;o<t.length;o++){const r=t[o],i=r.bar,l=g(e,r);n!==l&&(e.fillStyle=l,n=l),e.fillRect(i.x,i.y,i.width,i.height)}}(e,a),function(e,t,n){let o,r=!1;const i=!(0,d.isNullOrUndefined)(n);for(let c=0;c<t.length;c++){const u=t[c].information.BorderColor;if((0,d.isNullOrUndefined)(n)&&(0,d.isNullOrUndefined)(u))continue;const g={x:(a=t[c].bar).x+(0,s.getLinePixelTranslation)(l.DataBarBorderWidth),y:a.y+(0,s.getLinePixelTranslation)(l.DataBarBorderWidth),width:Math.max(a.width-l.DataBarBorderWidth,0),height:Math.max(a.height-l.DataBarBorderWidth,0)};r||(o=i?n:u,h(e,l.DataBarBorderWidth,[],o),e.beginPath(),r=!0),i||(C(e,u,o),o=u),g.width>0&&e.rect(g.x,g.y,g.width,g.height)}var a;r&&e.stroke()}(e,a,m)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataBarAxisLineDash=t.GradientEndingPositing=t.GradientStartingPositing=t.DataBarBorderWidth=t.DataBarAxisWidth=t.DataBarBottomPadding=t.DataBarTopPadding=t.DataBarHorizontalPadding=void 0,t.DataBarHorizontalPadding=1,t.DataBarTopPadding=1,t.DataBarBottomPadding=2,t.DataBarAxisWidth=1,t.DataBarBorderWidth=1,t.GradientStartingPositing=0,t.GradientEndingPositing=1,t.DataBarAxisLineDash=[3,1]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawDynamicImages=void 0;const o=n(1),r=n(0),i=n(15),l=n(4),a=n(31),s=n(5),d=n(6),c=n(20),u=n(23),g=n(3),h=n(2),C=n(21),f=n(12),m=n(57);function p(e,t,n,l,d,h,p){var S,R,F,T;const w=function(e){switch(e){case a.ImageType.Sparkline:return 0;case a.ImageType.InCellImage:return g.GridLineWidthPx;default:throw Error("marginForImageType: unsupported image type = "+e)}}(p),I=n.scaleFactor,b=I*(null!==(S=null===(R=l.Merge)||void 0===R?void 0:R.OriginDeltaX)&&void 0!==S?S:0),v=I*(null!==(F=null===(T=l.Merge)||void 0===T?void 0:T.OriginDeltaY)&&void 0!==F?F:0),x=0===b?w:0,D=0===v?w:0,A=h.ClusterOffsetX,P=h.ClusterOffsetY,M=function(e,t,n,o,r){let i=0,l=0;var a,d;y(r)?(i=null!==(a=r.ClusterImageWidth)&&void 0!==a?a:0,l=null!==(d=r.ClusterImageHeight)&&void 0!==d?d:0):(i=(0,s.getCellWidth)(e,o,!1)-t,l=(0,s.getCellHeight)(e,o,!1)-n);return{imageWidth:i,imageHeight:l}}(t,x,D,l,h),B=function(e,t,n,o,r,i){let l=0,a=0;return y(i)?(l=i.Width?i.Width*o-t:0,a=i.Height?i.Height*o-n:0):(l=(0,s.getCellWidthAdjustedForDrawing)(e,r)-t,a=(0,s.getCellHeightAdjustedForDrawing)(e,r)-n),{imageWidth:l,imageHeight:a}}(t,x,D,I,l,h),H=function(e,t,n,r,l,a,d,c){var u,g,h;if(!y(c))return{left:0,right:0,top:0,bottom:0};const C=!(null===(u=e.PivotTable)||void 0===u||!u.HasExpandCollapseIndicator),p=C?m.PaddingBetweenExpandCollapseButtonAndTextPx*d:0,S=(0,f.getExpandCollapseButtonWidth)(C)*d,R=(0,s.getCellWidthAdjustedForDrawing)(t,e)-l,F=function(e,t,n,r,i,l,a){let s=0,d=0;if(n<=t+i+r)return{left:s,right:d};const c=n-t-r-i;switch(e){case o.HorizontalAlignment.Right:s=c;break;case o.HorizontalAlignment.Center:s=d=c/2;break;case o.HorizontalAlignment.Automatic:case o.HorizontalAlignment.Left:d=n-t-i}return l?d+=a?r+i:0:s+=a?r+i:0,{left:s,right:d}}((0,i.getEffectiveHorizontalAlignment)(t,e),n,R,p,S,t.IsRtl,C),T=(0,s.getCellHeightAdjustedForDrawing)(t,e)-a,w=function(e,t,n){let r=0,i=0;if(t>n)return{top:r,bottom:i};const l=n-t;switch(e){case o.VerticalAlignment.Top:i=l;break;case o.VerticalAlignment.Center:r=i=l/2;break;case o.VerticalAlignment.Bottom:default:r=l}return{top:r,bottom:i}}(null!==(g=null===(h=e.CachedStyle)||void 0===h?void 0:h.VerticalAlignment)&&void 0!==g?g:o.VerticalAlignment.Bottom,r,T);return{left:F.left,right:F.right,top:w.top,bottom:w.bottom}}(l,t,B.imageWidth,B.imageHeight,x,D,I,h),O=(0,s.getCellLeftAdjustedForDrawing)(t,l,!1,!0)-b+H.left,k=(0,s.getCellTopAdjustedForDrawing)(t,l,!0)-v+H.top,L=(0,s.getCellWidthAdjustedForDrawing)(t,l)-x-H.right,N=(0,s.getCellHeightAdjustedForDrawing)(t,l)-D-H.bottom,E={x:O,y:k,width:L,height:N},z=function(e,t,n,o,r,i,l){return y(l)?(r<n&&(e*=1-(n-r)/n,n=r),i<o&&(t*=1-(o-i)/o,o=i),{clusterImageWidth:e,clusterImageHeight:t,imageWidth:n,imageHeight:o}):{clusterImageWidth:e,clusterImageHeight:t,imageWidth:n,imageHeight:o}}(M.imageWidth,M.imageHeight,B.imageWidth,B.imageHeight,L,N,h);e.drawImage(d,A,P,z.clusterImageWidth,z.clusterImageHeight,O,k,z.imageWidth,z.imageHeight),function(e,t,n,i){if(!(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.ShowDynamicImageCardOnHover,e))return;const l=(0,o.getRenderingRegionHitTestCache)(e,(0,r.getRenderingRegionKey)(n.renderingRegion)),a=(0,C.getUnadjustedHitRegionFromRect)(e,n,i,e.IsRtl);(0,c.registerCursorHitRegion)(t,l,a,u.DefaultCursorType,o.RenderFeaturesZIndex.DynamicImage);const s=(0,C.createDynamicImageCallback)(e,t,!0,!0),d=(0,C.createDynamicImageCallback)(e,t,!1,!1);(0,c.registerHitRegion)(t,l,a,o.RenderFeaturesZIndex.DynamicImage,s,"mouseenter"),(0,c.registerHitRegion)(t,l,a,o.RenderFeaturesZIndex.DynamicImage,d,"mouseleave")}(t,l,n,E)}function y(e){return!!(e.ClusterImageWidth&&e.ClusterImageHeight&&e.Width&&e.Height)}t.drawDynamicImages=function(e,t,n,o){(0,l.verifyArgumentNotNull)(e,"ctx","drawDynamicImages"),(0,l.verifyArgumentNotNull)(t,"model","drawDynamicImages"),(0,l.verifyArgumentNotNull)(n,"context","drawDynamicImages");const i=(0,r.getDynamicImages)(t,o);if((0,d.isNullOrUndefined)(i))return;const s=t.ClientOnlyCache.CellsToRender,c=(0,a.getOrLoadVersionedImage)(o,i.Version,i.ImageUrl,n.blockIdentifier,n.blockIdentifier);if(c)for(let i=0;i<s.length;i++){const l=s[i];if(!(0,h.cellIntersectsRenderingRegion)(l,n.renderingRegion))continue;const a=(0,r.getDynamicImageInformationFromCell)(l,o);(0,d.isNullOrUndefined)(a)||n.isFormulaView&&!(0,d.isNullOrUndefined)(l.FormulaInfo)||(0,r.isCellPreviewTextDefined)(l.PreviewText)||l.ShowSkeleton||p(e,t,n,l,c,a,o)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MinusPlusLineAdjustment=t.MinusPlusWidthPx=t.MinusPlusPaddingPx=void 0,t.MinusPlusPaddingPx=1,t.MinusPlusWidthPx=1,t.MinusPlusLineAdjustment=.5},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawSortDownChevronDownIcon=t.drawSortUpChevronDownIcon=t.drawSortUpFilterIcon=t.drawSortDownFilterIcon=t.drawFilterDownChevronIcon=t.drawDownChevronIcon=void 0;const o=n(0),r=n(48);function i(e,t,n){const o=t.left,i=t.bottom-t.height;e.beginPath(),a(e,o,i,n,!0,t),s(e,t,r.MiniChevronPoints),e.stroke()}function l(e,t,n){const o=t.left,i=t.bottom-t.height;e.beginPath(),s(e,t,r.FilterPoints),a(e,o,i,n,!1,t),e.stroke()}function a(e,t,n,i,l,a){const{width:s}=a,u=l?r.RightArrowPosition:r.LeftArrowPosition,g=(0,o.getLinePixelTranslation)(r.AutoFilterLineWidthPx),h=d(t,u.x,g,s),C=d(n,i?u.y+r.ArrowLengthPx:u.y,g,s),f=c(C,i?-r.ArrowLengthPx:r.ArrowLengthPx,s),m=c(h,-1,s),p=c(h,1,s),y=c(f,i?1:-1,s);e.moveTo(h,C),e.lineTo(h,f),e.moveTo(m,y),e.lineTo(p,y)}function s(e,t,n){if(!n||0===n.length)return;const i=t.left,l=t.bottom-t.height,a=n[0],s=(0,o.getLinePixelTranslation)(r.AutoFilterLineWidthPx);e.moveTo(d(i,a.x,s,t.width),d(l,a.y,s,t.width));for(let o=1;o<n.length;o++){const r=n[o];e.lineTo(d(i,r.x,s,t.width),d(l,r.y,s,t.width))}}function d(e,t,n,o){return Math.round(c(e,t,o))+n}function c(e,t,n){return e+t/r.AutoFilterIconRectPx*n}t.drawDownChevronIcon=function(e,t){e.beginPath(),s(e,t,r.ChevronPoints),e.stroke()},t.drawFilterDownChevronIcon=function(e,t){e.beginPath(),s(e,t,r.MiniChevronPoints),s(e,t,r.FilterPoints),e.stroke()},t.drawSortDownFilterIcon=function(e,t){l(e,t,!1)},t.drawSortUpFilterIcon=function(e,t){l(e,t,!0)},t.drawSortUpChevronDownIcon=function(e,t){i(e,t,!0)},t.drawSortDownChevronDownIcon=function(e,t){i(e,t,!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawComments=void 0;const o=n(1),r=n(11),i=n(2),l=n(5),a=n(0),s=n(128),d=n(197),c=n(41),u=n(60),g=n(20),h=n(21),C=n(94),f=n(23);function m(e,t,n,o,r){let i=!1;const l=t.ClientOnlyCache.CellsToRender;for(let g=0;g<l.length;g++){const h=l[g];if(h.Comment&&h.Comment.IsThreadedComment){if(r&&!!h.Comment.IsResolved!==o)continue;if(!p(h,n.renderingRegion))continue;const l=(0,d.getThreadedCommentNotchSize)(t,h,n.devicePixelRatio,n.zoom);if(l<s.MinCommentIconSizePx)continue;i||(i=!0,e.fillStyle=(c=n.highContrastScheme,u=o,c?u?(0,a.rgbToColorHex)(c.LinkColor):(0,a.rgbToColorHex)(c.TextColor):u?s.ResolvedThreadedCommentColor:s.ActiveThreadedCommentColor),e.beginPath()),y(e,t,h,n,l,S)}}var c,u;i&&e.fill()}function p(e,t){return!((0,o.isChangeGateEnabled)(o.ChangeGate.HideCommentIndicators)&&e.Comment.IsThreadedComment&&e.Comment.HideCommentIndicator||!(0,i.cellIntersectsRenderingRegion)(e,t))}function y(e,t,n,r,i,c,u){const C=function(e,t,n,o,r){return{left:function(e,t,n,o,r){const i=(0,d.shouldAddFilterPaddingToComment)(e,t,n,o,r)?(0,d.getFilterWithCommentPadding)(e,t,o,r):0;return(0,l.getCellRightAdjustedForDrawing)(e,t,e.IsRtl)-(n+i)}(e,t,n,o,r),bottom:function(e,t,n){return(0,l.getCellTopAdjustedForDrawing)(e,t,!1)+n}(e,t,n),width:n,height:n,outerColor:void 0,innerColor:void 0}}(t,n,i,r.devicePixelRatio,r.zoom);c(e,C,u),function(e,t,n,r){const i=(0,o.getRenderingRegionHitTestCache)(e,(0,a.getRenderingRegionKey)(n.renderingRegion)),c=r.width,u=Math.min((0,l.getCellWidthAdjustedForDrawing)(e,t),(0,l.getCellHeightAdjustedForDrawing)(e,t),c*s.CommentHitRegionProportionConstant),C={x:(0,d.getCommentHitRegionLeft)(e,t,r.left,r.width,u),y:r.bottom-r.height,width:u,height:u},m=(0,h.getUnadjustedHitRegionFromRect)(e,n,C,e.IsRtl),p=(0,h.createCommentsCallback)(e,t,!0,!0),y=(0,h.createCommentsCallback)(e,t,!1,!1);(0,g.registerCursorHitRegion)(t,i,m,f.DefaultCursorType,o.RenderFeaturesZIndex.Comments),(0,g.registerHitRegion)(t,i,m,o.RenderFeaturesZIndex.Comments,p,"mouseenter"),(0,g.registerHitRegion)(t,i,m,o.RenderFeaturesZIndex.Comments,y,"mouseleave")}(t,n,r,C)}function S(e,t){const{left:n,bottom:o,width:r,height:i}=t,l=function(e,t,n,o){return[{x:e,y:t},{x:e+n,y:t},{x:e+n,y:t+o},{x:e+n/2,y:t+o/2},{x:e,y:t+o/2},{x:e,y:t}]}(n,o-i,r,i);(0,c.createShapePath)(e,l)}t.drawComments=function(e,t,n){(0,o.verifyArgumentNotNull)(e,"ctx","drawComments"),(0,o.verifyArgumentNotNull)(t,"model","drawComments"),(0,o.verifyArgumentNotNull)(n,"context","drawComments"),function(e,t,n){let o=!1;const r=t.ClientOnlyCache.CellsToRender;for(let l=0;l<r.length;l++){const c=r[l];if(c.Comment&&!c.Comment.IsThreadedComment){if(!p(c,n.renderingRegion))continue;const r=(0,d.getLegacyCommentNotchSize)(t,c,s.LegacyCommentSizePx,n.devicePixelRatio,n.zoom);if(r<s.MinCommentIconSizePx)continue;o||(o=!0,e.fillStyle=(i=n.highContrastScheme)?(0,a.rgbToColorHex)(i.TextColor):s.LegacyCommentColor,e.beginPath()),y(e,t,c,n,r,u.createTrianglePathOnCellCorner,C.Position.Right)}}var i;o&&e.fill()}(e,t,n);const i=(0,r.getBooleanFeatureGate)("Microsoft.Office.Excel.GreyOutResolvedCommentIndicators",!1);m(e,t,n,!1,i),i&&m(e,t,n,!0,i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCommentHitRegionLeft=t.shouldAddFilterPaddingToComment=t.getCommentNotchSizeWithFilter=t.getLegacyCommentNotchSize=t.getThreadedCommentNotchSize=t.getFilterWithCommentPadding=void 0;const o=n(5),r=n(128),i=n(2),l=n(17),a=n(48),s=n(21),d=n(60);function c(e,t,n,o){const i=a.AutoFilterHorizontalPaddingPx+r.CommentWithFilterPaddingPx;return(0,l.getFilterSizeAdjustedForDrawing)(e,t,n,o)+Math.round(i*n*o)}function u(e,t,n,r,l){const a=c(e,t,r,l),s=(0,i.getDefaultBorderLineWidth)(l*r),d=(0,o.getCellWidthAdjustedForDrawing)(e,t)-s-a;return Math.min(n,d)}function g(e,t,n,r,i){var a,s;if(!t.Comment)return!1;const d=(0,o.getCellTopAdjustedForDrawing)(e,t,!1);if(t.AutoFilter&&(null===(a=t.AutoFilter.RenderingContext)||void 0===a||!a.IsHidden)||null!==(s=t.PivotFilter)&&void 0!==s&&s.DisplayFilter){const o=(0,l.getFilterSizeAdjustedForDrawing)(e,t,r,i);if((0,l.getFilterBottomAdjustedForDrawing)(e,t,o,r,i)-o-n<d)return!0}return!1}t.getFilterWithCommentPadding=c,t.getThreadedCommentNotchSize=function(e,t,n,o){let i=(0,s.getInteractiveIconMaxSizeAdjustedForDrawing)(r.ThreadedCommentSizePx,e,t,n,o,!0,!0);return g(e,t,i,n,o)&&(i=u(e,t,i,n,o)),i%2==1?i-1:i},t.getLegacyCommentNotchSize=function(e,t,n,o,r){let i=(0,d.getRightAngledTriangleSize)(e,t,n,o,r);return g(e,t,i,o,r)&&(i=u(e,t,i,o,r)),i},t.getCommentNotchSizeWithFilter=u,t.shouldAddFilterPaddingToComment=g,t.getCommentHitRegionLeft=function(e,t,n,r,i){const l=(0,o.getCellLeftAdjustedForDrawing)(e,t,e.IsRtl,!1),a=(0,o.getCellRightAdjustedForDrawing)(e,t,e.IsRtl),s=n+r-i,d=n+i;return(l>s||d>a)&&l-s>=d-a?n:s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawRichError=void 0;const o=n(1),r=n(20),i=n(5),l=n(3),a=n(94),s=n(2),d=n(60),c=n(199),u=n(21),g=n(0),h=n(23),C=n(47);function f(e,t,n,l){const a=(0,o.getRenderingRegionHitTestCache)(e,(0,g.getRenderingRegionKey)(n.renderingRegion)),s=Math.min((0,i.getCellWidthAdjustedForDrawing)(e,t),(0,i.getCellHeightAdjustedForDrawing)(e,t),c.RichErrorHitRegionMaxSizePx*n.scaleFactor),d={x:l.left,y:l.bottom-l.height,width:s,height:s},f=(0,u.getUnadjustedHitRegionFromRect)(e,n,d,e.IsRtl);let m=(0,o.isPassRibbonCommandsToCanvasRendererEnabled)()?(0,C.getRibbonCommandsInstance)().CardViewShowTemporaryErrorCard:e.RibbonCommands.CardViewShowTemporaryErrorCard;const p=(0,u.createRichErrorCallback)(e,t,m,!0);m=(0,o.isPassRibbonCommandsToCanvasRendererEnabled)()?(0,C.getRibbonCommandsInstance)().CardViewHideTemporaryCard:e.RibbonCommands.CardViewHideTemporaryCard;const y=(0,u.createRichErrorCallback)(e,t,m,!1);(0,r.registerCursorHitRegion)(t,a,f,h.DefaultCursorType,o.RenderFeaturesZIndex.RichError),(0,r.registerHitRegion)(t,a,f,o.RenderFeaturesZIndex.RichError,p,"mouseenter"),(0,r.registerHitRegion)(t,a,f,o.RenderFeaturesZIndex.RichError,y,"mouseleave")}function m(e,t){return!!e.HasIgnorableError&&!!(0,s.cellIntersectsRenderingRegion)(e,t.renderingRegion)}function p(e,t,n){return{left:(0,i.getCellLeftAdjustedForDrawing)(e,t,e.IsRtl,!1),bottom:(0,i.getCellTopAdjustedForDrawing)(e,t,!1)+n,width:n,height:n,outerColor:void 0,innerColor:void 0}}t.drawRichError=function(e,t,n){(0,o.verifyArgumentNotNull)(e,"ctx","drawErrorNotch"),(0,o.verifyArgumentNotNull)(t,"model","drawErrorNotch"),(0,o.verifyArgumentNotNull)(n,"context","drawErrorNotch");let r=!1,i=!1;const s=t.ClientOnlyCache.CellsToRender;for(let u=0;u<s.length;u++){const g=s[u];if(!m(g,n))continue;r||(i=!!t.RibbonCommands,(0,o.verifyArgumentNotNull)(t.RowNumbers,"model.RowNumbers","RowNumbers"),(0,o.verifyArgumentNotNull)(t.ColumnNumbers,"model.ColumnNumbers","ColumnNumbers"),e.setLineDash(l.DefaultDash),e.beginPath(),r=!0);const h=p(t,g,(0,d.getRightAngledTriangleSize)(t,g,c.RichErrorTriangleSizePx,n.devicePixelRatio,n.zoom));(0,d.createTrianglePathOnCellCorner)(e,h,a.Position.Left),i&&f(t,g,n,h)}r&&(e.fillStyle=n.highContrastScheme?(0,g.rgbToColorHex)(n.highContrastScheme.TextColor):c.RichErrorColor,e.fill())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RichErrorHitRegionMaxSizePx=t.RichErrorTriangleSizePx=t.RichErrorColor=void 0,t.RichErrorColor="#156712",t.RichErrorTriangleSizePx=8,t.RichErrorHitRegionMaxSizePx=25},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawRichValueIcons=void 0;const o=n(1),r=n(10),i=n(59),l=n(0),a=n(8),s=n(23),d=n(20),c=n(5),u=n(74),g=n(31),h=n(2),C=n(21),f=n(68),m=n(48),p=n(41),y=n(3),S=n(49),R=n(96),F=n(17),T=n(12),w=n(57),I=n(9),b=n(15),v=n(126),x=n(47);function D(e,t){return!(!e.RichValueIcon||!(0,h.cellIntersectsRenderingRegion)(e,t.renderingRegion)||e.DisplayFormula||(0,o.isChangeGateEnabled)(o.ChangeGate.DontShowRichValueIconForSpilledArrayFormulasInFormulaView)&&(0,h.isArrayFormulaChildInFormulaView)(e,t)||(0,l.isCellPreviewTextDefined)(e.PreviewText)||e.ShowSkeleton)}function A(e,t,n,a,c){n.RichValueIcon.Type===o.RichValueIconType.LinkedEntity?function(e,t,n){if(!t.RichValueIcon.Unicode)throw Error("drawUnicodeIcon: RichValueIconInformation does not have a char code value.");!function(e,t,n){const{x:o,y:r,height:i}=n,l=r+i;e.fillText(t,o,l)}(e,String.fromCharCode(t.RichValueIcon.Unicode),n)}(e,n,c):function(e,t,n,r){const i=t.RichValueIcon.Type===o.RichValueIconType.Disambiguation?1:2,l=(0,g.getOrLoadStaticImage)(i,n.blockIdentifier);l&&e.drawImage(l,r.x,r.y,r.width,r.height)}(e,n,a,c),function(e,t,n,a){const c=a.y+a.height;let u;if((0,p.shouldClipHorizontally)(e,t,a.x,a.width,!1)||(0,p.shouldClipVertically)(e,t,c,a.width)){const o=(0,p.getClippedDrawingContext)(e,t,n,a);u=(0,C.getUnadjustedHitRegionFromRect)(e,n,o,!1)}else u=(0,C.getUnadjustedHitRegionFromRect)(e,n,a,!1);const g=(0,o.getRenderingRegionHitTestCache)(e,(0,l.getRenderingRegionKey)(n.renderingRegion)),h=function(e){let t;const n=e.RichValueIcon.Type;return n===o.RichValueIconType.Disambiguation?t=i.gridRendererStrings.richValueIconDisambigTooltip:n!==o.RichValueIconType.Sync&&(t=i.gridRendererStrings.richValueIconShowCard),t}(t);(0,d.registerCursorHitRegion)(t,g,u,s.PointerCursorType,o.RenderFeaturesZIndex.RichValueIcon),(0,d.registerHitRegion)(t,g,u,o.RenderFeaturesZIndex.RichValueIcon,e=>({handled:!0,stopPropagation:!1}),"pointerdown"),(0,d.registerHitRegion)(t,g,u,o.RenderFeaturesZIndex.RichValueIcon,t=>{const n=(0,o.isPassRibbonCommandsToCanvasRendererEnabled)()?(0,x.getRibbonCommandsInstance)().CardViewShowDataCardOrDisambiguationPane:e.RibbonCommands.CardViewShowDataCardOrDisambiguationPane;return(0,r.handleRibbonCommand)(t,n,""),!0},"click"),(0,d.registerHitRegion)(t,g,u,o.RenderFeaturesZIndex.RichValueIcon,s.TouchCallback,"touchstart"),(0,d.registerHitRegion)(t,g,u,o.RenderFeaturesZIndex.RichValueIcon,s.EmptyFalseCallback,"touchend"),h&&(0,d.registerTooltipHitRegion)(t,g,u,h,o.RenderFeaturesZIndex.RichValueIcon)}(t,n,a,c)}function P(e,t,n,r,i){const l=Math.round(i*r.scaleFactor);let s=0;if(function(e,t){if(e.PivotTable)return!0;if(t.PivotTables&&t.PivotTables.length>0)for(let n=0;n<t.PivotTables.length;n++){const o=t.PivotTables[n];if(!o.IsEmptyPivot&&!o.IsOlap&&e.Row>=o.FirstRowIndex&&e.Row<=o.LastRowIndex&&e.Col>=o.FirstColIndex&&e.Col<=o.LastColIndex)return!0}return!1}(n,t))s=function(e,t,n,r,i){var l;const s=(0,R.shouldDrawAutoFilter)(n,r),d=t.IsRtl&&s?(0,F.getAutoFilterButtonPadding)(t,n,r.zoom,r.devicePixelRatio):0;let u=d+f.RichValueIconLeftHorizontalPadding+(0,c.getCellLeftAdjustedForDrawing)(t,n,!1,!1),g=u;const h=(0,b.getEffectiveHorizontalAlignment)(t,n);let C=0;null!==(l=n.PivotTable)&&void 0!==l&&l.HasExpandCollapseIndicator&&(C=Math.round((0,T.getExpandCollapseButtonPadding)(n)*r.scaleFactor),t.IsRtl||h===o.HorizontalAlignment.Left||(u+=C));const m=n.CachedIndent||w.NoIndent,p=Math.round((0,I.getCellHorizontalIndentationPaddingPx)(n,m)*r.scaleFactor),y=(0,I.getTextHorizontalPosition)(t,n,r)*r.scaleFactor,S=e.font;e.font=(0,a.getFontCssStringFromFont)(n.CachedFont,void 0,t);const x=(0,v.getTextWidthAdjustedForDrawing)(e,t,n,r.scaleFactor);e.font!==S&&(e.font=S);const D=(i+f.RichValueIconRightHorizontalPadding)*r.scaleFactor;switch(h){case o.HorizontalAlignment.Left:g=t.IsRtl?Math.max(Math.floor(y-D),u):Math.floor(d+C+w.PaddingBetweenExpandCollapseButtonAndTextPx*r.scaleFactor+p+(0,c.getCellLeftAdjustedForDrawing)(t,n,!1,!1));break;case o.HorizontalAlignment.CenterAcrossSelection:case o.HorizontalAlignment.Center:t.IsRtl,g=Math.max(Math.floor(y-x/2-D),u);break;case o.HorizontalAlignment.Right:g=t.IsRtl?Math.max(Math.floor((0,c.getCellRightAdjustedForDrawing)(t,n,!1)-p-w.PaddingBetweenExpandCollapseButtonAndTextPx*r.scaleFactor-C-x-D),u):Math.max(Math.floor(y-x-D),u);break;default:throw Error("getRichValueIconDrawingContext: unsupported horizontalAlignment: "+h)}return g}(e,t,n,r,i);else{const e=(0,R.shouldDrawAutoFilter)(n,r),i=(0,o.isChangeGateEnabled)(o.ChangeGate.RichIconFilterScale)?r.zoom:r.devicePixelRatio,l=(0,o.isChangeGateEnabled)(o.ChangeGate.RichIconFilterScale)?r.devicePixelRatio:r.zoom,a=(0,o.isChangeGateEnabled)(o.ChangeGate.RichIconFilterScale)?r.scaleFactor:1;s=(t.IsRtl&&e?(0,F.getFilterSizeAdjustedForDrawing)(t,n,l,i)+Math.round((m.AutoFilterTextHorizontalPaddingPx+f.RichValueIconLeftHorizontalPadding)*a):f.RichValueIconLeftHorizontalPadding)+(0,c.getCellLeftAdjustedForDrawing)(t,n,!1,!1)}return{x:s,y:function(e,t,n,r){const i=(0,S.getEffectiveVerticalAlignment)((0,u.getVerticalAlignmentForIcons)(e,t),S.AdvVerticalAlignmentFormat.CFIcon,void 0,void 0,void 0,void 0,t.DisplayFormula),l=(0,u.getIconBottomWhenAlignedWithMiddleBaseline)(e,t,n,r,i);let a;if((0,o.isChangeGateEnabled)(o.ChangeGate.CellIconBottomPadding))a=Math.round(r*y.CellIconBottomSizeRatioPadding);else{a=t.RichValueIcon.Type!==o.RichValueIconType.LinkedEntity?Math.round(r*y.CellIconBottomSizeRatioPadding):0}switch(i){case o.VerticalAlignment.Bottom:case o.VerticalAlignment.Top:return l-a;case o.VerticalAlignment.Center:return(0,u.isIconOutOfCellVerticalBoundaries)(e,t,l,r)?Math.floor((0,c.getCellCenterYAdjustedForDrawing)(e,t)+r/2):l-a;default:throw Error(`getIconVerticalPosition: Vertical alignment ${i} is not supported in RV Icon!`)}}(t,n,r.scaleFactor,l)-l,width:l,height:l}}function M(e,t,n,o){if(!n.highContrastScheme){var r,i;const n=null!==(r=null===(i=t.CachedFont)||void 0===i?void 0:i.Color)&&void 0!==r?r:"";e.fillStyle!==n&&(e.fillStyle=n)}const l=`${o.width}px ${y.CellFontUnicodeFontFamily}`;e.font!==l&&(e.font=l)}t.drawRichValueIcons=function(e,t,n){(0,o.verifyArgumentNotNull)(e,"ctx","drawRichValueIcons"),(0,o.verifyArgumentNotNull)(t,"model","drawRichValueIcons"),(0,o.verifyArgumentNotNull)(n,"context","drawRichValueIcons");const r=t.ClientOnlyCache.CellsToRender;!function(e,t){const n=t.highContrastScheme;e.fillStyle=n?(0,l.rgbToColorHex)(n.TextColor):y.DefaultCellFontColor,e.textAlign="left",e.textBaseline="alphabetic"}(e,n);for(let l=0;l<r.length;l++){var i;const a=r[l];if(!D(a,n))continue;const s=P(e,t,a,n,a.RichValueIcon.Width),{x:d,y:c,width:u}=s,g=c+u,C=(0,p.getClipRect)(t,a,d,g,u,!0);(null===(i=a.RichValueIcon)||void 0===i?void 0:i.Type)===o.RichValueIconType.LinkedEntity&&M(e,a,n,s),C&&(0,h.applyClipping)(e,C),A(e,t,a,n,s),C&&(0,h.restoreClipping)(e,C)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerCellsGeneralTooltip=void 0;const o=n(1),r=n(59),i=n(0),l=n(20),a=n(5),s=n(12),d=n(2);function c(e,t){return!(!(0,d.cellIntersectsRenderingRegion)(e,t.renderingRegion)||(0,i.isCellPreviewTextDefined)(e.PreviewText)||e.ShowSkeleton||!e.HasError&&!(0,s.cellTextReplacedWithHashes)(e))}function u(e,t,n){const d=(0,o.getRenderingRegionHitTestCache)(e,(0,i.getRenderingRegionKey)(t.renderingRegion)),c=(0,a.getCellWidthAdjustedForDrawing)(e,n),u=(0,a.getCellHeightAdjustedForDrawing)(e,n),g=e.IsRtl,h={x:(0,a.getCellLeftAdjustedForDrawing)(e,n,g,!1),y:(0,a.getCellTopAdjustedForDrawing)(e,n,!1),width:c,height:u},C={isMirrored:g,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:h,isRtl:g,blockWidth:e.BlockWidth};(0,l.registerTooltipHitRegion)(n,d,C,function(e){if((0,o.verifyArgumentNotNull)(r.gridRendererStrings,"gridRendererStrings","getGeneralTooltipStringForCell"),e.HasError)return r.gridRendererStrings.formulaErrorTooltip;if((0,s.cellTextReplacedWithHashes)(e))return e.OriginalText;throw"getGeneralTooltipStringForCell: unexpected tooltip string"}(n),o.RenderFeaturesZIndex.GeneralCellTooltip)}t.registerCellsGeneralTooltip=function(e,t,n){(0,o.verifyArgumentNotNull)(e,"ctx","registerCellsTooltip"),(0,o.verifyArgumentNotNull)(t,"model","registerCellsTooltip"),(0,o.verifyArgumentNotNull)(n,"context","registerCellsTooltip");const r=t.ClientOnlyCache.CellsToRender;for(let e=0;e<r.length;e++){const o=r[e];c(o,n)&&u(t,n,o)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTableSelectors=void 0;const o=n(1),r=n(0),i=n(10),l=n(20),a=n(5),s=n(2),d=n(21),c=n(27),u=n(97),g=n(203),h=n(23);function C(e,t){return!(!e.TableColHeader&&!e.TableRowHeader||!(0,s.cellIntersectsRenderingRegion)(e,t.renderingRegion))}function f(e,t,n,o){n.TableColHeader&&n.TableRowHeader&&m(e,t,n,o,2),n.TableColHeader&&m(e,t,n,o,0),n.TableRowHeader&&m(e,t,n,o,1)}function m(e,t,n,s,C){const f=function(e,t,n,o){const r=(0,a.getCellLeftAdjustedForDrawing)(e,n,e.IsRtl,!1),i=(0,a.getCellWidthAdjustedForDrawing)(e,n),l=(0,a.getCellTopAdjustedForDrawing)(e,n,!1),s=(0,a.getCellHeightAdjustedForDrawing)(e,n),d=Math.min(g.MaxColumnSelectorHeight,s*g.ColumnSelectorScalingFactor*t.scaleFactor),c=Math.min(g.MaxRowSelectorWidth,i*g.RowSelectorScalingFactor*t.scaleFactor);switch(o){case 0:return{x:r,y:l,width:i,height:d};case 1:return{x:r,y:l,width:c,height:s};case 2:return{x:r,y:l,width:c,height:d};default:throw Error("getTableSelectorRectInfo: unsupported selector type for table selector event: "+o)}}(t,s,n,C);s.debugMode&&function(e,t){const n={outerColor:"#00FF00",innerColor:"",left:t.x,bottom:t.y+t.height,width:t.width,height:t.height};(0,c.drawRectangle)(e,n)}(e,f);const m=(0,d.getUnadjustedHitRegionFromRect)(t,s,f,t.IsRtl),p=(0,o.getRenderingRegionHitTestCache)(t,(0,r.getRenderingRegionKey)(s.renderingRegion)),{cursor:y,zIndex:S}=function(e,t){switch(e){case 0:return{cursor:u.gridRendererCustomCursors.columnSelectCursor,zIndex:o.RenderFeaturesZIndex.ColumnOrRowSelector};case 1:return t?{cursor:u.gridRendererCustomCursors.rowSelectRTLCursor,zIndex:o.RenderFeaturesZIndex.ColumnOrRowSelector}:{cursor:u.gridRendererCustomCursors.rowSelectLTRCursor,zIndex:o.RenderFeaturesZIndex.ColumnOrRowSelector};case 2:return t?{cursor:u.gridRendererCustomCursors.tableSelectRTLCursor,zIndex:o.RenderFeaturesZIndex.TableSelector}:{cursor:u.gridRendererCustomCursors.tableSelectLTRCursor,zIndex:o.RenderFeaturesZIndex.TableSelector};default:throw Error("getCursorAndZIndex: unsupported selector type for table selector event: "+e)}}(C,t.IsRtl);(0,l.registerCursorHitRegion)(n,p,m,y,S),(0,o.isChangeGateEnabled)(o.ChangeGate.TableSelectionDragSelection)?((0,l.registerHitRegion)(n,p,m,S,e=>{const o=t.RowNumbers[n.Row],r=t.ColumnNumbers[n.Col];return(0,i.tableSelectorsCallback)(e,o,r,C),2===C},"pointerdown"),2===C&&(0,l.registerHitRegion)(n,p,m,S,h.EmptyTrueCallback,"pointerup")):((0,l.registerHitRegion)(n,p,m,S,e=>{const o=t.RowNumbers[n.Row],r=t.ColumnNumbers[n.Col];return(0,i.tableSelectorsCallback)(e,o,r,C),!0},"click"),(0,l.registerHitRegion)(n,p,m,S,h.EmptyTrueCallback,"pointerdown")),(0,l.registerHitRegion)(n,p,m,S,h.EmptyTrueCallback,"dblclick")}t.registerTableSelectors=function(e,t,n){(0,o.verifyArgumentNotNull)(e,"ctx","registerTableSelectors"),(0,o.verifyArgumentNotNull)(t,"model","registerTableSelectors"),(0,o.verifyArgumentNotNull)(n,"context","registerTableSelectors"),(0,o.verifyArgumentNotNull)(t.RowNumbers,"model.RowNumbers","registerTableSelectors"),(0,o.verifyArgumentNotNull)(t.ColumnNumbers,"model.ColumnNumbers","registerTableSelectors");const r=t.ClientOnlyCache.CellsToRender;for(let o=0;o<r.length;o++){const i=r[o];C(i,n)&&f(e,t,i,n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaxRowSelectorWidth=t.MaxColumnSelectorHeight=t.DPI=t.RowSelectorScalingFactor=t.ColumnSelectorScalingFactor=void 0,t.ColumnSelectorScalingFactor=.25,t.RowSelectorScalingFactor=.25,t.DPI=96,t.MaxColumnSelectorHeight=t.DPI*t.ColumnSelectorScalingFactor,t.MaxRowSelectorWidth=t.DPI*t.RowSelectorScalingFactor},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawPreviewModeOverlay=void 0;const o=n(1),r=n(0),i=n(2),l=n(205);t.drawPreviewModeOverlay=function(e,t,n){const a=(0,r.getPreviewCellsRange)(e);if(!n.isCellsPreviewMode||!a)return;const s=e.RowNumbers[0],d=e.ColumnNumbers[0];if(!function(e,t,n,r){return(0,o.verifyArgumentNotNull)(e,"previewRange","isOverlayIntersectsRenderingRegion"),(0,o.verifyArgumentNotNull)(t,"renderingRegion","isOverlayIntersectsRenderingRegion"),!(e.LastRow<t.startRow+n)&&(!(e.FirstRow>t.endRow+n)&&(!(e.FirstColumn<t.startColumn+r)&&!(e.LastColumn>t.endColumn+r)))}(a,n.renderingRegion,s,d))return;const c=function(e,t){const n=(0,r.getPreviewCellsRange)(e),o=function(e,t){if(t.FirstRow<e.RowNumbers[0])return-100;let n=(0,r.getModelRowIndex)(e,t.FirstRow);return n<0&&(n=~n),e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[n]}(e,n),l=function(e,t,n){if(t.LastRow>e.RowNumbers[e.RowNumbers.length-1])return(0,i.getBlockDimensionsAdjustedForDrawing)(e.BlockHeight,n)+100;let o=(0,r.getModelRowIndex)(e,t.LastRow);o<0&&(o=~o-1);const l=e.ClientOnlyCache.RowOffsetsAdjustedForDrawing;return l[o]+(0,i.getRowHeightFromOffsets)(o,l)}(e,n,t.scaleFactor),a=function(e,t){if(t.FirstColumn<e.ColumnNumbers[0])return-100;let n=(0,r.getModelColumnIndex)(e,t.FirstColumn);return n<0&&(n=~n),e.ClientOnlyCache.ColOffsetsAdjustedForDrawing[n]}(e,n);return{x:a,y:o,width:function(e,t,n){if(t.LastColumn>e.ColumnNumbers[e.ColumnNumbers.length-1])return(0,i.getBlockDimensionsAdjustedForDrawing)(e.BlockWidth,n)+100;let o=(0,r.getModelColumnIndex)(e,t.LastColumn);o<0&&(o=~o-1);const l=e.ClientOnlyCache.ColOffsetsAdjustedForDrawing;return l[o]+(0,i.getColWidthFromOffsets)(o,l)}(e,n,t.scaleFactor)-a,height:l-o}}(e,n),u=n.highContrastScheme;var g;u||(t.fillStyle=l.PreviewStyleBackgroundColor,t.globalAlpha=(0,o.isChangeGateEnabled)(o.ChangeGate.PreviewCellsSettings)&&null!==(g=e.ClientOnlyCache.PreviewCellsSettings)&&void 0!==g&&g.RetainCellTextOnPreview?l.PreviewBackgroundGlobalAlphaRetainUserContent:l.PreviewBackgroundGlobalAlpha,t.fillRect(c.x,c.y,c.width,c.height),t.globalAlpha=l.PreviewBorderGlobalAlpha,t.shadowColor=l.PreviewBorderShadowColor,t.shadowBlur=l.PreviewBorderShadowBlur,t.shadowOffsetY=l.PreviewBorderShadowOffsetY),t.strokeStyle=u?(0,r.rgbToColorHex)(u.TextColor):l.PreviewBorderColor,t.lineWidth=u?l.PreviewBorderHighContrastWidthPx:l.PreviewBorderWidthPx,t.strokeRect(c.x,c.y,c.width,c.height),t.globalAlpha=1,t.shadowColor="transparent"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewBorderHighContrastWidthPx=t.PreviewBorderWidthPx=t.PreviewBorderShadowOffsetY=t.PreviewBorderShadowBlur=t.PreviewBorderShadowColor=t.PreviewBorderGlobalAlpha=t.PreviewBorderColor=t.PreviewBackgroundGlobalAlphaRetainUserContent=t.PreviewBackgroundGlobalAlpha=t.PreviewStyleBackgroundColor=void 0,t.PreviewStyleBackgroundColor="#edebe9",t.PreviewBackgroundGlobalAlpha=.4,t.PreviewBackgroundGlobalAlphaRetainUserContent=.1,t.PreviewBorderColor="#000000",t.PreviewBorderGlobalAlpha=.35,t.PreviewBorderShadowColor="#000000",t.PreviewBorderShadowBlur=4,t.PreviewBorderShadowOffsetY=4,t.PreviewBorderWidthPx=1,t.PreviewBorderHighContrastWidthPx=3},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadPolyFills=void 0;const o=n(207),r=n(208),i=n(209),l=n(210),a=n(211),s=n(212),d=n(213),c=n(214),u=n(215);let g=!1;t.loadPolyFills=function(e){g||((0,o.loadStringRepeat)(),(0,r.loadStringTrimRight)(),(0,i.loadStringStartsWith)(),(0,l.loadStringEndsWith)(),(0,d.loadGetLineDash)(e),(0,a.loadSetLineDash)(e),(0,s.loadStringCodeAtPoint)(),(0,c.loadArrayMap)(),(0,u.loadDateNow)(),g=!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringRepeat=void 0;const o=n(6);t.loadStringRepeat=function(){String.prototype.repeat||(String.prototype.repeat=function(e){if(null==this)throw new TypeError("can't convert "+this+" to object");let t=""+this,n=0;if((0,o.isNullOrUndefined)(e)&&(n=0),e<0)throw new RangeError("repeat count must be non-negative");if(e===1/0)throw new RangeError("repeat count must be less than infinity");if(n=Math.floor(e),0===t.length||0===n)return"";if(t.length*n>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");const r=t.length*n;for(n=Math.floor(Math.log(n)/Math.log(2));n;)t+=t,n--;return t+=t.substring(0,r-t.length),t})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringTrimRight=void 0,t.loadStringTrimRight=function(){const e=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]*$/;String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(e,"")})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringStartsWith=void 0,t.loadStringStartsWith=function(){String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value(e,t){const n=t>0?0|t:0;return this.substring(n,n+e.length)===e}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringEndsWith=void 0,t.loadStringEndsWith=function(){String.prototype.endsWith||(String.prototype.endsWith=function(e,t){let n=t;return(void 0===n||n>this.length)&&(n=this.length),this.substring(n-e.length,n)===e})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadSetLineDash=void 0;const o=n(1),r=n(0);t.loadSetLineDash=function(e){try{CanvasRenderingContext2D.prototype.setLineDash||(CanvasRenderingContext2D.prototype.setLineDash=function(e){}),(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.UseOffscreenCanvas,e)&&(0,r.isOffscreenCanvasSupported)()&&(OffscreenCanvasRenderingContext2D.prototype.setLineDash||(CanvasRenderingContext2D.prototype.setLineDash=function(e){}))}catch(e){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringCodeAtPoint=void 0,t.loadStringCodeAtPoint=function(){/*! https://mths.be/codepointat v0.2.0 by @mathias */String.prototype.codePointAt||(String.prototype.codePointAt=function(e){if(null==this)throw TypeError();const t=String(this),n=t.length,o=e?Number(e):0;if(o<0||o>=n)return;const r=t.charCodeAt(o);let i;return r>=55296&&r<=56319&&n>o+1&&(i=t.charCodeAt(o+1),i>=56320&&i<=57343)?1024*(r-55296)+i-56320+65536:r})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadGetLineDash=void 0;const o=n(1),r=n(0);t.loadGetLineDash=function(e){try{CanvasRenderingContext2D.prototype.getLineDash||(CanvasRenderingContext2D.prototype.getLineDash=function(){return[]},(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.UseOffscreenCanvas,e)&&(0,r.isOffscreenCanvasSupported)()&&(OffscreenCanvasRenderingContext2D.prototype.getLineDash||(OffscreenCanvasRenderingContext2D.prototype.getLineDash=function(){return[]})))}catch(e){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadArrayMap=void 0,t.loadArrayMap=function(){try{Array.prototype.map||(Array.prototype.map=function(e){if(null==this)throw new TypeError("this is null or not defined");const t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");let o;arguments.length>1&&(o=arguments[1]);const r=new Array(n);let i=0;for(;i<n;){if(i in t){const n=t[i],l=e.call(o,n,i,t);r[i]=l}i++}return r})}catch(e){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadDateNow=void 0,t.loadDateNow=function(){Date.now||(Date.now=function(){return(new Date).getTime()})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateCellShrinkToFit=void 0;const o=n(9),r=n(5),i=n(2),l=n(8),a=n(12),s=n(39),d=n(14),c=n(6),u=n(17),g=n(13);function h(e,t,n,o,r,i){return e+r<t?n:n*function(e,t,n,o,r){const i=e+o;return r?Math.max(t-o,0)/(e+n):t/(i+n)}(e,t,o,r,i)}function C(e,t,n){return(0,o.getFontLineHeight)(e,n,t.CachedFont.FontName)*t.CachedDisplayText.length}t.updateCellShrinkToFit=function(e,t,n,f){(0,d.shouldRenderVerticalText)(n)?function(e,t){const n=t.CachedFont.Size,o=C(e,t,n),i=(0,r.getCellHeight)(e,t,!1),l=h(o,i,n,0,0,!1);t.ShrunkSize=l===n?l:function(e,t,n,o){let r=Math.floor(o);if(r<s.MinAllowedFontSize)return s.MinAllowedFontSize;let i=C(e,t,r);for(;i<n&&r<s.MaxAllowedFontSize;)r+=1,i=C(e,t,r);for(;i>n&&r>s.MinAllowedFontSize;)r-=1,i=C(e,t,r);return r}(e,t,i,l)}(t,n):function(e,t,n,s){var d;const{zoom:C,devicePixelRatio:f}=s,m=(0,l.getFontCssStringFromFont)(n.CachedFont,void 0,t);e.font=m;const p=(0,o.getTextWidthNoCaching)(e,t,n),y=(0,r.getCellWidth)(t,n,!1),S=n.CachedStyle.Indentation||0,R=n.CachedFont.Size,F=(0,u.shouldAddAutoFilterPadding)(t,n)?(0,u.getAutoFilterButtonPadding)(t,n,C,f):0,T=(0,o.getHorizontalPadding)(t,n,R,n.CachedFont.Italic,S||0,!0,F),w=!(0,c.isNullOrUndefined)(null===(d=n.LinkedEntity)||void 0===d?void 0:d.IconWidth)||!!n.RichValueIcon,I=(0,a.getIconSizeAndPadding)(t,n,R,C,f),b=(0,i.getTextDrawingMaxWidth)(y,T,0,0,(0,u.getAutoFilterButtonPaddingForShrinkToFit)(t,n,C,f));if(n.ShrunkSize=h(p,b,R,T,I,w),n.ShrunkSize<0&&(0,g.setRenderingResultInfo)(`\n    ShrinkSize was calculated to be negative: ${n.ShrunkSize},\n    textWidth: ${p},\n    cellWidth: ${y},\n    cellIndentation ${S},\n    maxTextWidth: ${b},\n    originalFontSize: ${R},\n    padding: ${T}\n    `),n.ShrunkSize&&n.ShrunkSize>0){const r=(0,l.getFontCssStringFromFont)(n.CachedFont,n.ShrunkSize,t);e.font=r,(0,o.getTextWidth)(e,t,n)}}(e,t,n,f)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawTableBordersInHighContrast=void 0;const o=n(1),r=n(0),i=n(3),l=n(2),a=n(119);function s(e,t,n,o){!function(e,t){return e.FirstRow>=t.FirstRow&&e.LastRow<=t.LastRow&&e.FirstColumn>=t.FirstColumn&&e.LastColumn<=t.LastColumn}(n,o)?function(e,t,n,o){d(e,t,n.FirstColumn,n.LastColumn,n.FirstRow,o,!0),d(e,t,n.FirstColumn,n.LastColumn,n.LastRow,o,!1),c(e,t,n.FirstRow,n.LastRow,n.FirstColumn,o,!0),c(e,t,n.FirstRow,n.LastRow,n.LastColumn,o,!1)}(e,t,n,o):function(e,t,n){const o=(0,a.getRowTopOffset)(t,(n.FirstRow-1)%i.RowCountInBlock),r=(0,a.getRowBottomOffset)(t,(n.LastRow-1)%i.RowCountInBlock),l=(0,a.getColumnLeftOffset)(t,(n.FirstColumn-1)%i.ColumnCountInBlock),s=(0,a.getColumnRightOffset)(t,(n.LastColumn-1)%i.ColumnCountInBlock);void 0!==o&&void 0!==r&&void 0!==l&&void 0!==s&&e.strokeRect(l-i.pixelTranslation,o-i.pixelTranslation,s-l,r-o)}(e,t,n)}function d(e,t,n,o,r,s,d){if(r>=s.FirstRow&&r<=s.LastRow){const{start:c,end:u}=(0,a.getIntersectionRange)(s.FirstColumn,s.LastColumn,n,o),g=(r-1)%i.RowCountInBlock,h=(c-1)%i.ColumnCountInBlock,C=(u-1)%i.ColumnCountInBlock,f=(0,a.getColumnLeftOffset)(t,h),m=(0,a.getColumnRightOffset)(t,C),p=d?(0,a.getRowTopOffset)(t,g):(0,a.getRowBottomOffset)(t,g);void 0!==f&&void 0!==m&&void 0!==p&&(0,l.drawHorizontalLine)(e,f,m,p-i.pixelTranslation)}}function c(e,t,n,o,r,s,d){if(r>=s.FirstColumn&&r<=s.LastColumn){const{start:c,end:u}=(0,a.getIntersectionRange)(s.FirstRow,s.LastRow,n,o),g=(r-1)%i.ColumnCountInBlock,h=(c-1)%i.RowCountInBlock,C=(u-1)%i.RowCountInBlock,f=(0,a.getRowTopOffset)(t,h),m=(0,a.getRowBottomOffset)(t,C),p=d?(0,a.getColumnLeftOffset)(t,g):(0,a.getColumnRightOffset)(t,g);void 0!==f&&void 0!==m&&void 0!==p&&(0,l.drawVerticalLine)(e,f,m,p-i.pixelTranslation)}}t.drawTableBordersInHighContrast=function(e,t,n){var l;!function(e,t,n){(0,o.verifyArgumentNotNull)(e,"ctx","drawTableHighlightInHighContrast"),(0,o.verifyArgumentNotNull)(n,"context","drawTableHighlightInHighContrast"),(0,o.verifyArgumentNotNull)(t,"model","drawTableHighlightInHighContrast"),(0,o.verifyArgumentNotNull)(t.RowOffsets,"model.RowOffsets","drawTableHighlightInHighContrast"),(0,o.verifyArgumentNotNull)(t.ColumnOffsets,"model.ColumnOffsets","drawTableHighlightInHighContrast"),(0,o.verifyArgumentNotNull)(t.RowNumbers,"model.RowNumbers","drawTableHighlightInHighContrast"),(0,o.verifyArgumentNotNull)(t.ColumnNumbers,"model.ColumnNumbers","drawTableHighlightInHighContrast")}(e,t,n);const d=null===(l=t.ClientOnlyCache)||void 0===l?void 0:l.TableRangesCache;if(!(d&&d.length>0&&n.highContrastScheme))return;const c={FirstRow:t.RowNumbers[i.BlockRowStartIndex],FirstColumn:t.ColumnNumbers[i.BlockColumnStartIndex],LastRow:t.RowNumbers[i.BlockRowEndIndex],LastColumn:t.ColumnNumbers[i.BlockColumnEndIndex]};!function(e,t){e.lineWidth=i.ThickBorderWeight,e.strokeStyle=t.highContrastScheme?(0,r.rgbToColorHex)(t.highContrastScheme.TextColor):"black"}(e,n),e.beginPath();for(let o=0;o<d.length;o++)(0,a.tableIntersectsRenderingRegion)(d[o],c,n.renderingRegion)&&s(e,t,d[o],c);e.stroke()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasRendererFactoryGlobal=t.CanvasRendererFactory=void 0;const o=n(103),r=n(219),i=n(1),l=n(0),a=n(4),s=n(220),d=n(223),c=n(225);class u{getModelAccessor(e){return(0,a.verifyArgumentNotNull)(e,"model","CanvasRendererFactory.getModelAccessor"),new r.GridBlockModelAccessor(e)}getGridCanvasRenderer(){return new o.GridCanvasRenderer}getHeaderCanvasRenderer(){return new c.HeaderCanvasRenderer}createRenderingCanvasElement(e){return new s.InteractableCanvasElement((0,l.isSubPixelRenderingEnabled)(),!!e)}createHeaderBlockModelAccessor(e,t,n){(0,a.verifyArgumentNotNull)(e,"gridModel","CanvasRendererFactory.createHeaderBlockModelAccessor"),(0,a.verifyArgumentNotNull)(n,"viewMode","CanvasRendererFactory.createHeaderBlockModelAccessor");const o=(0,i.createHeaderBlockModel)(e,t,n);return new d.HeaderBlockModelAccessor(o,t)}}t.CanvasRendererFactory=u,t.CanvasRendererFactoryGlobal=new u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestableGridBlockModelAccessor=t.GridBlockModelAccessor=void 0;const o=n(0),r=n(8),i=n(4),l=n(1),a=n(76),s=n(6),d=n(5),c=n(109),u=n(31),g=n(2),h=n(9),C=n(12),f=n(92),m=n(10),p=n(132),y=n(77),S=n(131),R=n(17),F=n(72),T=n(3),w=n(14),I=n(7);class b extends p.BlockModelAccessor{static verifyArgumentNotNull(e,t,n){(0,i.verifyArgumentNotNull)(e,t,"GridBlockModelAccessor."+n)}getCell(e,t){return(0,l.getCell)(e,t,this.model)}shouldCellExistInModel(e,t){if(!this.getCell(e,t))try{(0,l.validateCellShouldExistInModelUnsafe)(this.model,e,t)}catch(e){return!1}return!0}getOrCreateCell(e,t){return(0,l.getOrCreateCell)(this.model,e,t)}getUniqueId(){return this.model.UniqueId}getCellStyle(e){return(0,l.getCellStyle)(this.model,e)}getCellFont(e){return(0,o.getCellFont)(e,this.model)}hasRichText(e){return b.verifyArgumentNotNull(e,"cell","hasRichText"),!(0,s.isNullOrUndefined)(null==e?void 0:e.TextRuns)}cloneCellFont(e){const t=(0,o.getCellFont)(e,this.model);return t?(0,o.duplicateFont)(t,t.ID||0,t.RefCount||0):t}getBorderStyle(e){return(0,l.getCellBorderStyle)(this.model,e)}removeBorder(e){b.verifyArgumentNotNull(e,"cell","removeBorder"),b.verifyArgumentNotNull(this.model.BorderStyles,"this.model.BorderStyles","removeBorder"),e.BorderStyleID=e.GlobalBorderStyleID=l.UniqueStyleID.DefaultBorder,e.CachedBorderStyle=(0,l.getBorderStyleByID)(e,this.model)}getNumberOfBlockColumns(){return this.model.ColumnNumbers.length}isRtl(){return this.model.IsRtl}setIsRtl(e){this.model.IsRtl=e,this.setDirty("isRtl",l.DirtyType.ModelCoreChanges)}replaceCellInModel(e,t){b.verifyArgumentNotNull(e,"cell","replaceCellInModel"),b.verifyArgumentNotNull(t,"immediateModel","replaceCellInModel"),b.verifyArgumentNotNull(t.Styles,"immediateModel!.Styles","replaceCellInModel");const n=t.Styles[0];b.verifyArgumentNotNull(n,"style","replaceCellInModel"),b.verifyArgumentNotNull(t.Fonts,"immediateModel!.Fonts","replaceCellInModel");const r=this.duplicateAndSetFontsInModel(t.Fonts),i=(0,l.isGlobalFontsAndCellStylesFlightEnabled)(this.model);i&&(0,l.getGlobalFontsMap)().process(this.model.Fonts),e.TextRuns&&(e.TextRuns=(0,o.duplicateTextRuns)(e.TextRuns,r),i&&(0,o.updateGlobalFontIdsOfTextRuns)(e.TextRuns,this.model.Fonts)),n.FontID=r[n.FontID||0],i&&(n.GlobalFontID=(0,l.getGlobalStyleId)(n.FontID||0,this.model.Fonts)),e.CachedFont=(0,l.getFontByID)(n,this.model,(null==e?void 0:e.StyleID)||0);const a=(0,o.getLastNonUniqueStyleID)(this.model)+1;if(n.ID=a,this.model.Styles.splice(a,0,n),i&&(0,l.getGlobalCellStylesMap)().process(this.model.Styles),e.StyleID=a,e.CachedStyle=n,i&&(e.GlobalCellStyleID=(0,l.getGlobalStyleId)(a,this.model.Styles)),!(0,s.isNullOrUndefined)(t.BorderStyles)){const n=t.BorderStyles[0];!(0,s.isNullOrUndefined)(n)&&!(0,s.isNullOrUndefined)(n.Borders)&&n.Borders.length>0&&(n.RefCount=1,(0,l.isGlobalBorderStylesEnabled)(this.model)?this.setBordersNew(e,n,!1):this.setBorders(e,n))}if(this.getCell(e.Row,e.Col)){const t=(0,o.getCellPositionInArray)(e,this.model.Cells);this.model.Cells[t]=e,this.model.ClientOnlyCache.CellLookup[(0,l.getCellLookupKey)(e.Row,e.Col)]=e}else this.attachCellToModel(e);n.RefCount=1}attachCellToModel(e){(0,o.attachCellToModel)(e,this.model)}shouldApplyBorderAtPosition(e,t){return b.verifyArgumentNotNull(e,"cell","shouldApplyBorderAtPosition"),b.verifyArgumentNotNull(t,"borderPosition","shouldApplyBorderAtPosition"),(0,o.shouldApplyBorderAtPosition)(e,t,this.model)}deleteCellFromModel(e){b.verifyArgumentNotNull(e,"cell","deleteCellFromModel"),b.verifyArgumentNotNull(this.model.Cells,"this.model.Cells","deleteCellFromModel");const t=(0,l.getCell)(e.Row,e.Col,this.model);if(!t)return;if(t.Row!==e.Row||t.Col!==e.Col)return;const n=!!e.Merge;let r=0,i=0;const a=(0,o.getCellPositionInArray)(e,this.model.Cells);n&&(r=e.Merge.Rows,i=e.Merge.Columns);for(let t=e.Row;t<=e.Row+r;t++)for(let n=e.Col;n<=e.Col+i;n++)delete this.model.ClientOnlyCache.CellLookup[(0,l.getCellLookupKey)(t,n)];this.model.Cells.splice(a,1)}prepareCellStyleForEdit(e){b.verifyArgumentNotNull(e,"cell","prepareCellStyleForEdit");const t=(0,l.isGlobalFontsAndCellStylesFlightEnabled)(this.model),n=(null==e?void 0:e.StyleID)||0;let r;if(t)try{r=(0,l.getReferencedObjectById)(n,this.model.Styles)}catch(t){const n=`PrepareCellStyleEdit: Exception while retrieving cell style with message: ${t} and stacktrace: ${new Error(t).stack||""}`;I.ULS.sendTraceTag(507601601,I.LogCategory.msoulscat_ES_EWAJSGrid,I.TraceLevel.Important,n),r=this.getCellStyle(e)}else r=this.getCellStyle(e);if((0,s.isNullOrUndefined)(e.CachedStyle)&&(e.CachedStyle=r),!t&&!this.isStyleUnique(r.ID||0)&&(r.RefCount||0)<=1)return!0;const i=(0,o.getLastNonUniqueStyleID)(this.model)+1,a=(0,o.duplicateStyle)(this.model,r,i,1);return r.RefCount=Math.max(0,(r.RefCount||0)-1),this.model.Styles.splice(i,0,a),e.CachedStyle=a,e.StyleID=i,!1}updateGlobalCellStyleIDAfterEdit(e){b.verifyArgumentNotNull(e,"cell","updateGlobalCellStyleIDAfterEdit");const t=this.getCellStyle(e);if(void 0===t.GlobalFontID||null===t.GlobalFontID)return void(e.GlobalCellStyleID=void 0);const n=(0,l.getGlobalCellStylesMap)().getOrCreateID(t);e.GlobalCellStyleID=n,e.CachedStyle=(0,l.getCellStyleByID)(e,this.model)}setDefaultHyperlinkStyleOnCell(e){b.verifyArgumentNotNull(e,"cell","setDefaultHyperlinkStyleOnCell");const t=(0,l.getReferencedObjectById)(l.UniqueStyleID.Hyperlink,this.model.Styles);e.StyleID=l.UniqueStyleID.Hyperlink,e.CachedStyle=t,t.RefCount=(0,o.incrementNumericVal)(t.RefCount||0)}hideCommentIndicators(e){b.verifyArgumentNotNull(e,"isCommentIndicatorHidden","hideCommentIndicators"),b.verifyArgumentNotNull(this.model,"this.model","hideCommentIndicators");let t=!1;if(e&&this.model){const o=this.model.Cells||[];for(const r of o){var n;if(null!=r&&null!==(n=r.Comment)&&void 0!==n&&n.IsThreadedComment){const n=e(this.getRowNumber(r.Row),this.getColumnNumber(r.Col));this.getHideCommentIndicator(r)!==n&&(this.setHideCommentIndicator(r,n),this.setCellAndSpannedOverCellsDirty(r),t=!0)}}}return t}editCellFontAttributes(e,t){if(b.verifyArgumentNotNull(e,"cell","editFont"),b.verifyArgumentNotNull(e,"editFontAction","editFont"),this.attachCellToModel(e),this.prepareFontForEdit(e),e.TextRuns)for(let n=0;n<e.TextRuns.length;n++){const o=e.TextRuns[n];(0,s.isNullOrUndefined)(o.CachedFont)&&(o.CachedFont=(0,l.getReferencedObjectById)(o.FontID||0,this.model.Fonts)),t(o.CachedFont)}t(e.CachedFont)}copyCacheItemsToModel(e){(0,i.verifyArgumentNotNull)(e,"sourceModel","copyClientOnlyCacheToNewModel"),null!=e&&e.ClientOnlyCache&&(this.model.ClientOnlyCache||(this.model.ClientOnlyCache={}),this.model.ClientOnlyCache.RenderingRegionsHitTestCache=e.ClientOnlyCache.RenderingRegionsHitTestCache)}prepareFontForEdit(e){if(null!=e&&e.TextRuns)for(let t=0;t<e.TextRuns.length;t++){const n=e.TextRuns[t],o=(0,s.isNullOrUndefined)(n.CachedFont)?(0,l.getReferencedObjectById)(n.FontID||0,this.model.Fonts):n.CachedFont;this.prepareTextRunFontForEdit(o,n)}this.prepareCellFontForEdit(e)}prepareBorderStyleForEdit(e){return b.verifyArgumentNotNull(e,"cell","prepareBorderStyleForEdit"),(0,o.prepareBorderStyleForEdit)(e,this.model)}addLeftBorderToAdjacentCell(e){return b.verifyArgumentNotNull(e,"cell","addLeftBorderToAdjacentCell"),(0,o.addLeftBorderToAdjacentCell)(e,this.model)}cloneBorderStyle(e){b.verifyArgumentNotNull(e,"cell","cloneBorderStyle");const t=this.getBorderStyle(e);return(0,o.duplicateBorderStyle)(t,t.ID||0,1)}setBorders(e,t){return(0,o.setBordersToBorderStyle)(e,this.model,t)}setBordersNew(e,t,n){return b.verifyArgumentNotNull(e,"cell","setBordersNew"),b.verifyArgumentNotNull(e,"newBorderStyle","setBordersNew"),(0,o.setBordersNew)(e,this.model,t,n)}afterBorderStyleEdit(e){return b.verifyArgumentNotNull(e,"cell","afterBorderStyleEdit"),(0,o.afterBorderStyleEdit)(e,this.model)}afterFontEdit(e){if(b.verifyArgumentNotNull(e,"cell","afterFontEdit"),null!=e&&e.TextRuns)for(let t=0;t<e.TextRuns.length;t++){const n=e.TextRuns[t];(0,s.isNullOrUndefined)(n.CachedFont)&&(n.CachedFont=(0,l.getFontByID)(n,this.model,void 0));const o=(0,l.getGlobalFontsMap)().getOrCreateID(n.CachedFont);n.GlobalFontID=o}const t=(0,l.getGlobalFontsMap)().getOrCreateID(null==e?void 0:e.CachedFont);e.CachedFont.GlobalId=t,e.CachedStyle.GlobalFontID=t,e.CachedFont=(0,l.getFontByID)(e.CachedStyle,this.model,(null==e?void 0:e.StyleID)||0),this.updateGlobalCellStyleIDAfterEdit(e)}setInCellControlOptions(e,t){b.verifyArgumentNotNull(e,"cell","setInCellControlOptions"),(0,l.isChangeGateEnabled)(l.ChangeGate.FixCopyBlankCellToACellWithCheckbox)?e.InCellControlOptions=t||void 0:(b.verifyArgumentNotNull(t,"controlOptions","setInCellControlOptions"),t&&(e.InCellControlOptions=t))}getInCellControlOptions(e){return b.verifyArgumentNotNull(e,"cell","getInCellControlOptions"),(0,l.isChangeGateEnabled)(l.ChangeGate.FixCopyBlankCellToACellWithCheckbox)||e.InCellControlOptions?e.InCellControlOptions:null}setHideCommentIndicator(e,t){b.verifyArgumentNotNull(e,"cell","setHideCommentIndicator"),e&&e.Comment&&(e.Comment.HideCommentIndicator=t)}getHideCommentIndicator(e){return b.verifyArgumentNotNull(e,"cell","getHideCommentIndicator"),!!(e&&e.Comment&&e.Comment.HideCommentIndicator)&&e.Comment.HideCommentIndicator}getCellCssFont(e){return(0,o.verifyCellStyleAndFont)(this.model,e,"getCellCssFont"),(0,r.getFontCssStringFromCell)(e,this.model)}setCellAndSpannedOverCellsDirty(e){e&&((0,o.setCellAndSpannedOverCellsDirty)(this.model,e),this.setDirtyInternal(l.DirtyType.ModelCellChanges))}setAdjacentCellsDirty(e){if(!e)return;const t=(0,l.isChangeGateEnabled)(l.ChangeGate.AdjacentCellsMergeFix)?(0,l.getAdjacentCellsKeys)(this.model,e):(0,l.getAdjacentCellsKeysOld)(this.model,e.Row,e.Col);this.setCellsDirty(t)}getCalcBlockModel(){const e=new l.CalcBlockModel,t=this.model.RowNumbers.slice(),n=this.model.ColumnNumbers.slice();e.addHeaders(t,n);for(let t=0;t<this.model.Cells.length;t++){const n=this.model.Cells[t],o=e.createCell(n);e.addCell(o)}return e}updateCellSpillInformation(e,t,n){var r,i;(0,o.verifyCellStyleAndFont)(this.model,e,"updateCellSpillInformation");const d=t*n;if((0,g.isAdjustedForDrawingOffsetsInitialized)(this.model)||(0,g.initializeOffsetsForDrawing)(this.model,d),(0,s.isNullOrUndefined)(null==e||null===(r=e.CachedDrawingLayout)||void 0===r?void 0:r.CellTextLayout)||(e.CachedDrawingLayout.CellTextLayout={}),e.Merge)return;if((null==e||null===(i=e.CachedStyle)||void 0===i?void 0:i.HorizontalAlignment)===l.HorizontalAlignment.CenterAcrossSelection)return;this.setCellAndSpannedOverCellsDirty(e),e.Spill=void 0;let c=null;c=this.getOrCreateCanvasContext(),this.setContextCellFont(c,e),(0,l.isRenderFlagEnabled)(l.RenderFlagsArray.MoveSpillCellBeforeRendering,this.model)?e.TolType=l.TolType.Spill:((0,a.updateCellSpill)(c,this.model,e,t,n),void 0!==e.Spill&&this.removeBordersWithinASpillCell(e),this.setCellAndSpannedOverCellsDirty(e))}updateTolType(e){if((0,o.verifyCellStyleAndFont)(this.model,e,"updateTolType"),(0,l.isRenderFlagEnabled)(l.RenderFlagsArray.TextWidthClientPhase1,this.model)){let t=null;t=this.getOrCreateCanvasContext(),this.setContextCellFont(t,e);const n=(0,d.getCellWidth)(this.model,e,!0),o=(0,h.measureTextWidth)(t,e.Text,!0,!0);if(e.ValueType===l.CellValueType.Number)o/n*100>(0,m.getServiceSetting)(9,80)&&(e.TolType=l.TolType.Autofit);else if(null!=e&&e.Spill){const t=(0,d.getSpillCellWidth)(e,this.model),n=o/(t-this.model.ColumnWidths[(0,d.getSpillCellEndCol)(e,this.model)])*100;o/t*100>(0,m.getServiceSetting)(10,80)&&(e.TolType=l.TolType.Spill),n<(0,m.getServiceSetting)(11,120)&&(e.TolType=l.TolType.Spill)}}}updateClosestNonEmptyCellsSpillInformation(e,t,n){b.verifyArgumentNotNull(e,"cell","updateClosestNonEmptyCellsSpillInformation"),(0,o.verifyCellStyleAndFont)(this.model,e,"updateClosestNonEmptyCellsSpillInformation");let r=null;r=this.getOrCreateCanvasContext(),this.setContextCellFont(r,e),(0,a.updateClosestNonEmptyCellsSpill)(r,e,this.model,t,n)}getUserInput(e){return b.verifyArgumentNotNull(e,"cell","getUserInput"),e.UserInput}setUserInput(e,t){b.verifyArgumentNotNull(e,"cell","setUserInput"),b.verifyArgumentNotNull(t,"userInput","setUserInput"),e.UserInput=t}clearCellFormat(e){const t=(0,l.getReferencedObjectById)(l.UniqueStyleID.Default,this.model.Styles);e.StyleID=l.UniqueStyleID.Default,e.CachedStyle=t,e.CachedFont=(0,l.getFontByID)(t,this.model,l.UniqueStyleID.Default),e.BorderStyleID=e.GlobalBorderStyleID=l.UniqueStyleID.DefaultBorder,e.CachedBorderStyle=(0,l.getBorderStyleByID)(e,this.model)}getCellWidth(e,t){return b.verifyArgumentNotNull(e,"cell","getCellWidth"),(0,d.getCellWidth)(this.model,e,t)}getHorizontalPadding(e,t,n){b.verifyArgumentNotNull(e,"cell","getHorizontalPadding");const o=t*n;return this.ensureCachedObjectsInitialized(this.model,e,o),(0,h.getCellTextHorizontalPadding)(e,this.model,t,n)}getCellHeight(e){return b.verifyArgumentNotNull(e,"cell","getCellHeight"),(0,d.getCellHeight)(this.model,e,!0)}getTextMaxWidth(e,t,n){b.verifyArgumentNotNull(e,"cell","getTextDrawingMaxWidth");const o=t*n;return this.ensureCachedObjectsInitialized(this.model,e,o),(0,g.getTextDrawingMaxWidth)(this.getCellWidth(e,!0),(0,h.getCellTextHorizontalPadding)(e,this.model,t,n),(0,h.getDistanceFromCellStartToIconEnd)(this.model,e,t,n),(0,C.getExpandCollapseButtonPadding)(e),0)}getFormattedText(e){b.verifyArgumentNotNull(e,"cell","getFormattedText"),b.verifyArgumentNotNull(this.model.Fonts,"this.model.Fonts","getFormattedText");const t=[],n=[],r=(0,l.isGlobalFontsAndCellStylesFlightEnabled)(this.model),i=(e,t)=>{if(r)a(e,t);else if(!n[e])if(e<this.model.Fonts.length){const t=this.model.Fonts[e];n[e]=(0,o.duplicateFont)(t,t.ID||0,t.RefCount||0)}else p.BlockModelAccessor.throwErrorWrapper(`Font ${e} does not exist`,"getFormattedText")},a=(e,t)=>{if(!n[e]){const r=(0,l.getFontByID)(t,this.model,void 0);n[e]=(0,o.duplicateFont)(r,e||0,r.RefCount||0)}};if(e.TextRuns)e.TextRuns.forEach(e=>{i(e.FontID||0,e),t.push((0,o.duplicateTextRun)(e))});else{let n=e.CachedStyle?e.CachedStyle:this.getCellStyle(e);(0,l.isChangeGateEnabled)(l.ChangeGate.StyleIdCrashFix)?n=(0,l.getCellStyleByID)(e,this.model):(0,l.isGlobalFontsAndCellStylesFlightEnabled)(this.model)&&(n=(0,l.getReferencedObjectById)((null==e?void 0:e.StyleID)||0,this.model.Styles));const o={FontID:n.FontID||0,StartIndex:0};i(n.FontID||0,n),t.push(o)}return{Text:e.Text||"",TextRuns:t,Fonts:n}}getNoControlPhoneticText(e,t){return b.verifyArgumentNotNull(e,"phoneticInfo","getNoControlPhoneticText"),b.verifyArgumentNotNull(t,"cellText","getNoControlPhoneticText"),(0,f.getNoControlPhoneticText)(e,t)}prepareTextRunFontForEdit(e,t){!(0,l.isGlobalFontsAndCellStylesFlightEnabled)(this.model)&&(e.RefCount||0)<=1||this.duplicateAndSetNewFontOnTextRun(e,t)}prepareCellFontForEdit(e){var t;const n=this.prepareCellStyleForEdit(e),o=(0,l.isGlobalFontsAndCellStylesFlightEnabled)(this.model),r=(null==e||null===(t=e.CachedStyle)||void 0===t?void 0:t.FontID)||0;let i;if(o)try{i=(0,l.getReferencedObjectById)(r,this.model.Fonts)}catch(t){const n=`PrepareCellFontEdit: Exception while retrieving font with message: ${t} and stacktrace: ${new Error(t).stack||""}`;I.ULS.sendTraceTag(507601600,I.LogCategory.msoulscat_ES_EWAJSGrid,I.TraceLevel.Important,n),i=this.getCellFont(e)}else i=this.getCellFont(e);(0,s.isNullOrUndefined)(null==e?void 0:e.CachedFont)&&(e.CachedFont=i),n&&(i.RefCount||0)<=1||this.duplicateAndSetNewFontOnCell(i,e)}setFormattedText(e,t){b.verifyArgumentNotNull(e,"cell","setFormattedText"),b.verifyArgumentNotNull(t,"formattedText","setFormattedText"),b.verifyArgumentNotNull(t.TextRuns,"formattedText.TextRuns","setFormattedText"),b.verifyArgumentNotNull(t.Fonts,"formattedText.Fonts","setFormattedText"),b.verifyArgumentNotNull(this.model.Fonts,"this.model.Fonts","setFormattedText"),this.attachCellToModel(e),e.Text=t.Text;const n=this.duplicateAndSetFontsInModel(t.Fonts),r=e.TextRuns=(0,o.duplicateTextRuns)(t.TextRuns,n);(0,l.isGlobalFontsAndCellStylesFlightEnabled)(this.model)&&((0,l.getGlobalFontsMap)().process(t.Fonts),(0,o.updateGlobalFontIdsOfTextRuns)(e.TextRuns,this.model.Fonts));for(let e=0;e<r.length;e++)r[e].CachedFont=(0,l.getFontByID)(r[e],this.model,void 0)}discardFormattedText(e){b.verifyArgumentNotNull(e,"cell","discardFormattedText"),e.TextRuns=void 0}serializeCell(e){return(0,l.serializeCell)(e,this.model)}getOutlineState(e,t){const n=e?this.model.RowOutlinesInformation:this.model.ColumnOutlinesInformation;if(!n)return l.OutlineState.None;let o=l.OutlineState.None;for(let r=0;r<n.length;r++){const i=n[r];for(let n=0;n<i.Outlines.length;n++){const r=i.Outlines[n];if(t===r.ButtonIndex&&!r.IsExpanded)return l.OutlineState.Collapsed;this.isIndexInOutline(t,r,e)&&(o=l.OutlineState.Expanded)}}return o}compareCells(e,t,n){return(0,l.areGridCellsEqual)(e,t,n,this.model)}updateNumFmt(e){b.verifyArgumentNotNull(e,"cell","updateNumFmt"),(0,l.isAccAndCustomNumFmtApplicable)(e)?(0,c.updateNumFmtFromCell)(e):e.NumFmt=void 0}updateCellText(e,t){b.verifyArgumentNotNull(e,"cell","updateCellText"),b.verifyArgumentNotNull(t,"text","updateCellText"),e.TextRuns=void 0,e.DisplayFormula=!1,(0,o.updateCellText)(this.model,e,t)}updateCellValue(e,t){b.verifyArgumentNotNull(e,"cell","updateCellValue"),e.Value=null!=t?t:void 0}hasPageLayout(){return null!=this.model.PageBreaks||null!=this.model.PrintAreas}hasIntersectingPrintArea(e){const t=this.model.PrintAreas;if(b.verifyArgumentNotNull(this.model.RowNumbers,"RowNumbers","hasIntersectingPrintArea"),b.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","hasIntersectingPrintArea"),t&&e){const n=this.model.RowNumbers.length,r=this.model.ColumnNumbers.length;for(let i=0;i<t.length;i++){const l=t[i];if(l.FirstRow===n||l.FirstColumn===r)continue;const a=this.getRowNumber(l.FirstRow),s=l.LastRow>=n?this.getRowNumber(n-1):this.getRowNumber(l.LastRow),d={FirstRow:a,FirstColumn:this.getColumnNumber(l.FirstColumn),LastRow:s,LastColumn:l.LastColumn>=r?this.getColumnNumber(r-1):this.getColumnNumber(l.LastColumn)};if((0,o.doRangesIntersect)(e,d))return!0}}return!1}setPrintArea(e){e&&0!==e.length&&(this.model.PrintAreas=e,this.setDirty("setPrintArea",l.DirtyType.ModelCoreChanges))}addToPrintArea(e){e&&0!==e.length&&(this.model.PrintAreas=(this.model.PrintAreas||[]).concat(e),this.setDirty("addToPrintArea",l.DirtyType.ModelCoreChanges))}clearPrintArea(){this.model.PrintAreas&&(this.model.PrintAreas=void 0,this.setDirty("clearPrintArea",l.DirtyType.ModelCoreChanges))}hasPrintArea(){return!!this.model.PrintAreas&&this.model.PrintAreas.length>0}getPrintArea(){if(!this.model.PrintAreas)return[];const e=[];for(let t=0;t<this.model.PrintAreas.length;t++){const n=this.model.PrintAreas[t];e.push({FirstRow:n.FirstRow,FirstColumn:n.FirstColumn,LastRow:n.LastRow,LastColumn:n.LastColumn})}return e}insertPageBreak(e){(null!=e&&e.Row&&0!==e.Row.length||null!=e&&e.Col&&0!==e.Col.length)&&(this.insertRowBreak(null==e?void 0:e.Row),this.insertColBreak(null==e?void 0:e.Col),this.setDirty("insertPageBreak",l.DirtyType.ModelCoreChanges))}removePageBreak(e){const t=this.removeRowBreak(null==e?void 0:e.Row),n=this.removeColBreak(null==e?void 0:e.Col);!this.model.PageBreaks||this.model.PageBreaks.Row||this.model.PageBreaks.Col||(this.model.PageBreaks=void 0),(t||n)&&this.setDirty("removePageBreak",l.DirtyType.ModelCoreChanges)}resetAllPageBreak(){this.model.PageBreaks&&(this.model.PageBreaks=void 0,this.setDirty("resetAllPageBreak",l.DirtyType.ModelCoreChanges))}getPivotTableRanges(){return this.duplicatePivotTableRangeInformations(this.model.PivotTables)}getSparklineRanges(){var e;return this.duplicateSparklineRangeInformations(null===(e=this.model.Sparklines)||void 0===e?void 0:e.Ranges)}getSparklinesUrl(){var e,t;return null!==(e=null===(t=this.model.Sparklines)||void 0===t?void 0:t.ImageUrl)&&void 0!==e?e:""}getAllRichValueFields(){return this.duplicateRichValueFields(this.model.AllRichValueFields)}disposeBlock(e){(0,s.isNullOrUndefined)(e)||""===e||(0,u.clearImageFromCache)(u.ImageType.Sparkline,e)}getAutoFilterButtonTotalSize(e,t,n){return b.verifyArgumentNotNull(e,"cell","getAutoFilterButtonTotalSize"),this.getAutoFilterButtonTotalSizeInternal(e,t,n)}getAutoFilterMenuOffsetsFromCellStart(e,t,n){return b.verifyArgumentNotNull(e,"cell","getAutoFilterMenuOffsetsFromCellStart"),this.getAutoFilterMenuOffsetsFromCellStartInternal(e,t,n)}setPreviewRange(e){var t;const n=(0,l.getModelClientCache)(this.model);n.PreviewCellsRange&&this.setPreviewRangeCellsDirty(n.PreviewCellsRange),null!==(t=n.PreviewCellsSettings)&&void 0!==t&&t.PreviewCellsRange&&this.setPreviewRangeCellsDirty(n.PreviewCellsSettings.PreviewCellsRange),e&&this.setPreviewRangeCellsDirty(e),n.PreviewCellsRange=e||void 0}setPreviewCellsSettings(e){var t;const n=(0,l.getModelClientCache)(this.model);n.PreviewCellsRange&&this.setPreviewRangeCellsDirty(n.PreviewCellsRange),null!==(t=n.PreviewCellsSettings)&&void 0!==t&&t.PreviewCellsRange&&this.setPreviewRangeCellsDirty(n.PreviewCellsSettings.PreviewCellsRange),null!=e&&e.PreviewCellsRange&&this.setPreviewRangeCellsDirty(e.PreviewCellsRange),n.PreviewCellsSettings=e||void 0}getPreviewText(e){return b.verifyArgumentNotNull(e,"cell","getPreviewText"),e.PreviewText}setPreviewText(e,t){b.verifyArgumentNotNull(e,"cell","setPreviewText"),e.PreviewText=t}getPreviewNumFmt(e){return(0,o.assertArgumentNotNull)(e,"cell","getPreviewNumFmt"),e.PreviewNumFmt}setPreviewNumFmt(e,t){b.verifyArgumentNotNull(e,"cell","setPreviewNumFmt"),e.PreviewNumFmt=t}setRetainTextOnPreview(e,t){b.verifyArgumentNotNull(e,"cell","setRetainTextOnPreview"),e.RetainTextOnPreview=t}getPreviewCellStyle(e){return(0,o.assertArgumentNotNull)(e,"cell","getPreviewCellStyle"),e.PreviewCellStyle}setPreviewCellStyle(e,t){b.verifyArgumentNotNull(e,"cell","setPreviewCellStyle"),e.PreviewCellStyle=t}isSkeletonCell(e){return b.verifyArgumentNotNull(e,"cell","isSkeletonCell"),!!e.ShowSkeleton}setShowSkeleton(e,t){b.verifyArgumentNotNull(e,"cell","setShowSkeleton"),e.ShowSkeleton=t}hasFilters(){for(let e=0;e<this.model.Cells.length;e++){const t=this.model.Cells[e];if(t.AutoFilter||t.PivotFilter)return!0}return!1}updatePivotTablesAfterColWidthProcessing(){const e=this.model.PivotTables;if(e&&0!==e.length)for(let t=0;t<e.length;t++){const n=e[t];for(let e=n.FirstColumn;e<=n.LastColumn;e++){const t=(0,y.getColMetadata)(e+1);t&&t.SrvDx&&t.CachedColWidth&&(n.OriginPTWidth=n.OriginPTWidth-t.SrvDx+t.CachedColWidth)}}}hasRichValueIcon(e){return null!=e&&null!=e.LinkedEntity&&null!=e.LinkedEntity.IconWidth&&e.LinkedEntity.IconWidth>0}getCellContentWidth(e){var t;if((0,o.assertArgumentNotNull)(e,"cell","getCellContentWidth"),this.hasRichValueIcon(e))throw Error("getCellContentWidth: unsupported rich value icon!");const n=this.getOrCreateCanvasContext(),r={Text:e.Text,CellValueType:e.ValueType,CellStyleId:e.StyleID||0,Autofilter:null!=e.AutoFilter,ExpandColButton:null===(t=e.PivotTable)||void 0===t?void 0:t.ShouldShowExpandCollapseMenu,CondWidthIcon:null!=e.CondFormat&&null!=e.CondFormat.Icon,TextRuns:e.TextRuns};return(0,S.calculateColWidthForMetadata)(n,this.model,r)}isCellWidthFixed(e){return(0,o.assertArgumentNotNull)(e,"cell","isCellWidthFixed"),!!this.model.FixedColumns&&this.model.FixedColumns[e.Col]}isCellHeightFixed(e){return(0,o.assertArgumentNotNull)(e,"cell","isCellHeightFixed"),!!this.model.IsBitwiseFixedRows&&(0,o.isFixedRows)(this.model.IsBitwiseFixedRows,e.Row)}getRichValueTypes(){return this.model.RichValueTypes||[]}getCellHeightWithWrap(e,t,n,i){var a;(0,o.assertArgumentNotNull)(e,"cell","getCellHeightWithWrap");const s=(0,l.isChangeGateEnabled)(l.ChangeGate.WrapTextNullFontFix);if(!i||e.ValueType!==l.CellValueType.String||e.Merge||s&&!e.Text||(0,o.isFixedRows)(this.model.IsBitwiseFixedRows||0,e.Row))return this.getRowHeight(e.Row);e.CachedDrawingLayout||(e.CachedDrawingLayout={CellTextLayout:{}});const c={zoom:t,devicePixelRatio:n,debugMode:!1,isFormulaView:!1,isCanvasHitTestDebugHighlight:!1,isCellsPreviewMode:!1,modelFromCache:!1,renderPageLayout:!1,skeletonMode:!1,subPixelRenderingEnabled:!1,scaleFactor:t*n};let u=null;u=this.getOrCreateCanvasContext(),s&&(0,o.initializeCellCachedObjects)(this.model,e,!1),u.font=(0,r.getFontCssStringFromCell)(e,this.model);const f=(0,d.getCellWidth)(this.model,e,!0),m=(0,h.getDistanceFromCellStartToIconEnd)(this.model,e,t,devicePixelRatio),p=(0,g.getTextDrawingMaxWidth)(f,(0,h.getCellTextHorizontalPaddingWithoutVisualElements)(this.model,e),m,(0,C.getExpandCollapseButtonWidth)(null===(a=e.PivotTable)||void 0===a?void 0:a.HasExpandCollapseIndicator),(0,R.getAutoFilterPaddingForAdvancedHorizontalAlignment)(this.model,e,t,devicePixelRatio)),y=this.model.RowHeights[e.Row]-T.GridLineWidthPx,S=(0,w.shouldRenderVerticalText)(e)?y:p,I=(0,F.computeMaxTextWidthForWrapText)(e,(0,F.getBreakType)(e),S,this.model,c);if(I<=0)return this.getRowHeight(e.Row);const b=(0,h.getTextWidthNoCaching)(u,this.model,e),v=(0,h.getTextLineHeight)(e,this.model);return Math.ceil(b/I)*v}updateBreakOpForCell(e){(0,i.verifyArgumentNotNull)(e,"cell","updateBreakOpForCell");const t=(0,o.getDisplayText)(e,this.model);if(!t)return;if(!(0,o.doesTextContainThaiCharacter)(t))return;const n=(0,o.getBreakOpForThaiText)(t);n&&(e.WrapText||(e.WrapText={}),e.WrapText.BreakOp=n)}insertRowBreak(e){var t;e&&0!==e.length&&(null!==(t=this.model.PageBreaks)&&void 0!==t&&t.Row&&this.model.PageBreaks.Row.length>0?this.model.PageBreaks.Row=this.model.PageBreaks.Row.concat(e):this.model.PageBreaks?this.model.PageBreaks.Row=e:this.model.PageBreaks={Row:e})}insertColBreak(e){var t;e&&0!==e.length&&(null!==(t=this.model.PageBreaks)&&void 0!==t&&t.Col&&this.model.PageBreaks.Col.length>0?this.model.PageBreaks.Col=this.model.PageBreaks.Col.concat(e):this.model.PageBreaks?this.model.PageBreaks.Col=e:this.model.PageBreaks={Col:e})}removeRowBreak(e){var t;if(!e||0===e.length||null===(t=this.model.PageBreaks)||void 0===t||!t.Row||0===this.model.PageBreaks.Row.length)return!1;const n=this.model.PageBreaks.Row.filter(t=>e.every(e=>e.Index!==t.Index)),o=this.model.PageBreaks.Row.length!==n.length;return this.model.PageBreaks.Row=n.length>0?n:void 0,o}removeColBreak(e){var t;if(!e||0===e.length||null===(t=this.model.PageBreaks)||void 0===t||!t.Col||0===this.model.PageBreaks.Col.length)return!1;const n=this.model.PageBreaks.Col.filter(t=>e.every(e=>e.Index!==t.Index)),o=this.model.PageBreaks.Col.length!==n.length;return this.model.PageBreaks.Col=n.length>0?n:void 0,o}isStyleUnique(e){return e===l.UniqueStyleID.Default||e===l.UniqueStyleID.Hyperlink}removeBordersWithinASpillCell(e){for(let t=1;t<=e.Spill.SpanToEnd;t++){const n=this.getCell(e.Row,e.Col+t);if(n){const e=this.getBorderStyle(n);e&&e.Borders&&e.Borders.length>0&&this.removeCellLeftBorder(n,e)}}}removeCellLeftBorder(e,t){const n=(0,o.duplicateBorderStyle)(t,t.ID||0,1);if(n&&n.Borders){const t=n.Borders.length;for(let o=0;o<t;o++){const t=n.Borders[o];t&&t.BorderPosition===l.BorderPositionType.Left&&(n.Borders.splice(o),(0,l.isGlobalBorderStylesEnabled)(this.model)?this.setBordersNew(e,n,!0):this.setBorders(e,n))}}}duplicateAndSetNewFontOnTextRun(e,t){const n=this.duplicateAndSetNewFontInModel(e,!1);t.FontID=n.newFontId,t.CachedFont=n.newFont}duplicateAndSetNewFontOnCell(e,t){const{newFontId:n,newFont:o}=this.duplicateAndSetNewFontInModel(e,!1);t.CachedFont=o,t.CachedStyle.FontID=n}duplicateAndSetFontsInModel(e){const t=[],n=Object.keys(e);for(let o=0;o<n.length;o++){const r=e[parseInt(n[o],10)||0],{newFontId:i}=this.duplicateAndSetNewFontInModel(r,!0);t[r.ID||0]=i}return t}duplicatePivotTableRangeInformations(e){if(!e)return;const t=[];for(let n=0;n<e.length;n++)t.push(this.duplicatePivotTableRangeInformation(e[n]));return t}duplicatePivotTableRangeInformation(e){return{AltText:e.AltText,AltTextSummary:e.AltTextSummary,AutoFormatOnUpdate:e.AutoFormatOnUpdate,ColGrandTotalOn:e.ColGrandTotalOn,ColumnAreaFields:this.duplicatePivotTableFieldInfos(e.ColumnAreaFields),ColumnHeaderRange:this.duplicateRangeInformation(e.ColumnHeaderRange),ColumnMemberPropIndexes:e.ColumnMemberPropIndexes,ColumnTotalIndexes:e.ColumnTotalIndexes,ConfirmationRequiredForDataOps:e.ConfirmationRequiredForDataOps,ConnectionName:e.ConnectionName,CurrentStyleName:e.CurrentStyleName,StyleIndex:e.StyleIndex,DataPivotFieldCaption:e.DataPivotFieldCaption,DataPivotFieldIndex:e.DataPivotFieldIndex,DataSource:e.DataSource,DeltaXFromOriginPT:e.DeltaXFromOriginPT,DeltaXFromOriginPTAdjustedForDrawing:e.DeltaYFromOriginPTAdjustedForDrawing,DeltaYFromOriginPT:e.DeltaYFromOriginPT,DeltaYFromOriginPTAdjustedForDrawing:e.DeltaYFromOriginPTAdjustedForDrawing,DisplayErrorString:e.DisplayErrorString,DisplayNullString:e.DisplayNullString,ErrorString:e.ErrorString,ExternalSourceIndex:e.ExternalSourceIndex,FieldListVersion:e.FieldListVersion,FieldWellVersion:e.FieldWellVersion,FirstColIndex:e.FirstColIndex,FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,FirstRowIndex:e.FirstRowIndex,HasActiveFilter:e.HasActiveFilter,HideGridLines:e.HideGridLines,IndentIncrement:e.IndentIncrement,IsActionable:e.IsActionable,IsEmptyPivot:e.IsEmptyPivot,IsOlap:e.IsOlap,IsPageArea:e.IsPageArea,IsRefreshableTabularOlap:e.IsRefreshableTabularOlap,LastColIndex:e.LastRowIndex,LastColumn:e.LastColumn,LastRow:e.LastRow,LastRowIndex:e.LastRowIndex,NullString:e.NullString,OriginPTHeight:e.OriginPTHeight,OriginPTHeightAdjustedForDrawing:e.OriginPTHeightAdjustedForDrawing,OriginPTWidth:e.OriginPTWidth,OriginPTWidthAdjustedForDrawing:e.OriginPTWidthAdjustedForDrawing,PageAreaFields:this.duplicatePivotTableFieldInfos(e.PageAreaFields),PivotTableName:e.PivotTableName,RangeType:e.RangeType,RefreshOnLoad:e.RefreshOnLoad,RowAreaCaptions:e.RowAreaCaptions,RowAreaFields:this.duplicatePivotTableFieldInfos(e.RowAreaFields),RowHeaderRange:this.duplicateRangeInformation(e.RowHeaderRange),RowLocation:e.RowLocation,RowMemberPropIndexes:e.RowMemberPropIndexes,RowTotalIndexes:e.RowTotalIndexes,RwGrandTotalOn:e.RwGrandTotalOn,SaveSourceDataWithFile:e.SaveSourceDataWithFile,ShowColumnHeaders:e.ShowColumnHeaders,ShowColumnStripes:e.ShowColumnStripes,ShowDrillIndicators:e.ShowDrillIndicators,ShowItemsWithNoDataOnCol:e.ShowItemsWithNoDataOnCol,ShowItemsWithNoDataOnRw:e.ShowItemsWithNoDataOnRw,ShowRowHeaders:e.ShowRowHeaders,ShowRowStripes:e.ShowRowStripes,SupportsBIExplore:e.SupportsBIExplore,ValueAreaFields:this.duplicatePivotTableFieldInfos(e.ValueAreaFields),Xluid:e.Xluid,SlicerConnections:e.SlicerConnections,AutoRefresh:e.AutoRefresh,SupportsAutoRefresh:e.SupportsAutoRefresh}}duplicateRangeInformation(e){if(e)return{FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,LastColumn:e.LastColumn,LastRow:e.LastRow,RangeType:e.RangeType}}duplicatePivotTableFieldInfos(e){if(!e)return;const t=[];for(let n=0;n<e.length;n++)t.push(this.duplicatePivotTableFieldInfo(e[n]));return t}duplicatePivotTableFieldInfo(e){return{BaseFieldIndex:e.BaseFieldIndex,Caption:e.Caption,DataFieldAggregationType:e.DataFieldAggregationType,DataFieldFormatType:e.DataFieldFormatType,Index:e.Index,IsCompactLayout:e.IsCompactLayout,RepeatItemLabels:e.RepeatItemLabels,ShowBlankLineAfterEachItem:e.ShowBlankLineAfterEachItem,ShowItemsWithNoData:e.ShowItemsWithNoData,ShowSubtotal:e.ShowSubtotal,ShowSubtotalAtTop:e.ShowSubtotalAtTop,SortInfo:e.SortInfo,LabelOrDateFilterType:e.LabelOrDateFilterType,ValueFilterType:e.ValueFilterType,MeasureType:e.MeasureType,HasManualFilter:e.HasManualFilter,IsDateField:e.IsDateField,IsImplicitMeasure:e.IsImplicitMeasure,IsNumeric:e.IsNumeric}}duplicateAndSetNewFontInModel(e,t){const n=this.model.Fonts.length,r=t?e.RefCount||0:1,i=(0,o.duplicateFont)(e,n,r);return t||(e.RefCount=Math.max(0,(e.RefCount||0)-1)),this.model.Fonts.splice(n,0,i),{newFontId:n,newFont:i}}duplicateSparklineRangeInformations(e){if(!e)return;const t=[];for(let n=0;n<e.length;n++)t.push(this.duplicateSparklineRangeInformation(e[n]));return t}duplicateSparklineRangeInformation(e){return{FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,LastColumn:e.LastColumn,LastRow:e.LastRow,LocationColumn:e.LocationColumn,LocationRow:e.LocationRow,RangeType:e.RangeType,SparklineType:e.SparklineType}}duplicateRichValueFields(e){if(!e)return;const t=[];for(let n=0;n<e.length;n++)t.push(this.duplicateRichValueField(e[n]));return t}duplicateRichValueField(e){return{Index:e.Index,RefersToDotFunction:e.RefersToDotFunction,Value:e.Value}}setContextCellFont(e,t){e.font=(0,r.getFontCssStringFromCell)(t,this.model)}setPreviewRangeCellsDirty(e){const t={FirstColumn:Math.max(e.FirstColumn-1,0),FirstRow:Math.max(e.FirstRow-1,0),LastColumn:e.LastColumn+1,LastRow:e.LastRow+1};this.setCellsInRangeDirty(t)}setCellsInRangeDirty(e){for(let t=0;t<this.model.Cells.length;t++){const n=this.model.Cells[t];(0,l.isModelCellContainedInRange)(this.model,e,n)&&this.setCellAndSpannedOverCellsDirty(n)}}isIndexInOutline(e,t,n){const o=n?this.model.RowNumbers.length:this.model.ColumnNumbers.length;if(t.IsNonDefaultDirection){const n=-1!==t.ButtonIndex?t.ButtonIndex+1:0,r=-1!==t.StartIndex?t.StartIndex:o-1;if(e>=n&&e<=r)return!0}else{const n=-1!==t.StartIndex?t.StartIndex:0,r=-1!==t.ButtonIndex?t.ButtonIndex-1:o-1;if(e>=n&&e<=r)return!0}return!1}}t.GridBlockModelAccessor=b,t.TestableGridBlockModelAccessor=class extends b{duplicateAndSetFontsInModel(e){return super.duplicateAndSetFontsInModel(e)}duplicateTextRuns(e,t){return(0,o.duplicateTextRuns)(e,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InteractableCanvasElement=void 0;const o=n(110),r=n(0),i=n(23),l=n(130),a=n(221),s=n(10),d=n(7),c=n(222),u=n(11);class g extends o.RenderingCanvasElement{addRegionEventListener(e){this.cacheRegionAndRegisterEvents(e,e.eventType)}removeAllEventListeners(){this.isRegisteredToEvents&&(this.registeredEventsHitRegions.pointerdown&&this.canvas.removeEventListener("pointerdown",this.pointerDownEventHandler),this.registeredEventsHitRegions.pointerup&&this.canvas.removeEventListener("pointerup",this.pointerUpEventHandler),this.registeredEventsHitRegions.click&&(this.canvas.removeEventListener(i.PointerDownEvent,this.pointerDownEventHandler),this.canvas.removeEventListener("click",this.clickEventHandler)),this.registeredEventsHitRegions.touchstart&&this.canvas.removeEventListener("touchstart",this.touchStartEventHandler),this.registeredEventsHitRegions.dblclick&&this.canvas.removeEventListener("dblclick",this.dblClickEventHandler),this.registeredEventsHitRegions.touchend&&this.canvas.removeEventListener("touchend",this.touchEndEventHandler),this.isListeningToPointerMove&&(this.canvas.removeEventListener("pointermove",this.pointerMoveEventHandler),this.canvas.removeEventListener(i.PointerLeaveEvent,this.pointerLeaveEventHandler),this.isListeningToPointerMove=!1),this.registeredEventsHitRegions={},this.isRegisteredToEvents=!1,this.isHitMapSorted=!0)}addCursorRegion(e){this.cacheRegionAndRegisterEvents(e,i.CursorEventType)}addTooltipRegion(e){this.cacheRegionAndRegisterEvents(e,i.TooltipEventType)}addLongPressRegion(e){this.cacheRegionAndRegisterEvents(e,i.LongPressEventType)}dispose(){this.removeAllEventListeners(),super.dispose()}setHitMapOffsets(e,t,n,o,r){if(e.length>i.MaxHitMapOffsetCount||t.length>i.MaxHitMapOffsetCount)throw Error(`setHitMapOffsets:: offsets.length exceeds max allowed offsets length. x: ${e.length}, y: ${t.length}`);const l=r?r.endOffsetX-r.startOffsetX:n,a=g.doOffsetsHaveEqualDistances(e,l),s=g.getFirstOffsetSize(e,n);a&&0===s&&d.ULS.sendTraceTag(522311843,d.LogCategory.msoulscat_ES_EWAJSGrid,d.TraceLevel.Info,`setHitMapOffsets: width:${n} renderingRegion:${JSON.stringify(r)} offsetsX:${JSON.stringify(e)}}`),this.hitMapAxisX={areOffsetsEqual:a,equalOffsetsSize:s,offsets:e};const c=r?r.endOffsetY-r.startOffsetY:o,u=g.doOffsetsHaveEqualDistances(t,c),h=g.getFirstOffsetSize(t,o);u&&0===h&&d.ULS.sendTraceTag(522311872,d.LogCategory.msoulscat_ES_EWAJSGrid,d.TraceLevel.Info,`setHitMapOffsets: height:${o} renderingRegion:${JSON.stringify(r)} offsetsY:${JSON.stringify(t)}}`),this.hitMapAxisY={areOffsetsEqual:u,equalOffsetsSize:h,offsets:t}}optimizeHitMapLookup(){this.isHitMapSorted||this.sortHitMap()}setAppZoom(e){this.zoom=e}setDimensions(e,t,n){super.setDimensions(e,t,n),this.setDefaultHitMapAxes(e,t)}cancelLongPressTimer(e,t){this.longPressState.callbackScheduled&&!this.longPressState.longPressModeEnabled&&clearTimeout(this.longPressState.callbackId);const n=this.canvas;n&&n.releasePointerCapture&&-1!==this.longPressState.eventPointerId&&n.releasePointerCapture(this.longPressState.eventPointerId),this.longPressState.longPressModeEnabled&&this.handleMouseLongPressEnd(this.longPressState.lastHitRegion),this.longPressState=(0,l.getDefaultLongPressState)();const o=(0,l.getEventCoordinates)(e,t),r=this.getEventCoordinatesInCanvas(o.clientX,o.clientY);this.handlePointerMove(e,r)}getHitMapOffsetsX(){return this.hitMapAxisX}getHitMapOffsetsY(){return this.hitMapAxisY}getAppZoom(){return this.zoom}getIsHitMapSorted(){return this.isHitMapSorted}getEventTypeRegisteredEventsHitRegions(e){return this.registeredEventsHitRegions[e]}getIntersectingHitMapAreasKeys(e){const t=[],n=this.getRenderingRegion();if(!n)return t;const o=n.endOffsetX-n.startOffsetX,i=n.endOffsetY-n.startOffsetY;if(!(0,r.intersects1D)(e.x,e.x+e.width,0,0+o)||!(0,r.intersects1D)(e.y,e.y+e.height,0,0+i))return t;let l=g.getOffsetPosition(e.x,this.hitMapAxisX),a=g.getOffsetPosition(e.x+e.width-1,this.hitMapAxisX),s=g.getOffsetPosition(e.y,this.hitMapAxisY),c=g.getOffsetPosition(e.y+e.height-1,this.hitMapAxisY);(l<0||s<0||a>=this.hitMapAxisX.offsets.length||c>=this.hitMapAxisY.offsets.length)&&(this.arrayOverflowInvestigationLogged||(d.ULS.sendTraceTag(508052569,d.LogCategory.msoulscat_ES_EWAJSGrid,d.TraceLevel.Info,`InteractableCanvasElement::getIntersectingHitMapAreasKeys: xStartPosition:${l}, xEndPosition:${a}, yStartPosition:${s}, yEndPosition:${c}, hitMapAxisX:[${this.hitMapAxisX.offsets}], hitMapAxisY:[${this.hitMapAxisY.offsets}], region.x:${e.x}, region.width:${e.width}, region.y:${e.y}, region.height:${e.height}`),this.arrayOverflowInvestigationLogged=!0),l<0&&(l=0),s<0&&(s=0),a>=this.hitMapAxisX.offsets.length&&(a=this.hitMapAxisX.offsets.length-1),c>=this.hitMapAxisY.offsets.length&&(c=this.hitMapAxisY.offsets.length-1));for(let e=l;e<=a;e++)for(let n=s;n<=c;n++)t.push(g.getHitMapAreaKeyFromOffsetPosition(e,n));return t}getHitMapAreaKeyFromOffset(e,t){const n=g.getOffsetPosition(e,this.hitMapAxisX),o=g.getOffsetPosition(t,this.hitMapAxisY);return g.getHitMapAreaKeyFromOffsetPosition(n,o)}isEventStartAndEndInSameRegion(e,t,n){if(0===n.length)return!1;const{clientX:o,clientY:r}=(0,l.getEventCoordinates)(e,t),i=this.getEventCoordinatesInCanvas(o,r),a=this.getIntersectingHitRegions(t,i);return a.length>0&&(0,l.areTwoHitRegionsSame)(n[0],a[0])}static getHitMapAreaKeyFromOffsetPosition(e,t){return(e<<i.HitMapKeyXShift)+t}static getOffsetPosition(e,t){if(t.areOffsetsEqual)return 0===t.equalOffsetsSize&&(0,r.throwError)("areOffsetsEqual cannot be 0","getOffsetPosition"),Math.floor(e/t.equalOffsetsSize);const n=(0,r.binarySearch)(t.offsets,0,t.offsets.length,e,r.numbersComparer);return n<0?~n-1:n}static doOffsetsHaveEqualDistances(e,t){if(e.length<2)return!0;const n=e[1];for(let t=2;t<e.length;t++)if(e[t]-e[t-1]!==n)return!1;return t-e[e.length-1]===n}getDefaultHitMapAxis(e){const t=Math.floor(e/i.DefaultHitMapSectionsCount),n=[];for(let e=0;e<i.DefaultHitMapSectionsCount;e++)n.push(e*t);return 0===t&&d.ULS.sendTraceTag(522311873,d.LogCategory.msoulscat_ES_EWAJSGrid,d.TraceLevel.Info,"InteractableCanvasElement::getDefaultHitMapAxis: totalSize:"+e),{areOffsetsEqual:!0,equalOffsetsSize:t,offsets:n}}static getFirstOffsetSize(e,t){return e.length<2?t:e[1]}onPointerDown(e){if(!(0,s.shouldHitTestHandleEvent)())return!1;const t=this.getEventCoordinatesInCanvas(e.clientX,e.clientY);return this.lastPointerDownClickHitRegions=this.getIntersectingHitRegions("click",t),this.handleMouseLongPress(e,"pointerdown"),this.onBasicPointerEvent(e,"pointerdown",this.pointerDownEventHandler)}onPointerUp(e){return this.longPressState.callbackScheduled&&this.cancelLongPressTimer(e,"pointerup"),this.onBasicPointerEvent(e,"pointerup",this.pointerUpEventHandler)}onPointerLeave(e){return this.handleMouseLeaveEventTriggering(e,i.OutsideCanvasPoint),this.lastPointerPosition=i.OutsideCanvasPoint,this.canvas.style.cursor=i.UnsetCursorType,this.lastCursorType=i.UnsetCursorType,!0}onClick(e){return!(!(0,s.shouldHitTestHandleEvent)()||!this.isEventStartAndEndInSameRegion(e,"click",this.lastPointerDownClickHitRegions))&&this.onBasicPointerEvent(e,"click",this.clickEventHandler)}ondblclick(e){return!!(0,s.shouldHitTestHandleEvent)()&&this.onBasicPointerEvent(e,"dblclick",this.dblClickEventHandler)}onTouchStart(e){var t,n;if(!(0,s.shouldHitTestHandleEvent)())return!1;const o=this.getEventCoordinatesInCanvas(null===(t=e.touches)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.clientX,null===(n=e.touches)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.clientY);return this.lastPointerDownTouchEndHitRegions=this.getIntersectingHitRegions("touchend",o),this.onBasicPointerEvent(e,"touchstart",this.touchStartEventHandler)}onTouchEnd(e){return!(!(0,s.shouldHitTestHandleEvent)()||!this.isEventStartAndEndInSameRegion(e,"touchend",this.lastPointerDownTouchEndHitRegions))&&this.onBasicPointerEvent(e,"touchend",this.touchEndEventHandler)}onBasicPointerEvent(e,t,n){return(0,a.trackEventCallbackDuration)(()=>this.isEventHasRegisteredHandlers(t)?this.handleBasicPointerEvents(t,e):(this.removeUnnecessaryEventListeners(t,n),!0),t)}removeUnnecessaryEventListeners(e,t){this.isEventHasRegisteredHandlers("longpress")||(e!==i.PointerDownEvent||this.isEventHasRegisteredHandlers("click")?e===i.PointerUpEvent&&this.canvas.removeEventListener(e,t):this.canvas.removeEventListener(e,t))}onPointerMove(e){if((0,s.shouldHitTestHandleEvent)()){const t=()=>{const t=this.getEventCoordinatesInCanvas(e.clientX,e.clientY);this.handlePointerMove(e,t)};(0,a.trackEventCallbackDuration)(t,i.PointerMoveEvent)}}handleBasicPointerEvents(e,t){const n=(0,l.getEventCoordinates)(t,e),o=this.getEventCoordinatesInCanvas(n.clientX,n.clientY),r=this.getIntersectingHitRegions(e,o);return this.propagateEventToHandlers(t,r,e,()=>!0)}handlePointerMove(e,t){this.longPressState.longPressModeEnabled||(this.handleMouseLeaveEventTriggering(e,t),this.handleMouseEnterEventTriggering(e,t),this.handleCursorType(e,t),this.handleTooltipChange(t)),this.lastPointerPosition=t}handleMouseLeaveEventTriggering(e,t){if(this.lastPointerPosition===i.OutsideCanvasPoint)return;const n=this.getIntersectingHitRegions("mouseleave",this.lastPointerPosition);this.propagateEventToHandlers(e,n,"mouseleave",e=>t===i.OutsideCanvasPoint||!(0,r.isPointInRect)(e.region,t))}handleMouseEnterEventTriggering(e,t){if(t===i.OutsideCanvasPoint)return;const n=this.getIntersectingHitRegions("mouseenter",t);this.propagateEventToHandlers(e,n,"mouseenter",e=>this.lastPointerPosition===i.OutsideCanvasPoint||!(0,r.isPointInRect)(e.region,this.lastPointerPosition))}propagateEventToHandlers(e,t,n,o){let r=Number.MAX_SAFE_INTEGER;this.getIsRegionCollisionTelemetryEnabled()&&(0,c.logOverlappingRegions)(n,t);for(let i=0;i<t.length;i++){const l=t[i];if(l.zIndex>r)throw Error(`handleEventPropagationToHandlers: expected handlers to be sorted by z-index, highest first. latestZIndex=${r}, currentZIndex=${l.zIndex}, eventType: ${n}, totalHandlersCount=${t.length}`);if(o(l)){const t=l.callback(e);if("boolean"==typeof t){if(t)return e.stopPropagation(),e.preventDefault(),!1}else if(t.handled)return t.stopPropagation&&(e.stopPropagation(),e.preventDefault()),!1}r=l.zIndex}return!0}handleCursorType(e,t){let n=i.UnsetCursorType;if(t!==i.OutsideCanvasPoint){const o=this.getIntersectingHitRegions(i.CursorEventType,t);if(o&&o.length>0){this.getIsRegionCollisionTelemetryEnabled()&&(0,c.logOverlappingRegions)("cursor",o);const t=o.find(t=>t.shouldChangeCursor(e));t&&(n=t.cursorType)}}this.lastCursorType!==n&&(this.lastCursorType=n,this.canvas.style.cursor=n)}handleTooltipChange(e){let t=i.DefaultTooltip,n=void 0;if(e!==i.OutsideCanvasPoint){const o=this.getIntersectingHitRegions(i.TooltipEventType,e);if(o&&o.length>0){this.getIsRegionCollisionTelemetryEnabled()&&(0,c.logOverlappingRegions)("tooltip",o);const e=o[0],r=e.region;t=e.tooltipText,n=this.getHitMapAreaKeyFromOffset(r.x,r.y)}}const o=this.lastTooltipHitRegionKey!==n,r=this.lastTooltip!==t;if(r||o){if(this.lastTooltip=t,this.lastTooltipHitRegionKey=n,o&&!r)return this.canvas.setAttribute("title",i.DefaultTooltip),void setTimeout(()=>{this.canvas.setAttribute("title",t)},0);this.canvas.setAttribute("title",t)}}handleMouseLongPressStart(e){e&&e.onStart()}handleMouseLongPressEnd(e){e&&e.onEnd()}getLongPressHitRegion(e){if(e!==i.OutsideCanvasPoint){const t=this.getIntersectingHitRegions(i.LongPressEventType,e);if(t&&t.length>0)return t[0]}}cacheRegionAndRegisterEvents(e,t){this.registeredEventsHitRegions[t]||this.registerHandlersForEvent(t);const n=this.getEventHitAreaMap(t);this.addHitRegion(e,n)}registerHandlersForEvent(e){switch(e){case"pointerdown":this.canvas.addEventListener(e,this.pointerDownEventHandler);break;case"pointerup":this.canvas.addEventListener(e,this.pointerUpEventHandler);break;case"click":this.canvas.addEventListener(i.PointerDownEvent,this.pointerDownEventHandler),this.canvas.addEventListener(e,this.clickEventHandler);break;case"dblclick":this.canvas.addEventListener(e,this.dblClickEventHandler);break;case"touchstart":this.canvas.addEventListener(e,this.touchStartEventHandler);break;case"touchend":this.canvas.addEventListener(e,this.touchEndEventHandler);break;case"longpress":this.canvas.addEventListener(i.PointerDownEvent,this.pointerDownEventHandler),this.canvas.addEventListener(i.PointerUpEvent,this.pointerUpEventHandler);break;case"cursor":case"tooltip":case"mouseenter":case"mouseleave":this.isListeningToPointerMove||(this.canvas.addEventListener(i.PointerMoveEvent,this.pointerMoveEventHandler),this.canvas.addEventListener(i.PointerLeaveEvent,this.pointerLeaveEventHandler),this.isListeningToPointerMove=!0)}this.isRegisteredToEvents=!0}getEventHitAreaMap(e){return this.registeredEventsHitRegions[e]||(this.registeredEventsHitRegions[e]={}),this.registeredEventsHitRegions[e]}addHitRegion(e,t){const n=this.getIntersectingHitMapAreasKeys(e.region);for(let o=0;o<n.length;o++){const r=n[o];t[r]||(t[r]=[]),t[r].push(e)}this.isHitMapSorted=!1}setDefaultHitMapAxes(e,t){this.hitMapAxisX=this.getDefaultHitMapAxis(e),this.hitMapAxisY=this.getDefaultHitMapAxis(t)}getEventCoordinatesInCanvas(e,t){const n=(0,s.isStandardZoomCssSupportedByBrowser)()?e:e/this.zoom,o=(0,s.isStandardZoomCssSupportedByBrowser)()?t:t/this.zoom,r=this.canvas.getBoundingClientRect();return{x:(n-r.left)/((0,s.isStandardZoomCssSupportedByBrowser)()?this.zoom:1),y:(o-r.top)/((0,s.isStandardZoomCssSupportedByBrowser)()?this.zoom:1)}}getIntersectingHitRegions(e,t){const n=[];if(this.registeredEventsHitRegions[e]){const o=this.getHitMapAreaKeyFromOffset(t.x,t.y);this.optimizeHitMapLookup();const i=this.registeredEventsHitRegions[e][o];if(i&&i.length>0)for(let e=0;e<i.length;e++){const o=i[e];(0,r.isPointInRect)(o.region,t)&&n.push(o)}}return n}isEventHasRegisteredHandlers(e){return!!this.registeredEventsHitRegions&&!!this.registeredEventsHitRegions[e]}sortHitMap(){const e=Object.keys(this.registeredEventsHitRegions);for(let t=0;t<e.length;t++){const n=this.registeredEventsHitRegions[e[t]],o=Object.keys(n);for(let e=0;e<o.length;e++){const t=parseInt(o[e],10);n[t]=n[t].sort(l.hitRegionComparer)}}this.isHitMapSorted=!0}handleMouseLongPress(e,t){const n=1===e.button,o="touch"===e.pointerType;if(this.longPressState.callbackScheduled&&(!e.target||!n)||o)return;const r=(0,l.getEventCoordinates)(e,t),a=this.getEventCoordinatesInCanvas(r.clientX,r.clientY),s=this.getLongPressHitRegion(a);if(!s)return;const d=e.target,c=e.pointerId;d&&d.setPointerCapture&&-1!==c&&d.setPointerCapture(c),this.longPressState.callbackId=window.setTimeout(()=>{this.onLongPress()},i.MinLongPressDurationMs),this.longPressState.callbackScheduled=!0,this.longPressState.eventPointerId=c,this.longPressState.lastHitRegion=s}onLongPress(){this.canvas.style.cursor=i.UnsetCursorType,this.lastCursorType=i.UnsetCursorType,this.longPressState.longPressModeEnabled=!0,this.handleMouseLongPressStart(this.longPressState.lastHitRegion)}getIsRegionCollisionTelemetryEnabled(){var e;return void 0===this.isRegionCollisionTelemetryEnabled&&(this.isRegionCollisionTelemetryEnabled=(0,u.getBooleanFeatureGate)("Microsoft.Office.Excel.RegionCollisionTelemetry",void 0)),null!==(e=this.isRegionCollisionTelemetryEnabled)&&void 0!==e&&e}constructor(e,t){super(e,t),this.isHitMapSorted=!0,this.isRegisteredToEvents=!1,this.isListeningToPointerMove=!1,this.lastPointerPosition=i.OutsideCanvasPoint,this.lastPointerDownClickHitRegions=[],this.lastPointerDownTouchEndHitRegions=[],this.lastCursorType=i.UnsetCursorType,this.lastTooltip=i.DefaultTooltip,this.longPressState=(0,l.getDefaultLongPressState)(),this.zoom=1,this.arrayOverflowInvestigationLogged=!1,this.registeredEventsHitRegions={},this.setDefaultHitMapAxes(this.getWidth(),this.getHeight()),this.pointerDownEventHandler=this.onPointerDown.bind(this),this.pointerUpEventHandler=this.onPointerUp.bind(this),this.pointerMoveEventHandler=this.onPointerMove.bind(this),this.clickEventHandler=this.onClick.bind(this),this.dblClickEventHandler=this.ondblclick.bind(this),this.touchStartEventHandler=this.onTouchStart.bind(this),this.touchEndEventHandler=this.onTouchEnd.bind(this),this.pointerLeaveEventHandler=this.onPointerLeave.bind(this)}}t.InteractableCanvasElement=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trackEventCallbackDuration=void 0;const o=n(13),r=n(7),i=n(10);var l,a;!function(e){e[e.Inactive=0]="Inactive",e[e.Active=1]="Active",e[e.Cooldown=2]="Cooldown"}(l||(l={})),function(e){e[e.Inactive=0]="Inactive",e[e.Cooldown=1]="Cooldown"}(a||(a={}));let s=l.Inactive,d=a.Inactive,c={};function u(){const e=(0,i.getServiceSetting)(1,4e3);s=l.Cooldown,function(){if(d===a.Inactive){d=a.Cooldown;const e=(0,i.getServiceSetting)(2,6e4);setTimeout(()=>{!function(){const e=JSON.stringify(c);r.ULS.sendTraceTag(574648710,r.LogCategory.msoulscat_ES_EWAJSGrid,r.TraceLevel.Info,"HitTest::Telemetry::sendMeasurementResults: "+e),c={},d=a.Inactive}()},e)}}(),setTimeout(()=>{s=l.Inactive},e)}t.trackEventCallbackDuration=function(e,t){return function(){if(s===l.Inactive){const e=(0,i.getServiceSetting)(0,1e3);s=l.Active,setTimeout(u,e)}return s===l.Active}()?function(e,t){const n=o.perf?o.perf.now():-1,r=e();if(o.perf){const e=o.perf.now()-n;c[t]||(c[t]=[]),c[t].push(e.toFixed(4))}return r}(e,t):e()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logOverlappingRegions=void 0;const o=n(7),r=new Map;t.logOverlappingRegions=function(e,t){if(!t||t.length<=1)return;const n=JSON.stringify(t.map(e=>e.zIndex));r.has(e)||r.set(e,[]),r.get(e).includes(n)||(r.get(e).push(n),o.ULS.sendTraceTag(508403979,o.LogCategory.msoulscat_ES_EWAJSGrid,o.TraceLevel.Info,`logRegionCollision: source:${e}, regions:${n}`))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderBlockModelAccessor=void 0;const o=n(1),r=n(132),i=n(0),l=n(4),a=n(76),s=n(2),d=n(224),c=n(7),u=n(6),g=n(133),h=n(11);class C extends r.BlockModelAccessor{static verifyArgumentNotNull(e,t,n){(0,l.verifyArgumentNotNull)(e,t,"HeaderBlockModelAccessor."+n)}static throwErrorWrapper(e,t){(0,i.throwError)(e,"HeaderBlockModelAccessor."+t)}static isCellSnapped(e){return C.verifyArgumentNotNull(e,"cell","isCellSnapped"),(0,o.isChangeGateEnabled)(o.ChangeGate.FixHeaderSnappingAutoFilterNone)?!!e.IsCellSnapped:!!e.AutoFilter}setIsCellSnapped(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"setIsCellSnapped"),this.model.Cells[e].IsCellSnapped=t||void 0}isCellSnapped(e){this.verifyRelativeIndexOfRowColNumbers(e,"isCellSnapped");const t=this.model.Cells[e];return C.isCellSnapped(t)}getHeaderBlockModel(){return this.model}getIsHeaderSnapped(){return!!(0,o.getModelClientCache)(this.model).isHeaderSnapped}setIsHeaderSnapped(e){(0,o.getModelClientCache)(this.model).isHeaderSnapped=e}setStyleId(e,t){C.verifyArgumentNotNull(t,"styleId","setStyleId");const n=this.getCell(e);if(!n)throw Error("HeaderBlockModelAccessor.setStyleId: Cell not in model");if(this.headerSnappingDiffRenderFixEnabled&&(t=C.isCellSnapped(n)?this.getUpdatedCellAlignmentFromCenterToLeftRight(n,t):t),(n.StyleID||0)!==t){n.StyleID=t,!this.headerSnappingDiffRenderFixEnabled&&C.isCellSnapped(n)&&this.updateCellAlignmentFromCenterToLeftRight(n);try{this.updateGlobalCellStyleID(n)}catch(e){c.ULS.sendTraceTag(507130582,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Error,"HeaderBlockModelAccessor.setStyleId: "+e)}return!0}return!1}getStyleId(e){const t=this.getCell(e);if(!t)throw Error("HeaderBlockModelAccessor.setStyleId: Cell not in model");return t.StyleID||0}updateStylesForNamedSheetView(e){const t=(0,o.isIncreasedHeaderSizeEnabled)(this.model)?(0,o.getRowHeaderStylesArray)(o.ViewMode.NamedSheetView,this.model.IsRtl):o.RowHeadersNSVStylesArrayBeforeHeaderDragImprovements;this.model.Styles=e?t:o.ColumnHeadersNSVStylesArray,(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.NewDefaultTemplate,this.model)&&(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.NewThemeFontForHeaderFBarNBox,this.model)?this.model.Fonts=o.HeadersNSVFonts:this.model.Fonts=o.OldHeadersNSVFonts,this.processStyles(this.model)}updateStylesForDefaultViewMode(e){const t=(0,o.isIncreasedHeaderSizeEnabled)(this.model)?(0,o.getRowHeaderStylesArray)(o.ViewMode.Default,this.model.IsRtl):o.RowHeadersStylesArrayBeforeHeaderDragImprovements;this.model.Styles=e?t:o.ColumnHeadersStylesArray,(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.NewDefaultTemplate,this.model)&&(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.NewThemeFontForHeaderFBarNBox,this.model)?this.model.Fonts=o.HeadersFonts:this.model.Fonts=o.OldHeadersFonts,this.processStyles(this.model)}updateSpillInformation(e,t){const n=this.getOrCreateCanvasContext(),o=e*t;(0,s.isAdjustedForDrawingOffsetsInitialized)(this.model)||(0,s.initializeOffsetsForDrawing)(this.model,o);for(const o of this.model.Cells)(0,i.verifyCellStyleAndFont)(this.model,o,"updateSpillInformation"),o.Spill=void 0,(0,a.updateCellSpill)(n,this.model,o,e,t)}setCellExtent(e,t){const n=this.isRow?this.model.RowHeights:this.model.ColumnWidths;C.verifyArgumentNotNull(n,"blockExtents","setCellExtent");const r=this.isRow?this.model.RowOffsets:this.model.ColumnOffsets;C.verifyArgumentNotNull(r,"blockOffsets","setCellExtent"),(e>n.length-1||e<0)&&C.throwErrorWrapper("Cell not in model","setCellExtent"),t<=0&&C.throwErrorWrapper("Cell extent cannot be a non positive value","setCellExtent"),(0,d.setCellExtent)(this.model,e,t,!this.isRow),this.setDirty("setCellExtent",o.DirtyType.ModelCoreChanges)}getCellExtent(e){const t=this.isRow?this.model.RowHeights:this.model.ColumnWidths;return C.verifyArgumentNotNull(t,"blockExtents","getCellExtent"),(e>t.length-1||e<0)&&C.throwErrorWrapper("Cell not in model","getCellExtent"),t[e]}getAutoFilterMenuOffsetsFromCellStart(e,t,n){this.verifyRelativeIndexOfRowColNumbers(e,"getAutoFilterMenuOffsetsFromCellStart");const o=this.model.Cells[e];return this.getAutoFilterMenuOffsetsFromCellStartInternal(o,t,n)}getAutoFilterButtonTotalSize(e,t,n){this.verifyRelativeIndexOfRowColNumbers(e,"getAutoFilterButtonTotalSize");const o=this.model.Cells[e];return this.getAutoFilterButtonTotalSizeInternal(o,t,n)}addRowColToModel(e,t){(0,d.addRowColToModel)(this.model,this,e,t,this.isRow)}updateCellText(e,t){C.verifyArgumentNotNull(t,"text","updateCellText"),this.verifyRelativeIndexOfRowColNumbers(e,"updateCellText");const n=this.model.Cells[e];n.Text=t,n.Spill={SpanToStart:0,SpanToEnd:0,IsSpillBlocked:!0}}setUnsetShowResizePill(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"setUnsetShowResizePill"),this.model.Cells[e].ShowResizePill=t}setUnsetResizePillLocation(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"setUnsetResizePillLocation"),this.model.Cells[e].ResizePillLocation=null!=t?t:void 0}setUnsetHoveredCell(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"setUnsetHoveredCell"),this.model.Cells[e].IsHovered=t}setInsertButton(e,t,n,o){this.verifyRelativeIndexOfRowColNumbers(e,"setInsertButton"),(0,l.verifyArgumentNotNull)(n,"buttonType","setInsertButton");const r=this.model.Cells[e];(0,u.isNullOrUndefined)(r.InsertButtons)&&(r.InsertButtons={Start:void 0,End:void 0});const i={Type:n,Offset:o};let a=!1,s=0;return t?this.areInsertButtonsSame(r.InsertButtons.Start,i)||(s=Math.max((0,g.getInsertButtonSize)(i,!0),(0,g.getInsertButtonSize)(r.InsertButtons.Start,!0)),r.InsertButtons.Start=i,a=!0):this.areInsertButtonsSame(r.InsertButtons.End,i)||(s=Math.max((0,g.getInsertButtonSize)(r.InsertButtons.End,!1),(0,g.getInsertButtonSize)(i,!1)),r.InsertButtons.End=i,a=!0),a&&this.setCellsDirtyForInsertButtonSpillOnUpdate(e,t,s),a}removeInsertButton(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"removeInsertButton");const n=this.model.Cells[e];let o=!1,r=0;var i,l,a,s;return t?null!==(i=n.InsertButtons)&&void 0!==i&&i.Start&&(r=(0,g.getInsertButtonSize)(null===(l=n.InsertButtons)||void 0===l?void 0:l.Start,!0),n.InsertButtons.Start=void 0,o=!0):null!==(a=n.InsertButtons)&&void 0!==a&&a.End&&(r=(0,g.getInsertButtonSize)(null===(s=n.InsertButtons)||void 0===s?void 0:s.End,!1),n.InsertButtons.End=void 0,o=!0),o&&this.setCellsDirtyForInsertButtonSpillOnUpdate(e,t,r),o}updateCellAlignment(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"updateCellAlignment");const n=this.model.Cells[e];if(this.headerSnappingDiffRenderFixEnabled){const e=n.StyleID||0;n.StyleID=t?this.getUpdatedCellAlignmentFromCenterToLeftRight(n,e):this.getUpdatedCellAlignmentFromLeftRightToCenter(n,e)}else t?this.updateCellAlignmentFromCenterToLeftRight(n):this.updateCellAlignmentFromLeftRightToCenter(n);try{this.updateGlobalCellStyleID(n)}catch(e){c.ULS.sendTraceTag(507130581,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Error,"HeaderBlockModelAccessor.updateCellAlignment: "+e)}}activateCellAutoFilter(e,t){this.verifyAutoFilterArguments(e,t),this.model.Cells[e].AutoFilter=t}deactivateCellAutoFilter(e){this.verifyRelativeIndexOfRowColNumbers(e,"deactivateCellAutoFilter"),this.isRow&&C.throwErrorWrapper("AutoFilter in headerSnapping should be deactivated only for column header, but called for row header","deactivateCellAutoFilter"),this.model.Cells[e].AutoFilter=void 0}getCellAutoFilterCommandData(e){this.verifyRelativeIndexOfRowColNumbers(e,"getCellAutoFilterCommandData");const t=this.model.Cells[e].AutoFilter;return t||C.throwErrorWrapper("AutoFilter should be initialized by now but is undefined, cellRelativeIndex="+e,"getCellAutoFilterCommandData"),t.CommandData}removeRowColFromModel(e,t){(0,d.removeRowColFromModel)(this.model,this,e,t,this.isRow)}isLastRowColOfPreviousBlockHidden(){var e,t;return this.isRow?!(null===(e=this.model.AdjacentBlocksHiddensInfo)||void 0===e||!e.IsLastRowOfPrevBlockHidden):!(null===(t=this.model.AdjacentBlocksHiddensInfo)||void 0===t||!t.IsLastColOfPrevBlockHidden)}setCellDirty(e){const t=this.isRow?this.model.RowHeights:this.model.ColumnWidths;C.verifyArgumentNotNull(t,"blockExtents","setCellDirty"),(e>t.length-1||e<0)&&C.throwErrorWrapper(`Cell index ${e} not in model, length ${t.length}`,"setCellDirty");const n=this.ensureDirtyCellsKeysInitialized();this.addCellToDirtyCellKeys(e,n),this.setAdjacentCellsDirtyIfHidden(e,n),(0,o.isHeaderInsertEnabled)()&&this.setCellsDirtyForInsertButtonSpillsForCell(e,n),(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.DelayRenderToNextAnimationFrame,this.model)?this.setDirtyInternal(o.DirtyType.ModelCellChanges,!0):this.setDirtyInternal(o.DirtyType.ModelCellChanges)}setDataCleansingIcon(e,t){const n=this.getCell(e);if(!n)throw Error("HeaderBlockModelAccessor.setDataCleansingIcon: Cell not in model");n.DataCleansingIcon=t}getCell(e){return this.model.Cells[e]}updateCellAlignmentFromCenterToLeftRight(e){C.verifyArgumentNotNull(e,"cell","updateCellAlignmentLeftRight"),null!==e.StyleID&&void 0!==e.StyleID||(e.StyleID=o.UniqueHeadersStyleID.Default);const t=this.model.IsRtl;switch(e.StyleID){case o.UniqueHeadersStyleID.Default:e.StyleID=t?o.UniqueHeadersStyleID.RightAlignment:o.UniqueHeadersStyleID.LeftAlignment;break;case o.UniqueHeadersStyleID.Hover:e.StyleID=t?o.UniqueHeadersStyleID.HoverRightAlignment:o.UniqueHeadersStyleID.HoverLeftAlignment;break;case o.UniqueHeadersStyleID.PartialRowColSelection:e.StyleID=t?o.UniqueHeadersStyleID.PartialRowColSelectionRightAlignment:o.UniqueHeadersStyleID.PartialRowColSelectionLeftAlignment;break;case o.UniqueHeadersStyleID.PartialSelectionAndHover:e.StyleID=t?o.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment:o.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment;break;case o.UniqueHeadersStyleID.WholeSelectionAndHover:e.StyleID=t?o.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment:o.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment;break;case o.UniqueHeadersStyleID.WholeRowColSelection:e.StyleID=t?o.UniqueHeadersStyleID.WholeRowColSelectionRightAlignment:o.UniqueHeadersStyleID.WholeRowColSelectionLeftAlignment;break;default:c.ULS.sendTraceTag(509216715,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Info,`updateCellAlignmentLeftRight: cell's styleId is unexpected, styleId=${e.StyleID}, cell.col=${e.Col}`)}}updateCellAlignmentFromLeftRightToCenter(e){switch(C.verifyArgumentNotNull(e,"cell","updateCellAlignmentCenter"),null!==e.StyleID&&void 0!==e.StyleID||(e.StyleID=o.UniqueHeadersStyleID.LeftAlignment),e.StyleID){case o.UniqueHeadersStyleID.RightAlignment:case o.UniqueHeadersStyleID.LeftAlignment:e.StyleID=o.UniqueHeadersStyleID.Default;break;case o.UniqueHeadersStyleID.HoverRightAlignment:case o.UniqueHeadersStyleID.HoverLeftAlignment:e.StyleID=o.UniqueHeadersStyleID.Hover;break;case o.UniqueHeadersStyleID.PartialRowColSelectionRightAlignment:case o.UniqueHeadersStyleID.PartialRowColSelectionLeftAlignment:e.StyleID=o.UniqueHeadersStyleID.PartialRowColSelection;break;case o.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment:case o.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment:e.StyleID=o.UniqueHeadersStyleID.PartialSelectionAndHover;break;case o.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment:case o.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment:e.StyleID=o.UniqueHeadersStyleID.WholeSelectionAndHover;break;case o.UniqueHeadersStyleID.WholeRowColSelectionRightAlignment:case o.UniqueHeadersStyleID.WholeRowColSelectionLeftAlignment:e.StyleID=o.UniqueHeadersStyleID.WholeRowColSelection;break;default:c.ULS.sendTraceTag(509216714,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Info,`updateCellAlignmentCenter: cell's styleId is unexpected, styleId=${e.StyleID}, cell.col=${e.Col}`)}}getUpdatedCellAlignmentFromCenterToLeftRight(e,t){C.verifyArgumentNotNull(e,"cell","updateCellAlignmentLeftRight");const n=this.model.IsRtl;switch(t){case o.UniqueHeadersStyleID.Default:return n?o.UniqueHeadersStyleID.RightAlignment:o.UniqueHeadersStyleID.LeftAlignment;case o.UniqueHeadersStyleID.Hover:return n?o.UniqueHeadersStyleID.HoverRightAlignment:o.UniqueHeadersStyleID.HoverLeftAlignment;case o.UniqueHeadersStyleID.PartialRowColSelection:return n?o.UniqueHeadersStyleID.PartialRowColSelectionRightAlignment:o.UniqueHeadersStyleID.PartialRowColSelectionLeftAlignment;case o.UniqueHeadersStyleID.PartialSelectionAndHover:return n?o.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment:o.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment;case o.UniqueHeadersStyleID.WholeSelectionAndHover:return n?o.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment:o.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment;case o.UniqueHeadersStyleID.WholeRowColSelection:return n?o.UniqueHeadersStyleID.WholeRowColSelectionRightAlignment:o.UniqueHeadersStyleID.WholeRowColSelectionLeftAlignment;default:c.ULS.sendTraceTag(506849216,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Info,`updateCellAlignmentLeftRight: styleId is unexpected, styleId=${t}, cell.col=${e.Col}`)}return t}getUpdatedCellAlignmentFromLeftRightToCenter(e,t){switch(C.verifyArgumentNotNull(e,"cell","updateCellAlignmentCenter"),t){case o.UniqueHeadersStyleID.RightAlignment:case o.UniqueHeadersStyleID.LeftAlignment:return o.UniqueHeadersStyleID.Default;case o.UniqueHeadersStyleID.HoverRightAlignment:case o.UniqueHeadersStyleID.HoverLeftAlignment:return o.UniqueHeadersStyleID.Hover;case o.UniqueHeadersStyleID.PartialRowColSelectionRightAlignment:case o.UniqueHeadersStyleID.PartialRowColSelectionLeftAlignment:return o.UniqueHeadersStyleID.PartialRowColSelection;case o.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment:case o.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment:return o.UniqueHeadersStyleID.PartialSelectionAndHover;case o.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment:case o.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment:return o.UniqueHeadersStyleID.WholeSelectionAndHover;case o.UniqueHeadersStyleID.WholeRowColSelectionRightAlignment:case o.UniqueHeadersStyleID.WholeRowColSelectionLeftAlignment:return o.UniqueHeadersStyleID.WholeRowColSelection;default:c.ULS.sendTraceTag(506849187,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Info,`updateCellAlignmentCenter: styleId is unexpected, styleId=${t}, cell.col=${e.Col}`)}return t}verifyRelativeIndexOfRowColNumbers(e,t){const n=this.isRow?this.model.RowNumbers.length:this.model.ColumnNumbers.length;(e<0||e>=n)&&C.throwErrorWrapper(`Invalid header relative index, received index=${e}, but headerNumbers.length=${n}`,t)}verifyAutoFilterArguments(e,t){this.isRow&&C.throwErrorWrapper("AutoFilter in headerSnapping should be activated only for column header, but called for row header","activateCellAutoFilter"),C.verifyArgumentNotNull(t,"autoFilterData","activateCellAutoFilter"),this.verifyRelativeIndexOfRowColNumbers(e,"activateCellAutoFilter")}setAdjacentCellsDirtyIfHidden(e,t){const n=this.isRow?this.model.RowNumbers:this.model.ColumnNumbers;this.isPrevCellHidden(n,e)&&this.addCellToDirtyCellKeys(e-1,t),this.isNextCellHidden(n,e)&&this.addCellToDirtyCellKeys(e+1,t)}setCellsDirtyForInsertButtonSpillOnUpdate(e,t,n){const o=this.ensureDirtyCellsKeysInitialized();(0,g.setCellsDirtyForInsertButtonSpill)(this.model,this,e,t,n,e=>this.addCellToDirtyCellKeys(e,o))}setCellsDirtyForInsertButtonSpillsForCell(e,t){var n,o;const r=e=>this.addCellToDirtyCellKeys(e,t),i=this.model.Cells[e],l=(0,g.getInsertButtonSize)(null===(n=i.InsertButtons)||void 0===n?void 0:n.Start,!0),a=(0,g.getInsertButtonSize)(null===(o=i.InsertButtons)||void 0===o?void 0:o.End,!1);(0,g.setCellsDirtyForInsertButtonSpill)(this.model,this,e,!0,l,r),(0,g.setCellsDirtyForInsertButtonSpill)(this.model,this,e,!1,a,r)}processStyles(e){(0,l.verifyArgumentNotNull)(e,"model","processStyles"),(0,l.verifyArgumentNotNull)(e.Fonts,"model.Fonts","HeaderBlockModelAccessor:processStyles"),(0,l.verifyArgumentNotNull)(e.Styles,"model.Styles","HeaderBlockModelAccessor:processStyles");const t=e.Fonts,n=e.Styles;if((0,o.isGlobalFontsAndCellStylesFlightEnabled)(e)){try{this.processStylesWithGlobalFonts(n,t)}catch(e){(0,o.disableGlobalFonts)("HeaderBlockModelAccessor::ProcessStyle:: Fonts Processing failed with exception "+e)}try{this.processCellsWithGlobalCellStyles(e.Cells,e.Styles)}catch(e){(0,o.disableGlobalCellStyles)("HeaderBlockModelAccessor::ProcessStyle:: Cell Styles Processing failed with exception "+e)}}}processStylesWithGlobalFonts(e,t){(0,o.getGlobalFontsMap)().process(t);for(let n=0;n<e.length;n++){const r=e[n];if(r){const e=r.FontID||0,n=(0,o.getGlobalStyleId)(e,t);if(null==n)throw new Error(`HeaderBlockModelAccessor::preprocessStylesWithGlobalFonts: Local FontID ${e} not mapped to a Global Font ID`);r.GlobalFontID=n}}}processCellsWithGlobalCellStyles(e,t){(0,o.getGlobalCellStylesMap)().process(t);for(let t=0;t<e.length;t++){const n=e[t];try{this.updateGlobalCellStyleID(n)}catch(e){c.ULS.sendTraceTag(507130580,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Error,"HeaderBlockModelAccessor.processCellsWithGlobalCellStyles: "+e)}}}updateGlobalCellStyleID(e){if(!(0,o.isGlobalFontsAndCellStylesFlightEnabled)(this.model))return;const t=e.StyleID||0,n=(0,o.getGlobalStyleId)(t,this.model.Styles);if(null==n)throw new Error(`HeaderBlockModelAccessor::updateGlobalCellStyleID: Local Cell StyleID ${t} not mapped to a Global Style ID`);e.GlobalCellStyleID=n}addCellToDirtyCellKeys(e,t){const n=this.getHeaderRegularCellsIndex(),r=this.isRow?e:n,i=this.isRow?n:e;t.push((0,o.getCellLookupKey)(r,i))}getHeaderRegularCellsIndex(){return(0,s.doesHeaderModelContainOutlines)(this.model,this.isRow)?1:0}areInsertButtonsSame(e,t){return(null==e?void 0:e.Type)===(null==t?void 0:t.Type)&&(null==e?void 0:e.Offset)===(null==t?void 0:t.Offset)}isPrevCellHidden(e,t){return t>0&&e[t]>e[t-1]+1}isNextCellHidden(e,t){return t<e.length-1&&e[t+1]>e[t]+1}constructor(e,t){super(e),this.headerSnappingDiffRenderFixEnabled=!1,this.isRow=t,this.processStyles(e),(0,o.isChangeGateEnabled)(o.ChangeGate.RestrictStylesPreProcess)&&(e.AreStylesProcessed=!0),this.headerSnappingDiffRenderFixEnabled=(0,h.getBooleanFeatureGate)("Microsoft.Office.Excel.FixHeaderSnappingDiffRendering",!1)}}t.HeaderBlockModelAccessor=C},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeRowColFromModel=t.addRowColToModel=t.setCellExtent=void 0;const o=n(1),r=n(0);function i(e,t,n,o){const r=t?e.RowOutlinesInformation:e.ColumnOutlinesInformation;if(!r)return;const i=r.length;for(let e=0;e<i;e++){const t=r[e],i=t.Outlines.length;for(let e=0;e<i;e++){const r=t.Outlines[e],i=n===r.ButtonIndex&&!!r.IsButtonHidden;r.ButtonIndex>-1&&n<=r.ButtonIndex&&!i&&(o?r.ButtonIndex++:r.ButtonIndex--);const l=r.IsNonDefaultDirection?n<=r.StartIndex:n<r.StartIndex;r.StartIndex>-1&&l&&(o?r.StartIndex++:r.StartIndex--)}}}function l(e){return e?28:30}function a(e,t,n,i,l,a,s,d){const u=function(e,t,n){return n?t-e:t}(n,i,s),g=(0,o.createHeaderCell)(u,l,t,a,s);(0,r.addNewValueToArray)(e,i,g),c(e,i+1,s?2*n:n,t,d)}function s(e,t,n,o,i){(0,r.removeValueFromArray)(e,t),c(e,t,n,o,i)}function d(e,t,n){for(let o=t;o<e.length;o++)e[o]=e[o]+n}function c(e,t,n,o,r){for(let i=t;i<n;i++){const t=e[i],n=i===r;if(o){const o=n?-1:e[i-1].Row;t.Row=o+1}else{const o=n?-1:e[i-1].Col;t.Col=o+1}}}function u(e,t){const n=t?e.MaxRowOutlineLevelInSheet:e.MaxColOutlineLevelInSheet;return!!n&&n>0}t.setCellExtent=function(e,t,n,o){const r=o?e.ColumnWidths:e.RowHeights,i=n-r[t];0!==i&&(r[t]=n,d(o?e.ColumnOffsets:e.RowOffsets,t+1,i),o?e.BlockWidth+=i:e.BlockHeight+=i)},t.addRowColToModel=function(e,t,n,s,c){const g=c?e.RowNumbers:e.ColumnNumbers;if(g.indexOf(n)>=0)throw Error(`addRowColToModel: Invalid absolute index. ${c?"Row":"Column"} ${n} already exists in model`);if(s<0||s>g.length)throw Error("addRowColToModel: Invalid relative index.");!function(e,t,n,o){const r=(o?e.RowNumbers.length:e.ColumnNumbers.length)+1,i=u(e,o);if(a(e.Cells,o,r,n,t,i,!1,0),i){const s=n+r,d=l(o);a(e.Cells,o,r,s,t,i,!0,d)}}(e,n,s,c),(0,r.addNewValueToArray)(g,s,n),(0,r.addNewValueToArray)(c?e.RowHeights:e.ColumnWidths,s,o.MinimalCellExtent),function(e,t){const n=e[t];(0,r.addNewValueToArray)(e,t,n),d(e,t+1,o.MinimalCellExtent)}(c?e.RowOffsets:e.ColumnOffsets,s),c?e.BlockHeight+=o.MinimalCellExtent:e.BlockWidth+=o.MinimalCellExtent,t.resetCellLookup(),i(e,c,s,!0)},t.removeRowColFromModel=function(e,t,n,o,a){const c=a?e.RowNumbers:e.ColumnNumbers;if(c.indexOf(n)<0)throw Error(`removeRowColFromModel: Invalid absolute index. ${a?"Row":"Column"} ${n} doesn't exists in model`);if(o<0||o>=c.length)throw Error("removeRowColFromModel: Invalid relative index.");const g=a?e.RowHeights[o]:e.ColumnWidths[o];!function(e,t,n){const o=(n?e.RowNumbers.length:e.ColumnNumbers.length)-1;if(s(e.Cells,t,o,n,0),u(e,n)){const r=t+o,i=l(n);s(e.Cells,r,2*o,n,i)}}(e,o,a),(0,r.removeValueFromArray)(c,o),(0,r.removeValueFromArray)(a?e.RowHeights:e.ColumnWidths,o),function(e,t){const n=t===e.length-1?0:e[t+1]-e[t];(0,r.removeValueFromArray)(e,t),d(e,t,-n)}(a?e.RowOffsets:e.ColumnOffsets,o),a?e.BlockHeight-=g:e.BlockWidth-=g,t.resetCellLookup(),i(e,a,o,!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderCanvasRenderer=void 0;const o=n(1),r=n(55),i=n(226),l=n(13),a=n(112),s=n(227),d=n(122),c=n(0),u=n(98),g=n(129),h=n(2),C=n(228),f=n(229),m=n(111),p=n(127),y=n(96),S=n(230),R=n(11),F=n(231),T=n(232),w=n(233);class I extends g.CanvasRenderer{renderInternal(e,t,n){try{var u;(0,c.validateRenderingRegion)(n.renderingRegion,t,n);const g=(0,c.isHighContrastMode)(n);let I;g&&(I=n.highContrastScheme,(0,c.extendHighContrastScheme)(n,I));const b=n.scaleFactor,v=Math.round(t.BlockWidth*b),x=n.renderingRegion,D=-1*x.startOffsetY*b,A=(0,c.getDrawingOffsetXForRenderingRegion)(t,x)*b,P=(0,o.isDifferentialRenderingSupported)(t),M=(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.HeaderDragImprovements,t),B=(0,o.isIncreasedHeaderSizeEnabled)(t);P&&(this.setTransform(1,!1,A,D,v),(0,p.maskDifferentialRenderingAreas)(t,this.ctx)),this.setTransform(1,!1,0,0,v),this.clearHeaderCanvas(e.getWidth(),e.getHeight(),n);const H=(0,h.clipForOutlinesIfNecessary)(this.ctx,t,n);return this.setTransform(1,!1,A,D,v),(0,l.trackDuration)(l.RenderPerformanceMetric.DrawBackgroundFillMs,()=>(0,d.drawHeaderCellsBackgroundFill)(this.ctx,t,n)),t.ShowHeaders&&(this.setTransform(1,t.IsRtl,A,D,v),(0,l.trackDuration)(l.RenderPerformanceMetric.DrawGridlinesDurationMs,()=>(0,r.drawHeadersGridLines)(this.ctx,t,n,B))),B&&t.ShowHeaders&&(this.setTransform(1,t.IsRtl,A,D,v),(0,l.trackDuration)(l.RenderPerformanceMetric.ClearColumnHeaderGutterAreaDurationMs,()=>(0,F.clearColumnHeaderGutterArea)(this.ctx,t,n,b,g,I))),M&&t.ShowHeaders&&(this.setTransform(1,t.IsRtl,A,D,v),(0,l.trackDuration)(l.RenderPerformanceMetric.DrawRowColDragAndDropSixSquaresDurationMs,()=>(0,S.drawRowColDragAndDropSixSquares)(this.ctx,t,n))),t.ShowHeaders&&(this.setTransform(n.scaleFactor,!1,A,D,v),(0,l.trackDuration)(l.RenderPerformanceMetric.DrawTextDurationMs,()=>(0,a.drawText)(this.ctx,t,n))),(0,R.getBooleanFeatureGate)("Microsoft.Office.Excel.DataCleansingColumnHeaders",!1)&&t.ShowHeaders&&(this.setTransform(1,!1,A+2,D,v),(0,l.trackDuration)(l.RenderPerformanceMetric.DrawDataCleansingHeaderIcon,()=>(0,w.drawDataCleansingHeaderIcon)(this.ctx,t,n))),t.ShowHeaders&&(this.setTransform(1,t.IsRtl,A,D,v),(0,l.trackDuration)(l.RenderPerformanceMetric.DrawHiddenRowColDurationMs,()=>(0,C.drawHiddenRowCol)(this.ctx,t,n,this.isUnhideRowColumnUXImprovementsSlice1Enabled(),B))),(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.RenderResizePill,t)&&t.ShowHeaders&&(this.setTransform(1,t.IsRtl,A,D,v),(0,l.trackDuration)(l.RenderPerformanceMetric.DrawResizePillDurationMs,()=>(0,i.drawResizePill)(this.ctx,t,n,B))),(0,o.isHeaderInsertEnabled)()&&t.ShowHeaders&&(this.setTransform(1,t.IsRtl,A,D,v),(0,l.trackDuration)(l.RenderPerformanceMetric.DrawInsertDotAndInsertButton,()=>(0,T.drawInsertDotAndInsertButton)(this.ctx,t,n))),null!==(u=t.ClientOnlyCache)&&void 0!==u&&u.isHeaderSnapped&&(this.setTransform(1,!1,A,D,v),(0,l.trackDuration)(l.RenderPerformanceMetric.DrawAutoFiltersForHeaderSnappingMs,()=>(0,y.drawAutoFilters)(this.ctx,t,n))),H&&(0,h.restoreClipping)(this.ctx,H),this.setTransform(1,!1,A,D,v),(0,l.trackDuration)(l.RenderPerformanceMetric.DrawOutlines,()=>(0,s.drawOutlines)(this.ctx,t,n)),this.shouldInitializeCanvasHitTest(t,n.skeletonMode)&&(this.setTransform(1,!1,A,D,v),(0,l.trackDuration)(l.RenderPerformanceMetric.RegisterHeaderHitRegionsToModelMs,()=>(0,f.registerHeaderHitRegionsToModelCache)(t,n))),P&&this.ctx.restore(),n.debugMode&&(this.setTransform(b,!1,0,0,0),n.isCanvasHitTestDebugHighlight&&(0,m.highlightHitRegions)(t,this.ctx,n.renderingRegion)),(0,l.createRenderResult)(!0,"finished rendering.")}catch(e){return(0,l.createRenderResult)(!1,`exception caught in renderInternal: message: ${e.message} name: ${e.name} stack: ${e.stack} error: ${e}`)}}preprocessModel(e,t,n,o){(0,u.initializeCachedObjects)(e,t,this.shouldInitializeCanvasHitTest(e,o)),(0,h.initializeOffsetsForDrawing)(e,n.scaleFactor)}shouldInitializeCanvasHitTest(e,t){return!(0,o.isDifferentialRenderingSupported)(e)}clearHeaderCanvas(e,t,n){(0,l.trackDuration)(l.RenderPerformanceMetric.FillRectDurationMs,()=>{this.ctx.fillStyle=this.getCanvasBackgroundColor(n),this.ctx.fillRect(0,0,e,t)})}getCanvasBackgroundColor(e){return(0,c.isHighContrastMode)(e)?(0,c.rgbToColorHex)(e.highContrastScheme.BackgroundColor):e.viewMode===o.ViewMode.NamedSheetView?o.NSVHeaderBackgroundColor:o.DefaultHeaderBackgroundColor}isUnhideRowColumnUXImprovementsSlice1Enabled(){return void 0===this.unhideRowColumnUXImprovementsSlice1&&(this.unhideRowColumnUXImprovementsSlice1=(0,R.getBooleanFeatureGate)("Microsoft.Office.Excel.UnhideRowColumnUXImprovementsSlice1",!1)),this.unhideRowColumnUXImprovementsSlice1}constructor(){super(...arguments),this.unhideRowColumnUXImprovementsSlice1=void 0}}t.HeaderCanvasRenderer=I},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawResizePill=void 0;const o=n(1),r=n(134),i=n(4),l=n(5),a=n(38),s=n(0),d=n(3),c=n(78),u=n(6);function g(e,t,n,o,i,l,a,s,d){var c,u;e.strokeStyle=n,e.fillStyle=o,e.lineWidth=t,e.beginPath(),d?null===(c=e.roundRect)||void 0===c||c.call(e,i,l,a-t,s-t,[r.ResizePillBorderRadius]):null===(u=e.roundRect)||void 0===u||u.call(e,i+e.lineWidth,l+e.lineWidth,a-e.lineWidth,s-e.lineWidth,[r.ResizePillBorderRadius]),e.fill(),e.stroke()}function h(e){return e?(0,s.rgbToColorHex)(e.TextColor):c.HeaderDrawingsGreenColor}function C(e){return e?(0,s.rgbToColorHex)(e.BackgroundColor):c.HeaderDrawingsWhiteColor}function f(e,t,n,i){return{x:(0,l.getCellRightAdjustedForDrawing)(e,t,e.IsRtl)-r.DefaultRowResizePillWidthPx*n-r.DefaultSpaceFromRowHeaderRightBorderPx*n,y:(i&&t.ResizePillLocation===o.LocationInCell.CellStart?(0,l.getCellTopAdjustedForDrawing)(e,t,!1):(0,l.getCellBottomAdjustedForDrawing)(e,t))-r.DefaultRowResizePillHeightPx*n/2}}function m(e,t,n,i,s,c){const u=(c&&t.ResizePillLocation===o.LocationInCell.CellStart?(0,l.getCellLeftAdjustedForDrawing)(e,t,e.IsRtl,!1):(0,l.getCellRightAdjustedForDrawing)(e,t,e.IsRtl)+(i?d.GridLineWidthPx:0))-r.DefaultColResizePillWidthPx*n/2,g=(0,l.getCellTopAdjustedForDrawing)(e,t,!1),h=(0,a.getColumnHeaderGutterOffsetForDrawing)(n,s);return{x:u,y:g+h+((0,l.getCellHeightAdjustedForDrawing)(e,t)-h-r.DefaultColResizePillHeightPx*n)/2}}t.drawResizePill=function(e,t,n,l){(0,i.verifyArgumentNotNull)(e,"ctx","drawResizePill"),(0,i.verifyArgumentNotNull)(t,"model","drawResizePill"),(0,i.verifyArgumentNotNull)(n,"context","drawResizePill");const a=t.ClientOnlyCache.CellsToRender;let s=!1;const d=(0,o.isRenderResizePillAcrossBlockEnabled)();for(const i of a)if(d?!(0,u.isNullOrUndefined)(i.ResizePillLocation):i.ShowResizePill){if(s)throw Error("drawResizePill: Resize pill already drawn on another cell");s=!0;const a=(0,o.isChangeGateEnabled)(o.ChangeGate.ResizePillHighContrastFix),u=(0,o.isChangeGateEnabled)(o.ChangeGate.ResizePillAlignmentFix),p=n.highContrastScheme,y=n.scaleFactor,S=a?h(p):c.HeaderDrawingsGreenColor,R=a?C(p):c.HeaderDrawingsWhiteColor;if(t.IsRow){const n=f(t,i,y,d),o=r.DefaultRowResizePillWidthPx*y,l=r.DefaultRowResizePillHeightPx*y;g(e,y,S,R,n.x,n.y,o,l,u)}else{const n=m(t,i,y,u,l,d),o=r.DefaultColResizePillWidthPx*y,a=r.DefaultColResizePillHeightPx*y;g(e,y,S,R,n.x,n.y,o,a,u)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawOutlines=void 0;const o=n(1),r=n(5),i=n(95),l=n(2),a=n(135),s=n(3),d=n(0);function c(e,t,n,o,r){const i={TopPx:r?n.EndPoint.TopPx:o,LeftPx:r?o:n.EndPoint.LeftPx,Cell:t};n.Button={EdgeInformation:i,IsExpand:n.IsExpanded},e.push(n.Button)}function u(e,t,n,o,i,l){const a=!!t.IsNonDefaultDirection;!function(e,t,n,o,r){const i=-1===t.StartIndex,l=r&&i,a=function(e,t,n,o){return e.IsRow?o?e.BlockHeight*t:0:n}(e,o,n,l),s=function(e,t,n,o){return e.IsRow?n:o?e.IsRtl?0:e.BlockWidth*t:e.IsRtl?e.BlockWidth*t:0}(e,o,n,l);t.StartPoint={TopPx:a,LeftPx:s}}(e,t,i,l,a),function(e,t,n,o,i,l){const a=!!t.IsButtonHidden;if(e.IsRow){const d=function(e,t,n,o,i,l){let a=s.pixelTranslation;return t?i?a=l?(0,r.getCellBottomAdjustedForDrawing)(e,n)-s.pixelTranslation:(0,r.getCellTopAdjustedForDrawing)(e,n,!1)+s.pixelTranslation:(a+=(0,r.getCellCenterYAdjustedForDrawing)(e,n),a-=p(o)):a+=l?0:e.BlockHeight*o,Math.floor(a)}(e,o,n,i,a,l);t.EndPoint={TopPx:d,LeftPx:t.StartPoint.LeftPx}}else{const s=function(e,t,n,o,i,l){let a=0;const s=e.IsRtl,d=s&&l,c=!s&&l;return t?i?a+=s&&!l||c?(0,r.getCellRightAdjustedForDrawing)(e,n,!1):(0,r.getCellLeftAdjustedForDrawing)(e,n,!1,!1):(a=(0,r.getCellCenterXAdjustedForDrawing)(e,n,!1),a-=p(o)):a=c?0:!s||d?e.BlockWidth*o:0,Math.floor(a)}(e,o,n,i,a,l);t.EndPoint={TopPx:t.StartPoint.TopPx,LeftPx:s}}}(e,t,n,o,l,a)}function g(e,t,n,o){const i=n.StartIndex;i>-1&&(function(e,t,n,o){const i=y(e,n),l=!!t.IsNonDefaultDirection;if(e.IsRow){const n=function(e,t,n){return n?(0,r.getCellBottomAdjustedForDrawing)(e,t):(0,r.getCellTopAdjustedForDrawing)(e,t,!1)}(e,i,l);t.StartPoint.TopPx=n>0?n-s.pixelTranslation:0}else t.StartPoint.LeftPx=function(e,t,n,o){return e.IsRtl?function(e,t,n,o){return n?h(e,t):C(e,t,o)}(e,t,n,o):function(e,t,n,o){return n?C(e,t,o):h(e,t)}(e,t,n,o)}(e,i,l,o)}(e,n,i,o),function(e,t,n,o){const r=Math.round(a.OutlinesStartSizePx*o),i=e.IsRow,d=t.StartPoint,c=function(e,t,n,o){const r=o?e-t-s.pixelTranslation:e+t+s.pixelTranslation;return n?r:e}(d.LeftPx,r,i,e.IsRtl),u=i?d.TopPx:d.TopPx+r,g=d.LeftPx,h=d.TopPx;(0,l.drawLine)(n,c,u,g,h)}(e,n,t,o))}function h(e,t){const n=(0,r.getCellLeftAdjustedForDrawing)(e,t,!1,!1);return n>0?n-s.pixelTranslation:s.pixelTranslation}function C(e,t,n){const o=(0,r.getCellRightAdjustedForDrawing)(e,t,!1),i=e.BlockWidth*n;return o<i?o+s.pixelTranslation:i-s.pixelTranslation}function f(e,t,n,o){const r=Math.round((a.OutlinesPaddingPx+e*a.OutlinesLevelHeightWidthPx)*t);return n?Math.floor(o*t)-r:r}function m(e,t,n){const o=t?0:s.GridLineWidthPx;return e-p(n)+o}function p(e){return(0,i.getAdjustedButtonSize)(e,a.ExpandCollapseButtonSizePx)/2}function y(e,t){return e.IsRow?(0,o.getCell)(t,0,e):(0,o.getCell)(0,t,e)}function S(e,t,n,o,r,i,a){i&&!t.IsButtonHidden&&c(o,a,t,r,e.IsRow),(0,l.drawLine)(n,t.StartPoint.LeftPx,t.StartPoint.TopPx,t.EndPoint.LeftPx,t.EndPoint.TopPx)}t.drawOutlines=function(e,t,n){const r=t.IsRow?t.RowOutlinesInformation:t.ColumnOutlinesInformation;if(!r||0===r.length)return;const l=[];!function(e,t){const n=t.highContrastScheme;n?e.strokeStyle=(0,d.rgbToColorHex)(n.LinkColor):t.viewMode===o.ViewMode.NamedSheetView?e.strokeStyle=o.NSVOutlinesColor:e.strokeStyle=o.OutlinesColor}(e,n),e.beginPath();const h=t.IsRow,C=h&&t.IsRtl,p=n.scaleFactor;for(let n=0;n<r.length;++n){const o=r[n].Outlines,i=f(n,p,C,t.BlockWidth),a=i+s.pixelTranslation,d=m(i,h,p),R=o.length;for(let n=0;n<R;++n){const r=o[n],i=r.ButtonIndex,s=i>-1,C=s?y(t,i):void 0;u(t,r,C,s,a,p),r.IsExpanded||!s?(g(t,e,r,p),S(t,r,e,l,d,s,C),e.stroke()):c(l,C,r,d,h)}}!function(e,t,n,r){const l=n.highContrastScheme,s=function(e,t){return e?(0,d.rgbToColorHex)(e.LinkColor):t===o.ViewMode.NamedSheetView?o.NSVOutlinesColor:o.OutlinesColor}(l,n.viewMode),c=function(e,t){return e?(0,d.rgbToColorHex)(e.BackgroundColor):t===o.ViewMode.NamedSheetView?o.NSVHeaderBackgroundColor:o.DefaultHeaderBackgroundColor}(l,n.viewMode);for(let o=0;o<t.length;++o){const l=t[o],d=(0,i.getAdjustedButtonSize)(n.scaleFactor,a.ExpandCollapseButtonSizePx),u={outerColor:s,innerColor:c,left:l.EdgeInformation.LeftPx,bottom:l.EdgeInformation.TopPx+d,height:d,width:d};(0,i.drawExpandCollapseButton)(r,e,l.EdgeInformation.Cell,u,l.IsExpand,!1)}}(t,l,n,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.areHiddenRowColsExistInAdjacentBlocks=t.drawHiddenRowCol=void 0;const o=n(1),r=n(3),i=n(0),l=n(4),a=n(6),s=n(2),d=n(38),c=n(1);function u(e,t){let n=!1,o=!1;return e.AdjacentBlocksHiddensInfo?(t?(n=!!e.AdjacentBlocksHiddensInfo.IsLastRowOfPrevBlockHidden,o=!!e.AdjacentBlocksHiddensInfo.IsFirstRowOfNextBlockHidden):(n=!!e.AdjacentBlocksHiddensInfo.IsLastColOfPrevBlockHidden,o=!!e.AdjacentBlocksHiddensInfo.IsFirstColOfNextBlockHidden),{isLastRowColOfPrevBlockHidden:n,isFirstRowColOfNextBlockHidden:o}):{isLastRowColOfPrevBlockHidden:!1,isFirstRowColOfNextBlockHidden:!1}}function g(e,t){return t&&(0,c.isChangeGateEnabled)(c.ChangeGate.HiddenIndicatorZoomFixEnabled)?o.DefaultHiddenRowColInnerGapPx+2*p(e):o.DefaultHiddenRowColInnerGapPx+r.GridLineWidthPx}function h(e,t){return t?e+r.GridLineWidthPx:e-r.GridLineWidthPx}function C(e,t,n,o,r,i,l,a,s,c,u,g,h,C,p,y){const{hiddenFrameStartPositionsPx:S,hiddenFramePartiallySelectedStartPositionsPx:R,hiddenFrameWhollySelectedStartPositionsPx:F}=function(e,t,n,o,r,i){const l=[],a=[],s=[],{startIndex:c,endIndex:u}=function(e,t,n){return{startIndex:e>0?e-1:0,endIndex:t<n?t+1:n}}(o,r,t.length-1);let g=t[c],h=(0,d.isCellPartiallySelected)(n[c]),C=!!i&&(0,d.isCellWhollySelected)(n[c]);for(let o=c+1;o<=u;o++){const r=t[o],c=(0,d.isCellPartiallySelected)(n[o]),u=!!i&&(0,d.isCellWhollySelected)(n[o]);r>g+1&&m(e[o],h&&c?a:C&&u?s:l),h=c,C=u,g=r}return{hiddenFrameStartPositionsPx:l,hiddenFramePartiallySelectedStartPositionsPx:a,hiddenFrameWhollySelectedStartPositionsPx:s}}(r,i,o,u,g,y);!function(e,t,n,o,r,i,l,a){let s=n;if(e){const e=i[0];(0,d.isCellPartiallySelected)(e)&&(s=o),a&&(0,d.isCellWhollySelected)(e)&&(s=r),m(l[0],s)}if(t){const e=i[i.length-1];s=n,(0,d.isCellPartiallySelected)(e)&&(s=o),a&&(0,d.isCellWhollySelected)(e)&&(s=r),m(l[l.length-1],s)}}(h,C,S,R,F,o,r,y),f(S,e,t,n,l,a,s,c,!1,!1,p,y),y&&F.length>0&&f(F,e,t,n,l,a,s,c,!1,!0,p,y),f(R,e,t,n,l,a,s,c,!0,!1,p,y)}function f(e,t,n,l,s,d,u,g,h,C,f,m){if(e.length>0){const{frameOutlinesColor:y,fillColor:S}=function(e,t,n,l){return(0,a.isNullOrUndefined)(e.highContrastScheme)?e.viewMode===o.ViewMode.NamedSheetView?l?{frameOutlinesColor:t||n?r.NSVHiddenRowColumnIndicatorWithSelectionLineColor:r.NSVHiddenRowColumnIndicatorLineColor,fillColor:o.NSVHeaderBackgroundColor}:t?{frameOutlinesColor:r.NSVSelectedCellsGridLineColor,fillColor:o.NSVHeaderBackgroundColor}:{frameOutlinesColor:r.NSVDefaultGridLineColor,fillColor:o.NSVHeaderBackgroundColor}:l?t?{frameOutlinesColor:r.PartialRowColSelectionHiddenRowColumnIndicatorLineColor,fillColor:o.PartialRowColSelectionBackgroundColor}:n?{frameOutlinesColor:r.WholeRowColSelectionHiddenRowColumnIndicatorLineColor,fillColor:o.WholeRowColSelectionBackgroundColor}:{frameOutlinesColor:r.HiddenRowColumnIndicatorLineColor,fillColor:r.HiddenRowColumnIndicatorGapColor}:t?{frameOutlinesColor:r.SelectedCellsGridLineColor,fillColor:o.PartialRowColSelectionBackgroundColor}:{frameOutlinesColor:r.DefaultGridLineColor,fillColor:o.DefaultHeaderBackgroundColor}:{frameOutlinesColor:""+(0,i.rgbToColorHex)(e.highContrastScheme.TextColor),fillColor:""+(0,i.rgbToColorHex)(e.highContrastScheme.BackgroundColor)}}(n,h,C,m);!function(e,t,n,o,l,a,s,d,u){if(u&&(0,c.isChangeGateEnabled)(c.ChangeGate.HiddenIndicatorZoomFixEnabled)){t.fillStyle=s;for(const r of l){const i=r-p(e);t.fillRect(a?d:i,a?i:d,n,o)}}else{t.lineWidth=r.GridLineWidthPx,t.strokeStyle=s,t.beginPath();for(const e of l){const l=e-(0,i.getLinePixelTranslation)(r.GridLineWidthPx);t.rect(a?d:l,a?l:d,n,o)}t.stroke()}}(n,t,s,d,e,l,y,f,m),function(e,t,n,o,r,i,l){e.fillStyle=i;for(const i of o)e.fillRect(r?l:i,r?i:l,t,n)}(t,u,g,e,l,S,m&&!(0,c.isChangeGateEnabled)(c.ChangeGate.HiddenIndicatorZoomFixEnabled)?f-r.GridLineWidthPx:f)}}function m(e,t){const n=e-Math.ceil(o.DefaultHiddenRowColInnerGapPx/2);t.push(n)}function p(e){return r.GridLineWidthPx*Math.max(Math.round(e.scaleFactor),1)}t.drawHiddenRowCol=function(e,t,n,i,a){if(function(e){(0,l.verifyArgumentNotNull)(e.ColumnNumbers,"model.ColumnNumbers","drawHiddenRowCol"),(0,l.verifyArgumentNotNull)(e.RowNumbers,"model.RowNumbers","drawHiddenRowCol")}(t),n.scaleFactor<r.MinimalScaleFactorForGridlinesRendering)return;const f=t.IsRow,{isLastRowColOfPrevBlockHidden:m,isFirstRowColOfNextBlockHidden:p}=u(t,f),y=(0,s.doesHeaderModelContainOutlines)(t,f),S=t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,R=t.ClientOnlyCache.RowOffsetsAdjustedForDrawing;if(f){const r=y?1:0,l=(0,s.getColWidthFromOffsets)(r,S),a=y?S[1]:0;C(e,n,!0,t.Cells,R,t.RowNumbers,i&&(0,c.isChangeGateEnabled)(c.ChangeGate.HiddenIndicatorZoomFixEnabled)?h(l,!0):l,g(n,i),h(l,i),o.DefaultHiddenRowColInnerGapPx,n.renderingRegion.startRow,n.renderingRegion.endRow,m,p,a,i)}else{const l=(0,d.getColumnHeaderGutterOffsetForDrawing)(n.scaleFactor,a),u=y?1:0,f=(0,s.getRowHeightFromOffsets)(u,R)-l,F=y?R[1]:0,T=i&&(0,c.isChangeGateEnabled)(c.ChangeGate.HiddenIndicatorZoomFixEnabled)?F+l-r.GridLineWidthPx:F+l;C(e,n,!1,t.Cells,S,t.ColumnNumbers,g(n,i),i&&(0,c.isChangeGateEnabled)(c.ChangeGate.HiddenIndicatorZoomFixEnabled)?h(f,!0):f,o.DefaultHiddenRowColInnerGapPx,h(f,i),n.renderingRegion.startColumn,n.renderingRegion.endColumn,m,p,T,i)}},t.areHiddenRowColsExistInAdjacentBlocks=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerHeaderHitRegionsToModelCache=void 0;const o=n(1),r=n(23),i=n(0),l=n(20),a=n(5),s=n(21),d=n(78),c=n(97),u=n(3),g=n(38),h=n(10),C=n(2),f=n(95),m=n(135),p=n(7),y=n(136),S=n(11),R=n(134),F=n(133),T=n(99);let w=void 0,I=void 0,b=void 0;function v(e,t){const n=[];for(let o=0;o<t.length;o++){const r=t[o],i=(0,a.getAdjustedCellArea)(e,r,!1);n.push(i)}return n}function x(e,t,n,i,a){const d=(0,s.getUnadjustedHitRegionFromRect)(e,t,i,e.IsRtl);(0,l.registerCursorHitRegion)(n,a,d,r.GrabCursorType,o.RenderFeaturesZIndex.HeaderDragDropSquares,E);const c=function(e,t){const n=e.IsRow,o=n?t.Row:t.Col,r=(0,g.getCellAbsoluteIndex)(e,o,n);return e=>{if(G(e)&&(0,h.isHeaderDragAllowed)()){const t=e;return(0,h.onHeaderDragStartCallback)(n,r,t),!0}return!1}}(e,n);(0,l.registerHitRegion)(n,a,d,o.RenderFeaturesZIndex.HeaderDragDropSquares,c,r.PointerDownEvent)}function D(e,t,n,r,i,l,a){const s=l&&(0,o.isChangeGateEnabled)(o.ChangeGate.ModernHeaderResizeHitRegion),c=function(e,t,n,o){return e?n?t?e.height>=R.MinRowHeightToAllocateMaxResizeArea*o?R.MaxCellPixelsAllocatedToRowResizeZone*o:e.height>=R.MinRowHeightToAccomadateResizePillAndMinSelectionArea*o?(e.height-R.MinCellPixelsAllocatedForCellSelection*o)/2:e.height>=R.MinRowHeightToAccomadateResizePillAnd1pxSelectionArea*o?R.DefaultRowResizePillHeightPx*o/2:e.height*R.CellPercentageAllocatedToResize:e.width>=R.MinColWidthToAllocateMaxResizeArea*o?R.MaxCellPixelsAllocatedToColumnResizeZone*o:e.width>=R.MinColWidthToAccomadateResizePillAndMinSelectionArea*o?(e.width-R.MinCellPixelsAllocatedForCellSelection*o)/2:e.width>=R.MinColWidthToAccomadateResizePillAnd1pxSelectionArea*o?R.DefaultColResizePillWidthPx*o/2:e.width*R.CellPercentageAllocatedToResize:Math.max(d.MinCellPixelsAllocatedToResizeZone,Math.min(d.MaxCellPixelsAllocatedToResizeZone,Math.floor((t?e.height:e.width)*d.CellPercentageAllocatedToResizeZone))):0}(e,t,s,r);let h,C;const f=(0,g.getColumnHeaderGutterSizeForDrawing)(r,i);if(t){const t=a?d.RowHeaderDragAndInsertHitRegionWidth*r:0,o=n?e.x:e.x+t,i=e.width-t;h={x:o,y:e.y,width:i,height:c},C={x:o,y:e.y+e.height-c-(s?0:Math.min(u.GridLineWidthPx,e.height)),width:i,height:c+(s?0:Math.min(u.GridLineWidthPx,e.height))}}else n?(h={x:e.x+e.width-c,y:e.y+f,width:c,height:e.height-f},C={x:e.x,y:e.y+f,width:c+(s?0:Math.min(u.GridLineWidthPx,e.width)),height:e.height-f}):(h={x:e.x,y:e.y+f,width:c,height:e.height-f},C={x:e.x+e.width-c-(s?0:Math.min(u.GridLineWidthPx,e.width)),y:e.y+f,width:c+(s?0:Math.min(u.GridLineWidthPx,e.width)),height:e.height-f});return{firstResizeZoneHitRegion:h,secondResizeZoneHitRegion:C}}function A(e,t,n,o,r,i,l){const a=function(e,t,n,o){return e?Math.max(0,Math.min(d.MaxCellPixelsAllocatedToUnhideZone*t,Math.floor((n?e.height:e.width)*(o?d.OverlappingUnhideZonePercentage:1)))):0}(e,t,n,i);let s;return s=r?n?{x:e.x,y:e.y,width:e.width,height:a}:o?{x:e.x+e.width-a,y:e.y+l,width:a,height:e.height-l}:{x:e.x,y:e.y+l,width:a,height:e.height-l}:n?{x:e.x,y:e.y+e.height-a-Math.min(u.GridLineWidthPx,e.height),width:e.width,height:a+Math.min(u.GridLineWidthPx,e.height)}:o?{x:e.x,y:e.y+l,width:a+Math.min(u.GridLineWidthPx,e.width),height:e.height-l}:{x:e.x+e.width-a-Math.min(u.GridLineWidthPx,e.width),y:e.y+l,width:a+Math.min(u.GridLineWidthPx,e.width),height:e.height-l},s}function P(e,t,n,i,a,s,d,c,u,g,h,C){const f=L(a,i,d,c,u,!1,g,C),m=L(a,i,d,c,u,!0,g,C),p=function(e,t){return n=>j(e,!0,t)&&"touch"!==n.pointerType&&"pen"!==n.pointerType}(d,C);(0,l.registerCursorHitRegion)(e,t,n,s,o.RenderFeaturesZIndex.HeaderResize,p),(0,l.registerHitRegion)(e,t,n,o.RenderFeaturesZIndex.HeaderResize,f,r.PointerDownEvent),(0,l.registerHitRegion)(e,t,n,o.RenderFeaturesZIndex.HeaderResize,m,r.DoubleClickEventType),h&&((0,l.registerMouseEnterHitRegion)(e,t,n,o.RenderFeaturesZIndex.HeaderResize,k(i,a,d,!0,C)),(0,l.registerMouseLeaveHitRegion)(e,t,n,o.RenderFeaturesZIndex.HeaderResize,k(i,a,d,!1,C)))}function M(e,t,n,r,i,a,s){(0,l.registerMouseEnterHitRegion)(e,t,n,o.RenderFeaturesZIndex.UnhideSkittle,N(r,i,a,!0,s)),(0,l.registerMouseLeaveHitRegion)(e,t,n,o.RenderFeaturesZIndex.UnhideSkittle,N(r,i,a,!1,s))}function B(e,t,n,i,a,d,c,u){const g=(0,s.getUnadjustedHitRegionFromRect)(e,t,a,!1);(0,l.registerCursorHitRegion)(n,i,g,r.PointerCursorType,o.RenderFeaturesZIndex.HeaderInsert,function(e,t,n){return o=>(0,h.isHeaderInsertAllowed)(e,t,n)&&"touch"!==o.pointerType&&"pen"!==o.pointerType}(d,c,u)),(0,l.registerMouseEnterHitRegion)(n,i,g,o.RenderFeaturesZIndex.HeaderInsert,z(d,c,u,!0)),(0,l.registerMouseLeaveHitRegion)(n,i,g,o.RenderFeaturesZIndex.HeaderInsert,z(d,c,u,!1)),(0,l.registerHitRegion)(n,i,g,o.RenderFeaturesZIndex.HeaderInsert,function(e,t,n){return o=>{if(G(o)&&(0,h.isHeaderInsertAllowed)(e,t,n)){const r=o;return(0,h.headerInsertButtonInvokedCallback)(e,t,n,r),!0}return!1}}(d,c,u),r.ClickEventType),(0,l.registerHitRegion)(n,i,g,o.RenderFeaturesZIndex.HeaderInsert,function(e,t,n){return o=>!(!G(o)||!(0,h.isHeaderInsertAllowed)(e,t,n))}(d,c,u),r.PointerDownEvent)}function H(e,t,n){const o=n?1:0;return t?e.filter(e=>e.Col===o):e.filter(e=>e.Row===o)}function O(e,t,n){const o=e.IsRow,r=o?t.Row:t.Col,i=(0,g.getCellAbsoluteIndex)(e,r,o);return e=>("touch"!==e.pointerType&&((0,h.isHoverTelemetryEnabled)()&&n&&(0,h.trackGridRendererEventResponseTime)(e,["header-cell-hover"],void 0),(0,h.setOrRemoveHoveredCellCallback)(i,r,o,n)),!0)}function k(e,t,n,o,r){return i=>(j(n,o,r)&&"touch"!==i.pointerType&&"pen"!==i.pointerType&&(0,h.setOrRemoveResizeZoneHoveredCallback)(e,t,n,o),!1)}function L(e,t,n,r,i,l,a,s){return d=>{if(G(d)&&j(n,!0,s)){const s=d;(0,h.onHeaderResizeStartCallback)(s,t,e,n,r,a,l),V()&&(0,o.isChangeGateEnabled)(o.ChangeGate.DismissUnhideSkittleOnResize)&&(r||i)&&(0,h.onHeaderUnhideRowColCallback)(t,n,r,!1,!1)}return!0}}function N(e,t,n,o,r){return i=>("touch"!==i.pointerType&&(0,h.onHeaderUnhideRowColCallback)(e,t,n,o,r),!1)}function E(e){return(0,h.isHeaderDragAllowed)()&&"touch"!==e.pointerType&&"pen"!==e.pointerType}function z(e,t,n,o){return r=>("touch"!==r.pointerType&&(0,h.headerInsertHitAreaHoveredCallback)(e,t,n,o),!1)}function W(e,t,n,o){return r=>(G(r)&&(0,h.expandCollapseOutlines)(e,t,n,o),!0)}function G(e){return!("dblclick"!==e.type&&"click"!==e.type&&"mouse"!==e.pointerType)&&0===e.button}function V(){return void 0===w&&(w=(0,S.getBooleanFeatureGate)("Microsoft.Office.Excel.UnhideRowColumnSkittleSlice2",!1)),w}function j(e,t,n){let r=!1;return void 0===b&&(b=(0,S.getBooleanFeatureGate)("Microsoft.Office.Excel.RenderResizePill")&&(0,o.isChangeGateEnabled)(o.ChangeGate.CacheIsResizeAllowedValue)),r=b?n?(0,h.isResizeAllowed)(e):function(e,t){if(void 0!==I){const e=I;return t||(I=void 0),e}return I=(0,h.isResizeAllowed)(e),I}(e,t):(0,h.isResizeAllowed)(e),r}t.registerHeaderHitRegionsToModelCache=function(e,t){const n=e.IsRow,a=(0,C.doesHeaderModelContainOutlines)(e,n);if(!e.ShowHeaders&&!a)return;const u=(0,o.getRenderingRegionHitTestCache)(e,(0,i.getRenderingRegionKey)(t.renderingRegion)),h=e.ClientOnlyCache.CellsToRender;if(0===h.length)return;const S=a?H(h,n,!0):h,R=v(e,S);if(e.ShowHeaders){let i;!function(e,t,n,i,a){let d;c.gridRendererCustomCursors?d=e.IsRow?e.IsRtl?c.gridRendererCustomCursors.rowSelectRTLCursor:c.gridRendererCustomCursors.rowSelectLTRCursor:c.gridRendererCustomCursors.columnSelectCursor:(p.ULS.sendTraceTag(508924443,p.LogCategory.msoulscat_ES_EWAJSGrid,p.TraceLevel.Warning,"headersHitTest: registerHeaderCellsHitRegionsToModelCache:: gridRendererCustomCursors is undefined. Using default cursor."),d=r.DefaultCursorType);for(let r=0;r<n.length;r++){const c=n[r],u=i[r],g=(0,s.getUnadjustedHitRegionFromRect)(e,t,u,!1);if((0,l.registerCursorHitRegion)(c,a,g,d,o.RenderFeaturesZIndex.Headers),(0,l.registerMouseEnterHitRegion)(c,a,g,o.RenderFeaturesZIndex.Headers,O(e,c,!0)),(0,l.registerMouseLeaveHitRegion)(c,a,g,o.RenderFeaturesZIndex.Headers,O(e,c,!1)),(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.HeaderDragImprovements,e)){const n=(0,y.getHeaderDragSquareHitRegionRectInfo)(e,c,t.scaleFactor);n&&x(e,t,c,n,a)}}}(e,t,S,R,u),i=(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.ResizeHeaderUXModernization,e)?n?r.RowResizeModerinzeCursorType:r.ColResizeModernizeCursorType:n?r.RowResizeCursorType:r.ColResizeCursorType,function(e,t,n,r,i,l,a){const c=(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.RenderResizePill,e),u=(0,o.isRenderResizePillAcrossBlockEnabled)(),h=(0,o.isIncreasedHeaderSizeEnabled)(e),C=(0,o.isHeaderInsertEnabled)();for(let S=0;S<n.length;S++){const R=0===S,F=S+1===n.length,T=n[S],w=r[S],I=S,b=(0,g.getCellAbsoluteIndex)(e,S,a),v=b-1,x=b+1;let A,M=!1;if(R){var f,m;A=a?!(null===(f=e.AdjacentBlocksHiddensInfo)||void 0===f||!f.IsLastRowOfPrevBlockHidden):!(null===(m=e.AdjacentBlocksHiddensInfo)||void 0===m||!m.IsLastColOfPrevBlockHidden)}else{A=(0,g.getCellAbsoluteIndex)(e,S-1,a)!==v}if((0,o.isChangeGateEnabled)(o.ChangeGate.DismissUnhideSkittleOnResize))if(F){var p,y;M=a?!(null===(p=e.AdjacentBlocksHiddensInfo)||void 0===p||!p.IsFirstRowOfNextBlockHidden):!(null===(y=e.AdjacentBlocksHiddensInfo)||void 0===y||!y.IsFirstColOfNextBlockHidden)}else{M=(0,g.getCellAbsoluteIndex)(e,S+1,a)!==x}const B=A?S:S-1,H=D(w,a,e.IsRtl,t.scaleFactor,h,c,C),O=(0,s.getUnadjustedHitRegionFromRect)(e,t,H.firstResizeZoneHitRegion,!1),k=(0,s.getUnadjustedHitRegionFromRect)(e,t,H.secondResizeZoneHitRegion,!1),L=c&&!A&&(u||!(-1===B));1!==b&&P(T,i,O,v,B,l,a,A,!1,-1===B,L,F);const N=a&&b===d.MaxRowValue,E=!a&&b===d.MaxColValue,z=c&&(u||!F);N||E||P(T,i,k,b,I,l,a,!1,M,!1,z,F)}}(e,t,S,R,u,i,n),V()&&function(e,t,n,r,i,l){let a=void 0;for(let m=0;m<n.length;m++){const p=0===m,y=m+1===n.length,S=n[m],R=r[m],F=(0,g.getCellAbsoluteIndex)(e,m,l),T=F-1,w=F+1;let I=!1,b=!1;if(p){var d,c;I=l?!(null===(d=e.AdjacentBlocksHiddensInfo)||void 0===d||!d.IsLastRowOfPrevBlockHidden):!(null===(c=e.AdjacentBlocksHiddensInfo)||void 0===c||!c.IsLastColOfPrevBlockHidden)}else{I=(0,g.getCellAbsoluteIndex)(e,m-1,l)!==T}if(y){var u,h;b=l?!(null===(u=e.AdjacentBlocksHiddensInfo)||void 0===u||!u.IsFirstRowOfNextBlockHidden):!(null===(h=e.AdjacentBlocksHiddensInfo)||void 0===h||!h.IsFirstColOfNextBlockHidden)}else{b=(0,g.getCellAbsoluteIndex)(e,m+1,l)!==w}const v=I&&b;if(void 0!==a||l||!I&&!b||(a=(0,g.getColumnHeaderGutterSizeForDrawing)(t.scaleFactor,(0,o.isIncreasedHeaderSizeEnabled)(e))),I){var C;const n=A(R,t.scaleFactor,l,e.IsRtl,!0,v,null!==(C=a)&&void 0!==C?C:0);M(S,i,(0,s.getUnadjustedHitRegionFromRect)(e,t,n,!1),F,l,!0,e.IsRtl)}if(b){var f;const n=A(R,t.scaleFactor,l,e.IsRtl,!1,v,null!==(f=a)&&void 0!==f?f:0);M(S,i,(0,s.getUnadjustedHitRegionFromRect)(e,t,n,!1),F,l,!1,e.IsRtl)}}}(e,t,S,R,u,n),(0,o.isHeaderInsertEnabled)()&&function(e,t,n,o,r,i){const l=t.scaleFactor,a=i?d.RowHeaderDragAndInsertHitRegionWidth*l:(0,g.getColumnHeaderGutterSizeForDrawing)(l,!0),s=l*(i?T.RowHeaderTopInsertHitRegionHeight:T.ColumnHeaderStartInsertHitRegionWidth),c=l*(i?T.RowHeaderBottomInsertHitRegionHeight:T.ColumnHeaderEndInsertHitRegionWidth);for(let l=0;l<n.length;l++){const d=n[l],u=(0,g.getCellAbsoluteIndex)(e,l,i),{cellStartHitRegion:h,cellEndHitRegion:C}=(0,F.getHeaderInsertButtonHitRegions)(o[l],i,e.IsRtl,a,s,c);B(e,t,d,r,h,u,i,!0),B(e,t,d,r,C,u,i,!1)}}(e,t,S,R,u,n)}if(a){const i=H(h,n,!1),a=v(e,i);!function(e,t,n,i){const a=i?e.RowOutlinesInformation:e.ColumnOutlinesInformation;if(a)for(let d=0;d<a.length;d++){const c=a[d].Outlines,u=d+1;for(let a=0;a<c.length;a++){const d=c[a],h=d.ButtonIndex,C=(0,g.getCellAbsoluteIndex)(e,h,i)-1;if(-1===h||d.IsButtonHidden){if((0,o.isChangeGateEnabled)(o.ChangeGate.GroupRowColBugFix))continue;break}const p=d.Button,y=p.EdgeInformation.Cell,S=d.IsNonDefaultDirection?C+1:C-1,R=!d.IsExpanded,F=(0,f.getAdjustedButtonSize)(t.scaleFactor,m.ExpandCollapseButtonSizePx),T=p.EdgeInformation.TopPx,w={x:p.EdgeInformation.LeftPx,y:T,width:F,height:F},I=(0,s.getUnadjustedHitRegionFromRect)(e,t,w,!1),b=d.ECTitle;(0,l.registerTooltipHitRegion)(y,n,I,b,o.RenderFeaturesZIndex.Headers),(0,l.registerCursorHitRegion)(y,n,I,r.PointerCursorType,o.RenderFeaturesZIndex.Headers,e=>!0),(0,l.registerHitRegion)(y,n,I,o.RenderFeaturesZIndex.Headers,W(i,u,S,null!=R&&R),r.ClickEventType)}}}(e,t,u,n),function(e,t,n,i,a){for(let d=0;d<n.length;d++){const c=n[d],u=i[d],g=(0,s.getUnadjustedHitRegionFromRect)(e,t,u,!1);(0,l.registerHitRegion)(c,a,g,o.RenderFeaturesZIndex.Headers,e=>!0,r.PointerDownEvent)}}(e,t,i,a,u)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawRowColDragAndDropSixSquares=void 0;const o=n(1),r=n(5),i=n(4),l=n(137),a=n(38),s=n(0),d=n(136),c=n(10),u=n(2);function g(e,t,n,o){const r=[];let i=e.x;for(let l=0;l<t;++l){let t=e.y;for(let e=0;e<n;++e)r.push({x:i,y:t}),t+=o;i+=o}return r}t.drawRowColDragAndDropSixSquares=function(e,t,n){(0,i.verifyArgumentNotNull)(e,"ctx","drawRowColDragAndDropSixSquares"),(0,i.verifyArgumentNotNull)(t,"model","drawRowColDragAndDropSixSquares"),(0,i.verifyArgumentNotNull)(n,"context","drawRowColDragAndDropSixSquares"),(0,i.verifyArgumentNotNull)(t.IsRow,"model.IsRow","drawRowColDragAndDropSixSquares");const h=(0,o.isChangeGateEnabled)(o.ChangeGate.CellHoverStateProperty),C=t.ClientOnlyCache.CellsToRender;for(const i of C){const C=i.StyleID||0;if(!(h?i.IsHovered:o.HoverHeadersStylesSet.has(C)))continue;if(!(0,c.isHeaderDragAllowed)())return;const p=n.scaleFactor;let y,S=[];const R=(0,a.getDimensionAdjustedForDrawing)(l.DragSquareDimension,p),F=(0,a.getDimensionAdjustedForDrawing)(l.DragSquareGap,p),T=(0,d.getHeaderDragSquareRegionRectInfo)(t,i,p,R,F);if(t.IsRow){var f;if((0,r.getCellHeightAdjustedForDrawing)(t,i)<=T.height)continue;y=(0,s.isHighContrastMode)(n)?(0,u.getHighContrastTextColor)(i,n.highContrastScheme):(null===(f=(0,s.getCellFont)(i,t))||void 0===f?void 0:f.Color)||o.HoverFontColor,S=g(T,l.DragSquareNumberOfDotsInShortEdge,l.DragSquareNumberOfDotsInLongEdge,R+F)}else{if((0,r.getCellWidthAdjustedForDrawing)(t,i)<=T.width)continue;var m;if((0,s.isHighContrastMode)(n))y=(0,s.rgbToColorHex)(n.highContrastScheme.TextColor);else y=n.viewMode===o.ViewMode.NamedSheetView&&(0,u.doesHeaderModelContainOutlines)(t,!1)?(null===(m=(0,s.getCellFont)(i,t))||void 0===m?void 0:m.Color)||o.HoverFontColor:(0,a.isCellWhollySelected)(i)?o.WholeRowColSelectionBackgroundColor:o.HoverFontColor;S=g(T,l.DragSquareNumberOfDotsInLongEdge,l.DragSquareNumberOfDotsInShortEdge,R+F)}e.fillStyle=y;for(const t of S)e.fillRect(t.x,t.y,R,R)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearColumnHeaderGutterArea=void 0;const o=n(1),r=n(4),i=n(38),l=n(0),a=n(2);t.clearColumnHeaderGutterArea=function(e,t,n,s,d,c){if((0,r.verifyArgumentNotNull)(e,"ctx","clearColumnHeaderGutterArea"),(0,r.verifyArgumentNotNull)(t,"model","clearColumnHeaderGutterArea"),(0,r.verifyArgumentNotNull)(n,"context","clearColumnHeaderGutterArea"),(0,r.verifyArgumentNotNull)(t.IsRow,"model.IsRow","clearColumnHeaderGutterArea"),t.IsRow)return;const u=n.viewMode===o.ViewMode.NamedSheetView&&(0,a.doesHeaderModelContainOutlines)(t,!1);e.fillStyle=d?(0,l.rgbToColorHex)(c.BackgroundColor):u?o.NSVHeaderBackgroundColor:o.DefaultHeaderBackgroundColor,e.fillRect(0,(0,i.getDimensionAdjustedForDrawing)(t.RowOffsets[t.RowOffsets.length-1],s),t.BlockWidth*s,(0,i.getColumnHeaderGutterSizeForDrawing)(s,!0))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawInsertDotAndInsertButton=void 0;const o=n(1),r=n(99),i=n(5),l=n(78),a=n(0);function s(e,t,n,o,i,s){let c=-2,g=void 0;const h=t.ClientOnlyCache.CellsToRender;for(const S of h){var C,f,m,p;const h=null===(C=S.InsertButtons)||void 0===C?void 0:C.Start,R=null===(f=S.InsertButtons)||void 0===f?void 0:f.End;if(s&&0===(t.IsRow?S.Col:S.Row))continue;const F=t.IsRow?S.Row:S.Col,T=c+1===F&&(null===(m=g)||void 0===m?void 0:m.Type)===(null==h?void 0:h.Type)&&(null===(p=g)||void 0===p?void 0:p.Offset)===(null==h?void 0:h.Offset);c=F,g=R;const w=!T&&(null==h?void 0:h.Type)===o,I=(null==R?void 0:R.Type)===o;(w||I)&&(i||(e.lineWidth=n.scaleFactor*r.InsertButtonStrokeWidth,e.strokeStyle=(y=n.highContrastScheme)?(0,a.rgbToColorHex)(y.TextColor):l.HeaderDrawingsGreenColor,e.fillStyle=u(n.highContrastScheme),i=!0),w&&d(S,t,n,h,!0,!!t.IsRow,e),I&&d(S,t,n,R,!1,!!t.IsRow,e))}var y;return i}function d(e,t,n,l,s,d,u){const g=n.scaleFactor,h=r.InsertButtonStrokeWidth*g,{x:C,y:f,radius:m}=function(e,t,n,l,s,d,c){const{radius:u,paddingForDrawing:g}=function(e,t,n,i){let l=0,a=0;return t?(e.Type===o.InsertButtonType.InsertDot&&(l=r.InsertDotRadius*i,a=r.InsertDotRowPadding*i),e.Type===o.InsertButtonType.InsertButton&&(l=r.InsertButtonRadius*i,a=r.InsertButtonRowPadding*i)):(e.Type===o.InsertButtonType.InsertDot&&(l=r.InsertDotRadius*i,a=r.InsertDotColumnPadding*i),e.Type===o.InsertButtonType.InsertButton&&(l=r.InsertButtonRadius*i,a=r.InsertButtonColumnPadding*i)),{radius:l,paddingForDrawing:a+l+n/2}}(e,t,l,s);let h=0,C=0;return t?(h=(0,i.getCellLeftAdjustedForDrawing)(d,c,d.IsRtl,!1),C=n?(0,i.getCellTopAdjustedForDrawing)(d,c,!1):(0,i.getCellBottomAdjustedForDrawing)(d,c)):(C=(0,i.getCellTopAdjustedForDrawing)(d,c,!1),h=n?(0,i.getCellLeftAdjustedForDrawing)(d,c,d.IsRtl,!1):(0,i.getCellLeftAdjustedForDrawing)(d,c,d.IsRtl,!1)+(0,i.getCellWidthAdjustedForDrawing)(d,c)),t?{x:h+g,y:C+e.Offset-((0,o.isChangeGateEnabled)(o.ChangeGate.InsertDrawingsClarity)?(0,a.getLinePixelTranslation)(l):0),radius:u}:{x:h+e.Offset-((0,o.isChangeGateEnabled)(o.ChangeGate.InsertDrawingsClarity)?(0,a.getLinePixelTranslation)(l):0),y:C+g,radius:u}}(l,d,s,h,g,t,e);l.Type===o.InsertButtonType.InsertDot?c(u,C,f,m):l.Type===o.InsertButtonType.InsertButton&&function(e,t,n,o,r){c(e,t,n,r),function(e,t,n,o){e.beginPath(),e.moveTo(t-o/2,n),e.lineTo(t+o/2,n),e.moveTo(t,n-o/2),e.lineTo(t,n+o/2),e.stroke()}(e,t,n,o)}(u,C,f,r.InsertButtonLineHeight*g,m)}function c(e,t,n,o){e.beginPath(),e.arc(t,n,o,0,r.ThreeSixtyDegreeInRadians),e.fill(),e.stroke()}function u(e){return e?(0,a.rgbToColorHex)(e.BackgroundColor):l.HeaderDrawingsWhiteColor}t.drawInsertDotAndInsertButton=function(e,t,n){var r;(0,o.verifyArgumentNotNull)(e,"ctx","drawInsertDotAndInsertButton"),(0,o.verifyArgumentNotNull)(t,"model","drawInsertDotAndInsertButton"),(0,o.verifyArgumentNotNull)(n,"context","drawInsertDotAndInsertButton");let i=!1;const l=t.IsRow?t.RowOutlinesInformation:t.ColumnOutlinesInformation,a=(null!==(r=null==l?void 0:l.length)&&void 0!==r?r:0)>0;i=s(e,t,n,o.InsertButtonType.InsertDot,i,a),s(e,t,n,o.InsertButtonType.InsertButton,i,a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawDataCleansingHeaderIcon=void 0;const o=n(1),r=n(0),i=n(8),l=n(4),a=n(2),s=n(3),d=n(74),c=n(12),u=n(41),g=n(18),h=n(19),C=n(124),f=n(11),m=n(21),p=n(20),y=n(10),S=n(23),R=n(47);function F(e,t,n,o){const r=(0,u.getClipRect)(t,n,o.left,o.bottom,o.size,!1);(0,a.applyClipping)(e,r),(0,C.drawCircledSymbols)(e,o),(0,a.restoreClipping)(e,r)}function T(e,t,n,i){!function(e,t,n,i,l,a){const s=(0,m.getUnadjustedHitRegionFromRect)(e,n,i,!1),d=(0,o.getRenderingRegionHitTestCache)(e,(0,r.getRenderingRegionKey)(n.renderingRegion));(0,p.registerCursorHitRegion)(t,d,s,S.PointerCursorType,o.RenderFeaturesZIndex.DataCleansing),(0,p.registerTooltipHitRegion)(t,d,s,"Clean Data",o.RenderFeaturesZIndex.DataCleansing),(0,p.registerHitRegion)(t,d,s,o.RenderFeaturesZIndex.DataCleansing,l,"click"),(0,p.registerHitRegion)(t,d,s,o.RenderFeaturesZIndex.DataCleansing,e=>!0,"pointerdown"),(0,p.registerHitRegion)(t,d,s,o.RenderFeaturesZIndex.DataCleansing,e=>!0,"dblclick"),(0,p.registerHitRegion)(t,d,s,o.RenderFeaturesZIndex.DataCleansing,l,"touchend"),(0,p.registerHitRegion)(t,d,s,o.RenderFeaturesZIndex.DataCleansing,S.TouchCallback,"touchstart")}(e,t,n,i,t=>{const n=(0,o.isPassRibbonCommandsToCanvasRendererEnabled)()?(0,R.getRibbonCommandsInstance)().DataCleansingShowTaskPane:e.RibbonCommands.DataCleansingShowTaskPane;return(0,y.handleRibbonCommand)(t,n,""),!0})}function w(e,t,n){return!(!e.DataCleansingIcon||(0,r.isCellPreviewTextDefined)(e.PreviewText)||e.ShowSkeleton||!(0,a.cellIntersectsRenderingRegion)(e,t.renderingRegion)||n.size<=h.MinimalIconSize)}function I(e,t,n,o){const r=(0,i.getActualFontSize)(t),l=(0,c.getIconSize)(r,n);return{size:l,image:h.CFIconImage.CircleSymbolMedium,left:(0,d.getIconLeftPosition)(e,t,l,r,n),bottom:(0,d.getIconVerticalPosition)(e,t,n,l),highContrastScheme:o}}function b(e){return{x:e.left,y:e.bottom-e.size,width:e.size,height:e.size}}t.drawDataCleansingHeaderIcon=function(e,t,n){if(!(0,f.getBooleanFeatureGate)("Microsoft.Office.Excel.DataCleansingColumnHeaders",!1)||!(0,o.isPassRibbonCommandsToCanvasRendererEnabled)()&&!t.RibbonCommands)return;(0,l.verifyArgumentNotNull)(e,"ctx","drawDataCleansingHeaderIcon"),(0,l.verifyArgumentNotNull)(t,"model","drawDataCleansingHeaderIcon"),(0,l.verifyArgumentNotNull)(n,"context","drawDataCleansingHeaderIcon");const r=t.ClientOnlyCache.CellsToRender;r.length>0&&(e.lineWidth=g.ShapeOutlineWidthPx,e.setLineDash(s.DefaultDash));const i=null!==n.highContrastScheme?n.highContrastScheme:void 0;for(let o=0;o<r.length;o++){const l=r[o],a=I(t,l,n.scaleFactor,i);w(l,n,a)&&(F(e,t,l,a),T(t,l,n,b(a)))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasRendererGlobals=void 0;const o=n(13),r=n(9),i=n(1),l=n(0),a=n(235),s=n(31),d=n(46),c=n(10),u=n(7),g=n(138),h=n(238),C=n(239),f=n(240),m=n(241),p=n(59),y=n(242),S=n(97),R=n(98),F=n(77),T=n(243),w=n(245),I=n(246),b=n(247),v=n(248),x=n(139),D=n(100),A=n(11),P=n(140),M=n(250);class B{static lookupPerfMetricName(e){return o.RenderPerformanceMetric[e]}static measureTextWidth(e,t,n,o){const r=B.canvasContext();return B.measureTextWidthWithContext(r,e,t,n,o)}static measureTextWidthOffscreen(e,t,n,o){const r=B.offScreenCanvasContext();return B.measureTextWidthWithContext(r,e,t,n,o)}static measureTextWidthWithContext(e,t,n,o,i){if(!e)throw Error("measureTextWidthWithContext: ctx is undefined");return e.font=n,(0,r.measureTextWidth)(e,t,o,i)}static compareFormattedTexts(e,t){return(0,i.areFormattedTextsEqual)(e,t)}static compareMergeInformation(e,t){return(0,i.areMergeInformationEqual)(e,t)}static compareInCellControlOptions(e,t){return(0,i.areInCellControlOptionsEqual)(e,t)}static compareNumberFormatInformation(e,t){return(0,i.areNumberFormatInformationEqual)(e,t)}static compareHeaderBlockModels(e,t){return(0,i.compareHeaderBlockModels)(e,t)}static compareGridBlockModels(e,t,n){return(0,i.compareGridBlockModels)(e,t,n)}static comparePartialGridBlockModels(e,t,n,o,r,l){return(0,i.comparePartialGridBlockModels)(e,t,n,o,r,l)}static serializeCell(e,t){return(0,i.serializeCell)(e,t)}static registerActionOnFontLoad(e,t,n,o,r){var i;null===(i=(0,a.registerActionOnFontLoadIfRequired)(e,t,n,o,r))||void 0===i||i.catch(e=>{throw e})}static getFontsLoadStatus(e){return(0,d.getFontsLoadStatus)(e)}static stopFontRenderingTelemetry(){(0,a.stopFontRenderingTelemetry)()}static getFontLoadRenderingLogs(){return(0,a.getFontLoadRenderingLogs)()}static registerExternalCallbacks(e){(0,c.registerExternalCallbacks)(e)}static isExternalCallbacksRegistered(){return(0,c.isexternalCallbacksRegistered)()}static initializeLogger(e){e&&(0,u.initializeLogger)(e)}static initializeChangeGates(e){(0,A.setChangeGateDictionaryGetter)(()=>e)}static initializeFeatureGates(e){(0,A.setFeatureGateDictionaryGetter)(()=>e)}static initializeGridRendererImageLoader(e,t){(0,s.initializeGridRendererImageLoader)(e,t)}static setStaticImageUrl(e,t){(0,s.setStaticImageUrl)(e,t)}static loadPreviewFont(e){(0,a.loadPreviewFont)(e)}static loadPreviewFontFamily(e,t){(0,a.loadPreviewFontFamily)(e,t)}static isFontLoadApiSupported(){return(0,d.fontFaceSetSupported)()}static initPassiveTestManager(){(0,g.initPassiveTelemetryManager)()}static initGridRendererStrings(e){(0,p.initGridRendererStrings)(e)}static isGridRendererStringsInitialized(){return(0,p.isGridRendererStringsInitialized)()}static initGridRendererCustomCursors(e){(0,S.initGridRendererCustomCursors)(e)}static isGridRendererCustomCursorsInitialized(){return(0,S.isGridRendererCustomCursorsInitialized)()}static registerForCompressedTextTelemetryCollector(e){const t=B.canvasContext();t&&(0,h.registerCompressedTextTelemetryCollector)(t,e)}static registerForSpillCellTelemetryCollector(e){const t=B.canvasContext();t&&(0,C.registerSpillCellTelemetryCollector)(t,e)}static registerForAutoFitWidthTelemetryCollector(e){const t=B.canvasContext();t&&(0,f.registerAutoFitWidthTelemetryCollector)(t,e)}static registerForAutofitHeightTelemetryCollector(e){const t=B.canvasContext();t&&(0,m.registerAutoFitHeightTelemetryCollector)(t,e)}static registerCellHashDisplayCollector(e){(0,y.registerCellHashDisplayCollector)(e)}static registerAppMemoryInfoCollector(){(0,w.registerAppMemoryInfoTelemetryCollector)()}static registerModelCascadeTimeInfoCollector(e){(0,b.registerModelCascadeTimeCollector)(e)}static registerModelStyleSizeInfoCollector(e){(0,v.registerModelStyleSizeCollector)(e)}static registerBlockStatisticsInfoCollector(){(0,I.registerBlockStatisticsLogCollector)()}static registerForFontCheckTelemetryCollector(e){B.canvasContext()&&(0,M.registerFontCheckTelemetryCollector)(e)}static preprocessModel(e,t,n){return(0,R.preprocessAutofitWidth)(B.canvasContext(),e,t,n)}static getProcessedColumnWidth(e,t){const n=(0,F.getColMetadata)(e);return n&&n.SrvDx===t&&n.CachedColWidth||t}static resetColWidthCache(){(0,F.resetCache)()}static resetColWidthCacheByCol(e){(0,F.resetColWidthCacheByCol)(e)}static analyzeLowRenderingFidelity(e){return(0,T.analyzeModelFidelity)(e)}static hasRenderingFidelityThresholdExceeded(e,t){return(0,T.hasThresholdExceeded)(e,t)}static getErrorTypeForRenderingFidelityProblem(e){return(0,T.getErrorTypeForProblem)(e)}static getVetoForRenderingFidelityProblem(e){return(0,T.getVetoType)(e)}static renderingRegionContainsDirtyCells(e,t){return(0,l.renderingRegionContainsDirtyCells)(e,t)}static calculateRowHeaderWidth(e,t){return(0,i.calculateRowHeaderWidth)(e,t)}static getCellStyleHashes(e){return(0,l.getCellStyleHashesFromModel)(e)}static canRowColHideOrCascade(e,t,n,o){return(0,x.canCellsOfRowColHideOrCascade)(e,t,n,o)}static canMultipleRowColHideOrCascade(e,t,n,o,r){return(0,x.canCellsOfMultipleRowColHideOrCascade)(e,t,n,o,r)}static performModelCascade(e,t,n,o){return(0,x.modelCascade)(e,t,n,o)}static performModelCascadeForMultipleRowCols(e,t,n,o,r){return(0,x.modelCascadeMultipleRowCols)(e,t,n,o,r)}static performModelCascadeRowColsOperations(e,t,n,o,r,i,l){return(0,x.modelCascadeRowColsOperations)(e,t,n,o,r,i,l)}static hideRowCols(e,t,n){return(0,x.hideRowsColumns)(e,t,n)}static hideMultipleRowCols(e,t,n,o){return(0,x.hideMultipleRowsColumns)(e,t,n,o)}static performModelRowColOperation(e,t,n,o,r,i=!1){return(0,x.modelRowColOperations)(e,t,n,o,r,i)}static cloneModel(e){return(0,D.duplicateModel)(e)}static getRenderedFontsTelemetry(){return(0,a.getRenderedFontsTelemetry)()}static getFlickeredFontsInBootPhase(){return(0,d.getFlickeredFontsInBootPhase)()}static preprocessModelStyles(e){return(0,i.preprocessModelStyles)(e)}static preprocessStyles(e){return(0,i.processGlobalStyles)(e)}static isGlobalBorderStylesEnabled(e){return(0,i.isGlobalBorderStylesEnabled)(e)}static isGlobalFontsAndCellStylesEnabled(){return(0,i.isGlobalFontsAndCellStylesEnabled)()}static isGlobalBorderStylesEnabledNew(){return(0,i.isGlobalBorderStylesEnabledNew)()}static getGlobalStylesTelemetry(){return(0,i.getGlobalStylesTelemetry)()}static disableGlobalBorderStyles(e){return(0,i.disableGlobalBorderStyles)(e)}static getFontsToDownload(e){return(0,a.getFontsToBeDownloaded)(e)}static getChangedCells(e,t){return(0,l.getChangedCellsFromModel)(e,t)}static updateReferenceUpdateForModel(e,t,n,o){return(0,l.updateReferenceUpdate)(e,t,n,o)}static removeExtraModelRowCol(e){return(0,x.removeExtraModelRowsColumns)(e)}static updateWithClientRowHeights(e,t){return(0,l.updateModelWithRowHeightOverrides)(e,t)}static removeRowHeightOverridesFromModel(e,t){return(0,l.removeRowHeightOverrides)(e,t)}static getWholeSelectionHeadersStylesSet(){return i.WholeSelectionHeadersStylesSet}static getPartialSelectionHeadersStylesSet(){return i.PartiallySelectionHeadersStylesSet}static getHoverHeadersStylesSet(){return i.HoverHeadersStylesSet}static updatedPageBreaksOfCurrentBlockPair(e,t,n,o,r,i){return(0,x.updatePageBreaksOfBlockPair)(e,t,n,o,r,i)}static updatePrintAreasOfCurrentBlockPair(e,t,n,o,r,i){return(0,x.updatePrintAreasOfBlockPair)(e,t,n,o,r,i)}static canvasInstance(){return B.canvas||(B.canvas=document.createElement("canvas")),B.canvas}static offScreenCanvasInstance(){return B.offScreenCanvas||(B.offScreenCanvas=new OffscreenCanvas(1,1)),B.offScreenCanvas}static canvasContext(){return B.canvasInstance().getContext("2d")}static offScreenCanvasContext(){return B.offScreenCanvasInstance().getContext("2d")}static isMergedCellSpanningAcrossBlocks(e){return(0,P.isMergedCellSpanningAcrossBlocksVerticallyAndHorizontally)(e)}}t.CanvasRendererGlobals=B},function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.getFontLoadRenderingLogs=t.stopFontRenderingTelemetry=t.loadPreviewFontFamily=t.loadPreviewFont=t.getFontsToBeDownloaded=t.getRenderedFontsTelemetry=t.registerActionOnFontLoadIfRequired=void 0;const r=n(1),i=n(66),l=n(46),a=n(0),s=n(8),d=n(10),c=n(7),u=n(121),g=n(3),h=n(56),C=n(11),f=["Aptos Narrow","aptos narrow","Calibri","calibri"],m=(0,r.isChangeGateEnabled)(r.ChangeGate.IncreaseFontLoadTimeout)?(0,d.getServiceSetting)(8,10):(0,d.getServiceSetting)(8,7),p=(0,r.isChangeGateEnabled)(r.ChangeGate.IncreaseFontLoadTimeout)?(0,d.getServiceSetting)(6,500):(0,d.getServiceSetting)(6,100),y=(0,r.isChangeGateEnabled)(r.ChangeGate.IncreaseFontLoadTimeout)?(0,d.getServiceSetting)(7,5e3):(0,d.getServiceSetting)(7,3e3),S=(0,r.isChangeGateEnabled)(r.ChangeGate.RemoveRefCountCheckForFontLoad),R=document.createElement("div"),F=[];let T,w;R.innerText=".",R.style.visibility="hidden",null!==(o=document)&&void 0!==o&&o.body&&document.body.appendChild(R);let I=!1,b=0;function v(e){const t=new Set,n=(0,l.shouldUseOldApiForFontLoadCheck)(),o=new Set,i=[];if(e.Fonts)for(let r=0;r<e.Fonts.length;r++){const d=e.Fonts[r];if(!d)continue;const c=d.FontName;if(!c)continue;const u=(0,h.canonizeFontName)(c);if(x()&&o.add(u),!(n?t.has(c):t.has(u))){if((0,a.isPLTRegressionInMFPFixEnabled)()&&(!n||(0,s.isKnownFont)(u))&&!(0,l.isFontVisited)(u)){const e=(0,l.updateFontLoadStatus)((0,a.isGridRenderPerfFixEnabled)()?(0,h.canonizeFontNameNoLowercase)(c):u);(0,l.setFontVisited)(u),x()&&e&&i.push(u)}!(S||(d.RefCount||0)>0)||(0,l.doesFontExist)(u,!1)&&(0,l.getFontLoadStatus)(u,!1)!==l.FontLoadStatus.Pending||(n?t.add(c):t.add(u))}}if(o.size>0){const e=Array.from(o.values());1===e.length&&f.includes(e[0])||2===e.length&&f.includes(e[0])&&f.includes(e[1])||M(2,e)}i.length>0&&M(3,i),function(e){if(!(0,l.doesFontExist)(g.CellFontUnicodeFontFamily)||(0,l.getFontLoadStatus)(g.CellFontUnicodeFontFamily)===l.FontLoadStatus.Pending){var t;const n=null===(t=e.ClientOnlyCache)||void 0===t?void 0:t.CellsToRender;if(n)for(let t=0;t<n.length;t++){const o=n[t],i=!!(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.InCellControls,e)&&o.InCellControlOptions&&o.InCellControlOptions.Type===r.InCellControlType.Checkbox&&(0,u.isCellDataValidForCheckboxOrBlankCheckbox)(o);if(o.RichValueIcon||i)return!0}}return!1}(e)&&t.add(g.CellFontUnicodeFontFamily);const d=Array.from(t.values());return x()&&d.length>0&&M(4,d),d}function x(){return void 0===w&&(w=(0,a.isModernFontRenderingEnabled)()&&(0,C.getBooleanFeatureGate)("Microsoft.Office.Excel.FontRenderingTelemetry",!1)),!(!w||I)}function D(e){return new Promise(t=>{setTimeout(()=>A(e,m,t),p)})}function A(e,t,n){const o=m-t+1;switch((0,l.getFontFaceLoadStatus)(e)){case"loaded":c.ULS.sendTraceTag(542722120,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Info,`FontLoader::handleFontIsStillLoading: ${(0,s.getFontNameForLogging)(e)} was loaded successfully after ${o} retries.`),n({font:e,isSuccessful:!0});break;case"loading":if(t>1){const o=function(e){const t=1<<m-e+1;return Math.min(t*p,y)}(t);setTimeout(A,o,e,t-1,n)}else c.ULS.sendTraceTag(542722121,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Info,`FontLoader::handleFontIsStillLoading: ${(0,s.getFontNameForLogging)(e)} failed to load after ${o} retries.`),n({font:e,isSuccessful:!1});break;default:n({font:e,isSuccessful:!1})}}function P(e){(0,l.setFontLoadDivWithFontFamily)(R,e),(0,l.setFontLoadStatus)(e,l.FontLoadStatus.Pending),x()&&M(9,[e])}function M(e,t){F.push({stage:e,data:t,seq:++b})}function B(e){return!(0,l.doesFontExist)(e)&&!(0,l.verifyFontLoadStatus)(e,l.FontLoadStatus.Loaded)}function H(){const e=document.createElement("div");return e.style.visibility="hidden",e.innerText=".",e}t.registerActionOnFontLoadIfRequired=function(e,t,n,o,r){if(!(0,l.fontFaceSetSupported)()||!(0,a.isDefined)(t))return;r||(r=v(e));const c=function(e){if(void 0===T&&(T=(0,a.isModernFontRenderingEnabled)()&&(0,C.getBooleanFeatureGate)("Microsoft.Office.Excel.LocalFontSourceInMFP",!1)),!T)return e;const t=new Set,n=[];for(let o=0;o<e.length;o++){const r=e[o];if(t.has(r)||(0,l.doesFontExist)(r)&&(0,l.getFontLoadStatus)(r)===l.FontLoadStatus.Loaded)continue;const i=(0,h.canonizeFontName)(r);(0,l.isFontVisited)(i)||((0,l.setFontVisited)(i),!(0,d.isFontSourceAddedToCss)(i)&&0===(0,d.getFontFamilyEndPoint)(r)||!(0,l.isFontAvailable)(r))?t.add(r):((0,l.setFontLoadStatus)(r,l.FontLoadStatus.Loaded),x()&&n.push(r))}return n.length>0&&M(7,n),Array.from(t.values())}(r);if(c.length>0)return t(0),x()&&M(8,c),function(e){(0,a.isFontRefactorFGV2Enabled)()?function(e){const t=[];for(let n=0;n<e.length;n++)B(e[n])&&t.push(e[n]);0!==t.length&&(1!==t.length?function(e){const t=H();for(let n=0;n<e.length;n++){const o=e[n],r=H();(0,l.setFontLoadDivWithFontFamily)(r,o),t.appendChild(r)}R.appendChild(t);for(let t=0;t<e.length;t++)(0,l.setFontLoadStatus)(e[t],l.FontLoadStatus.Pending);x()&&e.length>0&&M(9,e),setTimeout(()=>{window.requestAnimationFrame(()=>{R.removeChild(t)})},p)}(t):P(t[0]))}(e):function(e){for(let t=0;t<e.length;t++)B(e[t])&&P(e[t])}(e)}(c),function(e,t,n){const o=[],r=[];return(0,l.getFontFaceSetReady)().then(()=>function(e,t,n){const o=[];for(let r=0;r<e.length;r++){const i=e[r];(0,l.verifyFontLoadStatus)(i,l.FontLoadStatus.Loaded)?t.push(i):(0,l.verifyFontLoadStatus)(i,l.FontLoadStatus.Failed)?n.push(i):"loading"===(0,l.getFontFaceLoadStatus)(i)&&o.push(D(i))}return Promise.all(o)}(e,o,r)).then(e=>{if(!(0,a.isDefined)(t))return;const[d,c]=function(e){const t=[],n=[];for(let o=0;o<e.length;o++){const r=e[o];r.isSuccessful?t.push(r.font):n.push(r.font)}return[t,n]}(e);!function(e){for(let t=0;t<e.length;t++){const n=e[t];(0,l.getFontLoadStatus)(n)!==l.FontLoadStatus.Loaded&&((0,i.recalculateFontMetrics)(n),(0,l.setFontLoadStatus)(n,l.FontLoadStatus.Loaded))}x()&&e.length>0&&M(10,e)}(o.concat(d)),function(e,t){const n=(0,a.isDefined)(t);for(let o=0;o<e.length;o++){const r=e[o];(0,l.setFontLoadStatus)(r,l.FontLoadStatus.Failed),n&&(0,s.isKnownFont)(r)&&t((0,s.sanitizeFontName)(r))}x()&&e.length>0&&M(11,e)}(r.concat(c),n),(o.length>0||d.length>0)&&t(1),t(2)}).catch(e=>{!function(e,t){(0,a.isDefined)(e)&&(0,a.isDefined)(t)&&(t("API_Failure"),e(2))}(t,n)})}(c,t,n);o&&t(1)},t.getRenderedFontsTelemetry=function(){return(0,s.getRenderedFontsCount)()},t.getFontsToBeDownloaded=v,t.loadPreviewFont=function(e){(0,l.setFontLoadDivWithFontFamily)(R,"msofp"),(0,l.getFontFaceSetReady)().then(()=>{(0,l.verifyFontLoadStatus)("msofp",l.FontLoadStatus.Failed)&&e("ERROR")},()=>{e("API_Failure")})},t.loadPreviewFontFamily=function(e,t){"loaded"!==(0,l.getFontFaceLoadStatus)(e)&&(((0,a.isFontRefactorFGEnabled)()||"unloaded"===(0,l.getFontFaceLoadStatus)(e))&&(0,l.setFontLoadDivWithFontFamily)(R,e),(0,l.getFontFaceSetReady)().then(()=>{(0,l.verifyFontLoadStatus)(e,l.FontLoadStatus.Failed)&&t("ERROR")},()=>{t("API_Failure")}))},t.stopFontRenderingTelemetry=function(){I=!0},t.getFontLoadRenderingLogs=function(){return F}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdleTracker=void 0;const o=n(79),r=n(237);class i extends r.Idle{startTrackingIfApplicable(){this.isScheduled||(this.isScheduled=!0,this.lastActiveTime=(0,o.getCurrentTimeInMs)(),setTimeout(this.onTimerTick.bind(this),1e3*this.activityReportInSec))}stopTracking(){this.isScheduled=!1}onTimerTick(){super.onTimerTick();const e=(0,o.getCurrentTimeInMs)()-this.lastActiveTime;this.isScheduled&&e<this.maxTimeAfterIdle?setTimeout(this.onTimerTick.bind(this),1e3*this.activityReportInSec):this.isScheduled=!1}reportActivity(){super.reportActivity(),this.lastActiveTime=(0,o.getCurrentTimeInMs)()}constructor(e,t){super(e),this.isScheduled=!1,this.maxTimeAfterIdle=t,this.lastActiveTime=(0,o.getCurrentTimeInMs)()}}t.IdleTracker=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Idle=void 0;const o=["keypress","keydown","click","contextmenu","dblclick","mousemove","scroll","touchmove","touchstart"];t.Idle=class{onMouseEntersFrame(){this.onEnterFrame(),this.userMouseIsInFrame=!0}onTimerTick(){this.userReportedActive=!1,1===this.activityReportMode&&this.userIsActive||this.userMouseIsInFrame&&this.isPageVisible()?this.reportActivity():this.onReportUserIsIdle()}reportActivity(){this.onReportUserIsActive(),this.userReportedActive=!0,this.userIsActive=!1}overrideDefaultsWithOptions(e){this.activityReportInSec=e.activityReportInSec||this.activityReportInSec,this.activityReportMode=e.activityReportMode||this.activityReportMode,this.detectFramesInSec=e.detectFramesInSec||this.detectFramesInSec,this.onActivity=e.onActivity||this.onActivity,this.onEnterFrame=e.onEnterFrame||this.onEnterFrame,this.onReportUserIsActive=e.onReportUserIsActive||this.onReportUserIsActive,this.onReportUserIsIdle=e.onReportUserIsIdle||this.onReportUserIsIdle}isPageVisible(){return"hidden"!==document.visibilityState}constructor(e){this.userReportedActive=!1,this.userIsActive=!1,this.userMouseIsInFrame=!1,this.attachedFrames=[],this.activityReportMode=1,this.activityReportInSec=5,this.detectFramesInSec=-1,this.onActivity=()=>{},this.onEnterFrame=()=>{},this.onReportUserIsActive=()=>{},this.onReportUserIsIdle=()=>{},this.attachListenerToNewFrames=()=>{const e=Array.prototype.slice.call(window.document.getElementsByTagName("frame")),t=Array.prototype.slice.call(window.document.getElementsByTagName("iframe")),n=e.concat(t);for(const e of n)this.attachedFrames.indexOf(e)<0&&(e.addEventListener("mouseenter",this.onMouseEntersFrame.bind(this),this,!1),this.attachedFrames.push(e),this.userMouseIsInFrame=!0)},this.onUserActivity=()=>{this.onActivity(),this.userIsActive=!0,2!==this.activityReportMode||this.userReportedActive||this.reportActivity(),this.userMouseIsInFrame=!1},this.overrideDefaultsWithOptions(e),o.forEach(e=>{window.addEventListener(e,this.onUserActivity,!0)}),e.scheduleByDefault&&(setInterval(this.onTimerTick.bind(this),1e3*this.activityReportInSec),this.detectFramesInSec>0&&setInterval(this.attachListenerToNewFrames,1e3*this.detectFramesInSec)),this.reportActivity()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerCompressedTextTelemetryCollector=void 0;const o=n(2),r=n(58),i=n(10),l=n(8),a=n(0),s=n(5),d=n(12),c=n(9),u=n(29),g=n(79),h=n(30);let C;t.registerCompressedTextTelemetryCollector=function(e,t){C||(C=new f(e)),function(e){if(!e||!e.Cells)return!1;for(let t=0;t<e.Cells.length;t++){const n=e.Cells[t];if(n.Text&&!(0,g.shouldTextBeClipped)(e,n))return!0}return!1}(t)&&C.register(t)};class f extends h.AbstractPassiveTelemetryCollector{collect(){if(!this.canCollectorExecute())return{isValid:!1,value:u.ResultMessageCollectorDisabled};const e=this.data.pop(),t=[];if(!e||null==e||!e.Cells)return{isValid:!1,value:u.ResultMessageInsufficientData};for(let n=0;n<e.Cells.length;n++){const o=e.Cells[n];o.Text&&!(0,g.shouldTextBeClipped)(e,o)&&t.push(o)}if(t.length<1)return{isValid:!1,value:u.ResultMessageInsufficientData};const n=t[Math.floor(Math.random()*t.length)];n.CachedDisplayText||(n.CachedDisplayText=(0,a.getDisplayText)(n,e));const h=(0,r.getDefaultContextState)(void 0,e.IsRtl);(0,r.updateContextForCurrentCell)(this.canvasContext,h,n,e,void 0);const C=(0,i.getAppZoom)(),f=(0,i.getDevicePixelRatio)(),m=(0,o.getTextDrawingMaxWidth)((0,s.getCellWidth)(e,n,!0),(0,c.getCellTextHorizontalPadding)(n,e,C,f),(0,c.getDistanceFromCellStartToIconEnd)(e,n,C,f),(0,d.getExpandCollapseButtonPadding)(n),0),p=(0,c.getTextWidth)(this.canvasContext,e,n);return{isValid:!0,value:{isCompressed:p>m,textWidth:p,maxWidth:m,len:n.CachedDisplayText.length,font:{name:(0,l.getFontNameForLogging)(n.CachedFont.FontName),size:n.CachedFont.Size,italic:!!n.CachedFont.Italic,bold:!!n.CachedFont.Bold}}}}constructor(e){super("CompressedTextCollector"),this.canvasContext=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerSpillCellTelemetryCollector=void 0;const o=n(1),r=n(10),i=n(8),l=n(76),a=n(29),s=n(30);let d;t.registerSpillCellTelemetryCollector=function(e,t){d||(d=new c(e)),function(e){if(!e||!e.Cells)return!1;for(let t=0;t<e.Cells.length;t++){const n=e.Cells[t];if(n.Spill&&n.Text)return!0}return!1}(t)&&d.register(t)};class c extends s.AbstractPassiveTelemetryCollector{collect(){if(!this.canCollectorExecute())return{isValid:!1,value:a.ResultMessageCollectorDisabled};const e=this.data.pop(),t=[];if(!e||null==e||!e.Cells)return{isValid:!1,value:a.ResultMessageInsufficientData};for(let n=0;n<e.Cells.length;n++){const o=e.Cells[n];o.Text&&o.Spill&&t.push(o)}if(t.length<1)return{isValid:!1,value:a.ResultMessageInsufficientData};const n=t[Math.floor(Math.random()*t.length)],s=JSON.parse(JSON.stringify(n));return(0,l.updateCellSpill)(this.canvasContext,e,s,(0,r.getAppZoom)(),(0,r.getDevicePixelRatio)()),{isValid:!0,value:{isEqual:(0,o.areGridCellsEqual)(n,s,e,e).isEqual,font:{name:(0,i.getFontNameForLogging)(n.CachedFont.FontName),italic:!!n.CachedFont.Italic,bold:!!n.CachedFont.Bold}}}}constructor(e){super("SpillCellCollector"),this.canvasContext=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerAutoFitWidthTelemetryCollector=void 0;const o=n(17),r=n(2),i=n(58),l=n(10),a=n(8),s=n(0),d=n(12),c=n(9),u=n(29),g=n(79),h=n(30);let C;t.registerAutoFitWidthTelemetryCollector=function(e,t){C||(C=new f(e)),function(e){if(!e||!e.Cells)return!1;for(let t=0;t<e.Cells.length;t++){const n=e.Cells[t];if(n.Text&&!(0,g.shouldTextBeClipped)(e,n))return!0}return!1}(t)&&C.register(t)};class f extends h.AbstractPassiveTelemetryCollector{collect(){if(!this.canCollectorExecute())return{isValid:!1,value:u.ResultMessageCollectorDisabled};const e=this.data.pop(),t=[];if(!e||null==e||!e.Cells)return{isValid:!1,value:u.ResultMessageInsufficientData};for(let n=0;n<e.Cells.length;n++){const o=e.Cells[n];o.Text&&!(0,g.shouldTextBeClipped)(e,o)&&m(o)&&t.push(o)}if(t.length<1)return{isValid:!1,value:u.ResultMessageInsufficientData};const n=t[Math.floor(Math.random()*t.length)];n.CachedDisplayText||(n.CachedDisplayText=(0,s.getDisplayText)(n,e));const h=(0,i.getDefaultContextState)(void 0,e.IsRtl);(0,i.updateContextForCurrentCell)(this.canvasContext,h,n,e,void 0);const C=(0,l.getAppZoom)(),f=(0,l.getDevicePixelRatio)(),p=(0,r.getTextDrawingMaxWidth)(n.SrvDx||0,(0,c.getCellTextHorizontalPaddingWithoutVisualElements)(e,n),(0,c.getDistanceFromCellStartToIconEnd)(e,n,C,f),(0,d.getExpandCollapseButtonPadding)(n),(0,o.getAutoFilterPaddingForAdvancedHorizontalAlignment)(e,n,C,f)),y=(0,c.getTextWidth)(this.canvasContext,e,n);return{isValid:!0,value:{tooWide:y>p,tooNarrow:p>y+this.canvasContext.measureText(" ").width,textWidth:y,maxWidth:p,len:n.CachedDisplayText.length,font:{name:(0,a.getFontNameForLogging)(n.CachedFont.FontName),size:n.CachedFont.Size,italic:!!n.CachedFont.Italic,bold:!!n.CachedFont.Bold}}}}constructor(e){super("AutoFitWidthCollector"),this.canvasContext=e}}function m(e){return!!e.SrvDx}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerAutoFitHeightTelemetryCollector=void 0;const o=n(89),r=n(35),i=n(58),l=n(8),a=n(0),s=n(9),d=n(29),c=n(30);let u;t.registerAutoFitHeightTelemetryCollector=function(e,t){u||(u=new g(e)),function(e){if(!e||!e.Cells)return!1;for(let t=0;t<e.Cells.length;t++){const n=e.Cells[t];if(n.Text&&n.WrapText&&h(n))return!0}return!1}(t)&&u.register(t)};class g extends c.AbstractPassiveTelemetryCollector{collect(){if(!this.canCollectorExecute())return{isValid:!1,value:d.ResultMessageCollectorDisabled};const e=this.data.pop(),t=[];if(!e||null==e||!e.Cells)return{isValid:!1,value:d.ResultMessageInsufficientData};for(let n=0;n<e.Cells.length;n++){const o=e.Cells[n];o.Text&&o.WrapText&&h(o)&&t.push(o)}if(t.length<1)return{isValid:!1,value:d.ResultMessageInsufficientData};const n=t[Math.floor(Math.random()*t.length)],c=(0,i.getDefaultContextState)(void 0,e.IsRtl);(0,i.updateContextForCurrentCell)(this.canvasContext,c,n,e,void 0);const u=(0,s.getTextWidth)(this.canvasContext,e,n),g=(0,s.getTextLineHeight)(n,e),C=(0,a.getFormattedText)(n.CachedDisplayText,n,e),f=(0,o.breakTextToLines)(this.canvasContext,n.CachedDisplayText,u,r.BreakType.Wrap,this.canvasContext.measureText(" ").width,e,n,C,n.WrapText),m=f.textLines.length*g,p=n.SrvDy||0;return{isValid:!0,value:{tooLong:m>p,tooShort:p-m>g,textHeight:m,SrvDy:p,numLines:f.textLines.length,isRichText:!!C,font:{name:(0,l.getFontNameForLogging)(n.CachedFont.FontName),size:n.CachedFont.Size,italic:!!n.CachedFont.Italic,bold:!!n.CachedFont.Bold}}}}constructor(e){super("AutoFitHeightCollector"),this.canvasContext=e}}function h(e){return!!e.SrvDy}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerCellHashDisplayCollector=void 0;const o=n(1),r=n(0),i=n(8),l=n(29),a=n(30);let s;t.registerCellHashDisplayCollector=function(e){s||(s=new d),function(e){if(!e||!e.Cells)return!1;for(let t=0;t<e.Cells.length;t++){const n=e.Cells[t];if(n.Text&&g(n))return!0}return!1}(e)&&s.register(e)};class d extends a.AbstractPassiveTelemetryCollector{collect(){if(!this.canCollectorExecute())return{isValid:!1,value:l.ResultMessageCollectorDisabled};const e=this.data.pop(),t=[];if(!e||null==e||!e.Cells)return{isValid:!1,value:l.ResultMessageInsufficientData};for(let n=0;n<e.Cells.length;n++){const o=e.Cells[n];o.Text&&g(o)&&t.push(o)}if(t.length<1)return{isValid:!1,value:l.ResultMessageInsufficientData};let n=0;const o={};for(let i=0;i<t.length;i++){const l=t[i],a=l.CachedDisplayText||(0,r.getDisplayText)(l,e),s=l.Text,d=c(a);if(d!==c(s)&&d&&(n++,l.CachedFont)){const e=u(l.CachedFont);o[e]||(o[e]=0),o[e]+=1}}return{isValid:!0,value:{updatedCells:n,totalCells:t.length,fontWise:o}}}constructor(){super("CellHashDisplayCollector")}}function c(e){for(let t=0;t<e.length;t++)if("#"!==e[t])return!1;return!0}function u(e){const t=(0,i.getFontNameForLogging)(e.FontName),n=e.Size;return`${(0,i.getCellFontWeightStyle)(e.Bold||!1,e.Italic||!1)} ${t} ${n}pt`}function g(e){return e.ValueType===o.CellValueType.Number}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVetoType=t.getErrorTypeForProblem=t.hasThresholdExceeded=t.analyzeModelFidelity=void 0;const o=n(1),r=n(22),i=n(8),l=n(244),a={};function s(e,t){const n=t.CachedBorderStyle;if(n)for(let t=0;t<n.Borders.length;t++){const o=n.Borders[t];2===o.Weight?f(e,l.ProblemType.MediumBorder):3===o.Weight&&f(e,l.ProblemType.ThickBorder)}}function d(e,t,n){const o=n.CachedStyle,i=n.CachedFont;o&&i&&o.Orientation&&((0,r.shouldDrawRotatedText)(t,n.CachedStyle,n.CachedFont)||f(e,l.ProblemType.CellTextOrientation))}function c(e,t){if(!t.Text)return;const n=t.CachedDisplayTextRuns;if(n){for(let t=0;t<n.length;t++)if(n[t].CachedFont&&!(0,i.isFontSupportedNew)(n[t].CachedFont.FontName)){f(e,l.ProblemType.CustomFont);break}}else t.CachedFont&&!(0,i.isFontSupportedNew)(t.CachedFont.FontName)&&f(e,l.ProblemType.CustomFont)}function u(e,t){const n=t.CachedFont;n&&(n.Underline!==o.FontUnderline.SingleAccounting&&n.Underline!==o.FontUnderline.DoubleAccounting||f(e,l.ProblemType.AccountingUnderline))}function g(e,t,n){const r=t.CachedStyle;r&&r.IsPattern&&!(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.RenderPatternStyle,n)&&f(e,l.ProblemType.PatternStyle)}function h(e,t){const n=t.CachedBorderStyle;n&&n.HasDiagBorder&&f(e,l.ProblemType.DiagonalBorder)}function C(e,t){const n=t.CachedDisplayTextRuns;if(t.WrapText&&n)for(let t=0;t<n.length;t++){const r=n[t].CachedFont;if(r&&(r.VerticalAlign===o.FontVerticalAlignment.Subscript||r.VerticalAlign===o.FontVerticalAlignment.Superscript))return void f(e,l.ProblemType.SubScriptSuperScriptInWrapText)}}function f(e,t){const n=l.ProblemType[t];e[n]?e[n]+=1:e[n]=1}a[l.ProblemType[l.ProblemType.AccountingUnderline]]={value:5,errorType:"MissingFeatureWithFallback",veto:"ContentFallback"},a[l.ProblemType[l.ProblemType.BoldText]]={value:25,errorType:"LowRenderingFeature",veto:"ContentRenderedIncorrectly"},a[l.ProblemType[l.ProblemType.CellHashText]]={value:5,errorType:"MissingFeatureWithFallback",veto:"ContentFallback"},a[l.ProblemType[l.ProblemType.CellTextOrientation]]={value:5,errorType:"MissingFeatureWithFallback",veto:"ContentFallback"},a[l.ProblemType[l.ProblemType.CustomFont]]={value:5,errorType:"MissingFeatureWithFallback",veto:"MissingFont"},a[l.ProblemType[l.ProblemType.DiagonalBorder]]={value:1,errorType:"MissingFeatureWithoutFallback",veto:"ContentRenderFailed"},a[l.ProblemType[l.ProblemType.MediumBorder]]={value:25,errorType:"LowRenderingFeature",veto:"ContentRenderedIncorrectly"},a[l.ProblemType[l.ProblemType.PatternStyle]]={value:1,errorType:"MissingFeatureWithoutFallback",veto:"ContentRenderFailed"},a[l.ProblemType[l.ProblemType.SpillCellAcrossBlocks]]={value:5,errorType:"MissingFeatureWithFallback",veto:"ContentFallback"},a[l.ProblemType[l.ProblemType.SubScriptSuperScriptInWrapText]]={value:25,errorType:"LowRenderingFeature",veto:"ContentRenderedIncorrectly"},a[l.ProblemType[l.ProblemType.ThickBorder]]={value:25,errorType:"LowRenderingFeature",veto:"ContentRenderedIncorrectly"},t.analyzeModelFidelity=function(e){const t={};for(let r=0;r<e.Cells.length;r++){const i=e.Cells[r];i&&(c(t,i),s(t,i),d(t,e,i),u(t,i),g(t,i,e),C(t,i),h(t,i),n=t,(o=i).Spill&&o.Spill.IsSpillBlocked&&o.Spill.IsSpillingOutsideOfBlock&&f(n,l.ProblemType.SpillCellAcrossBlocks))}var n,o;return t},t.hasThresholdExceeded=function(e,t){return t>a[e].value},t.getErrorTypeForProblem=function(e){return a[e].errorType+"_"+e},t.getVetoType=function(e){return a[e].veto}},function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.ProblemType=void 0,function(e){e[e.ThickBorder=0]="ThickBorder",e[e.MediumBorder=1]="MediumBorder",e[e.BoldText=2]="BoldText",e[e.CustomFont=3]="CustomFont",e[e.CellHashText=4]="CellHashText",e[e.CellTextOrientation=5]="CellTextOrientation",e[e.AccountingUnderline=6]="AccountingUnderline",e[e.SubScriptSuperScriptInWrapText=7]="SubScriptSuperScriptInWrapText",e[e.PatternStyle=8]="PatternStyle",e[e.DiagonalBorder=9]="DiagonalBorder",e[e.SpillCellAcrossBlocks=10]="SpillCellAcrossBlocks"}(o||(t.ProblemType=o={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerAppMemoryInfoTelemetryCollector=void 0;const o=n(10),r=n(29),i=n(30);let l;t.registerAppMemoryInfoTelemetryCollector=function(){l||(l=new a),l.register({})};class a extends i.AbstractPassiveTelemetryCollector{collect(){var e,t,n;if(!this.canCollectorExecute())return{isValid:!1,value:r.ResultMessageCollectorDisabled};const i=null===(e=performance.memory)||void 0===e?void 0:e.usedJSHeapSize,l=null===(t=performance.memory)||void 0===t?void 0:t.totalJSHeapSize,a=null===(n=performance.memory)||void 0===n?void 0:n.jsHeapSizeLimit,s=navigator.deviceMemory||-1,d=document.getElementsByTagName("*").length,c=(0,o.blockCacheSizeCallback)();let u=0;const g=document.getElementsByTagName(r.CanvasTagName);for(let e=0;e<g.length;e++){const t=g.item(e);t&&(u+=t.clientHeight*t.clientWidth)}return{isValid:!0,value:{usedJSHeapSize:i,totalJSHeapSize:l,jsHeapSizeLimit:a,deviceMemory:s,numOfDomElements:d,numOfCanvas:g.length,numOfGridCanvas:document.getElementsByClassName(r.GridCanvasClassName).length,blockCacheSize:c,computedSizeOfCanvas:u}}}constructor(){super("AppMemoryInfoCollector")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerBlockStatisticsLogCollector=void 0;const o=n(10),r=n(29),i=n(30);let l;t.registerBlockStatisticsLogCollector=function(){l||(l=new a),l.register({})};class a extends i.AbstractPassiveTelemetryCollector{collect(){return this.canCollectorExecute()?{isValid:!0,value:(0,o.getBlockStatisticLog)()}:{isValid:!1,value:r.ResultMessageCollectorDisabled}}constructor(){super("blockStatisticsLogCollector")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerModelCascadeTimeCollector=void 0;const o=n(1),r=n(0),i=n(29),l=n(30);let a;t.registerModelCascadeTimeCollector=function(e){a||(a=new s),function(e){var t;return!(null===(t=e.Cells)||void 0===t||!t.length)}(e)&&a.register(e)};class s extends l.AbstractPassiveTelemetryCollector{collect(){var e;if(!this.canCollectorExecute())return{isValid:!1,value:i.ResultMessageCollectorDisabled};const t=this.data.pop(),n=JSON.stringify(t),o=performance.now(),r=JSON.parse(n),l=JSON.parse(n),a=performance.now(),s=r.Cells,h=s[Math.floor(Math.random()*s.length)].Col,C=[],f=new Map,m=[],p=new Map,y=[],S=new Map,R=[],F=l.Styles.length,T=l.BorderStyles.length,w=l.Fonts.length;for(let e=0;e<s.length;e++){const t=s[e];if(t.Col!==h)continue;const n=g(t);n.Col=0,C.push(n);const o=n.StyleID||0;if(f.has(o))n.StyleID=f.get(o);else{const e=d(o,r,F,f),t=e.FontID||0;if(S.has(t))e.FontID=S.get(t);else{const n=u(t,r,w,S);n.ID=w+n.Size,R.push(n),e.FontID=n.ID,S.set(t,n.ID)}e.ID=F+f.size,f.set(o,e.ID),m.push(e),n.StyleID=e.ID}const i=n.BorderStyleID||0;if(p.has(i))n.BorderStyleID=p.get(i);else{const e=c(i,r,T,p);e.ID=T+f.size,p.set(o,e.ID),y.push(e),n.BorderStyleID=e.ID}}const I=performance.now();!function(e,t){e.ColMetadata.unshift(t.ColMetadata.shift()),e.ColumnNumbers.unshift(t.ColumnNumbers.shift()),e.ColumnOffsets.unshift(t.ColumnOffsets.shift()),e.ColumnWidths.unshift(t.ColumnWidths.shift())}(l,r);const b=performance.now();!function(e,t,n,o){var r,i,l;null===(r=e.Styles)||void 0===r||r.push(...t),null===(i=e.Fonts)||void 0===i||i.push(...n),null===(l=e.BorderStyles)||void 0===l||l.push(...o)}(l,m,R,y);const v=performance.now();null===(e=l.Cells)||void 0===e||e.push(...C);const x=performance.now(),D=(x-o).toFixed(2),A=(a-o).toFixed(2),P=(I-a).toFixed(2),M=(b-I).toFixed(2),B=(v-b).toFixed(2),H=(x-v).toFixed(2),O=(x-a).toFixed(2);return{isValid:!0,value:{numOfCellsCopied:C.length,numOfStylesCopied:m.length,numOfBorderStylesCopied:y.length,numOfFontsCopied:R.length,totalTime:D,totalTimeWithoutPreprocess:O,preparePhaseTime:P,preprocessTime:A,columnShiftTime:M,styleShiftTime:B,cellShiftTime:H}}}constructor(){super("ModelCascadeTimeCollector")}}function d(e,t,n,i){const l=(0,o.getReferencedObjectById)(e,t.Styles);return(0,r.duplicateStyle)(t,l,n+i.size,1)}function c(e,t,n,i){const l=(0,o.getReferencedObjectById)(e,t.BorderStyles);return(0,r.duplicateBorderStyle)(l,n+i.size,1)}function u(e,t,n,i){const l=(0,o.getReferencedObjectById)(e,t.Fonts);return(0,r.duplicateFont)(l,n+i.size,1)}function g(e){const t=e.Spill?{SpanToEnd:e.Spill.SpanToEnd,IsSpillBlocked:e.Spill.IsSpillBlocked,IsSpillingOutsideOfBlock:e.Spill.IsSpillingOutsideOfBlock,SpanToStart:e.Spill.SpanToStart}:void 0;return{Col:e.Col,Row:e.Row,Text:e.Text,StyleID:e.StyleID||0,Ifmt:e.Ifmt||0,IfmtStamped:e.IfmtStamped||0,BorderStyleID:e.BorderStyleID||0,HorizontalAlignmentSet:e.HorizontalAlignmentSet,ValueType:e.ValueType,HasIgnorableError:e.HasIgnorableError,TableColHeader:e.TableColHeader,TableRowHeader:e.TableRowHeader,SrvDx:e.SrvDx||0,SrvDy:e.SrvDy||0,TolType:e.TolType||0,Spill:t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerModelStyleSizeCollector=void 0;const o=n(29),r=n(30);let i;t.registerModelStyleSizeCollector=function(e){var t;i||(i=new l),null!==(t=e.Cells)&&void 0!==t&&t.length&&i.register(e)};class l extends r.AbstractPassiveTelemetryCollector{collect(){var e,t,n,r;if(!this.canCollectorExecute())return{isValid:!1,value:o.ResultMessageCollectorDisabled};const i=new TextEncoder,l=this.data.pop(),a=i.encode(JSON.stringify(l)).length,s=i.encode(JSON.stringify(l.Cells)).length,d=i.encode(JSON.stringify(l.Styles)).length,c=i.encode(JSON.stringify(l.Fonts)).length,u=i.encode(JSON.stringify(l.BorderStyles)).length,g=d+u+c;return{isValid:!0,value:{sizePercentageForModel:g/a*100,sizePercentageForCell:g/(g+s)*100,modelSize:a,styleSize:d,borderStyleSize:u,fontSize:c,numOfCells:(null===(e=l.Cells)||void 0===e?void 0:e.length)||0,numOfStyles:(null===(t=l.Styles)||void 0===t?void 0:t.length)||0,numOfFonts:(null===(n=l.Fonts)||void 0===n?void 0:n.length)||0,numOfBorderStyles:(null===(r=l.BorderStyles)||void 0===r?void 0:r.length)||0}}}constructor(){super("ModelStyleSizeCollector")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.doesMergedCellOverlapMultipleRowColExcludingCellAtEdge=t.isMergeCellsToBeValidatedForFreezePaneCse=t.addEdgeCellsBordersForCascadedCells=t.addEdgeBordersToFreezePaneBlocks=t.isFreezePaneCseSlice1Enabled=void 0;const o=n(1),r=n(0),i=n(139),l=n(11),a=(0,o.isChangeGateEnabled)(o.ChangeGate.EnableMergeCellSupportForFreezePanesCse),s=(0,o.isChangeGateEnabled)(o.ChangeGate.EnableFreezePanesCSEForMergedEdgeCells);let d=void 0,c=void 0;function u(){return void 0===d&&(d=(0,l.getBooleanFeatureGate)("Microsoft.Office.Excel.FreezePanesCseSlice1",!1)),!!d}function g(e,t,n,r,l,a,s,d,c,u,g,h,C,f,m,p){let y=!1;const S=e.BorderStyleID||0,R=(0,o.isGlobalBorderStylesEnabled)(t),F=e.BorderStyleID||0,T=C?m!==e.Col:m!==e.Row,w=(0,i.getAdjacentCell)(e,t.Cells,h,C,!g||!!T,null!=f&&f.skipCascadingBeforeRowColIndex?C?e.Col+(null==f?void 0:f.rowColIndexToEndRangeCascade):e.Row+(null==f?void 0:f.rowColIndexToEndRangeCascade):g?m:p).BorderStyleID||0;if(l&&a.get(F)&&s.get(w))e.BorderStyleID=a.get(F),R&&(e.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID((0,o.getReferencedObjectById)(S,t.BorderStyles)));else{if(l&&(a.set(F,c),s.set(w,n+s.size)),C){const e=u.Borders;let t=e.length;for(let n=0;n<e.length;n++)e[n].BorderPosition<d.BorderPosition&&(t=n+1);u.Borders.splice(t,0,d)}else u.Borders.push(d);r.push(u),e.BorderStyleID=c,R&&(e.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID(u)),y=!0}return y}t.isFreezePaneCseSlice1Enabled=u,t.addEdgeBordersToFreezePaneBlocks=function(e,t,n){const o=n-1,r=e.Cells.filter(e=>t?e.Row===o:e.Col===o),l=e.Cells.filter(e=>t?e.Row===n:e.Col===n);let a=0,s=0;for(;a<l.length;){const n=s<r.length?r[s]:null,o=l[a];t?n?n.Col===o.Col?((0,i.addBottomBorderToNewBlockEdgeCell)(n,o,e,e),s++,a++):n.Col<o.Col?s++:((0,i.addBottomBorderToNewBlockEdgeCell)(n,o,e,e),a++):((0,i.addBottomBorderToNewBlockEdgeCell)(n,o,e,e),a++):n?n.Row===o.Row?((0,i.addRightBorderToNewBlockEdgeCell)(n,o,e,e),s++,a++):n.Row<o.Row?s++:((0,i.addRightBorderToNewBlockEdgeCell)(n,o,e,e),a++):((0,i.addRightBorderToNewBlockEdgeCell)(n,o,e,e),a++)}},t.addEdgeCellsBordersForCascadedCells=function(e,t,n,l,a,s,d,c,h,C,f,m,p){var y,S;const R=u()&&!!f,F=(0,i.isCellInLastCascadedCol)(h,c[c.length-1]),T=C?(null===(y=t.ColumnNumbers)||void 0===y?void 0:y.length)-1:(null===(S=t.RowNumbers)||void 0===S?void 0:S.length)-1,w=!!R&&(0,i.isCellInLastCascadedCol)(m,T),I=C?e.Col:e.Row,b=R&&(0,i.isCellInLastCascadedCol)(I,function(e,t){return null!=t&&t.performDiagonalCascading||null!=t&&t.skipCascadingBeforeRowColIndex?e?i.maxColumnCount-1:i.maxRowCount-1:(null==t?void 0:t.rowColIndexToEndRangeCascade)-1}(C,f));if(!F&&!b&&!w)return!1;(F||w)&&function(e,t,n,l=!1,a){const s=n?e.Col:e.Row;if(l&&s===a&&(n?s===i.maxColumnCount-1:s===i.maxRowCount-1))return;const d=(0,o.isGlobalBorderStylesEnabled)(t),c=t.BorderStyles.length,u=(0,r.duplicateBorderStyle)((0,o.getBorderStyleByID)(e,t),c,1),g=u.Borders.findIndex(e=>l?n?e.BorderPosition===o.BorderPositionType.Right:e.BorderPosition===o.BorderPositionType.Bottom:n?e.BorderPosition===o.BorderPositionType.Bottom:e.BorderPosition===o.BorderPositionType.Right);-1!==g&&(u.Borders.splice(g,1),e.BorderStyleID=c,t.BorderStyles.push(u),d&&(e.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID(u)))}(e,t,C,R,m);let v=!1,x=!1,D=!1;const A=n+l.length,P=e.BorderStyleID||0,M=(0,r.duplicateBorderStyle)((0,o.getReferencedObjectById)(P,t.BorderStyles),A,1);return F&&(v=function(e,t,n,o,r,l,a,s,d,c,u,h,C,f,m){const p=function(e,t,n,o,r,l,a){return l?l?e?(0,i.getBottomBorder)(t,n,o,e,r,a):(0,i.getRightBorder)(t,n,o,e,r,a):{}:e?(0,i.getBottomBorder)(t,n,o,e):(0,i.getRightBorder)(t,n,o,e)}(n,e,t,u,h,n?m!==e.Col:m!==e.Row,function(e,t,n,o){return null!=n&&n.skipCascadingBeforeRowColIndex?e?t.Col+n.rowColIndexToEndRangeCascade:t.Row+n.rowColIndexToEndRangeCascade:o}(n,e,C,m));return 0!==Object.keys(p).length&&g(e,t,o,r,l,a,s,p,d,c,!0,u,n,C,m,f)}(e,t,C,n,l,a,s,d,A,M,h,R,f,p,m)),R&&(w&&(x=function(e,t,n,r,i){const l=e.BorderStyleID||0;return!t.has(l)&&l!==o.UniqueStyleID.DefaultBorder&&(t.set(l,r),n.push(i),!0)}(e,s,l,A,M)),b&&(D=function(e,t,n,o,r,l,a,s,d,c,u,h,C){const f=n?e.Col:e.Row,m=function(e,t,n,o,r,l,a,s){return n?(0,i.getRightBorder)(e,t,o,!n,!0,a):(0,i.getBottomBorder)(e,t,null!=l&&l.performDiagonalCascading?s:o,!n,!0,null!=l&&l.skipCascadingBeforeRowColIndex?n?e.Row+(null==l?void 0:l.rowColIndexToEndRangeCascade):e.Col+(null==l?void 0:l.rowColIndexToEndRangeCascade):a)}(e,t,n,f,0,u,h,C);return 0!==Object.keys(m).length&&g(e,t,o,r,l,a,s,m,d,c,!1,u.performDiagonalCascading?C:f,!n,u,C,h)}(e,t,C,n,l,a,s,d,A,M,f,p,m))),v||D||x},t.isMergeCellsToBeValidatedForFreezePaneCse=function(e){return e===i.GridInstantaneousOperation.FreezePane&&(void 0===c&&(c=(0,l.getBooleanFeatureGate)("Microsoft.Office.Excel.FreezePanesCseSlice2",!1)),!!c&&u())&&a},t.doesMergedCellOverlapMultipleRowColExcludingCellAtEdge=function(e,t,n,o){if(s){if(!e.Merge)return!1;if(o){if(e.Row+e.Merge.Rows===t)return!1}else if(e.Col+e.Merge.Columns===t)return!1}return(0,i.doesMergedCellOverlapMultipleRowCol)(e,t,n,o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerFontCheckTelemetryCollector=void 0;const o=n(29),r=n(30),i=n(10),l=n(8);let a;t.registerFontCheckTelemetryCollector=function(e){if(a||(a=new s),!document.fonts||!i.getFontFamilyEndPoint)return;const t=function(e){const t=[];if(!e.Fonts)return t;for(let n=0;n<e.Fonts.length;n++){const o=e.Fonts[n];o&&t.push(o)}return t}(e);t.length>0&&a.register(t)};class s extends r.AbstractPassiveTelemetryCollector{collect(){if(!this.canCollectorExecute())return{isValid:!1,value:o.ResultMessageCollectorDisabled};const e=this.data.pop();if(!e)return{isValid:!1,value:o.ResultMessageInsufficientData};const t=e[Math.floor(Math.random()*e.length)].FontName;let n=window.performance.now();const r=document.fonts.check("12px "+t,"random text"),a=window.performance.now()-n;return n=window.performance.now(),{isValid:!0,value:{isFontLoadedDocumentCheck:r,timeTakenForDocumentCheck:a,isFontLoadedCanvas:(0,i.isFontSupported)(t),timeTakenForCanvasCheck:window.performance.now()-n,isFontKnown:(0,l.isKnownFont)(t),fontName:(0,i.getFontFamilyEndPoint)(t)}}}constructor(){super("FontCheckTelemetryCollector")}}},function(e,t,n){"use strict";let o;Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeGatesManagerSet=t.isChangeGateEnabled=t.setChangeGatesManager=void 0,t.setChangeGatesManager=e=>{o=e},t.isChangeGateEnabled=e=>!o||o.isChangeGateEnabled(e),t.isChangeGatesManagerSet=()=>!!o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";n.r(t),n.d(t,"rumShepherd",(function(){return o})),n.d(t,"gridRenderer",(function(){return ne}));var o={};n.r(o),n.d(o,"SubComponentInitEventName",(function(){return C})),n.d(o,"SubComponentSetLoadStateEventName",(function(){return f})),n.d(o,"AppLoadMetricReportEventName",(function(){return m})),n.d(o,"dispatchRumShepherdEvent",(function(){return y})),n.d(o,"VISUALLY_READY",(function(){return r})),n.d(o,"FUNCTIONALLY_READY",(function(){return i})),n.d(o,"VISUALLY_PERCEIVED",(function(){return l})),n.d(o,"setupDefaultRumShepherd",(function(){return Q})),n.d(o,"RumShepherdFactoryGlobal",(function(){return te}));const r="visually-ready",i="functionally-ready",l="visually-perceived";var a=n(16);function s(){const e=window.performance;return e&&e.timeOrigin?e.timeOrigin:e&&e.timing&&e.timing.navigationStart?e.timing.navigationStart:0}function d(){const e=window.performance;return e&&e.now?e.now():(new Date).getDate()-s()}function c(){const e=window.performance;return e&&e.now?s()+e.now():(new Date).getDate()}function u(e){return s()+e}let g=[];function h(e,t,n,o){const r=`[rum:${Number(d().toFixed())}]${t} ${n?JSON.stringify(n):""}`;g.push({level:e,message:r}),o&&function(){const e={traces:[...g]};g=[],y(p,e)}()}const C="Wac-SubComponentsInit",f="Wac-SubComponentSetLoadState",m="Wac-AppLoadMetricReport",p="Wac-AppLoadTrace",y=(e,t)=>{try{const n=new CustomEvent(e,{detail:t});self.dispatchEvent(n)}catch(e){h(a.a.Error,"dispatchRumShepherdEvent failed with exception:",e)}};function S(e){return e===r||e===i||e===l}function R(e,t){for(const o in e){var n;if(null===(n=e[o].states[t])||void 0===n||!n.final)return!1}return!0}function F(e,t){return t&&e&&S(t)&&e.states[t]}function T(e){return e?_object_spread({},e):{}}function w(e){const t=[];for(const n in e){const o=e[n];t.push({id:o.id,rootElementId:o.rootElementId,subComponents:b(o.subComponents)})}return t}function I(e){const t=[];for(const n in e){const o=e[n];t.push({id:o.id,rootElementId:o.rootElementId,subComponents:v(o.subComponents)})}return t}function b(e){const t=[];for(const n in e){const o=e[n];o.nonReporting||t.push({id:o.id,initTime:u(o.initTime),optional:o.optional,unused:o.unused,nonReporting:o.nonReporting,states:x(o.states)})}return t}function v(e){const t=[];for(const n in e){const o=e[n];o.nonReporting&&t.push({id:o.id,initTime:u(o.initTime),optional:o.optional,unused:o.unused,nonReporting:o.nonReporting,states:x(o.states)})}return t}function x(e){const t={};for(const n in e){const o=e[n];null!=o&&o.time&&(t[n]=u(o.time))}return t}function D(e,t){const n=e.subComponents;for(const e in n){const o=n[e];if(!(o.states[t]||o.unused||o.nonReporting))return!1}return!0}function A(e){let t=Number.POSITIVE_INFINITY;for(const n in e.subComponents){const o=e.subComponents[n];t=Math.min(t,o.initTime)}return t}function P(e,t){if(!e||!t)return!1;const n=e.subComponents;for(const e in n)if(!M(n[e],t))return!1;return!0}function M(e,t){if(!e)return!1;const n=e.states[t];return e.optional||(null==n?void 0:n.time)&&n.promotedFromPreviousState}function B(e,t){return t===r&&F(e,l)}function H(e,t){return{start:e.start,time:null!=t?t:e.time,error:e.error,monitor:e.monitor,measures:T(e.measures),data:T(e.data)}}function O(e,t,n,o){"then"in e?e.then(e=>{o(e)}).catch(e=>{const r=`Error in invokeMonitor [${n}}]`;h(a.a.Error,r,e),o({start:t,time:t,monitor:"",error:`${r}: ${e}`})}):o(e)}class k{getBooleanSetting(e,t){const n=this._settings[e];if(!n)return t;switch(n.trim().toLowerCase()){case"true":return!0;case"false":return!1;default:return t}}getStringSetting(e,t){return this._settings[e]||t}constructor(e){this._settings=null!=e?e:{}}}class L{get timeout(){return this.timeoutInMs}get reason(){return this._reason}set onCancelled(e){this._onCancelled=e}constructor(e){this.timeoutInMs=e,this._reason="",this._cancel=e=>{this._reason||(this._reason=e?"timeout":"cancelled",this._onCancelled&&this._onCancelled())},this.cancel=()=>{this._cancel(!1)},e>0&&window.setTimeout(()=>this._cancel(!0),e)}}function N(e){return new L(null!=e?e:0)}class E{get tabHideTime(){return this._firstTabHiddenTime}get metrics(){return this._metrics}startMonitors(e,t){h(a.a.Verbose,"startMonitors",{appState:e});const n=(e,n)=>{if(h(a.a.Verbose,"onCompleteWithInputCheck",{metric:e}),n){if(!n.error){const e=this._metrics["first-input"]?this._metrics["first-input"].time:0,t=this._metrics["first-interaction"]?this._metrics["first-interaction"].time:0;e>0&&e<n.time&&(0===t||e<=t)&&(n.error="first-input"),t>0&&t<n.time&&(n.error="first-interaction")}t(e,n)}};e===r&&(this.monitorMetric("first-input",t),this.monitorMetric("first-interaction",t),this.monitorMetric("first-idle",n),this.monitorMetric("stable-interactivity",n,12e4))}cancelMonitors(e){if(e!==r)return;h(a.a.Info,"cancelAppStateMonitors",e);const t=e=>{var t;null===(t=this._monitoredMetrics[e])||void 0===t||t.cancel(),this._monitoredMetrics[e]=void 0,this._metrics[e]=void 0};t("stable-interactivity"),t("first-idle")}monitorMetric(e,t,n){if(h(a.a.Verbose,"monitorMetric",e),this._monitoredMetrics[e])return void h(a.a.Verbose,"monitorMetric:already-running",e);const o=N(n);this._monitoredMetrics[e]=o;const r=d();O((0,this._shepherdInit.monitors[e])(r,o),r,e,n=>{h(a.a.Verbose,"monitorMetric:complete",e),t(e,n)})}constructor(e){this._metrics={},this._monitoredMetrics={},this._firstTabHiddenTime=0,this._shepherdInit=e,function(e){let t="hidden"===document.visibilityState?0:1/0;e(t),document.addEventListener("visibilitychange",n=>{t=Math.min(t,n.timeStamp),e(t)},{once:!0})}(e=>this._firstTabHiddenTime=e)}}function z(e,t,n,o,r){r&&t.nonReporting||(e.states[n]={result:H(o),monitoring:void 0,final:D(e,n)})}class W{ProcessUnusedComponentFinal(e){for(const t in e.states){const n=t,o=e.states[n];!o.final&&D(e,n)&&(h(a.a.Verbose,"processSubComponentUnused:unused-final",{component:e.id,state:n}),o.final=!0,this._reportAppStateIfReady(n))}}addSubComponents(e){if(!(e&&e.component&&e.subComponents))return void h(a.a.Error,"Invalid data",e);const t=this._components[e.component];if(!t)return void h(a.a.Error,"Invalid component",e);const n=t.ignoreNewSubComponents;if(function(e){for(const t in e.states)if(e.states[t].final)return!1;return!0}(t)||n){h(a.a.Verbose,"addSubComponents",{ignore:n,data:e});try{const o=Array.isArray(e.subComponents)?e.subComponents:[e.subComponents];for(let e=0;e<o.length;e+=1)this._addSubComponent(t,o[e],n,!1,!1);if(e.optionalSubComponents)for(let o=0;o<e.optionalSubComponents.length;o+=1)this._addSubComponent(t,e.optionalSubComponents[o],n,!0,!1);if(e.nonReportingSubComponents)for(let o=0;o<e.nonReportingSubComponents.length;o+=1)this._addSubComponent(t,e.nonReportingSubComponents[o],n,!0,!0)}catch(e){h(a.a.Error,"addSubComponents",e)}}else h(a.a.Error,"Component cannot be modified",e)}setSubComponentState(e){var t;const n=d();if(!(e&&e.subComponent&&e.component&&e.state))return void h(a.a.Error,"Invalid data",e);const o=this._components[e.component];if(!o)return void h(a.a.Error,"Invalid component",e);if(o.ignoredSubComponents[e.subComponent])return;o.ignoreNewSubComponents=o.ignoreNewSubComponents||!!e.ignoreNewSubComponents;const r=o.subComponents[e.subComponent];if(!r)return void h(a.a.Error,"Unexpected sub-component",e);if("unused"===e.state)return void this._processSubComponentUnused(o,r);const i=e.state;if(!S(i))return void h(a.a.Error,"Unknown state reported",e);if(null!==(t=o.states[i])&&void 0!==t&&t.final)return void h(a.a.Error,"Component state final. Can't set",e);if(r.unused||r.states[i])return void h(a.a.Error,"SubComponent unused or set",e);const l=e.promoteStateFrom;l?this._processSubComponentState(o,r,i,n,l):this._processSubComponentState(o,r,i,n)}get components(){return this._components}get metrics(){return this._monitorMetrics.metrics}constructor(e){this._components={},this._reportedMetrics={},this._canAppStateMetricBeReported=e=>{if(this._reportedMetrics[e])return!1;const t=R(this._components,e);return h(a.a.Verbose,"canAppStateMetricBeReported:metric-final:",{metric:e,isFinal:t}),t},this._canMonitorMetricBeReported=e=>{if("stable-interactivity"===e||"first-idle"===e){const t=this._monitorMetrics.metrics[e],n=R(this._components,r);return h(a.a.Verbose,"canMonitorMetricBeReported:si-error:",{metric:e,error:null==t?void 0:t.error,vrStateFinal:n}),!!t&&"cancelled"!==t.error&&n}return!0},this._reportMonitorMetricIfReady=e=>{const t=this._reportedMetrics[e],n=this._canMonitorMetricBeReported(e);!t&&n?this._reportMetricInternal(e):h(a.a.Info,"reportMonitorMetricIfReady:not-ready",{metric:e,isReported:t,canMetricBeReported:n})},this._reportAppStateIfReady=e=>{this._canAppStateMetricBeReported(e)&&this._reportMetricInternal(e)},this._reportMetricInternal=e=>{try{const t=this._monitorMetrics.metrics[e],n={metric:e,timeOrigin:this._timeOrigin,time:t.time,error:t.error||(this._monitorMetrics.tabHideTime<t.time?"tab-switch":void 0),monitor:t.monitor,measures:T(t.measures),data:T(t.data),auxMetrics:[],componentsData:w(this._components),nonReportingComponentData:I(this._components)},o=n.measures;if(o.tabsSwitch=this._monitorMetrics.tabHideTime<t.time?this._monitorMetrics.tabHideTime:0,o.start=t.start,o.reportedTime=d(),"stable-interactivity"===e){const e=this._monitorMetrics.metrics[r];o[r]=e?e.time:0;const t=this._monitorMetrics.metrics[i];o[i]=t?t.time:0}if(S(e)){for(const t in this._components){const r=this._components[t];if(!r)continue;const i=r.states[e].result;if(!i)continue;o[t]=i.time,n.error=n.error||i.error;const l={metric:`${e}-${t}`,time:i.time,monitor:i.monitor,error:i.error,measures:T(i.measures)};l.measures.start=i.start,l.measures.init=A(r),n.auxMetrics.push(l)}const t=this._monitorMetrics.metrics["stable-interactivity"];t&&t.error&&"cancelled"!==t.error&&!n.error&&(n.error="si-error")}this._shepherdInit.appLoadMetricReportCallback&&(this._reportedMetrics[e]=!0,h(a.a.Info,"reportMetric:reporting",e,!0),this._shepherdInit.appLoadMetricReportCallback(n))}catch(e){h(a.a.Error,"reportMetric:error",e)}},this._flushRumShepherdState=()=>{const e={time:c(),allMetricsReported:(t=this._reportedMetrics,!!(t[r]&&t[i]&&t["stable-interactivity"]&&t["first-input"]&&t["first-interaction"]&&t["first-idle"])),metrics:this._monitorMetrics.metrics,components:w(this._components),timeOrigin:s()};var t;this._shepherdInit.appLoadStateLoggingCallback(e)},this._processSubComponentState=(e,t,n,o,r)=>{if(F(t,r)){const e=t.states[r];t.states[n]={time:e.time,promotedFromPreviousState:!0}}else t.states[n]={time:o,promotedFromPreviousState:!1};if(h(a.a.Verbose,"processSubComponentState",{component:e.id,subComponent:t.id,state:n}),!function(e,t){const n=e.subComponents;for(const e in n){const o=n[e].states[t];if(!((null==o?void 0:o.time)||n[e].optional||B(n[e],t)))return!1}return!0}(e,n))return void h(a.a.Verbose,"processSubComponentState:component-not-ready",{component:e.id,state:n});const i=(e,t,n)=>{t&&(h(a.a.Info,"processSubComponentState:complete-appstate-metric",e),this.metrics[e]=H(t,n),this._reportAppStateIfReady(e))},l=(e,t)=>{t&&(h(a.a.Info,"processSubComponentState:complete-monitor-metric",e),this.metrics[e]=H(t),this._reportMonitorMetricIfReady(e))},s=(e,t)=>{const n=function(e,t){let n=0;for(const r in e){var o;const i=null===(o=e[r].states[t])||void 0===o||null===(o=o.result)||void 0===o?void 0:o.time,l=e[r].allSubComponentsUnused;if(!i&&!l)return;i&&(n=Math.max(n,i))}return n}(this._components,e);h(a.a.Verbose,"processSubComponentState:appStateTime",{time:n,state:e}),n&&(i(e,t,n),this._monitorMetrics.startMonitors(e,l))};this._monitorMetrics.cancelMonitors(n);const c=this._settingsManager.getBooleanSetting("RumShepherdNonReportingComponentsIsEnabled",!1),u=F(t,r),g=function(e,t){if(t&&e&&e.states[t]){const n=e.states[t];return(null==n?void 0:n.result)&&(null==n?void 0:n.final)}return!1}(e,r);if(u){const o=e.states[r];return g?P(e,n)?(z(e,t,n,o.result,c),void s(n,o.result)):void 0:void(P(e,n)&&o.monitoring&&(h(a.a.Verbose,"processSubComponentState: detected promotion while previous state is monitoring, marking state to promote later.",{component:e.id,state:n,promotedFromState:r}),o.stateToPromoteWhenFinal=n))}if(e.allSubComponentsUnused){const t={start:0,time:0,monitor:""};return e.states[n]={result:H(t),final:!0},h(a.a.Verbose,"processSubComponentState:setting component's state timings to 0 since all subComponents are unused",{component:e.id,state:n}),void s(n,t)}void 0!==r&&h(a.a.Verbose,"processSubComponentState:starting monitor although we are promoting",{component:e.id,subComponent:t.id,promotedFromState:r,state:n,isPromotingAndPromotedStateExists:u,isPreviousStateHasAFinalResult:g});const C=this._shepherdInit.monitors[n];h(a.a.Verbose,"processSubComponentState:start-monitor",{state:n}),function(e,t,n,o){const r=e.states[t];if(null!=r&&r.final)return;null!=r&&r.monitoring&&(null==r||r.monitoring.cancel());const i=d(),l=N(5e3);e.states[t]={monitoring:l,final:D(e,t)},O(n(i,l,e),i,t,o)}(e,n,C,o=>{h(a.a.Verbose,"processSubComponentState:monitor-complete",{state:n});const r=e.states[n].stateToPromoteWhenFinal;z(e,t,n,o,c),r&&(h(a.a.Verbose,"processSubComponentState: promotion callback detected state to promote.",{component:e.id,state:n,stateToPromote:r}),z(e,t,r,o,c)),s(n,o)})},this._processSubComponentUnused=(e,t)=>{h(a.a.Verbose,"processSubComponentUnused",{subComponent:t.id}),t.unused=!0;const n=e.subComponents;let o=!0;for(const e in n)n[e].unused||(o=!1);o?(e.allSubComponentsUnused=!0,this._processSubComponentState(e,t,l,0),h(a.a.Verbose,"processSubComponentUnused:vp-final",{component:e.id,VISUALLY_PERCEIVED:l}),e.states[l].final=!0,this._reportAppStateIfReady(l),this._processSubComponentState(e,t,r,0),h(a.a.Verbose,"processSubComponentUnused:vr-final",{component:e.id,VISUALLY_READY:r}),e.states[r].final=!0,this._reportAppStateIfReady(r),this._processSubComponentState(e,t,i,0),h(a.a.Verbose,"processSubComponentUnused:fr-final",{component:e.id,FUNCTIONALLY_READY:i}),e.states[i].final=!0,this._reportAppStateIfReady(i)):this.ProcessUnusedComponentFinal(e),this._reportMonitorMetricIfReady("stable-interactivity"),this._reportMonitorMetricIfReady("first-idle")},this._addSubComponent=(e,t,n,o,r)=>{n?e.ignoredSubComponents[t]=!0:e.subComponents[t]||(e.subComponents[t]={id:t,initTime:d(),optional:o,unused:!1,nonReporting:r,states:{}})},h(a.a.Info,"initialize"),this._timeOrigin=Number(Number(s()).toFixed()),this._shepherdInit=_object_spread({},e),this._monitorMetrics=new E(this._shepherdInit),this._settingsManager=new k(this._shepherdInit.appSettings);for(const t of e.components)this._components[t.id]={id:t.id,rootElementId:t.rootElementId,ignoreNewSubComponents:!1,subComponents:{},states:{},ignoredSubComponents:{}};window.setTimeout(()=>this._flushRumShepherdState(),12e4)}}function G(e){return"PerformanceObserver"in window&&"function"==typeof PerformanceObserver&&PerformanceObserver.supportedEntryTypes&&-1!==PerformanceObserver.supportedEntryTypes.indexOf(e)}function V(e,t){return window.requestAnimationFrame?new Promise(n=>{let o;const r=(r=0)=>{cancelAnimationFrame(o),n({start:e,time:r,monitor:"rAF",error:t.reason})};t.onCancelled=r,o=requestAnimationFrame(()=>{r(d())})}):Promise.resolve({start:e,time:0,monitor:"",error:"rAF Unsupported"})}function j(e,t){return new Promise(n=>{let o,r;const i=(i=0)=>{cancelAnimationFrame(o),clearTimeout(r),n({start:e,time:i,monitor:"rAF-setTimeout",error:t.reason})};t.onCancelled=()=>i(),o=requestAnimationFrame(()=>{r=window.setTimeout(()=>{i(d())},0)})})}function _(e,t,n=1e3){const o=t||N(12e3);if(!G("longtask"))return function(e,t){const n=d();if(!window.requestAnimationFrame)return Promise.resolve({start:n,time:0,monitor:"",error:"rAF unsupported"});const o=d();let r=0,i=o,l=0,a=0,s=o;return new Promise(o=>{let d;const c=(t=0)=>{cancelAnimationFrame(d);const i={start:n,time:t,monitor:"long-frames",error:e.reason,measures:{longTasksCount:r,longestTaskDuration:a,longTasksDuration:l}};o(i)};e.onCancelled=c;const u=e=>{let n=e-i;const o=e-s;if(s=e,o>=50&&(n=0,l+=o,r+=1,i=e,a=Math.max(a,o)),n>=t)return c(i),void U();d=window.requestAnimationFrame(u)};d=window.requestAnimationFrame(u)})}(o,n);const r=performance.now();let i=0,l=r,a=0,s=0;return new Promise(t=>{let r;const c=()=>{clearTimeout(r),u&&u.disconnect();const n=d()-e,c={start:e,time:l,monitor:"longtask-api",error:o.reason,measures:{longTasksDuration:a,longTasksCount:i,longestTaskDuration:s,monitoredTime:n}};t(c)};o.onCancelled=c;const u=new PerformanceObserver((function(e){e.getEntries().forEach(e=>{i+=1,a+=e.duration;const t=e.startTime+e.duration;l=Math.max(t,l),s=Math.max(s,e.duration)})}));u.observe({entryTypes:["longtask"]});const g=()=>{const e=performance.now()-l;if(e>=n)c(),U();else{const t=n-e;r=window.setTimeout(g,t)}};r=window.setTimeout(g,n)})}function U(){try{self.dispatchEvent(new CustomEvent("StableInteractivityDetected"))}catch(e){h(a.a.Error,"StableInteractivityDetected failed with exception: "+e)}}function q(e,t){return G("first-input")?new Promise(n=>{let o;const r=(t,r,i)=>{o&&o.disconnect(),n({start:e,time:t,monitor:"first-input-api",error:i,measures:{fid:r}})};try{t.onCancelled=()=>r(0,0,t.reason);const e=e=>{const t=e.processingStart,n=t-e.startTime;r(t,n)};o=new PerformanceObserver(t=>{t.getEntries().forEach(t=>e(t))}),o.observe({type:"first-input",buffered:!0})}catch(e){r(0,0,"exception")}}):Promise.resolve({start:e,time:0,monitor:"",error:"FID unsupported"})}function $(e,t){const n=["click","mousedown","keydown","touchstart","pointerdown","wheel","select","contextmenu","scroll"],o={passive:!0,capture:!0},r=c();return new Promise(i=>{const l=(n,o,r)=>{d(removeEventListener);const l={start:e,time:n,monitor:"first-interaction",error:t.reason,data:{eventName:o},measures:{delay:r}};i(l)};t.onCancelled=()=>l(0,"",0);const a=e=>{if(e.cancelable){const t=c(),n=e.timeStamp>1e12;let o=(n?c():performance.now())-e.timeStamp;(o<0||o>t-r)&&(o=0),l(n?e.timeStamp-s():e.timeStamp,e.type,o)}},d=e=>{n.forEach((function(t){e(t,a,o)}))};d(addEventListener)})}function Y(e,t){return window.requestIdleCallback?new Promise(n=>{let o;const r=(t,r)=>{window.cancelIdleCallback(o),n({start:e,time:t,monitor:"first-idle",error:r})};try{o=window.requestIdleCallback(e=>r(d(),e.didTimeout?"timeout":""),{timeout:t.timeout}),t.onCancelled=()=>r(0,t.reason)}catch(e){r(0,"exception")}}):Promise.resolve({start:e,time:0,monitor:"",error:"requestIdleCallback unsupported"})}let X=0;const K=e=>{const t=`report ${e.metric}:${e.time}ms`;h(a.a.Info,t,e);const n=new CustomEvent(m,{detail:e});self.dispatchEvent(n)},J=e=>{h(a.a.Info,`reporting the application load state at epoch time: ${e.time}; with the status of all metrics reported as ${e.allMetricsReported}`,e);const t=new CustomEvent("Wac-AppLoadStateReport",{detail:e});self.dispatchEvent(t)},Z=(e,t,n)=>{if(n){const o=`vr-${n.id}-${X}`;X+=1;const r=document.documentElement;return function(e,t,n,o){let r=o?function(e,t,n,o){if(!G("element"))return;const r="testimg-"+n,i=function(e){const t=document.createElement("img");if(e){if(!("elementTiming"in t))return;t.elementTiming=e}return t.style.position="absolute",t.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",t.ariaHidden="true",t}(r);if(!i)return;const l=null!=o?o:document.documentElement;return new Promise(n=>{const o=(t=0,o)=>{s&&s.disconnect(),n({start:e,time:t,monitor:"image-paint-api",error:o})},s=new PerformanceObserver(e=>{const t=e.getEntries();for(const e of t){const t=e;if(t.identifier===r){try{i.hidden=!0,l.removeChild(i)}catch(e){h(a.a.Error,"measureImagePaintTime",e)}return void o(t.renderTime)}}});t.onCancelled=()=>o(0,t.reason),s.observe({type:"element",buffered:!0}),l.appendChild(i)})}(e,t,n,o):void 0;return r||(r=V(e,t)),r}(e,t,o,null!=r?r:void 0)}return V(e,t)};function Q(e,t){const n=new W({appLoadMetricReportCallback:K,appLoadStateLoggingCallback:J,appSettings:t,monitors:{"visually-ready":Z,"visually-perceived":Z,"functionally-ready":j,"stable-interactivity":_,"first-input":q,"first-interaction":$,"first-idle":Y},components:e});window.addEventListener(C,e=>{const t=e.detail;n.addSubComponents(t)}),window.addEventListener(f,e=>{const t=e.detail;n.setSubComponentState(t)})}class ee{constructor(e){this.rumShepherdDataCollection=[],this.collectRumShepherdAction=e=>{e&&this.rumShepherdDataCollection.push(e)},this.stopRumShepherdDataRetrieverEventListener=()=>{window.removeEventListener("Wac-AppLoadMetricReport",this.eventCallback)},this.eventCallback=e=>{const t=e.detail;"visually-ready"===t.metric&&(this.stopRumShepherdDataRetrieverEventListener(),this.getComponentData(t.auxMetrics),this.shouldCollectSubComponentData&&(this.timeOrigin=t.timeOrigin,this.getSubComponentDataForComponents(t.componentsData)))},this.getSubComponentDataForComponents=e=>{e.forEach(e=>{e.subComponents.forEach(t=>{t.unused||t.nonReporting||(this.collectRumShepherdAction({startTime:0,endTime:t.initTime-this.timeOrigin,rumShepherdDataProps:{component:""+e.id,subComponent:""+t.id,state:"VRInit"}}),this.collectRumShepherdAction({startTime:t.initTime-this.timeOrigin,endTime:t.states["visually-ready"]-this.timeOrigin,rumShepherdDataProps:{component:""+e.id,subComponent:""+t.id,state:"VRInitToVR"}}))})})},this.getComponentData=e=>{e.forEach(e=>{this.collectRumShepherdAction({startTime:0,endTime:e.measures.init,rumShepherdDataProps:{component:""+e.metric.replace("visually-ready-",""),subComponent:"",state:"VRInit"}}),this.collectRumShepherdAction({startTime:e.measures.init,endTime:e.time,rumShepherdDataProps:{component:""+e.metric.replace("visually-ready-",""),subComponent:"",state:"VRInitToVR"}})})},this.retrieveRumShepherdEventsBetweenTimeRange=(e,t)=>this.rumShepherdDataCollection.filter(n=>e<=n.endTime&&t>=n.startTime),this.shouldCollectSubComponentData=e,window.addEventListener("Wac-AppLoadMetricReport",this.eventCallback)}}const te=new class{setupDefault(e){if(e)return Q(e),null}setupDefaultWithAppSettings(e,t){if(!e)return;const n={};try{if(t)for(const e of t.keys())if(e){const o=t.get(e);o&&(n[e]=o)}Q(e,n)}catch(e){h(a.a.Error,"appSettings: map to dictionary conversion error",e)}return null}createAndInitRumShepherdDataRetriever(e){return new ee(e)}};var ne=n(101)},function(e,t,n){"use strict";var o,r,i,l,a,s,d,c;n.r(t),n.d(t,"FontLoadState",(function(){return o})),n.d(t,"LoadStatus",(function(){return r})),n.d(t,"MessageLevel",(function(){return i})),n.d(t,"StaticImages",(function(){return l})),n.d(t,"CanvasServiceSettings",(function(){return a})),n.d(t,"TableSelectorType",(function(){return s})),n.d(t,"FontEndPoint",(function(){return d})),n.d(t,"FontRenderingLogStage",(function(){return c})),function(e){e[e.NotInitialized=-1]="NotInitialized",e[e.Start=0]="Start",e[e.Loaded=1]="Loaded",e[e.Completed=2]="Completed"}(o||(o={})),function(e){e[e.Loaded=0]="Loaded",e[e.Error=1]="Error",e[e.Loading=2]="Loading",e[e.Unloaded=3]="Unloaded",e[e.Missing=4]="Missing",e[e.Undefined=5]="Undefined",e[e.Unexpected=6]="Unexpected"}(r||(r={})),function(e){e[e.Info=0]="Info",e[e.Monitorable=1]="Monitorable",e[e.Warning=2]="Warning",e[e.Error=3]="Error"}(i||(i={})),function(e){e[e.EmptyPivotTable=0]="EmptyPivotTable",e[e.RichValueIconDisambig=1]="RichValueIconDisambig",e[e.RichValueIconSync=2]="RichValueIconSync"}(l||(l={})),function(e){e[e.CanvasEventHandlersMeasureDurationMs=0]="CanvasEventHandlersMeasureDurationMs",e[e.CanvasEventHandlersTimeoutDurationMs=1]="CanvasEventHandlersTimeoutDurationMs",e[e.CanvasEventHandlersLogTraceCooldownMs=2]="CanvasEventHandlersLogTraceCooldownMs",e[e.PassiveTelemetryManagerExecutionDurationMs=3]="PassiveTelemetryManagerExecutionDurationMs",e[e.PassiveTelemetryManagerMaxUserInactiveTimeMs=4]="PassiveTelemetryManagerMaxUserInactiveTimeMs",e[e.PassiveTelemetryManagerMinLogThrottleTimeMs=5]="PassiveTelemetryManagerMinLogThrottleTimeMs",e[e.FontLoadRetryBaseIntervalMs=6]="FontLoadRetryBaseIntervalMs",e[e.FontLoadRetryMaxIntervalMs=7]="FontLoadRetryMaxIntervalMs",e[e.FontLoadRetries=8]="FontLoadRetries",e[e.TextWidthTolLimitForAutofit=9]="TextWidthTolLimitForAutofit",e[e.TextWidthTolLowerLimitForSpillCell=10]="TextWidthTolLowerLimitForSpillCell",e[e.TextWidthTolUpperLimitForSpillCell=11]="TextWidthTolUpperLimitForSpillCell",e[e.TextWidthCacheSizeLimit=12]="TextWidthCacheSizeLimit"}(a||(a={})),function(e){e[e.Column=0]="Column",e[e.Row=1]="Row",e[e.Table=2]="Table"}(s||(s={})),function(e){e[e.Unknown=0]="Unknown",e[e.Static=1]="Static",e[e.Flat=2]="Flat",e[e.Hierarchical=3]="Hierarchical",e[e.Custom=4]="Custom",e[e.Embedded=5]="Embedded"}(d||(d={})),function(e){e[e.TTVRHappenedForApp=0]="TTVRHappenedForApp",e[e.FirstFontLoadCompleted=1]="FirstFontLoadCompleted",e[e.ModelFonts=2]="ModelFonts",e[e.LoadedKnownFonts=3]="LoadedKnownFonts",e[e.FontsToLoad=4]="FontsToLoad",e[e.FontSourceToDownload=5]="FontSourceToDownload",e[e.FontsSourceUrlAdded=6]="FontsSourceUrlAdded",e[e.LocallyAvailableFonts=7]="LocallyAvailableFonts",e[e.TriggerFontLoading=8]="TriggerFontLoading",e[e.FontLoadStatusPending=9]="FontLoadStatusPending",e[e.FontLoadStatusLoaded=10]="FontLoadStatusLoaded",e[e.FontLoadStatusFailed=11]="FontLoadStatusFailed"}(c||(c={}))}])}));
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/gridRenderer.min.js.map/3c233f9a1500f0a63cd45df78f19c659/gridRenderer.min.js.map